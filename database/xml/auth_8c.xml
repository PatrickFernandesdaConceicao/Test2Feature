<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<doxygen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="compound.xsd" version="1.9.1" xml:lang="en-US">
  <compounddef id="auth_8c" kind="file" language="C++">
    <compoundname>auth.c</compoundname>
    <includes refid="config_8h" local="yes">config.h</includes>
    <includes local="no">stdio.h</includes>
    <includes refid="string_8h" local="no">string.h</includes>
    <includes local="no">netinet/in.h</includes>
    <includes local="no">arpa/inet.h</includes>
    <includes refid="priv_8h" local="yes">libssh/priv.h</includes>
    <includes refid="crypto_8h" local="yes">libssh/crypto.h</includes>
    <includes refid="ssh2_8h" local="yes">libssh/ssh2.h</includes>
    <includes refid="buffer_8h" local="yes">libssh/buffer.h</includes>
    <includes refid="agent_8h" local="yes">libssh/agent.h</includes>
    <includes refid="misc_8h" local="yes">libssh/misc.h</includes>
    <includes refid="packet_8h" local="yes">libssh/packet.h</includes>
    <includes refid="session_8h" local="yes">libssh/session.h</includes>
    <includes refid="keys_8h" local="yes">libssh/keys.h</includes>
    <includes refid="auth_8h" local="yes">libssh/auth.h</includes>
    <includes refid="pki_8h" local="yes">libssh/pki.h</includes>
    <includes refid="gssapi_8h" local="yes">libssh/gssapi.h</includes>
    <includes refid="legacy_8h" local="yes">libssh/legacy.h</includes>
    <incdepgraph>
      <node id="33">
        <label>libssh/packet.h</label>
        <link refid="packet_8h"/>
        <childnode refid="20" relation="include">
        </childnode>
      </node>
      <node id="19">
        <label>stdbool.h</label>
      </node>
      <node id="30">
        <label>stdarg.h</label>
      </node>
      <node id="12">
        <label>sys/select.h</label>
      </node>
      <node id="16">
        <label>netinet/in.h</label>
      </node>
      <node id="17">
        <label>arpa/inet.h</label>
      </node>
      <node id="40">
        <label>libssh/pki.h</label>
        <link refid="pki_8h"/>
        <childnode refid="6" relation="include">
        </childnode>
        <childnode refid="5" relation="include">
        </childnode>
        <childnode refid="18" relation="include">
        </childnode>
        <childnode refid="41" relation="include">
        </childnode>
      </node>
      <node id="39">
        <label>libssh/keys.h</label>
        <link refid="keys_8h"/>
        <childnode refid="2" relation="include">
        </childnode>
        <childnode refid="9" relation="include">
        </childnode>
        <childnode refid="20" relation="include">
        </childnode>
      </node>
      <node id="5">
        <label>libssh/priv.h</label>
        <link refid="priv_8h"/>
        <childnode refid="6" relation="include">
        </childnode>
        <childnode refid="7" relation="include">
        </childnode>
        <childnode refid="4" relation="include">
        </childnode>
        <childnode refid="8" relation="include">
        </childnode>
        <childnode refid="9" relation="include">
        </childnode>
        <childnode refid="15" relation="include">
        </childnode>
      </node>
      <node id="14">
        <label>libssh/legacy.h</label>
        <link refid="legacy_8h"/>
      </node>
      <node id="4">
        <label>string.h</label>
        <link refid="string_8h"/>
        <childnode refid="5" relation="include">
        </childnode>
      </node>
      <node id="6">
        <label>stdint.h</label>
      </node>
      <node id="7">
        <label>stdlib.h</label>
      </node>
      <node id="32">
        <label>libssh/misc.h</label>
        <link refid="misc_8h"/>
      </node>
      <node id="24">
        <label>libssh/dh.h</label>
        <link refid="dh_8h"/>
        <childnode refid="2" relation="include">
        </childnode>
        <childnode refid="18" relation="include">
        </childnode>
      </node>
      <node id="29">
        <label>libssh/buffer.h</label>
        <link refid="buffer_8h"/>
        <childnode refid="30" relation="include">
        </childnode>
        <childnode refid="9" relation="include">
        </childnode>
      </node>
      <node id="21">
        <label>libssh/libcrypto.h</label>
        <link refid="libcrypto_8h"/>
        <childnode refid="2" relation="include">
        </childnode>
      </node>
      <node id="15">
        <label>libssh/callbacks.h</label>
        <link refid="callbacks_8h"/>
        <childnode refid="9" relation="include">
        </childnode>
        <childnode refid="4" relation="include">
        </childnode>
      </node>
      <node id="13">
        <label>netdb.h</label>
      </node>
      <node id="25">
        <label>libssh/ecdh.h</label>
        <link refid="ecdh_8h"/>
        <childnode refid="2" relation="include">
        </childnode>
        <childnode refid="15" relation="include">
        </childnode>
      </node>
      <node id="26">
        <label>libssh/kex.h</label>
        <link refid="kex_8h"/>
        <childnode refid="5" relation="include">
        </childnode>
        <childnode refid="15" relation="include">
        </childnode>
      </node>
      <node id="35">
        <label>libssh/pcap.h</label>
        <link refid="pcap_8h"/>
        <childnode refid="2" relation="include">
        </childnode>
        <childnode refid="9" relation="include">
        </childnode>
      </node>
      <node id="23">
        <label>libssh/libmbedcrypto.h</label>
        <link refid="libmbedcrypto_8h"/>
        <childnode refid="2" relation="include">
        </childnode>
      </node>
      <node id="37">
        <label>libssh/channels.h</label>
        <link refid="channels_8h"/>
        <childnode refid="5" relation="include">
        </childnode>
      </node>
      <node id="11">
        <label>sys/types.h</label>
      </node>
      <node id="22">
        <label>libssh/libgcrypt.h</label>
        <link refid="libgcrypt_8h"/>
        <childnode refid="2" relation="include">
        </childnode>
      </node>
      <node id="31">
        <label>libssh/agent.h</label>
        <link refid="agent_8h"/>
        <childnode refid="9" relation="include">
        </childnode>
      </node>
      <node id="8">
        <label>unistd.h</label>
      </node>
      <node id="18">
        <label>libssh/crypto.h</label>
        <link refid="crypto_8h"/>
        <childnode refid="19" relation="include">
        </childnode>
        <childnode refid="2" relation="include">
        </childnode>
        <childnode refid="20" relation="include">
        </childnode>
        <childnode refid="24" relation="include">
        </childnode>
        <childnode refid="25" relation="include">
        </childnode>
        <childnode refid="26" relation="include">
        </childnode>
        <childnode refid="27" relation="include">
        </childnode>
      </node>
      <node id="38">
        <label>libssh/poll.h</label>
        <link refid="poll_8h"/>
        <childnode refid="2" relation="include">
        </childnode>
      </node>
      <node id="41">
        <label>libssh/ed25519.h</label>
        <link refid="ed25519_8h"/>
        <childnode refid="5" relation="include">
        </childnode>
      </node>
      <node id="9">
        <label>libssh/libssh.h</label>
        <link refid="libssh_8h"/>
        <childnode refid="8" relation="include">
        </childnode>
        <childnode refid="10" relation="include">
        </childnode>
        <childnode refid="11" relation="include">
        </childnode>
        <childnode refid="12" relation="include">
        </childnode>
        <childnode refid="13" relation="include">
        </childnode>
        <childnode refid="14" relation="include">
        </childnode>
      </node>
      <node id="27">
        <label>libssh/curve25519.h</label>
        <link refid="curve25519_8h"/>
        <childnode refid="2" relation="include">
        </childnode>
        <childnode refid="9" relation="include">
        </childnode>
      </node>
      <node id="20">
        <label>libssh/wrapper.h</label>
        <link refid="wrapper_8h"/>
        <childnode refid="19" relation="include">
        </childnode>
        <childnode refid="2" relation="include">
        </childnode>
        <childnode refid="9" relation="include">
        </childnode>
        <childnode refid="21" relation="include">
        </childnode>
        <childnode refid="22" relation="include">
        </childnode>
        <childnode refid="23" relation="include">
        </childnode>
      </node>
      <node id="2">
        <label>config.h</label>
        <link refid="config_8h"/>
      </node>
      <node id="28">
        <label>libssh/ssh2.h</label>
        <link refid="ssh2_8h"/>
      </node>
      <node id="36">
        <label>libssh/auth.h</label>
        <link refid="auth_8h"/>
        <childnode refid="2" relation="include">
        </childnode>
        <childnode refid="15" relation="include">
        </childnode>
      </node>
      <node id="42">
        <label>libssh/gssapi.h</label>
        <link refid="gssapi_8h"/>
        <childnode refid="2" relation="include">
        </childnode>
        <childnode refid="34" relation="include">
        </childnode>
      </node>
      <node id="3">
        <label>stdio.h</label>
      </node>
      <node id="1">
        <label>libssh-mirror/src/auth.c</label>
        <link refid="auth_8c"/>
        <childnode refid="2" relation="include">
        </childnode>
        <childnode refid="3" relation="include">
        </childnode>
        <childnode refid="4" relation="include">
        </childnode>
        <childnode refid="16" relation="include">
        </childnode>
        <childnode refid="17" relation="include">
        </childnode>
        <childnode refid="5" relation="include">
        </childnode>
        <childnode refid="18" relation="include">
        </childnode>
        <childnode refid="28" relation="include">
        </childnode>
        <childnode refid="29" relation="include">
        </childnode>
        <childnode refid="31" relation="include">
        </childnode>
        <childnode refid="32" relation="include">
        </childnode>
        <childnode refid="33" relation="include">
        </childnode>
        <childnode refid="34" relation="include">
        </childnode>
        <childnode refid="39" relation="include">
        </childnode>
        <childnode refid="36" relation="include">
        </childnode>
        <childnode refid="40" relation="include">
        </childnode>
        <childnode refid="42" relation="include">
        </childnode>
        <childnode refid="14" relation="include">
        </childnode>
      </node>
      <node id="34">
        <label>libssh/session.h</label>
        <link refid="session_8h"/>
        <childnode refid="19" relation="include">
        </childnode>
        <childnode refid="5" relation="include">
        </childnode>
        <childnode refid="26" relation="include">
        </childnode>
        <childnode refid="33" relation="include">
        </childnode>
        <childnode refid="35" relation="include">
        </childnode>
        <childnode refid="36" relation="include">
        </childnode>
        <childnode refid="37" relation="include">
        </childnode>
        <childnode refid="38" relation="include">
        </childnode>
        <childnode refid="2" relation="include">
        </childnode>
        <childnode refid="32" relation="include">
        </childnode>
      </node>
      <node id="10">
        <label>inttypes.h</label>
      </node>
    </incdepgraph>
    <innerclass refid="structssh__agent__state__struct" prot="public">ssh_agent_state_struct</innerclass>
    <innerclass refid="structssh__auth__auto__state__struct" prot="public">ssh_auth_auto_state_struct</innerclass>
      <sectiondef kind="enum">
      <memberdef kind="enum" id="group__libssh__auth_1ga288d00c21fe2d652607792379d90b7cf" prot="public" static="no" strong="no">
        <type></type>
        <name>ssh_agent_state_e</name>
        <enumvalue id="group__libssh__auth_1gga288d00c21fe2d652607792379d90b7cfa5965e2ae4d759e633b54e038783fb118" prot="public">
          <name>SSH_AGENT_STATE_NONE</name>
          <initializer>= 0</initializer>
          <briefdescription>
          </briefdescription>
          <detaileddescription>
          </detaileddescription>
        </enumvalue>
        <enumvalue id="group__libssh__auth_1gga288d00c21fe2d652607792379d90b7cfa2c08668800684d1e8b900b73b6681bb6" prot="public">
          <name>SSH_AGENT_STATE_PUBKEY</name>
          <briefdescription>
          </briefdescription>
          <detaileddescription>
          </detaileddescription>
        </enumvalue>
        <enumvalue id="group__libssh__auth_1gga288d00c21fe2d652607792379d90b7cfaadc9127e305c239a7e60de4bb569c89d" prot="public">
          <name>SSH_AGENT_STATE_AUTH</name>
          <briefdescription>
          </briefdescription>
          <detaileddescription>
          </detaileddescription>
        </enumvalue>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="libssh-mirror/src/auth.c" line="827" column="1" bodyfile="libssh-mirror/src/auth.c" bodystart="827" bodyend="831"/>
      </memberdef>
      <memberdef kind="enum" id="group__libssh__auth_1gac65f4923889fe6f2b91021872463b4c4" prot="public" static="no" strong="no">
        <type></type>
        <name>ssh_auth_auto_state_e</name>
        <enumvalue id="group__libssh__auth_1ggac65f4923889fe6f2b91021872463b4c4a7423bce4e2477ab036c8ce272fd7642f" prot="public">
          <name>SSH_AUTH_AUTO_STATE_NONE</name>
          <initializer>= 0</initializer>
          <briefdescription>
          </briefdescription>
          <detaileddescription>
          </detaileddescription>
        </enumvalue>
        <enumvalue id="group__libssh__auth_1ggac65f4923889fe6f2b91021872463b4c4a82677b8f55353fe73bdd8ddb9958d367" prot="public">
          <name>SSH_AUTH_AUTO_STATE_PUBKEY</name>
          <briefdescription>
          </briefdescription>
          <detaileddescription>
          </detaileddescription>
        </enumvalue>
        <enumvalue id="group__libssh__auth_1ggac65f4923889fe6f2b91021872463b4c4a0f73343ecb44ed535c5d53cede05485a" prot="public">
          <name>SSH_AUTH_AUTO_STATE_KEY_IMPORTED</name>
          <briefdescription>
          </briefdescription>
          <detaileddescription>
          </detaileddescription>
        </enumvalue>
        <enumvalue id="group__libssh__auth_1ggac65f4923889fe6f2b91021872463b4c4ad484a042d380c408bc75ef844e8e0e9c" prot="public">
          <name>SSH_AUTH_AUTO_STATE_PUBKEY_ACCEPTED</name>
          <briefdescription>
          </briefdescription>
          <detaileddescription>
          </detaileddescription>
        </enumvalue>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="libssh-mirror/src/auth.c" line="964" column="1" bodyfile="libssh-mirror/src/auth.c" bodystart="964" bodyend="969"/>
      </memberdef>
      </sectiondef>
      <sectiondef kind="func">
      <memberdef kind="function" id="group__libssh__auth_1ga812fb86c3dd4a6245bc7d01beaa9cfe8" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>static int ssh_userauth_request_service</definition>
        <argsstring>(ssh_session session)</argsstring>
        <name>ssh_userauth_request_service</name>
        <param>
          <type><ref refid="libssh_8h_1a02d3754de040612632cdd499c20f92f6" kindref="member">ssh_session</ref></type>
          <declname>session</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="libssh-mirror/src/auth.c" line="69" column="12" bodyfile="libssh-mirror/src/auth.c" bodystart="69" bodyend="79"/>
        <references refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" compoundref="pkd__daemon_8c" startline="62">rc</references>
        <references refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" compoundref="torture__session__keys_8c" startline="61">session</references>
        <references refid="libssh_8h_1a9c57e4f6482106336045a4d25a55f28e" compoundref="libssh_8h" startline="331">SSH_AGAIN</references>
        <references refid="priv_8h_1aa21fd8a7a609329603b7b16da7939fca" compoundref="priv_8h" startline="240">SSH_LOG</references>
        <references refid="libssh_8h_1ab3c2f1accd58d32987f02d8aebdc1fc4" compoundref="libssh_8h" startline="370">SSH_LOG_WARN</references>
        <references refid="libssh_8h_1ac1ee1d1e917456d4760a94a18015377d" compoundref="libssh_8h" startline="329">SSH_OK</references>
        <references refid="libssh_8h_1abf8db7680a5214da800ad02d8599f073" compoundref="client_8c" startline="325" endline="370">ssh_service_request</references>
        <referencedby refid="group__libssh__auth_1ga691078be9ea2a55fed97c7488395af5a" compoundref="auth_8c" startline="726" endline="825">ssh_userauth_agent_publickey</referencedby>
        <referencedby refid="group__libssh__auth_1gac689d3761c0dc4ebee9971ecc482d9a4" compoundref="auth_8c" startline="1424" endline="1480">ssh_userauth_kbdint_init</referencedby>
        <referencedby refid="group__libssh__auth_1ga58e7c265236edbc97a2f117d3f23b4dd" compoundref="auth_8c" startline="406" endline="459">ssh_userauth_none</referencedby>
        <referencedby refid="group__libssh__auth_1ga50c0c150f8c4703e7ee49b3e3e3ca215" compoundref="auth_8c" startline="1246" endline="1307">ssh_userauth_password</referencedby>
        <referencedby refid="group__libssh__auth_1gaa38c4f3194ef36720da7eddb0aa99e23" compoundref="auth_8c" startline="609" endline="723">ssh_userauth_publickey</referencedby>
        <referencedby refid="group__libssh__auth_1ga592f673c4d417a6a46cd4876ac8287aa" compoundref="auth_8c" startline="489" endline="584">ssh_userauth_try_publickey</referencedby>
      </memberdef>
      <memberdef kind="function" id="group__libssh__auth_1ga4eba018b5d45cc32999cb76b06440c55" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>static int ssh_auth_response_termination</definition>
        <argsstring>(void *user)</argsstring>
        <name>ssh_auth_response_termination</name>
        <param>
          <type>void *</type>
          <declname>user</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="libssh-mirror/src/auth.c" line="81" column="12" bodyfile="libssh-mirror/src/auth.c" bodystart="81" bodyend="97"/>
        <references refid="structssh__session__struct_1a3d57e01582c0c9099f7f319513321fe8">ssh_session_struct::auth</references>
        <references refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" compoundref="torture__session__keys_8c" startline="61">session</references>
        <references refid="auth_8h_1a0d3114986a741a14dc3ac03f7d8eafefa1aebfec92e739cd95a40eafe1b468444" compoundref="auth_8h" startline="86">SSH_AUTH_STATE_AUTH_NONE_SENT</references>
        <references refid="auth_8h_1a0d3114986a741a14dc3ac03f7d8eafefab046bd91ca00b04b47ce0c7b670423ba" compoundref="auth_8h" startline="78">SSH_AUTH_STATE_GSSAPI_MIC_SENT</references>
        <references refid="auth_8h_1a0d3114986a741a14dc3ac03f7d8eafefa12492663176bc8d81ec1f5f832ee7250" compoundref="auth_8h" startline="74">SSH_AUTH_STATE_GSSAPI_REQUEST_SENT</references>
        <references refid="auth_8h_1a0d3114986a741a14dc3ac03f7d8eafefa91300865963f77efc3044542fbd6ce36" compoundref="auth_8h" startline="76">SSH_AUTH_STATE_GSSAPI_TOKEN</references>
        <references refid="auth_8h_1a0d3114986a741a14dc3ac03f7d8eafefa6d785d00012593230e88f00debb19179" compoundref="auth_8h" startline="72">SSH_AUTH_STATE_KBDINT_SENT</references>
        <references refid="auth_8h_1a0d3114986a741a14dc3ac03f7d8eafefa3ec3c08deba889e791cdca82edeb2ce6" compoundref="auth_8h" startline="58">SSH_AUTH_STATE_NONE</references>
        <references refid="auth_8h_1a0d3114986a741a14dc3ac03f7d8eafefaedccdf68a9f5857c7f31ac557b2a57b6" compoundref="auth_8h" startline="84">SSH_AUTH_STATE_PASSWORD_AUTH_SENT</references>
        <references refid="auth_8h_1a0d3114986a741a14dc3ac03f7d8eafefa867ade5fd7a5853b32a1935a47bd9776" compoundref="auth_8h" startline="82">SSH_AUTH_STATE_PUBKEY_AUTH_SENT</references>
        <references refid="auth_8h_1a0d3114986a741a14dc3ac03f7d8eafefaeb9522ba4289c7bf7575802e7182cc3d" compoundref="auth_8h" startline="80">SSH_AUTH_STATE_PUBKEY_OFFER_SENT</references>
        <references refid="structssh__session__struct_1af0805877d21d43e81423ead52345c64b" compoundref="session_8h" startline="156">ssh_session_struct::state</references>
        <references refid="ssh__client_8c_1a14871705f45ccdc5bb9f4549efd8e119" compoundref="ssh__client_8c" startline="48">user</references>
        <referencedby refid="group__libssh__auth_1gabff6b3898d3bf45b62cc3ed3774eaa83" compoundref="auth_8c" startline="142" endline="186">ssh_userauth_get_response</referencedby>
      </memberdef>
      <memberdef kind="function" id="group__libssh__auth_1gafd0aab143e9cce0a3781144fe74dd7ab" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>const char *</type>
        <definition>static const char* ssh_auth_get_current_method</definition>
        <argsstring>(ssh_session session)</argsstring>
        <name>ssh_auth_get_current_method</name>
        <param>
          <type><ref refid="libssh_8h_1a02d3754de040612632cdd499c20f92f6" kindref="member">ssh_session</ref></type>
          <declname>session</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="libssh-mirror/src/auth.c" line="99" column="19" bodyfile="libssh-mirror/src/auth.c" bodystart="99" bodyend="127"/>
        <references refid="structssh__session__struct_1a3d57e01582c0c9099f7f319513321fe8">ssh_session_struct::auth</references>
        <references refid="structssh__session__struct_1aa859857ac7a99808ffc537e08087e541" compoundref="session_8h" startline="158">ssh_session_struct::current_method</references>
        <references refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" compoundref="torture__session__keys_8c" startline="61">session</references>
        <references refid="libssh_8h_1aa17667dad32ec77112a201b1b4b858e8" compoundref="libssh_8h" startline="177">SSH_AUTH_METHOD_GSSAPI_MIC</references>
        <references refid="libssh_8h_1a47af3117d9ab19c61afeebfbfac8cfc4" compoundref="libssh_8h" startline="175">SSH_AUTH_METHOD_HOSTBASED</references>
        <references refid="libssh_8h_1a4c64484fdce4756309799d0e2a4e926a" compoundref="libssh_8h" startline="176">SSH_AUTH_METHOD_INTERACTIVE</references>
        <references refid="libssh_8h_1af37d502f88abb23d55e6c35aacc6b340" compoundref="libssh_8h" startline="172">SSH_AUTH_METHOD_NONE</references>
        <references refid="libssh_8h_1ad10dd2f5826e2d92a30bd8af3404574d" compoundref="libssh_8h" startline="173">SSH_AUTH_METHOD_PASSWORD</references>
        <references refid="libssh_8h_1aff27d66c1f5ba3871e72b5a61573f44a" compoundref="libssh_8h" startline="174">SSH_AUTH_METHOD_PUBLICKEY</references>
        <referencedby refid="group__libssh__auth_1ga89e83a8f415d2d6783b25b5f96226208" compoundref="auth_8c" startline="222" endline="277">SSH_PACKET_CALLBACK</referencedby>
      </memberdef>
      <memberdef kind="function" id="group__libssh__auth_1gabff6b3898d3bf45b62cc3ed3774eaa83" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>static int ssh_userauth_get_response</definition>
        <argsstring>(ssh_session session)</argsstring>
        <name>ssh_userauth_get_response</name>
        <param>
          <type><ref refid="libssh_8h_1a02d3754de040612632cdd499c20f92f6" kindref="member">ssh_session</ref></type>
          <declname>session</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="libssh-mirror/src/auth.c" line="142" column="12" bodyfile="libssh-mirror/src/auth.c" bodystart="142" bodyend="186"/>
        <references refid="structssh__session__struct_1a3d57e01582c0c9099f7f319513321fe8">ssh_session_struct::auth</references>
        <references refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" compoundref="pkd__daemon_8c" startline="62">rc</references>
        <references refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" compoundref="torture__session__keys_8c" startline="61">session</references>
        <references refid="libssh_8h_1a5b35a5038ad8eac4a4e4c00c6239e6e2a0f166cff4fa03faf4e4c11ad854a4996" compoundref="libssh_8h" startline="166">SSH_AUTH_AGAIN</references>
        <references refid="libssh_8h_1a5b35a5038ad8eac4a4e4c00c6239e6e2ac3d2d6d092a7adc147b7f859a0b252d2" compoundref="libssh_8h" startline="163">SSH_AUTH_DENIED</references>
        <references refid="libssh_8h_1a5b35a5038ad8eac4a4e4c00c6239e6e2a33d82f552d20734c17e770af637e3e17" compoundref="libssh_8h" startline="167">SSH_AUTH_ERROR</references>
        <references refid="libssh_8h_1a5b35a5038ad8eac4a4e4c00c6239e6e2a644612ea6c0e8413a3ff82547b74ce3a" compoundref="libssh_8h" startline="165">SSH_AUTH_INFO</references>
        <references refid="libssh_8h_1a5b35a5038ad8eac4a4e4c00c6239e6e2a3bb06206cff7b6f818099d6019418eea" compoundref="libssh_8h" startline="164">SSH_AUTH_PARTIAL</references>
        <references refid="group__libssh__auth_1ga4eba018b5d45cc32999cb76b06440c55" compoundref="auth_8c" startline="81" endline="97">ssh_auth_response_termination</references>
        <references refid="auth_8h_1a0d3114986a741a14dc3ac03f7d8eafefa1aebfec92e739cd95a40eafe1b468444" compoundref="auth_8h" startline="86">SSH_AUTH_STATE_AUTH_NONE_SENT</references>
        <references refid="auth_8h_1a0d3114986a741a14dc3ac03f7d8eafefa331579d75bb0aa08050ca67a12861387" compoundref="auth_8h" startline="66">SSH_AUTH_STATE_ERROR</references>
        <references refid="auth_8h_1a0d3114986a741a14dc3ac03f7d8eafefa2274da14b3dc9f07b5fe6493045c356c" compoundref="auth_8h" startline="64">SSH_AUTH_STATE_FAILED</references>
        <references refid="auth_8h_1a0d3114986a741a14dc3ac03f7d8eafefab046bd91ca00b04b47ce0c7b670423ba" compoundref="auth_8h" startline="78">SSH_AUTH_STATE_GSSAPI_MIC_SENT</references>
        <references refid="auth_8h_1a0d3114986a741a14dc3ac03f7d8eafefa12492663176bc8d81ec1f5f832ee7250" compoundref="auth_8h" startline="74">SSH_AUTH_STATE_GSSAPI_REQUEST_SENT</references>
        <references refid="auth_8h_1a0d3114986a741a14dc3ac03f7d8eafefa91300865963f77efc3044542fbd6ce36" compoundref="auth_8h" startline="76">SSH_AUTH_STATE_GSSAPI_TOKEN</references>
        <references refid="auth_8h_1a0d3114986a741a14dc3ac03f7d8eafefa97ddb5eeec18ad7d054ec5795e6e16d6" compoundref="auth_8h" startline="68">SSH_AUTH_STATE_INFO</references>
        <references refid="auth_8h_1a0d3114986a741a14dc3ac03f7d8eafefa6d785d00012593230e88f00debb19179" compoundref="auth_8h" startline="72">SSH_AUTH_STATE_KBDINT_SENT</references>
        <references refid="auth_8h_1a0d3114986a741a14dc3ac03f7d8eafefa3ec3c08deba889e791cdca82edeb2ce6" compoundref="auth_8h" startline="58">SSH_AUTH_STATE_NONE</references>
        <references refid="auth_8h_1a0d3114986a741a14dc3ac03f7d8eafefa36be1b8a3aec2b226f03077dc1e6f962" compoundref="auth_8h" startline="60">SSH_AUTH_STATE_PARTIAL</references>
        <references refid="auth_8h_1a0d3114986a741a14dc3ac03f7d8eafefaedccdf68a9f5857c7f31ac557b2a57b6" compoundref="auth_8h" startline="84">SSH_AUTH_STATE_PASSWORD_AUTH_SENT</references>
        <references refid="auth_8h_1a0d3114986a741a14dc3ac03f7d8eafefa8d27800e44e1c7e3a5f30594443f78ef" compoundref="auth_8h" startline="70">SSH_AUTH_STATE_PK_OK</references>
        <references refid="auth_8h_1a0d3114986a741a14dc3ac03f7d8eafefa867ade5fd7a5853b32a1935a47bd9776" compoundref="auth_8h" startline="82">SSH_AUTH_STATE_PUBKEY_AUTH_SENT</references>
        <references refid="auth_8h_1a0d3114986a741a14dc3ac03f7d8eafefaeb9522ba4289c7bf7575802e7182cc3d" compoundref="auth_8h" startline="80">SSH_AUTH_STATE_PUBKEY_OFFER_SENT</references>
        <references refid="auth_8h_1a0d3114986a741a14dc3ac03f7d8eafefa8e24c237c09404d0c93a1d3b5f8f3945" compoundref="auth_8h" startline="62">SSH_AUTH_STATE_SUCCESS</references>
        <references refid="libssh_8h_1a5b35a5038ad8eac4a4e4c00c6239e6e2ab145398ebf554c3cc5d6acfb241c5235" compoundref="libssh_8h" startline="162">SSH_AUTH_SUCCESS</references>
        <references refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" compoundref="libssh_8h" startline="330">SSH_ERROR</references>
        <references refid="group__libssh__session_1ga4b84e1ae757c0d4007a5eefdf4651694" compoundref="session_8c" startline="692" endline="740">ssh_handle_packets_termination</references>
        <references refid="session_8h_1a1d6b747c5003e24c3461096c76580b15" compoundref="session_8h" startline="82">SSH_TIMEOUT_USER</references>
        <references refid="structssh__session__struct_1af0805877d21d43e81423ead52345c64b" compoundref="session_8h" startline="156">ssh_session_struct::state</references>
        <referencedby refid="group__libssh__auth_1ga691078be9ea2a55fed97c7488395af5a" compoundref="auth_8c" startline="726" endline="825">ssh_userauth_agent_publickey</referencedby>
        <referencedby refid="group__libssh__auth_1gac689d3761c0dc4ebee9971ecc482d9a4" compoundref="auth_8c" startline="1424" endline="1480">ssh_userauth_kbdint_init</referencedby>
        <referencedby refid="group__libssh__auth_1gaaa68e6aec2da509b246b7cba071408d3" compoundref="auth_8c" startline="1493" endline="1542">ssh_userauth_kbdint_send</referencedby>
        <referencedby refid="group__libssh__auth_1ga58e7c265236edbc97a2f117d3f23b4dd" compoundref="auth_8c" startline="406" endline="459">ssh_userauth_none</referencedby>
        <referencedby refid="group__libssh__auth_1ga50c0c150f8c4703e7ee49b3e3e3ca215" compoundref="auth_8c" startline="1246" endline="1307">ssh_userauth_password</referencedby>
        <referencedby refid="group__libssh__auth_1gaa38c4f3194ef36720da7eddb0aa99e23" compoundref="auth_8c" startline="609" endline="723">ssh_userauth_publickey</referencedby>
        <referencedby refid="group__libssh__auth_1ga592f673c4d417a6a46cd4876ac8287aa" compoundref="auth_8c" startline="489" endline="584">ssh_userauth_try_publickey</referencedby>
      </memberdef>
      <memberdef kind="function" id="group__libssh__auth_1ga1fc1f11c7ba0469c866c42956450ebf7" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type></type>
        <definition>SSH_PACKET_CALLBACK</definition>
        <argsstring>(ssh_packet_userauth_banner)</argsstring>
        <name>SSH_PACKET_CALLBACK</name>
        <param>
          <type>ssh_packet_userauth_banner</type>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="libssh-mirror/src/auth.c" line="195" column="1" bodyfile="libssh-mirror/src/auth.c" bodystart="195" bodyend="213"/>
        <references refid="structssh__session__struct_1a556cfe2037fb907bb21d1aa6a10a8944" compoundref="session_8h" startline="134">ssh_session_struct::banner</references>
        <references refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" compoundref="torture__session__keys_8c" startline="61">session</references>
        <references refid="buffer_8h_1ae9ba83ddeaf673b2d15be5312495ed7e">ssh_buffer_get_ssh_string</references>
        <references refid="priv_8h_1aa21fd8a7a609329603b7b16da7939fca" compoundref="priv_8h" startline="240">SSH_LOG</references>
        <references refid="libssh_8h_1a5e4247396f11fdc228d356a408c81715" compoundref="libssh_8h" startline="374">SSH_LOG_DEBUG</references>
        <references refid="libssh_8h_1ab3c2f1accd58d32987f02d8aebdc1fc4" compoundref="libssh_8h" startline="370">SSH_LOG_WARN</references>
        <references refid="group__libssh__callbacks_1gac29df803aa1295d6a498c1b081f3b494" compoundref="callbacks_8h" startline="517">SSH_PACKET_USED</references>
        <references refid="libssh_8h_1a5bc8710c8633117ff449d15489fca051" compoundref="libssh_8h" startline="790">SSH_STRING_FREE</references>
        <references refid="ssh__client_8c_1a14871705f45ccdc5bb9f4549efd8e119" compoundref="ssh__client_8c" startline="48">user</references>
      </memberdef>
      <memberdef kind="function" id="group__libssh__auth_1ga89e83a8f415d2d6783b25b5f96226208" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type></type>
        <definition>SSH_PACKET_CALLBACK</definition>
        <argsstring>(ssh_packet_userauth_failure)</argsstring>
        <name>SSH_PACKET_CALLBACK</name>
        <param>
          <type>ssh_packet_userauth_failure</type>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="libssh-mirror/src/auth.c" line="222" column="1" bodyfile="libssh-mirror/src/auth.c" bodystart="222" bodyend="277"/>
        <references refid="structssh__session__struct_1a3d57e01582c0c9099f7f319513321fe8">ssh_session_struct::auth</references>
        <references refid="structssh__session__struct_1aa859857ac7a99808ffc537e08087e541" compoundref="session_8h" startline="158">ssh_session_struct::current_method</references>
        <references refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" compoundref="pkd__daemon_8c" startline="62">rc</references>
        <references refid="sshd__direct-tcpip_8c_1aed3129b7674034c979192bcca6b0ad8c" compoundref="sshd__direct-tcpip_8c" startline="36">SAFE_FREE</references>
        <references refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" compoundref="torture__session__keys_8c" startline="61">session</references>
        <references refid="group__libssh__auth_1gafd0aab143e9cce0a3781144fe74dd7ab" compoundref="auth_8c" startline="99" endline="127">ssh_auth_get_current_method</references>
        <references refid="libssh_8h_1aa17667dad32ec77112a201b1b4b858e8" compoundref="libssh_8h" startline="177">SSH_AUTH_METHOD_GSSAPI_MIC</references>
        <references refid="libssh_8h_1a47af3117d9ab19c61afeebfbfac8cfc4" compoundref="libssh_8h" startline="175">SSH_AUTH_METHOD_HOSTBASED</references>
        <references refid="libssh_8h_1a4c64484fdce4756309799d0e2a4e926a" compoundref="libssh_8h" startline="176">SSH_AUTH_METHOD_INTERACTIVE</references>
        <references refid="libssh_8h_1ad10dd2f5826e2d92a30bd8af3404574d" compoundref="libssh_8h" startline="173">SSH_AUTH_METHOD_PASSWORD</references>
        <references refid="libssh_8h_1aff27d66c1f5ba3871e72b5a61573f44a" compoundref="libssh_8h" startline="174">SSH_AUTH_METHOD_PUBLICKEY</references>
        <references refid="libssh_8h_1aac3fef0944d87a778c92bd1dc9f3c153" compoundref="libssh_8h" startline="171">SSH_AUTH_METHOD_UNKNOWN</references>
        <references refid="auth_8h_1a0d3114986a741a14dc3ac03f7d8eafefa331579d75bb0aa08050ca67a12861387" compoundref="auth_8h" startline="66">SSH_AUTH_STATE_ERROR</references>
        <references refid="auth_8h_1a0d3114986a741a14dc3ac03f7d8eafefa2274da14b3dc9f07b5fe6493045c356c" compoundref="auth_8h" startline="64">SSH_AUTH_STATE_FAILED</references>
        <references refid="auth_8h_1a0d3114986a741a14dc3ac03f7d8eafefa36be1b8a3aec2b226f03077dc1e6f962" compoundref="auth_8h" startline="60">SSH_AUTH_STATE_PARTIAL</references>
        <references refid="buffer_8h_1ab51014ef9a47e7cdbd235af3e62b81ee" compoundref="buffer_8h" startline="59">ssh_buffer_unpack</references>
        <references refid="libssh_8h_1a036b2b00fb04337a4d06d719d1b62be1a86ff0b2e8da6ad8628efc556b6ce1887" compoundref="libssh_8h" startline="286">SSH_FATAL</references>
        <references refid="group__libssh__error_1ga9241586665bf21f823806473fc386258" compoundref="error_8c" startline="128" endline="132">ssh_get_error</references>
        <references refid="priv_8h_1aa21fd8a7a609329603b7b16da7939fca" compoundref="priv_8h" startline="240">SSH_LOG</references>
        <references refid="libssh_8h_1a930fb852177813d4718c5d1911568740" compoundref="libssh_8h" startline="372">SSH_LOG_INFO</references>
        <references refid="libssh_8h_1ac1ee1d1e917456d4760a94a18015377d" compoundref="libssh_8h" startline="329">SSH_OK</references>
        <references refid="group__libssh__callbacks_1gac29df803aa1295d6a498c1b081f3b494" compoundref="callbacks_8h" startline="517">SSH_PACKET_USED</references>
        <references refid="libssh_8h_1a036b2b00fb04337a4d06d719d1b62be1ad1339fb4b92a9d25bdb99df5de5c4f88" compoundref="libssh_8h" startline="285">SSH_REQUEST_DENIED</references>
        <references refid="priv_8h_1a55177b3e8db90ca9adb435c44281963c" compoundref="priv_8h" startline="258">ssh_set_error</references>
        <references refid="structssh__session__struct_1af0805877d21d43e81423ead52345c64b" compoundref="session_8h" startline="156">ssh_session_struct::state</references>
        <references refid="structssh__session__struct_1a3e967ac3134cae87dae1f6a794424073" compoundref="session_8h" startline="157">ssh_session_struct::supported_methods</references>
        <references refid="ssh__client_8c_1a14871705f45ccdc5bb9f4549efd8e119" compoundref="ssh__client_8c" startline="48">user</references>
      </memberdef>
      <memberdef kind="function" id="group__libssh__auth_1gadbd916c2423b2097647263645e0dd422" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type></type>
        <definition>SSH_PACKET_CALLBACK</definition>
        <argsstring>(ssh_packet_userauth_success)</argsstring>
        <name>SSH_PACKET_CALLBACK</name>
        <param>
          <type>ssh_packet_userauth_success</type>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="libssh-mirror/src/auth.c" line="286" column="1" bodyfile="libssh-mirror/src/auth.c" bodystart="286" bodyend="317"/>
        <references refid="structssh__session__struct_1a3d57e01582c0c9099f7f319513321fe8">ssh_session_struct::auth</references>
        <references refid="structssh__session__struct_1aa859857ac7a99808ffc537e08087e541" compoundref="session_8h" startline="158">ssh_session_struct::current_method</references>
        <references refid="structssh__crypto__struct_1a264a702f7930c64683183b9334fa19d0" compoundref="crypto_8h" startline="144">ssh_crypto_struct::delayed_compress_in</references>
        <references refid="structssh__crypto__struct_1a180198c8214743d490536a6855244355" compoundref="crypto_8h" startline="145">ssh_crypto_struct::delayed_compress_out</references>
        <references refid="structssh__crypto__struct_1a9322f181b21f808d19918940335ecf40" compoundref="crypto_8h" startline="143">ssh_crypto_struct::do_compress_in</references>
        <references refid="structssh__crypto__struct_1a2d1c6e8bd0458906a8dffa7ea982fa2d" compoundref="crypto_8h" startline="142">ssh_crypto_struct::do_compress_out</references>
        <references refid="structssh__session__struct_1a997060832a3419d8fe884d3da855ef4c" compoundref="session_8h" startline="129">ssh_session_struct::flags</references>
        <references refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" compoundref="torture__session__keys_8c" startline="61">session</references>
        <references refid="structssh__session__struct_1a6f74d1a1eb6ed715b1073b67caa18460" compoundref="session_8h" startline="147">ssh_session_struct::session_state</references>
        <references refid="libssh_8h_1aac3fef0944d87a778c92bd1dc9f3c153" compoundref="libssh_8h" startline="171">SSH_AUTH_METHOD_UNKNOWN</references>
        <references refid="auth_8h_1a0d3114986a741a14dc3ac03f7d8eafefa8e24c237c09404d0c93a1d3b5f8f3945" compoundref="auth_8h" startline="62">SSH_AUTH_STATE_SUCCESS</references>
        <references refid="wrapper_8h_1a9ebe789b5f29a369c7799ec6ce17f1a9a86b8de4a56d77c10ee93f4cb0ab82d71" compoundref="wrapper_8h" startline="60">SSH_DIRECTION_IN</references>
        <references refid="wrapper_8h_1a9ebe789b5f29a369c7799ec6ce17f1a9a4a51e00d57fa481f88149a9d7cd83c91" compoundref="wrapper_8h" startline="61">SSH_DIRECTION_OUT</references>
        <references refid="priv_8h_1aa21fd8a7a609329603b7b16da7939fca" compoundref="priv_8h" startline="240">SSH_LOG</references>
        <references refid="libssh_8h_1a5e4247396f11fdc228d356a408c81715" compoundref="libssh_8h" startline="374">SSH_LOG_DEBUG</references>
        <references refid="libssh_8h_1a466c84d8dd5b1ba9162d491f31117a6b" compoundref="libssh_8h" startline="376">SSH_LOG_TRACE</references>
        <references refid="packet_8h_1af36b281d11b6c0affbc0faaf1ec52fbe" compoundref="packet_8c" startline="939" endline="977">ssh_packet_get_current_crypto</references>
        <references refid="group__libssh__callbacks_1gac29df803aa1295d6a498c1b081f3b494" compoundref="callbacks_8h" startline="517">SSH_PACKET_USED</references>
        <references refid="group__libssh__error_1gafa4e94327a2833d9e0eba2480a4988f7" compoundref="error_8c" startline="113" endline="119">ssh_reset_error</references>
        <references refid="session_8h_1ae54e87f0565e24b25aed1372b3493a2b" compoundref="session_8h" startline="76">SSH_SESSION_FLAG_AUTHENTICATED</references>
        <references refid="session_8h_1a9bbd1d5ae11485e27279be6ad461992caced7c62fd9f24fe8f6672d50b8219f60" compoundref="session_8h" startline="45">SSH_SESSION_STATE_AUTHENTICATED</references>
        <references refid="structssh__session__struct_1af0805877d21d43e81423ead52345c64b" compoundref="session_8h" startline="156">ssh_session_struct::state</references>
        <references refid="ssh__client_8c_1a14871705f45ccdc5bb9f4549efd8e119" compoundref="ssh__client_8c" startline="48">user</references>
      </memberdef>
      <memberdef kind="function" id="group__libssh__auth_1gabcd6b05236558e07e8dc564a68f0a4a6" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type></type>
        <definition>SSH_PACKET_CALLBACK</definition>
        <argsstring>(ssh_packet_userauth_pk_ok)</argsstring>
        <name>SSH_PACKET_CALLBACK</name>
        <param>
          <type>ssh_packet_userauth_pk_ok</type>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="libssh-mirror/src/auth.c" line="327" column="1" bodyfile="libssh-mirror/src/auth.c" bodystart="327" bodyend="354"/>
        <references refid="structssh__session__struct_1a3d57e01582c0c9099f7f319513321fe8">ssh_session_struct::auth</references>
        <references refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" compoundref="pkd__daemon_8c" startline="62">rc</references>
        <references refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" compoundref="torture__session__keys_8c" startline="61">session</references>
        <references refid="auth_8h_1a0d3114986a741a14dc3ac03f7d8eafefa331579d75bb0aa08050ca67a12861387" compoundref="auth_8h" startline="66">SSH_AUTH_STATE_ERROR</references>
        <references refid="auth_8h_1a0d3114986a741a14dc3ac03f7d8eafefa12492663176bc8d81ec1f5f832ee7250" compoundref="auth_8h" startline="74">SSH_AUTH_STATE_GSSAPI_REQUEST_SENT</references>
        <references refid="auth_8h_1a0d3114986a741a14dc3ac03f7d8eafefa6d785d00012593230e88f00debb19179" compoundref="auth_8h" startline="72">SSH_AUTH_STATE_KBDINT_SENT</references>
        <references refid="auth_8h_1a0d3114986a741a14dc3ac03f7d8eafefa8d27800e44e1c7e3a5f30594443f78ef" compoundref="auth_8h" startline="70">SSH_AUTH_STATE_PK_OK</references>
        <references refid="auth_8h_1a0d3114986a741a14dc3ac03f7d8eafefaeb9522ba4289c7bf7575802e7182cc3d" compoundref="auth_8h" startline="80">SSH_AUTH_STATE_PUBKEY_OFFER_SENT</references>
        <references refid="priv_8h_1aa21fd8a7a609329603b7b16da7939fca" compoundref="priv_8h" startline="240">SSH_LOG</references>
        <references refid="libssh_8h_1a466c84d8dd5b1ba9162d491f31117a6b" compoundref="libssh_8h" startline="376">SSH_LOG_TRACE</references>
        <references refid="group__libssh__callbacks_1gac29df803aa1295d6a498c1b081f3b494" compoundref="callbacks_8h" startline="517">SSH_PACKET_USED</references>
        <references refid="structssh__session__struct_1af0805877d21d43e81423ead52345c64b" compoundref="session_8h" startline="156">ssh_session_struct::state</references>
        <references refid="ssh__client_8c_1a14871705f45ccdc5bb9f4549efd8e119" compoundref="ssh__client_8c" startline="48">user</references>
      </memberdef>
      <memberdef kind="function" id="group__libssh__auth_1ga35d44897a44b4bb3b7c01108c1812a37" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>int ssh_userauth_list</definition>
        <argsstring>(ssh_session session, const char *username)</argsstring>
        <name>ssh_userauth_list</name>
        <param>
          <type><ref refid="libssh_8h_1a02d3754de040612632cdd499c20f92f6" kindref="member">ssh_session</ref></type>
          <declname>session</declname>
        </param>
        <param>
          <type>const char *</type>
          <declname>username</declname>
        </param>
        <briefdescription>
<para>Get available authentication methods from the server. </para>
        </briefdescription>
        <detaileddescription>
<para>This requires the function <ref refid="group__libssh__auth_1ga58e7c265236edbc97a2f117d3f23b4dd" kindref="member">ssh_userauth_none()</ref> to be called before the methods are available. The server MAY return a list of methods that may continue.</para>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername direction="in">session</parametername>
</parameternamelist>
<parameterdescription>
<para>The SSH session.</para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">username</parametername>
</parameternamelist>
<parameterdescription>
<para>Deprecated, set to NULL.</para>
</parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>A bitfield of the fllowing values:<itemizedlist>
<listitem><para>SSH_AUTH_METHOD_PASSWORD</para>
</listitem><listitem><para>SSH_AUTH_METHOD_PUBLICKEY</para>
</listitem><listitem><para>SSH_AUTH_METHOD_HOSTBASED</para>
</listitem><listitem><para>SSH_AUTH_METHOD_INTERACTIVE</para>
</listitem></itemizedlist>
</para>
</simplesect>
<simplesect kind="warning"><para>Other reserved flags may appear in future versions. </para>
</simplesect>
<simplesect kind="see"><para><ref refid="group__libssh__auth_1ga58e7c265236edbc97a2f117d3f23b4dd" kindref="member">ssh_userauth_none()</ref> </para>
</simplesect>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="libssh-mirror/src/auth.c" line="376" column="5" bodyfile="libssh-mirror/src/auth.c" bodystart="376" bodyend="385"/>
        <references refid="structssh__session__struct_1a3d57e01582c0c9099f7f319513321fe8">ssh_session_struct::auth</references>
        <references refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" compoundref="torture__session__keys_8c" startline="61">session</references>
        <references refid="structssh__session__struct_1a3e967ac3134cae87dae1f6a794424073" compoundref="session_8h" startline="157">ssh_session_struct::supported_methods</references>
        <references refid="proxy_8c_1a9b20c006bd90a09e1465fb668700e81d" compoundref="proxy_8c" startline="35">username</references>
        <referencedby refid="examples_2authentication_8c_1a442e0c31c0c57f60ec1f5eaaceebf436" compoundref="examples_2authentication_8c" startline="141" endline="241">authenticate_console</referencedby>
        <referencedby refid="classssh_1_1Session_1a08d70b5cdb5bd1a2a8f5f9ebbdf67b3b" compoundref="libsshpp_8hpp" startline="293" endline="297">ssh::Session::getAuthList</referencedby>
        <referencedby refid="legacy_8h_1aba195cc3cbc63d4c688d65b3307c1e24" compoundref="legacy_8c" startline="44" endline="46">ssh_auth_list</referencedby>
        <referencedby refid="torture__auth_8c_1add171176cc97a54d8bf7a3a9fcbd49c8" compoundref="torture__auth_8c" startline="440" endline="465">torture_auth_agent</referencedby>
        <referencedby refid="torture__auth_8c_1ac1e47567b2530e7c7c17d7f3367db43c" compoundref="torture__auth_8c" startline="467" endline="496">torture_auth_agent_nonblocking</referencedby>
        <referencedby refid="torture__auth_8c_1a1bc4253d4b7389acb38fa5e5ffc3cf51" compoundref="torture__auth_8c" startline="253" endline="275">torture_auth_autopubkey</referencedby>
        <referencedby refid="torture__auth_8c_1a2fc459f58be2d4e235c5ef4397fa8b4b" compoundref="torture__auth_8c" startline="277" endline="305">torture_auth_autopubkey_nonblocking</referencedby>
        <referencedby refid="torture__auth_8c_1a4b7c297eeeae3bb821a5480574439b78" compoundref="torture__auth_8c" startline="307" endline="340">torture_auth_kbdint</referencedby>
        <referencedby refid="torture__auth_8c_1a8c1979b9feebe5c34354456ff4260ee4" compoundref="torture__auth_8c" startline="342" endline="384">torture_auth_kbdint_nonblocking</referencedby>
        <referencedby refid="torture__auth_8c_1acab4c789da42f078db39e0e8dec81bc4" compoundref="torture__auth_8c" startline="386" endline="407">torture_auth_password</referencedby>
        <referencedby refid="torture__auth_8c_1a144cbca03a69c33a0137bbcbd69873cf" compoundref="torture__auth_8c" startline="409" endline="438">torture_auth_password_nonblocking</referencedby>
        <referencedby refid="torture__auth_8c_1a1e1c5e9d0352de375c56cf27921d00f6" compoundref="torture__auth_8c" startline="597" endline="632">torture_auth_pubkey_types</referencedby>
        <referencedby refid="torture__auth_8c_1a30fc01934c5dc0343d91dc6b90cbabac" compoundref="torture__auth_8c" startline="634" endline="670">torture_auth_pubkey_types_ecdsa</referencedby>
        <referencedby refid="torture__auth_8c_1aaefb1835a46af27a36149a89c3308825" compoundref="torture__auth_8c" startline="777" endline="822">torture_auth_pubkey_types_ecdsa_nonblocking</referencedby>
        <referencedby refid="torture__auth_8c_1aef29b45c88fd31e623e989959a72a434" compoundref="torture__auth_8c" startline="672" endline="728">torture_auth_pubkey_types_ed25519</referencedby>
        <referencedby refid="torture__auth_8c_1a6f2cc3f2514eaf5b14e030490d6993f3" compoundref="torture__auth_8c" startline="824" endline="888">torture_auth_pubkey_types_ed25519_nonblocking</referencedby>
        <referencedby refid="torture__auth_8c_1a6c870e5368b648dc01f643bbc52a62f4" compoundref="torture__auth_8c" startline="730" endline="775">torture_auth_pubkey_types_nonblocking</referencedby>
        <referencedby refid="torture__rekey_8c_1a75d0cca74861337645286b4d42e57006" compoundref="torture__rekey_8c" startline="150" endline="209">torture_rekey_send</referencedby>
        <referencedby refid="torture__rekey_8c_1a3c7d816b41acf84841eb39ec72475998" compoundref="torture__rekey_8c" startline="393" endline="440">torture_rekey_server_send</referencedby>
        <referencedby refid="torture__rekey_8c_1a83928e03d85a04fd06d4c4a0ca9c7394" compoundref="torture__rekey_8c" startline="324" endline="388">torture_rekey_time</referencedby>
        <referencedby refid="torture__server__auth__kbdint_8c_1a1ae155752732ad519ce76bedf8b2a5b7" compoundref="torture__server__auth__kbdint_8c" startline="686" endline="746">torture_server_auth_kbdint</referencedby>
        <referencedby refid="torture__server_8c_1a209f1dfc209f45f52226ee57825f596b" compoundref="torture__server_8c" startline="355" endline="390">torture_server_auth_password</referencedby>
        <referencedby refid="torture__server_8c_1a73fb9c5aabcb0550f2bdee3cfd7ef346" compoundref="torture__server_8c" startline="392" endline="424">torture_server_auth_pubkey</referencedby>
        <referencedby refid="torture_8c_1aa1653e389922c4762e71dbd2ab2d7cda" compoundref="torture_8c" startline="262" endline="353">torture_ssh_session</referencedby>
        <referencedby refid="torture__server__config_8c_1a5de50eda837b8f94dcf6d18a765d0dc8" compoundref="torture__server__config_8c" startline="350" endline="423">try_config_content</referencedby>
      </memberdef>
      <memberdef kind="function" id="group__libssh__auth_1ga58e7c265236edbc97a2f117d3f23b4dd" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>int ssh_userauth_none</definition>
        <argsstring>(ssh_session session, const char *username)</argsstring>
        <name>ssh_userauth_none</name>
        <param>
          <type><ref refid="libssh_8h_1a02d3754de040612632cdd499c20f92f6" kindref="member">ssh_session</ref></type>
          <declname>session</declname>
        </param>
        <param>
          <type>const char *</type>
          <declname>username</declname>
        </param>
        <briefdescription>
<para>Try to authenticate through the &quot;none&quot; method. </para>
        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername direction="in">session</parametername>
</parameternamelist>
<parameterdescription>
<para>The ssh session to use.</para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">username</parametername>
</parameternamelist>
<parameterdescription>
<para>The username, this SHOULD be NULL.</para>
</parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>SSH_AUTH_ERROR: A serious error happened.<linebreak/>
 SSH_AUTH_DENIED: Authentication failed: use another method<linebreak/>
 SSH_AUTH_PARTIAL: You&apos;ve been partially authenticated, you still have to use another method<linebreak/>
 SSH_AUTH_SUCCESS: Authentication success<linebreak/>
 SSH_AUTH_AGAIN: In nonblocking mode, you&apos;ve got to call this again later.</para>
</simplesect>
<simplesect kind="note"><para>Most server implementations do not permit changing the username during authentication. The username should only be set with <ref refid="group__libssh__session_1ga7a801b85800baa3f4e16f5b47db0a73d" kindref="member">ssh_options_set()</ref> only before you connect to the server. </para>
</simplesect>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="libssh-mirror/src/auth.c" line="406" column="5" bodyfile="libssh-mirror/src/auth.c" bodystart="406" bodyend="459"/>
        <references refid="structssh__session__struct_1a3d57e01582c0c9099f7f319513321fe8">ssh_session_struct::auth</references>
        <references refid="structssh__session__struct_1aa859857ac7a99808ffc537e08087e541" compoundref="session_8h" startline="158">ssh_session_struct::current_method</references>
        <references refid="structssh__session__struct_1a1c29cf990c1d0df6e1b0971d4f3d1f3e">ssh_session_struct::opts</references>
        <references refid="structssh__session__struct_1af0aed60c1e529bbfdcb483fd80bf98a0" compoundref="session_8h" startline="140">ssh_session_struct::out_buffer</references>
        <references refid="structssh__session__struct_1a5552665043089000065df39c5a5a7094" compoundref="session_8h" startline="146">ssh_session_struct::pending_call_state</references>
        <references refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" compoundref="pkd__daemon_8c" startline="62">rc</references>
        <references refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" compoundref="torture__session__keys_8c" startline="61">session</references>
        <references refid="ssh2_8h_1a423ea81df02faff2d59b730af16ac59e" compoundref="ssh2_8h" startline="27">SSH2_MSG_USERAUTH_REQUEST</references>
        <references refid="libssh_8h_1a9c57e4f6482106336045a4d25a55f28e" compoundref="libssh_8h" startline="331">SSH_AGAIN</references>
        <references refid="libssh_8h_1a5b35a5038ad8eac4a4e4c00c6239e6e2a0f166cff4fa03faf4e4c11ad854a4996" compoundref="libssh_8h" startline="166">SSH_AUTH_AGAIN</references>
        <references refid="libssh_8h_1a5b35a5038ad8eac4a4e4c00c6239e6e2a33d82f552d20734c17e770af637e3e17" compoundref="libssh_8h" startline="167">SSH_AUTH_ERROR</references>
        <references refid="libssh_8h_1af37d502f88abb23d55e6c35aacc6b340" compoundref="libssh_8h" startline="172">SSH_AUTH_METHOD_NONE</references>
        <references refid="auth_8h_1a0d3114986a741a14dc3ac03f7d8eafefa1aebfec92e739cd95a40eafe1b468444" compoundref="auth_8h" startline="86">SSH_AUTH_STATE_AUTH_NONE_SENT</references>
        <references refid="buffer_8h_1ae17848a86043f0abfc60c1c4f6126ccd" compoundref="buffer_8h" startline="49">ssh_buffer_pack</references>
        <references refid="libssh_8h_1ac8802ff7f5348d0145dab5242623f740">ssh_buffer_reinit</references>
        <references refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" compoundref="libssh_8h" startline="330">SSH_ERROR</references>
        <references refid="libssh_8h_1a036b2b00fb04337a4d06d719d1b62be1a86ff0b2e8da6ad8628efc556b6ce1887" compoundref="libssh_8h" startline="286">SSH_FATAL</references>
        <references refid="packet_8h_1a7e6c7ed74c23ace432476aa8a6841140" compoundref="packet_8c" startline="1761" endline="1843">ssh_packet_send</references>
        <references refid="session_8h_1abb7a4342b889601983497b3f094957e1a3ee5993b383a7d6a1bfd35e2e0ed3ed1" compoundref="session_8h" startline="62">SSH_PENDING_CALL_AUTH_NONE</references>
        <references refid="session_8h_1abb7a4342b889601983497b3f094957e1a33be3f7cd03fe7fced1eeacd369cad94" compoundref="session_8h" startline="60">SSH_PENDING_CALL_NONE</references>
        <references refid="priv_8h_1a55177b3e8db90ca9adb435c44281963c" compoundref="priv_8h" startline="258">ssh_set_error</references>
        <references refid="priv_8h_1ae280c413c792e04237f000841ac8ce44" compoundref="priv_8h" startline="265">ssh_set_error_oom</references>
        <references refid="group__libssh__auth_1gabff6b3898d3bf45b62cc3ed3774eaa83" compoundref="auth_8c" startline="142" endline="186">ssh_userauth_get_response</references>
        <references refid="group__libssh__auth_1ga812fb86c3dd4a6245bc7d01beaa9cfe8" compoundref="auth_8c" startline="69" endline="79">ssh_userauth_request_service</references>
        <references refid="structssh__session__struct_1af0805877d21d43e81423ead52345c64b" compoundref="session_8h" startline="156">ssh_session_struct::state</references>
        <references refid="proxy_8c_1a9b20c006bd90a09e1465fb668700e81d" compoundref="proxy_8c" startline="35">username</references>
        <references refid="structssh__session__struct_1a8ed5d5d3116679fd7b8f2c0e1db92726" compoundref="session_8h" startline="210">ssh_session_struct::username</references>
        <referencedby refid="examples_2authentication_8c_1a442e0c31c0c57f60ec1f5eaaceebf436" compoundref="examples_2authentication_8c" startline="141" endline="241">authenticate_console</referencedby>
        <referencedby refid="ssh__client_8c_1a0d3591711bd7d6cb03d42294115721bb" compoundref="ssh__client_8c" startline="318" endline="366">client</referencedby>
        <referencedby refid="sftp__stress_2main_8c_1acc3eb7c671bca3152e8e0df16bd40145" compoundref="sftp__stress_2main_8c" startline="76" endline="135">connect_host</referencedby>
        <referencedby refid="ssh__client__fuzzer_8cpp_1a91ce7c16e9840492202299da2b451e60" compoundref="ssh__client__fuzzer_8cpp" startline="85" endline="158">LLVMFuzzerTestOneInput</referencedby>
        <referencedby refid="proxy_8c_1a3c04138a5bfe5d72780bb7e82a18e627" compoundref="proxy_8c" startline="215" endline="346">main</referencedby>
        <referencedby refid="torture__algorithms_8c_1a15b3d1cac3aa670c3409b3bdc4c30223" compoundref="torture__algorithms_8c" startline="83" endline="135">test_algorithm</referencedby>
        <referencedby refid="torture__algorithms_8c_1a09eb7c5ef70408a9d0a2771bdfa48c7a" compoundref="torture__algorithms_8c" startline="553" endline="589">torture_algorithms_zlib</referencedby>
        <referencedby refid="torture__algorithms_8c_1af4b1201c7c4184336c8ce8b13b8052c6" compoundref="torture__algorithms_8c" startline="591" endline="628">torture_algorithms_zlib_openssh</referencedby>
        <referencedby refid="torture__auth_8c_1add171176cc97a54d8bf7a3a9fcbd49c8" compoundref="torture__auth_8c" startline="440" endline="465">torture_auth_agent</referencedby>
        <referencedby refid="torture__auth_8c_1ac1e47567b2530e7c7c17d7f3367db43c" compoundref="torture__auth_8c" startline="467" endline="496">torture_auth_agent_nonblocking</referencedby>
        <referencedby refid="torture__auth_8c_1a1bc4253d4b7389acb38fa5e5ffc3cf51" compoundref="torture__auth_8c" startline="253" endline="275">torture_auth_autopubkey</referencedby>
        <referencedby refid="torture__auth_8c_1a2fc459f58be2d4e235c5ef4397fa8b4b" compoundref="torture__auth_8c" startline="277" endline="305">torture_auth_autopubkey_nonblocking</referencedby>
        <referencedby refid="torture__auth_8c_1a4b7c297eeeae3bb821a5480574439b78" compoundref="torture__auth_8c" startline="307" endline="340">torture_auth_kbdint</referencedby>
        <referencedby refid="torture__auth_8c_1a8c1979b9feebe5c34354456ff4260ee4" compoundref="torture__auth_8c" startline="342" endline="384">torture_auth_kbdint_nonblocking</referencedby>
        <referencedby refid="torture__auth_8c_1a71d7b34d984879dbfaf6afb2870233ec" compoundref="torture__auth_8c" startline="207" endline="225">torture_auth_none</referencedby>
        <referencedby refid="torture__auth_8c_1a5836d87eecde023390a0acf40b7160c6" compoundref="torture__auth_8c" startline="227" endline="251">torture_auth_none_nonblocking</referencedby>
        <referencedby refid="torture__auth_8c_1acab4c789da42f078db39e0e8dec81bc4" compoundref="torture__auth_8c" startline="386" endline="407">torture_auth_password</referencedby>
        <referencedby refid="torture__auth_8c_1a144cbca03a69c33a0137bbcbd69873cf" compoundref="torture__auth_8c" startline="409" endline="438">torture_auth_password_nonblocking</referencedby>
        <referencedby refid="torture__auth_8c_1a1e1c5e9d0352de375c56cf27921d00f6" compoundref="torture__auth_8c" startline="597" endline="632">torture_auth_pubkey_types</referencedby>
        <referencedby refid="torture__auth_8c_1a30fc01934c5dc0343d91dc6b90cbabac" compoundref="torture__auth_8c" startline="634" endline="670">torture_auth_pubkey_types_ecdsa</referencedby>
        <referencedby refid="torture__auth_8c_1aaefb1835a46af27a36149a89c3308825" compoundref="torture__auth_8c" startline="777" endline="822">torture_auth_pubkey_types_ecdsa_nonblocking</referencedby>
        <referencedby refid="torture__auth_8c_1aef29b45c88fd31e623e989959a72a434" compoundref="torture__auth_8c" startline="672" endline="728">torture_auth_pubkey_types_ed25519</referencedby>
        <referencedby refid="torture__auth_8c_1a6f2cc3f2514eaf5b14e030490d6993f3" compoundref="torture__auth_8c" startline="824" endline="888">torture_auth_pubkey_types_ed25519_nonblocking</referencedby>
        <referencedby refid="torture__auth_8c_1a6c870e5368b648dc01f643bbc52a62f4" compoundref="torture__auth_8c" startline="730" endline="775">torture_auth_pubkey_types_nonblocking</referencedby>
        <referencedby refid="torture__rekey_8c_1a75d0cca74861337645286b4d42e57006" compoundref="torture__rekey_8c" startline="150" endline="209">torture_rekey_send</referencedby>
        <referencedby refid="torture__rekey_8c_1a3c7d816b41acf84841eb39ec72475998" compoundref="torture__rekey_8c" startline="393" endline="440">torture_rekey_server_send</referencedby>
        <referencedby refid="torture__rekey_8c_1a83928e03d85a04fd06d4c4a0ca9c7394" compoundref="torture__rekey_8c" startline="324" endline="388">torture_rekey_time</referencedby>
        <referencedby refid="torture__server__auth__kbdint_8c_1a1ae155752732ad519ce76bedf8b2a5b7" compoundref="torture__server__auth__kbdint_8c" startline="686" endline="746">torture_server_auth_kbdint</referencedby>
        <referencedby refid="torture__server_8c_1a45fb3c9d4948a2e1428a5d00f28d47b6" compoundref="torture__server_8c" startline="325" endline="353">torture_server_auth_none</referencedby>
        <referencedby refid="torture__server_8c_1a209f1dfc209f45f52226ee57825f596b" compoundref="torture__server_8c" startline="355" endline="390">torture_server_auth_password</referencedby>
        <referencedby refid="torture__server_8c_1a73fb9c5aabcb0550f2bdee3cfd7ef346" compoundref="torture__server_8c" startline="392" endline="424">torture_server_auth_pubkey</referencedby>
        <referencedby refid="torture_8c_1aa1653e389922c4762e71dbd2ab2d7cda" compoundref="torture_8c" startline="262" endline="353">torture_ssh_session</referencedby>
        <referencedby refid="torture__server__config_8c_1a5de50eda837b8f94dcf6d18a765d0dc8" compoundref="torture__server__config_8c" startline="350" endline="423">try_config_content</referencedby>
        <referencedby refid="classssh_1_1Session_1a988398835fc131b0eb5a83a4adaec532" compoundref="libsshpp_8hpp" startline="192" endline="196">ssh::Session::userauthNone</referencedby>
      </memberdef>
      <memberdef kind="function" id="group__libssh__auth_1ga592f673c4d417a6a46cd4876ac8287aa" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>int ssh_userauth_try_publickey</definition>
        <argsstring>(ssh_session session, const char *username, const ssh_key pubkey)</argsstring>
        <name>ssh_userauth_try_publickey</name>
        <param>
          <type><ref refid="libssh_8h_1a02d3754de040612632cdd499c20f92f6" kindref="member">ssh_session</ref></type>
          <declname>session</declname>
        </param>
        <param>
          <type>const char *</type>
          <declname>username</declname>
        </param>
        <param>
          <type>const <ref refid="libssh_8h_1a7e8a3aee44db4899c088577a8db5dcfa" kindref="member">ssh_key</ref></type>
          <declname>pubkey</declname>
        </param>
        <briefdescription>
<para>Try to authenticate with the given public key. </para>
        </briefdescription>
        <detaileddescription>
<para>To avoid unnecessary processing and user interaction, the following method is provided for querying whether authentication using the &apos;pubkey&apos; would be possible.</para>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername direction="in">session</parametername>
</parameternamelist>
<parameterdescription>
<para>The SSH session.</para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">username</parametername>
</parameternamelist>
<parameterdescription>
<para>The username, this SHOULD be NULL.</para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">pubkey</parametername>
</parameternamelist>
<parameterdescription>
<para>The public key to try.</para>
</parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>SSH_AUTH_ERROR: A serious error happened.<linebreak/>
 SSH_AUTH_DENIED: The server doesn&apos;t accept that public key as an authentication token. Try another key or another method.<linebreak/>
 SSH_AUTH_PARTIAL: You&apos;ve been partially authenticated, you still have to use another method.<linebreak/>
 SSH_AUTH_SUCCESS: The public key is accepted, you want now to use <ref refid="group__libssh__auth_1gaa38c4f3194ef36720da7eddb0aa99e23" kindref="member">ssh_userauth_publickey()</ref>.<linebreak/>
 SSH_AUTH_AGAIN: In nonblocking mode, you&apos;ve got to call this again later.</para>
</simplesect>
<simplesect kind="note"><para>Most server implementations do not permit changing the username during authentication. The username should only be set with <ref refid="group__libssh__session_1ga7a801b85800baa3f4e16f5b47db0a73d" kindref="member">ssh_options_set()</ref> only before you connect to the server. </para>
</simplesect>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="libssh-mirror/src/auth.c" line="489" column="5" bodyfile="libssh-mirror/src/auth.c" bodystart="489" bodyend="584"/>
        <references refid="structssh__session__struct_1a3d57e01582c0c9099f7f319513321fe8">ssh_session_struct::auth</references>
        <references refid="structssh__session__struct_1aa859857ac7a99808ffc537e08087e541" compoundref="session_8h" startline="158">ssh_session_struct::current_method</references>
        <references refid="structssh__session__struct_1a1c29cf990c1d0df6e1b0971d4f3d1f3e">ssh_session_struct::opts</references>
        <references refid="structssh__session__struct_1af0aed60c1e529bbfdcb483fd80bf98a0" compoundref="session_8h" startline="140">ssh_session_struct::out_buffer</references>
        <references refid="structssh__session__struct_1a5552665043089000065df39c5a5a7094" compoundref="session_8h" startline="146">ssh_session_struct::pending_call_state</references>
        <references refid="curve25519-sha256_0dlibssh_8org_8txt_1a555595207a1407936ebb264ebdbf434c" compoundref="curve25519-sha256_0dlibssh_8org_8txt" startline="93">pubkey</references>
        <references refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" compoundref="pkd__daemon_8c" startline="62">rc</references>
        <references refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" compoundref="torture__session__keys_8c" startline="61">session</references>
        <references refid="ssh2_8h_1a423ea81df02faff2d59b730af16ac59e" compoundref="ssh2_8h" startline="27">SSH2_MSG_USERAUTH_REQUEST</references>
        <references refid="libssh_8h_1a9c57e4f6482106336045a4d25a55f28e" compoundref="libssh_8h" startline="331">SSH_AGAIN</references>
        <references refid="libssh_8h_1a5b35a5038ad8eac4a4e4c00c6239e6e2a0f166cff4fa03faf4e4c11ad854a4996" compoundref="libssh_8h" startline="166">SSH_AUTH_AGAIN</references>
        <references refid="libssh_8h_1a5b35a5038ad8eac4a4e4c00c6239e6e2ac3d2d6d092a7adc147b7f859a0b252d2" compoundref="libssh_8h" startline="163">SSH_AUTH_DENIED</references>
        <references refid="libssh_8h_1a5b35a5038ad8eac4a4e4c00c6239e6e2a33d82f552d20734c17e770af637e3e17" compoundref="libssh_8h" startline="167">SSH_AUTH_ERROR</references>
        <references refid="libssh_8h_1aff27d66c1f5ba3871e72b5a61573f44a" compoundref="libssh_8h" startline="174">SSH_AUTH_METHOD_PUBLICKEY</references>
        <references refid="auth_8h_1a0d3114986a741a14dc3ac03f7d8eafefaeb9522ba4289c7bf7575802e7182cc3d" compoundref="auth_8h" startline="80">SSH_AUTH_STATE_PUBKEY_OFFER_SENT</references>
        <references refid="buffer_8h_1ae17848a86043f0abfc60c1c4f6126ccd" compoundref="buffer_8h" startline="49">ssh_buffer_pack</references>
        <references refid="libssh_8h_1ac8802ff7f5348d0145dab5242623f740">ssh_buffer_reinit</references>
        <references refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" compoundref="libssh_8h" startline="330">SSH_ERROR</references>
        <references refid="libssh_8h_1a036b2b00fb04337a4d06d719d1b62be1a86ff0b2e8da6ad8628efc556b6ce1887" compoundref="libssh_8h" startline="286">SSH_FATAL</references>
        <references refid="group__libssh__pki_1ga79010baa7b7ca9d4467910ff863e669d" compoundref="pki_8c" startline="371" endline="401">ssh_key_algorithm_allowed</references>
        <references refid="group__libssh__pki_1ga7ad4109947adef7dbe7f9b8d1577cc88" compoundref="pki_8c" startline="483" endline="506">ssh_key_get_signature_algorithm</references>
        <references refid="group__libssh__pki_1ga9bc688b5cbc400320ac44896eba21924" compoundref="pki_8c" startline="621" endline="627">ssh_key_is_public</references>
        <references refid="packet_8h_1a7e6c7ed74c23ace432476aa8a6841140" compoundref="packet_8c" startline="1761" endline="1843">ssh_packet_send</references>
        <references refid="session_8h_1abb7a4342b889601983497b3f094957e1acc1374f13198a1db57344b049d626c4a" compoundref="session_8h" startline="64">SSH_PENDING_CALL_AUTH_OFFER_PUBKEY</references>
        <references refid="session_8h_1abb7a4342b889601983497b3f094957e1a33be3f7cd03fe7fced1eeacd369cad94" compoundref="session_8h" startline="60">SSH_PENDING_CALL_NONE</references>
        <references refid="group__libssh__pki_1gaadeaf6dc35e99214de0af82c3c431649" compoundref="pki_8c" startline="2030" endline="2046">ssh_pki_export_pubkey_blob</references>
        <references refid="libssh_8h_1a036b2b00fb04337a4d06d719d1b62be1ad1339fb4b92a9d25bdb99df5de5c4f88" compoundref="libssh_8h" startline="285">SSH_REQUEST_DENIED</references>
        <references refid="priv_8h_1a55177b3e8db90ca9adb435c44281963c" compoundref="priv_8h" startline="258">ssh_set_error</references>
        <references refid="priv_8h_1ae280c413c792e04237f000841ac8ce44" compoundref="priv_8h" startline="265">ssh_set_error_oom</references>
        <references refid="libssh_8h_1a5bc8710c8633117ff449d15489fca051" compoundref="libssh_8h" startline="790">SSH_STRING_FREE</references>
        <references refid="group__libssh__auth_1gabff6b3898d3bf45b62cc3ed3774eaa83" compoundref="auth_8c" startline="142" endline="186">ssh_userauth_get_response</references>
        <references refid="group__libssh__auth_1ga812fb86c3dd4a6245bc7d01beaa9cfe8" compoundref="auth_8c" startline="69" endline="79">ssh_userauth_request_service</references>
        <references refid="structssh__session__struct_1af0805877d21d43e81423ead52345c64b" compoundref="session_8h" startline="156">ssh_session_struct::state</references>
        <references refid="proxy_8c_1a9b20c006bd90a09e1465fb668700e81d" compoundref="proxy_8c" startline="35">username</references>
        <references refid="structssh__session__struct_1a8ed5d5d3116679fd7b8f2c0e1db92726" compoundref="session_8h" startline="210">ssh_session_struct::username</references>
        <referencedby refid="examples_2authentication_8c_1a92d7c9e4306c6cab0efa38f402ce3d11" compoundref="examples_2authentication_8c" startline="103" endline="133">auth_keyfile</referencedby>
        <referencedby refid="group__libssh__auth_1ga7d84f3f89f65455b80b10e2643d80719" compoundref="auth_8c" startline="872" endline="961">ssh_userauth_agent</referencedby>
        <referencedby refid="legacy_8h_1a34ad35b88d0117527c37a70d93fd1f51" compoundref="legacy_8c" startline="48" endline="66">ssh_userauth_offer_pubkey</referencedby>
        <referencedby refid="group__libssh__auth_1ga53e6771b250c061463ed98b6e5b6e0af" compoundref="auth_8c" startline="1007" endline="1212">ssh_userauth_publickey_auto</referencedby>
        <referencedby refid="torture__auth_8c_1a3dc15f1542313d7536ea949a57ed8d0b" compoundref="torture__auth_8c" startline="498" endline="544">torture_auth_cert</referencedby>
        <referencedby refid="classssh_1_1Session_1afb635d7f84b000bbabb09a86ad5ad074" compoundref="libsshpp_8hpp" startline="271" endline="275">ssh::Session::userauthTryPublickey</referencedby>
      </memberdef>
      <memberdef kind="function" id="group__libssh__auth_1gaa38c4f3194ef36720da7eddb0aa99e23" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>int ssh_userauth_publickey</definition>
        <argsstring>(ssh_session session, const char *username, const ssh_key privkey)</argsstring>
        <name>ssh_userauth_publickey</name>
        <param>
          <type><ref refid="libssh_8h_1a02d3754de040612632cdd499c20f92f6" kindref="member">ssh_session</ref></type>
          <declname>session</declname>
        </param>
        <param>
          <type>const char *</type>
          <declname>username</declname>
        </param>
        <param>
          <type>const <ref refid="libssh_8h_1a7e8a3aee44db4899c088577a8db5dcfa" kindref="member">ssh_key</ref></type>
          <declname>privkey</declname>
        </param>
        <briefdescription>
<para>Authenticate with public/private key or certificate. </para>
        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername direction="in">session</parametername>
</parameternamelist>
<parameterdescription>
<para>The SSH session.</para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">username</parametername>
</parameternamelist>
<parameterdescription>
<para>The username, this SHOULD be NULL.</para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">privkey</parametername>
</parameternamelist>
<parameterdescription>
<para>The private key for authentication.</para>
</parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>SSH_AUTH_ERROR: A serious error happened.<linebreak/>
 SSH_AUTH_DENIED: The server doesn&apos;t accept that public key as an authentication token. Try another key or another method.<linebreak/>
 SSH_AUTH_PARTIAL: You&apos;ve been partially authenticated, you still have to use another method.<linebreak/>
 SSH_AUTH_SUCCESS: The public key is accepted.<linebreak/>
 SSH_AUTH_AGAIN: In nonblocking mode, you&apos;ve got to call this again later.</para>
</simplesect>
<simplesect kind="note"><para>Most server implementations do not permit changing the username during authentication. The username should only be set with <ref refid="group__libssh__session_1ga7a801b85800baa3f4e16f5b47db0a73d" kindref="member">ssh_options_set()</ref> only before you connect to the server. </para>
</simplesect>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="libssh-mirror/src/auth.c" line="609" column="5" bodyfile="libssh-mirror/src/auth.c" bodystart="609" bodyend="723"/>
        <references refid="structssh__session__struct_1a3d57e01582c0c9099f7f319513321fe8">ssh_session_struct::auth</references>
        <references refid="structssh__session__struct_1aa859857ac7a99808ffc537e08087e541" compoundref="session_8h" startline="158">ssh_session_struct::current_method</references>
        <references refid="structssh__session__struct_1a1c29cf990c1d0df6e1b0971d4f3d1f3e">ssh_session_struct::opts</references>
        <references refid="structssh__session__struct_1af0aed60c1e529bbfdcb483fd80bf98a0" compoundref="session_8h" startline="140">ssh_session_struct::out_buffer</references>
        <references refid="structssh__session__struct_1a5552665043089000065df39c5a5a7094" compoundref="session_8h" startline="146">ssh_session_struct::pending_call_state</references>
        <references refid="curve25519-sha256_0dlibssh_8org_8txt_1a5d18fd02a76effa0a15b1decb554cc12" compoundref="curve25519-sha256_0dlibssh_8org_8txt" startline="96">privkey</references>
        <references refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" compoundref="pkd__daemon_8c" startline="62">rc</references>
        <references refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" compoundref="torture__session__keys_8c" startline="61">session</references>
        <references refid="ssh2_8h_1a423ea81df02faff2d59b730af16ac59e" compoundref="ssh2_8h" startline="27">SSH2_MSG_USERAUTH_REQUEST</references>
        <references refid="libssh_8h_1a9c57e4f6482106336045a4d25a55f28e" compoundref="libssh_8h" startline="331">SSH_AGAIN</references>
        <references refid="libssh_8h_1a5b35a5038ad8eac4a4e4c00c6239e6e2a0f166cff4fa03faf4e4c11ad854a4996" compoundref="libssh_8h" startline="166">SSH_AUTH_AGAIN</references>
        <references refid="libssh_8h_1a5b35a5038ad8eac4a4e4c00c6239e6e2ac3d2d6d092a7adc147b7f859a0b252d2" compoundref="libssh_8h" startline="163">SSH_AUTH_DENIED</references>
        <references refid="libssh_8h_1a5b35a5038ad8eac4a4e4c00c6239e6e2a33d82f552d20734c17e770af637e3e17" compoundref="libssh_8h" startline="167">SSH_AUTH_ERROR</references>
        <references refid="libssh_8h_1aff27d66c1f5ba3871e72b5a61573f44a" compoundref="libssh_8h" startline="174">SSH_AUTH_METHOD_PUBLICKEY</references>
        <references refid="auth_8h_1a0d3114986a741a14dc3ac03f7d8eafefa867ade5fd7a5853b32a1935a47bd9776" compoundref="auth_8h" startline="82">SSH_AUTH_STATE_PUBKEY_AUTH_SENT</references>
        <references refid="buffer_8h_1a75f9cd3d07f2039b0cd1821a7eb0d7f8">ssh_buffer_add_ssh_string</references>
        <references refid="buffer_8h_1ae17848a86043f0abfc60c1c4f6126ccd" compoundref="buffer_8h" startline="49">ssh_buffer_pack</references>
        <references refid="libssh_8h_1ac8802ff7f5348d0145dab5242623f740">ssh_buffer_reinit</references>
        <references refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" compoundref="libssh_8h" startline="330">SSH_ERROR</references>
        <references refid="libssh_8h_1a036b2b00fb04337a4d06d719d1b62be1a86ff0b2e8da6ad8628efc556b6ce1887" compoundref="libssh_8h" startline="286">SSH_FATAL</references>
        <references refid="group__libssh__pki_1ga79010baa7b7ca9d4467910ff863e669d" compoundref="pki_8c" startline="371" endline="401">ssh_key_algorithm_allowed</references>
        <references refid="group__libssh__pki_1ga7ad4109947adef7dbe7f9b8d1577cc88" compoundref="pki_8c" startline="483" endline="506">ssh_key_get_signature_algorithm</references>
        <references refid="group__libssh__pki_1ga09de68aba0a7c4e31d8ba7df43b637c5" compoundref="pki_8c" startline="636" endline="642">ssh_key_is_private</references>
        <references refid="group__libssh__pki_1ga10eb6e34355baea3a0dd8431188ca790" compoundref="pki_8c" startline="414" endline="471">ssh_key_type_to_hash</references>
        <references refid="packet_8h_1a7e6c7ed74c23ace432476aa8a6841140" compoundref="packet_8c" startline="1761" endline="1843">ssh_packet_send</references>
        <references refid="session_8h_1abb7a4342b889601983497b3f094957e1a85ca960326af12df3bd2abca946f1617" compoundref="session_8h" startline="65">SSH_PENDING_CALL_AUTH_PUBKEY</references>
        <references refid="session_8h_1abb7a4342b889601983497b3f094957e1a33be3f7cd03fe7fced1eeacd369cad94" compoundref="session_8h" startline="60">SSH_PENDING_CALL_NONE</references>
        <references refid="group__libssh__pki_1gab366c5e63b468061d201397939bc6a82" compoundref="pki_8c" startline="2511" endline="2582">ssh_pki_do_sign</references>
        <references refid="group__libssh__pki_1gaadeaf6dc35e99214de0af82c3c431649" compoundref="pki_8c" startline="2030" endline="2046">ssh_pki_export_pubkey_blob</references>
        <references refid="libssh_8h_1a036b2b00fb04337a4d06d719d1b62be1ad1339fb4b92a9d25bdb99df5de5c4f88" compoundref="libssh_8h" startline="285">SSH_REQUEST_DENIED</references>
        <references refid="priv_8h_1a55177b3e8db90ca9adb435c44281963c" compoundref="priv_8h" startline="258">ssh_set_error</references>
        <references refid="priv_8h_1ae280c413c792e04237f000841ac8ce44" compoundref="priv_8h" startline="265">ssh_set_error_oom</references>
        <references refid="libssh_8h_1a5bc8710c8633117ff449d15489fca051" compoundref="libssh_8h" startline="790">SSH_STRING_FREE</references>
        <references refid="group__libssh__auth_1gabff6b3898d3bf45b62cc3ed3774eaa83" compoundref="auth_8c" startline="142" endline="186">ssh_userauth_get_response</references>
        <references refid="group__libssh__auth_1ga812fb86c3dd4a6245bc7d01beaa9cfe8" compoundref="auth_8c" startline="69" endline="79">ssh_userauth_request_service</references>
        <references refid="structssh__session__struct_1af0805877d21d43e81423ead52345c64b" compoundref="session_8h" startline="156">ssh_session_struct::state</references>
        <references refid="proxy_8c_1a9b20c006bd90a09e1465fb668700e81d" compoundref="proxy_8c" startline="35">username</references>
        <references refid="structssh__session__struct_1a8ed5d5d3116679fd7b8f2c0e1db92726" compoundref="session_8h" startline="210">ssh_session_struct::username</references>
        <referencedby refid="examples_2authentication_8c_1a92d7c9e4306c6cab0efa38f402ce3d11" compoundref="examples_2authentication_8c" startline="103" endline="133">auth_keyfile</referencedby>
        <referencedby refid="legacy_8h_1afb953cc1f6cccb9263b06543bfd30bba" compoundref="legacy_8c" startline="68" endline="95">ssh_userauth_pubkey</referencedby>
        <referencedby refid="group__libssh__auth_1ga53e6771b250c061463ed98b6e5b6e0af" compoundref="auth_8c" startline="1007" endline="1212">ssh_userauth_publickey_auto</referencedby>
        <referencedby refid="torture__auth_8c_1a3dc15f1542313d7536ea949a57ed8d0b" compoundref="torture__auth_8c" startline="498" endline="544">torture_auth_cert</referencedby>
        <referencedby refid="torture__auth_8c_1aef29b45c88fd31e623e989959a72a434" compoundref="torture__auth_8c" startline="672" endline="728">torture_auth_pubkey_types_ed25519</referencedby>
        <referencedby refid="torture__auth_8c_1a6f2cc3f2514eaf5b14e030490d6993f3" compoundref="torture__auth_8c" startline="824" endline="888">torture_auth_pubkey_types_ed25519_nonblocking</referencedby>
        <referencedby refid="classssh_1_1Session_1a6dd49ee38bf24c31c5e0e28dc2af07b7" compoundref="libsshpp_8hpp" startline="282" endline="286">ssh::Session::userauthPublickey</referencedby>
      </memberdef>
      <memberdef kind="function" id="group__libssh__auth_1ga691078be9ea2a55fed97c7488395af5a" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>static int ssh_userauth_agent_publickey</definition>
        <argsstring>(ssh_session session, const char *username, ssh_key pubkey)</argsstring>
        <name>ssh_userauth_agent_publickey</name>
        <param>
          <type><ref refid="libssh_8h_1a02d3754de040612632cdd499c20f92f6" kindref="member">ssh_session</ref></type>
          <declname>session</declname>
        </param>
        <param>
          <type>const char *</type>
          <declname>username</declname>
        </param>
        <param>
          <type><ref refid="libssh_8h_1a7e8a3aee44db4899c088577a8db5dcfa" kindref="member">ssh_key</ref></type>
          <declname>pubkey</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="libssh-mirror/src/auth.c" line="726" column="12" bodyfile="libssh-mirror/src/auth.c" bodystart="726" bodyend="825"/>
        <references refid="structssh__session__struct_1a3d57e01582c0c9099f7f319513321fe8">ssh_session_struct::auth</references>
        <references refid="structssh__session__struct_1aa859857ac7a99808ffc537e08087e541" compoundref="session_8h" startline="158">ssh_session_struct::current_method</references>
        <references refid="structssh__session__struct_1a1c29cf990c1d0df6e1b0971d4f3d1f3e">ssh_session_struct::opts</references>
        <references refid="structssh__session__struct_1af0aed60c1e529bbfdcb483fd80bf98a0" compoundref="session_8h" startline="140">ssh_session_struct::out_buffer</references>
        <references refid="structssh__session__struct_1a5552665043089000065df39c5a5a7094" compoundref="session_8h" startline="146">ssh_session_struct::pending_call_state</references>
        <references refid="curve25519-sha256_0dlibssh_8org_8txt_1a555595207a1407936ebb264ebdbf434c" compoundref="curve25519-sha256_0dlibssh_8org_8txt" startline="93">pubkey</references>
        <references refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" compoundref="pkd__daemon_8c" startline="62">rc</references>
        <references refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" compoundref="torture__session__keys_8c" startline="61">session</references>
        <references refid="ssh2_8h_1a423ea81df02faff2d59b730af16ac59e" compoundref="ssh2_8h" startline="27">SSH2_MSG_USERAUTH_REQUEST</references>
        <references refid="libssh_8h_1a9c57e4f6482106336045a4d25a55f28e" compoundref="libssh_8h" startline="331">SSH_AGAIN</references>
        <references refid="libssh_8h_1a5b35a5038ad8eac4a4e4c00c6239e6e2a0f166cff4fa03faf4e4c11ad854a4996" compoundref="libssh_8h" startline="166">SSH_AUTH_AGAIN</references>
        <references refid="libssh_8h_1a5b35a5038ad8eac4a4e4c00c6239e6e2ac3d2d6d092a7adc147b7f859a0b252d2" compoundref="libssh_8h" startline="163">SSH_AUTH_DENIED</references>
        <references refid="libssh_8h_1a5b35a5038ad8eac4a4e4c00c6239e6e2a33d82f552d20734c17e770af637e3e17" compoundref="libssh_8h" startline="167">SSH_AUTH_ERROR</references>
        <references refid="libssh_8h_1aff27d66c1f5ba3871e72b5a61573f44a" compoundref="libssh_8h" startline="174">SSH_AUTH_METHOD_PUBLICKEY</references>
        <references refid="auth_8h_1a0d3114986a741a14dc3ac03f7d8eafefa867ade5fd7a5853b32a1935a47bd9776" compoundref="auth_8h" startline="82">SSH_AUTH_STATE_PUBKEY_AUTH_SENT</references>
        <references refid="buffer_8h_1a75f9cd3d07f2039b0cd1821a7eb0d7f8">ssh_buffer_add_ssh_string</references>
        <references refid="buffer_8h_1ae17848a86043f0abfc60c1c4f6126ccd" compoundref="buffer_8h" startline="49">ssh_buffer_pack</references>
        <references refid="libssh_8h_1ac8802ff7f5348d0145dab5242623f740">ssh_buffer_reinit</references>
        <references refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" compoundref="libssh_8h" startline="330">SSH_ERROR</references>
        <references refid="libssh_8h_1a036b2b00fb04337a4d06d719d1b62be1a86ff0b2e8da6ad8628efc556b6ce1887" compoundref="libssh_8h" startline="286">SSH_FATAL</references>
        <references refid="group__libssh__pki_1ga79010baa7b7ca9d4467910ff863e669d" compoundref="pki_8c" startline="371" endline="401">ssh_key_algorithm_allowed</references>
        <references refid="group__libssh__pki_1ga7ad4109947adef7dbe7f9b8d1577cc88" compoundref="pki_8c" startline="483" endline="506">ssh_key_get_signature_algorithm</references>
        <references refid="packet_8h_1a7e6c7ed74c23ace432476aa8a6841140" compoundref="packet_8c" startline="1761" endline="1843">ssh_packet_send</references>
        <references refid="session_8h_1abb7a4342b889601983497b3f094957e1a099a4746aa5830db8c84495e1e0481e4" compoundref="session_8h" startline="66">SSH_PENDING_CALL_AUTH_AGENT</references>
        <references refid="session_8h_1abb7a4342b889601983497b3f094957e1a33be3f7cd03fe7fced1eeacd369cad94" compoundref="session_8h" startline="60">SSH_PENDING_CALL_NONE</references>
        <references refid="group__libssh__pki_1ga030b5e767d97bd26053a5644b083c133" compoundref="pki_8c" startline="2585" endline="2633">ssh_pki_do_sign_agent</references>
        <references refid="group__libssh__pki_1gaadeaf6dc35e99214de0af82c3c431649" compoundref="pki_8c" startline="2030" endline="2046">ssh_pki_export_pubkey_blob</references>
        <references refid="libssh_8h_1a036b2b00fb04337a4d06d719d1b62be1ad1339fb4b92a9d25bdb99df5de5c4f88" compoundref="libssh_8h" startline="285">SSH_REQUEST_DENIED</references>
        <references refid="priv_8h_1a55177b3e8db90ca9adb435c44281963c" compoundref="priv_8h" startline="258">ssh_set_error</references>
        <references refid="priv_8h_1ae280c413c792e04237f000841ac8ce44" compoundref="priv_8h" startline="265">ssh_set_error_oom</references>
        <references refid="libssh_8h_1a5bc8710c8633117ff449d15489fca051" compoundref="libssh_8h" startline="790">SSH_STRING_FREE</references>
        <references refid="group__libssh__auth_1gabff6b3898d3bf45b62cc3ed3774eaa83" compoundref="auth_8c" startline="142" endline="186">ssh_userauth_get_response</references>
        <references refid="group__libssh__auth_1ga812fb86c3dd4a6245bc7d01beaa9cfe8" compoundref="auth_8c" startline="69" endline="79">ssh_userauth_request_service</references>
        <references refid="structssh__session__struct_1af0805877d21d43e81423ead52345c64b" compoundref="session_8h" startline="156">ssh_session_struct::state</references>
        <references refid="proxy_8c_1a9b20c006bd90a09e1465fb668700e81d" compoundref="proxy_8c" startline="35">username</references>
        <references refid="structssh__session__struct_1a8ed5d5d3116679fd7b8f2c0e1db92726" compoundref="session_8h" startline="210">ssh_session_struct::username</references>
        <referencedby refid="group__libssh__auth_1ga7d84f3f89f65455b80b10e2643d80719" compoundref="auth_8c" startline="872" endline="961">ssh_userauth_agent</referencedby>
        <referencedby refid="group__libssh__auth_1ga5cc49db459d6e27c8645a20bbd0f5f88" compoundref="auth_8c" startline="1311" endline="1336">ssh_userauth_agent_pubkey</referencedby>
      </memberdef>
      <memberdef kind="function" id="group__libssh__auth_1ga7d4487088981015ec0b1c66befc1c7dd" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void ssh_agent_state_free</definition>
        <argsstring>(void *data)</argsstring>
        <name>ssh_agent_state_free</name>
        <param>
          <type>void *</type>
          <declname>data</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="libssh-mirror/src/auth.c" line="840" column="6" bodyfile="libssh-mirror/src/auth.c" bodystart="840" bodyend="848"/>
        <references refid="group__libssh__pki_1ga08808beb83a42ccd6f1c710ddeb1b4c2" compoundref="pki_8c" startline="205" endline="210">ssh_key_free</references>
        <references refid="libssh_8h_1a892d8251a4be8c99d31d0bb599174c0c" compoundref="libssh_8h" startline="798">SSH_STRING_FREE_CHAR</references>
        <references refid="structssh__agent__state__struct_1aff904ec87c3104dfb7bb6915ef9a88b6" compoundref="auth_8c" startline="834">ssh_agent_state_struct::state</references>
        <referencedby refid="group__libssh__session_1gae5af27a98a7488e9f5ded6b37c274156" compoundref="session_8c" startline="191" endline="326">ssh_free</referencedby>
        <referencedby refid="group__libssh__auth_1ga7d84f3f89f65455b80b10e2643d80719" compoundref="auth_8c" startline="872" endline="961">ssh_userauth_agent</referencedby>
      </memberdef>
      <memberdef kind="function" id="group__libssh__auth_1ga7d84f3f89f65455b80b10e2643d80719" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>int ssh_userauth_agent</definition>
        <argsstring>(ssh_session session, const char *username)</argsstring>
        <name>ssh_userauth_agent</name>
        <param>
          <type><ref refid="libssh_8h_1a02d3754de040612632cdd499c20f92f6" kindref="member">ssh_session</ref></type>
          <declname>session</declname>
        </param>
        <param>
          <type>const char *</type>
          <declname>username</declname>
        </param>
        <briefdescription>
<para>Try to do public key authentication with ssh agent. </para>
        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername direction="in">session</parametername>
</parameternamelist>
<parameterdescription>
<para>The ssh session to use.</para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">username</parametername>
</parameternamelist>
<parameterdescription>
<para>The username, this SHOULD be NULL.</para>
</parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>SSH_AUTH_ERROR: A serious error happened.<linebreak/>
 SSH_AUTH_DENIED: The server doesn&apos;t accept that public key as an authentication token. Try another key or another method.<linebreak/>
 SSH_AUTH_PARTIAL: You&apos;ve been partially authenticated, you still have to use another method.<linebreak/>
 SSH_AUTH_SUCCESS: The public key is accepted, you want now to use <ref refid="group__libssh__auth_1gaa38c4f3194ef36720da7eddb0aa99e23" kindref="member">ssh_userauth_publickey()</ref>.<linebreak/>
 SSH_AUTH_AGAIN: In nonblocking mode, you&apos;ve got to call this again later.</para>
</simplesect>
<simplesect kind="note"><para>Most server implementations do not permit changing the username during authentication. The username should only be set with <ref refid="group__libssh__session_1ga7a801b85800baa3f4e16f5b47db0a73d" kindref="member">ssh_options_set()</ref> only before you connect to the server. </para>
</simplesect>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="libssh-mirror/src/auth.c" line="872" column="5" bodyfile="libssh-mirror/src/auth.c" bodystart="872" bodyend="961"/>
        <references refid="structssh__session__struct_1a5c92e3c7c116f8162038fdca66361641" compoundref="session_8h" startline="151">ssh_session_struct::agent_state</references>
        <references refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" compoundref="pkd__daemon_8c" startline="62">rc</references>
        <references refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" compoundref="torture__session__keys_8c" startline="61">session</references>
        <references refid="agent_8h_1a470bb8d667532292562a8567cbd708de" compoundref="agent_8c" startline="398" endline="405">ssh_agent_get_first_ident</references>
        <references refid="agent_8h_1a730a3c31e6bef0b7f88f0061dc5deb3f" compoundref="agent_8c" startline="408" endline="455">ssh_agent_get_next_ident</references>
        <references refid="agent_8h_1a8ecb166e690f4b0bf35af42184f28407">ssh_agent_is_running</references>
        <references refid="group__libssh__auth_1gga288d00c21fe2d652607792379d90b7cfaadc9127e305c239a7e60de4bb569c89d" compoundref="auth_8c" startline="830">SSH_AGENT_STATE_AUTH</references>
        <references refid="group__libssh__auth_1ga7d4487088981015ec0b1c66befc1c7dd" compoundref="auth_8c" startline="840" endline="848">ssh_agent_state_free</references>
        <references refid="group__libssh__auth_1gga288d00c21fe2d652607792379d90b7cfa5965e2ae4d759e633b54e038783fb118" compoundref="auth_8c" startline="828">SSH_AGENT_STATE_NONE</references>
        <references refid="group__libssh__auth_1gga288d00c21fe2d652607792379d90b7cfa2c08668800684d1e8b900b73b6681bb6" compoundref="auth_8c" startline="829">SSH_AGENT_STATE_PUBKEY</references>
        <references refid="libssh_8h_1a5b35a5038ad8eac4a4e4c00c6239e6e2a0f166cff4fa03faf4e4c11ad854a4996" compoundref="libssh_8h" startline="166">SSH_AUTH_AGAIN</references>
        <references refid="libssh_8h_1a5b35a5038ad8eac4a4e4c00c6239e6e2ac3d2d6d092a7adc147b7f859a0b252d2" compoundref="libssh_8h" startline="163">SSH_AUTH_DENIED</references>
        <references refid="libssh_8h_1a5b35a5038ad8eac4a4e4c00c6239e6e2a33d82f552d20734c17e770af637e3e17" compoundref="libssh_8h" startline="167">SSH_AUTH_ERROR</references>
        <references refid="libssh_8h_1a5b35a5038ad8eac4a4e4c00c6239e6e2a3bb06206cff7b6f818099d6019418eea" compoundref="libssh_8h" startline="164">SSH_AUTH_PARTIAL</references>
        <references refid="libssh_8h_1a5b35a5038ad8eac4a4e4c00c6239e6e2ab145398ebf554c3cc5d6acfb241c5235" compoundref="libssh_8h" startline="162">SSH_AUTH_SUCCESS</references>
        <references refid="group__libssh__pki_1ga08808beb83a42ccd6f1c710ddeb1b4c2" compoundref="pki_8c" startline="205" endline="210">ssh_key_free</references>
        <references refid="priv_8h_1aa21fd8a7a609329603b7b16da7939fca" compoundref="priv_8h" startline="240">SSH_LOG</references>
        <references refid="libssh_8h_1a5e4247396f11fdc228d356a408c81715" compoundref="libssh_8h" startline="374">SSH_LOG_DEBUG</references>
        <references refid="libssh_8h_1a930fb852177813d4718c5d1911568740" compoundref="libssh_8h" startline="372">SSH_LOG_INFO</references>
        <references refid="priv_8h_1ae280c413c792e04237f000841ac8ce44" compoundref="priv_8h" startline="265">ssh_set_error_oom</references>
        <references refid="libssh_8h_1a892d8251a4be8c99d31d0bb599174c0c" compoundref="libssh_8h" startline="798">SSH_STRING_FREE_CHAR</references>
        <references refid="group__libssh__auth_1ga691078be9ea2a55fed97c7488395af5a" compoundref="auth_8c" startline="726" endline="825">ssh_userauth_agent_publickey</references>
        <references refid="group__libssh__auth_1ga592f673c4d417a6a46cd4876ac8287aa" compoundref="auth_8c" startline="489" endline="584">ssh_userauth_try_publickey</references>
        <references refid="structssh__agent__state__struct_1aff904ec87c3104dfb7bb6915ef9a88b6" compoundref="auth_8c" startline="834">ssh_agent_state_struct::state</references>
        <references refid="proxy_8c_1a9b20c006bd90a09e1465fb668700e81d" compoundref="proxy_8c" startline="35">username</references>
        <references refid="priv_8h_1a65e0a55b6af58e00b0a584d665af60ab" compoundref="priv_8h" startline="320">ZERO_STRUCTP</references>
        <referencedby refid="group__libssh__auth_1ga53e6771b250c061463ed98b6e5b6e0af" compoundref="auth_8c" startline="1007" endline="1212">ssh_userauth_publickey_auto</referencedby>
        <referencedby refid="torture__auth_8c_1add171176cc97a54d8bf7a3a9fcbd49c8" compoundref="torture__auth_8c" startline="440" endline="465">torture_auth_agent</referencedby>
        <referencedby refid="torture__auth_8c_1ac1e47567b2530e7c7c17d7f3367db43c" compoundref="torture__auth_8c" startline="467" endline="496">torture_auth_agent_nonblocking</referencedby>
      </memberdef>
      <memberdef kind="function" id="group__libssh__auth_1ga53e6771b250c061463ed98b6e5b6e0af" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>int ssh_userauth_publickey_auto</definition>
        <argsstring>(ssh_session session, const char *username, const char *passphrase)</argsstring>
        <name>ssh_userauth_publickey_auto</name>
        <param>
          <type><ref refid="libssh_8h_1a02d3754de040612632cdd499c20f92f6" kindref="member">ssh_session</ref></type>
          <declname>session</declname>
        </param>
        <param>
          <type>const char *</type>
          <declname>username</declname>
        </param>
        <param>
          <type>const char *</type>
          <declname>passphrase</declname>
        </param>
        <briefdescription>
<para>Tries to automatically authenticate with public key and &quot;none&quot;. </para>
        </briefdescription>
        <detaileddescription>
<para>It may fail, for instance it doesn&apos;t ask for a password and uses a default asker for passphrases (in case the private key is encrypted).</para>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername direction="in">session</parametername>
</parameternamelist>
<parameterdescription>
<para>The SSH session.</para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">username</parametername>
</parameternamelist>
<parameterdescription>
<para>The username, this SHOULD be NULL.</para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">passphrase</parametername>
</parameternamelist>
<parameterdescription>
<para>Use this passphrase to unlock the privatekey. Use NULL if you don&apos;t want to use a passphrase or the user should be asked.</para>
</parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>SSH_AUTH_ERROR: A serious error happened.<linebreak/>
 SSH_AUTH_DENIED: The server doesn&apos;t accept that public key as an authentication token. Try another key or another method.<linebreak/>
 SSH_AUTH_PARTIAL: You&apos;ve been partially authenticated, you still have to use another method.<linebreak/>
 SSH_AUTH_SUCCESS: The public key is accepted, you want now to use <ref refid="group__libssh__auth_1gaa38c4f3194ef36720da7eddb0aa99e23" kindref="member">ssh_userauth_publickey()</ref>.<linebreak/>
 SSH_AUTH_AGAIN: In nonblocking mode, you&apos;ve got to call this again later.</para>
</simplesect>
<simplesect kind="note"><para>Most server implementations do not permit changing the username during authentication. The username should only be set with <ref refid="group__libssh__session_1ga7a801b85800baa3f4e16f5b47db0a73d" kindref="member">ssh_options_set()</ref> only before you connect to the server. </para>
</simplesect>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="libssh-mirror/src/auth.c" line="1007" column="5" bodyfile="libssh-mirror/src/auth.c" bodystart="1007" bodyend="1212"/>
        <references refid="structssh__session__struct_1a3d57e01582c0c9099f7f319513321fe8">ssh_session_struct::auth</references>
        <references refid="structssh__callbacks__struct_1a5f79b2d36329d0ce6e9ac2cd3b77b046" compoundref="callbacks_8h" startline="152">ssh_callbacks_struct::auth_function</references>
        <references refid="structssh__session__struct_1a704e97e502aaee91fc79507a3458a87d" compoundref="session_8h" startline="154">ssh_session_struct::auto_state</references>
        <references refid="structssh__common__struct_1a2f42939ea278698d861c7617b7529eb7" compoundref="session_8h" startline="105">ssh_common_struct::callbacks</references>
        <references refid="structssh__session__struct_1acad23ad6d8bee359da41b9ed0faa6eaa" compoundref="session_8h" startline="110">ssh_session_struct::common</references>
        <references refid="structssh__session__struct_1a997060832a3419d8fe884d3da855ef4c" compoundref="session_8h" startline="129">ssh_session_struct::flags</references>
        <references refid="structssh__session__struct_1aab5ecfb12d53a23b21dbf61790aa7e94" compoundref="session_8h" startline="209">ssh_session_struct::identity</references>
        <references refid="structssh__session__struct_1a1c29cf990c1d0df6e1b0971d4f3d1f3e">ssh_session_struct::opts</references>
        <references refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" compoundref="pkd__daemon_8c" startline="62">rc</references>
        <references refid="sshd__direct-tcpip_8c_1aed3129b7674034c979192bcca6b0ad8c" compoundref="sshd__direct-tcpip_8c" startline="36">SAFE_FREE</references>
        <references refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" compoundref="torture__session__keys_8c" startline="61">session</references>
        <references refid="libssh_8h_1a5b35a5038ad8eac4a4e4c00c6239e6e2a0f166cff4fa03faf4e4c11ad854a4996" compoundref="libssh_8h" startline="166">SSH_AUTH_AGAIN</references>
        <references refid="group__libssh__auth_1ggac65f4923889fe6f2b91021872463b4c4a0f73343ecb44ed535c5d53cede05485a" compoundref="auth_8c" startline="967">SSH_AUTH_AUTO_STATE_KEY_IMPORTED</references>
        <references refid="group__libssh__auth_1ggac65f4923889fe6f2b91021872463b4c4a7423bce4e2477ab036c8ce272fd7642f" compoundref="auth_8c" startline="965">SSH_AUTH_AUTO_STATE_NONE</references>
        <references refid="group__libssh__auth_1ggac65f4923889fe6f2b91021872463b4c4a82677b8f55353fe73bdd8ddb9958d367" compoundref="auth_8c" startline="966">SSH_AUTH_AUTO_STATE_PUBKEY</references>
        <references refid="group__libssh__auth_1ggac65f4923889fe6f2b91021872463b4c4ad484a042d380c408bc75ef844e8e0e9c" compoundref="auth_8c" startline="968">SSH_AUTH_AUTO_STATE_PUBKEY_ACCEPTED</references>
        <references refid="libssh_8h_1a5b35a5038ad8eac4a4e4c00c6239e6e2ac3d2d6d092a7adc147b7f859a0b252d2" compoundref="libssh_8h" startline="163">SSH_AUTH_DENIED</references>
        <references refid="libssh_8h_1a5b35a5038ad8eac4a4e4c00c6239e6e2a33d82f552d20734c17e770af637e3e17" compoundref="libssh_8h" startline="167">SSH_AUTH_ERROR</references>
        <references refid="libssh_8h_1aff27d66c1f5ba3871e72b5a61573f44a" compoundref="libssh_8h" startline="174">SSH_AUTH_METHOD_PUBLICKEY</references>
        <references refid="libssh_8h_1a5b35a5038ad8eac4a4e4c00c6239e6e2a3bb06206cff7b6f818099d6019418eea" compoundref="libssh_8h" startline="164">SSH_AUTH_PARTIAL</references>
        <references refid="libssh_8h_1a5b35a5038ad8eac4a4e4c00c6239e6e2ab145398ebf554c3cc5d6acfb241c5235" compoundref="libssh_8h" startline="162">SSH_AUTH_SUCCESS</references>
        <references refid="libssh_8h_1a8f938067bd84c30bd28b7c2705a37beb" compoundref="libssh_8h" startline="332">SSH_EOF</references>
        <references refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" compoundref="libssh_8h" startline="330">SSH_ERROR</references>
        <references refid="libssh_8h_1a036b2b00fb04337a4d06d719d1b62be1a86ff0b2e8da6ad8628efc556b6ce1887" compoundref="libssh_8h" startline="286">SSH_FATAL</references>
        <references refid="group__libssh__pki_1ga08808beb83a42ccd6f1c710ddeb1b4c2" compoundref="pki_8c" startline="205" endline="210">ssh_key_free</references>
        <references refid="group__libssh__misc_1gad36d247bfcae7965d6aca8245d061e0d" compoundref="misc_8c" startline="682" endline="686">ssh_list_get_iterator</references>
        <references refid="priv_8h_1aa21fd8a7a609329603b7b16da7939fca" compoundref="priv_8h" startline="240">SSH_LOG</references>
        <references refid="libssh_8h_1a5e4247396f11fdc228d356a408c81715" compoundref="libssh_8h" startline="374">SSH_LOG_DEBUG</references>
        <references refid="libssh_8h_1a930fb852177813d4718c5d1911568740" compoundref="libssh_8h" startline="372">SSH_LOG_INFO</references>
        <references refid="libssh_8h_1ab3c2f1accd58d32987f02d8aebdc1fc4" compoundref="libssh_8h" startline="370">SSH_LOG_WARN</references>
        <references refid="session_8h_1a4a21bc2bfa096997458dcfccbda31434" compoundref="session_8h" startline="91">SSH_OPT_FLAG_PUBKEY_AUTH</references>
        <references refid="group__libssh__pki_1ga5777bc537da6a447b2a9aa9eceff9877" compoundref="pki_8c" startline="1992" endline="2008">ssh_pki_export_privkey_to_pubkey</references>
        <references refid="group__libssh__pki_1gaa94ec2542a8dc9fb32c0989680a1e20f" compoundref="pki_8c" startline="1693" endline="1702">ssh_pki_export_pub_uri_from_priv_uri</references>
        <references refid="group__libssh__pki_1ga576cb3a5c7f40a0e20a88b14a023613d" compoundref="pki_8c" startline="2086" endline="2142">ssh_pki_export_pubkey_file</references>
        <references refid="group__libssh__pki_1ga1c8f84137606b1585006302499100ee0" compoundref="pki_8c" startline="900" endline="982">ssh_pki_import_privkey_file</references>
        <references refid="group__libssh__pki_1gaffb08168b870fb9e86cc7649c8987eb0" compoundref="pki_8c" startline="1717" endline="1823">ssh_pki_import_pubkey_file</references>
        <references refid="group__libssh__pki_1ga991cafa534b76035ec5cc4c9c0367458" compoundref="pki_8c" startline="1672" endline="1682">ssh_pki_is_uri</references>
        <references refid="priv_8h_1a55177b3e8db90ca9adb435c44281963c" compoundref="priv_8h" startline="258">ssh_set_error</references>
        <references refid="priv_8h_1ae280c413c792e04237f000841ac8ce44" compoundref="priv_8h" startline="265">ssh_set_error_oom</references>
        <references refid="group__libssh__auth_1ga7d84f3f89f65455b80b10e2643d80719" compoundref="auth_8c" startline="872" endline="961">ssh_userauth_agent</references>
        <references refid="group__libssh__auth_1gaa38c4f3194ef36720da7eddb0aa99e23" compoundref="auth_8c" startline="609" endline="723">ssh_userauth_publickey</references>
        <references refid="group__libssh__auth_1ga592f673c4d417a6a46cd4876ac8287aa" compoundref="auth_8c" startline="489" endline="584">ssh_userauth_try_publickey</references>
        <references refid="structssh__auth__auto__state__struct_1ad79845cdd57294bad689bf52b1be697d" compoundref="auth_8c" startline="972">ssh_auth_auto_state_struct::state</references>
        <references refid="structssh__session__struct_1a3e967ac3134cae87dae1f6a794424073" compoundref="session_8h" startline="157">ssh_session_struct::supported_methods</references>
        <references refid="structssh__callbacks__struct_1aa5cdca2ba78d7582d8eff77ef7995700" compoundref="callbacks_8h" startline="148">ssh_callbacks_struct::userdata</references>
        <references refid="proxy_8c_1a9b20c006bd90a09e1465fb668700e81d" compoundref="proxy_8c" startline="35">username</references>
        <referencedby refid="examples_2authentication_8c_1a442e0c31c0c57f60ec1f5eaaceebf436" compoundref="examples_2authentication_8c" startline="141" endline="241">authenticate_console</referencedby>
        <referencedby refid="legacy_8h_1aebc0160212f355d57e4c331e4650d53c" compoundref="legacy_8c" startline="97" endline="99">ssh_userauth_autopubkey</referencedby>
        <referencedby refid="torture__auth_8c_1a1bc4253d4b7389acb38fa5e5ffc3cf51" compoundref="torture__auth_8c" startline="253" endline="275">torture_auth_autopubkey</referencedby>
        <referencedby refid="torture__auth_8c_1a2fc459f58be2d4e235c5ef4397fa8b4b" compoundref="torture__auth_8c" startline="277" endline="305">torture_auth_autopubkey_nonblocking</referencedby>
        <referencedby refid="torture__auth_8c_1a1e1c5e9d0352de375c56cf27921d00f6" compoundref="torture__auth_8c" startline="597" endline="632">torture_auth_pubkey_types</referencedby>
        <referencedby refid="torture__auth_8c_1a30fc01934c5dc0343d91dc6b90cbabac" compoundref="torture__auth_8c" startline="634" endline="670">torture_auth_pubkey_types_ecdsa</referencedby>
        <referencedby refid="torture__auth_8c_1aaefb1835a46af27a36149a89c3308825" compoundref="torture__auth_8c" startline="777" endline="822">torture_auth_pubkey_types_ecdsa_nonblocking</referencedby>
        <referencedby refid="torture__auth_8c_1a6c870e5368b648dc01f643bbc52a62f4" compoundref="torture__auth_8c" startline="730" endline="775">torture_auth_pubkey_types_nonblocking</referencedby>
        <referencedby refid="torture__rekey_8c_1a75d0cca74861337645286b4d42e57006" compoundref="torture__rekey_8c" startline="150" endline="209">torture_rekey_send</referencedby>
        <referencedby refid="torture__rekey_8c_1a3c7d816b41acf84841eb39ec72475998" compoundref="torture__rekey_8c" startline="393" endline="440">torture_rekey_server_send</referencedby>
        <referencedby refid="torture__rekey_8c_1a83928e03d85a04fd06d4c4a0ca9c7394" compoundref="torture__rekey_8c" startline="324" endline="388">torture_rekey_time</referencedby>
        <referencedby refid="torture__server_8c_1a73fb9c5aabcb0550f2bdee3cfd7ef346" compoundref="torture__server_8c" startline="392" endline="424">torture_server_auth_pubkey</referencedby>
        <referencedby refid="torture_8c_1aa1653e389922c4762e71dbd2ab2d7cda" compoundref="torture_8c" startline="262" endline="353">torture_ssh_session</referencedby>
        <referencedby refid="torture__server__config_8c_1a5de50eda837b8f94dcf6d18a765d0dc8" compoundref="torture__server__config_8c" startline="350" endline="423">try_config_content</referencedby>
        <referencedby refid="classssh_1_1Session_1a651141f9bcf5792644f6d411ab2cc0c5" compoundref="libsshpp_8hpp" startline="180" endline="184">ssh::Session::userauthPublickeyAuto</referencedby>
      </memberdef>
      <memberdef kind="function" id="group__libssh__auth_1ga50c0c150f8c4703e7ee49b3e3e3ca215" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>int ssh_userauth_password</definition>
        <argsstring>(ssh_session session, const char *username, const char *password)</argsstring>
        <name>ssh_userauth_password</name>
        <param>
          <type><ref refid="libssh_8h_1a02d3754de040612632cdd499c20f92f6" kindref="member">ssh_session</ref></type>
          <declname>session</declname>
        </param>
        <param>
          <type>const char *</type>
          <declname>username</declname>
        </param>
        <param>
          <type>const char *</type>
          <declname>password</declname>
        </param>
        <briefdescription>
<para>Try to authenticate by password. </para>
        </briefdescription>
        <detaileddescription>
<para>This authentication method is normally disabled on SSHv2 server. You should use keyboard-interactive mode.</para>
<para>The &apos;password&apos; value MUST be encoded UTF-8. It is up to the server how to interpret the password and validate it against the password database. However, if you read the password in some other encoding, you MUST convert the password to UTF-8.</para>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername direction="in">session</parametername>
</parameternamelist>
<parameterdescription>
<para>The ssh session to use.</para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">username</parametername>
</parameternamelist>
<parameterdescription>
<para>The username, this SHOULD be NULL.</para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">password</parametername>
</parameternamelist>
<parameterdescription>
<para>The password to authenticate in UTF-8.</para>
</parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>SSH_AUTH_ERROR: A serious error happened.<linebreak/>
 SSH_AUTH_DENIED: Authentication failed: use another method<linebreak/>
 SSH_AUTH_PARTIAL: You&apos;ve been partially authenticated, you still have to use another method<linebreak/>
 SSH_AUTH_SUCCESS: Authentication success<linebreak/>
 SSH_AUTH_AGAIN: In nonblocking mode, you&apos;ve got to call this again later.</para>
</simplesect>
<simplesect kind="note"><para>Most server implementations do not permit changing the username during authentication. The username should only be set with <ref refid="group__libssh__session_1ga7a801b85800baa3f4e16f5b47db0a73d" kindref="member">ssh_options_set()</ref> only before you connect to the server.</para>
</simplesect>
<simplesect kind="see"><para><ref refid="group__libssh__auth_1ga58e7c265236edbc97a2f117d3f23b4dd" kindref="member">ssh_userauth_none()</ref> </para>
</simplesect>
<simplesect kind="see"><para><ref refid="group__libssh__auth_1ga6b3b1c2a045286d9476b0252791a07d2" kindref="member">ssh_userauth_kbdint()</ref> </para>
</simplesect>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="libssh-mirror/src/auth.c" line="1246" column="5" bodyfile="libssh-mirror/src/auth.c" bodystart="1246" bodyend="1307"/>
        <references refid="structssh__session__struct_1a3d57e01582c0c9099f7f319513321fe8">ssh_session_struct::auth</references>
        <references refid="structssh__session__struct_1aa859857ac7a99808ffc537e08087e541" compoundref="session_8h" startline="158">ssh_session_struct::current_method</references>
        <references refid="structssh__session__struct_1a1c29cf990c1d0df6e1b0971d4f3d1f3e">ssh_session_struct::opts</references>
        <references refid="structssh__session__struct_1af0aed60c1e529bbfdcb483fd80bf98a0" compoundref="session_8h" startline="140">ssh_session_struct::out_buffer</references>
        <references refid="structssh__session__struct_1a5552665043089000065df39c5a5a7094" compoundref="session_8h" startline="146">ssh_session_struct::pending_call_state</references>
        <references refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" compoundref="pkd__daemon_8c" startline="62">rc</references>
        <references refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" compoundref="torture__session__keys_8c" startline="61">session</references>
        <references refid="ssh2_8h_1a423ea81df02faff2d59b730af16ac59e" compoundref="ssh2_8h" startline="27">SSH2_MSG_USERAUTH_REQUEST</references>
        <references refid="libssh_8h_1a9c57e4f6482106336045a4d25a55f28e" compoundref="libssh_8h" startline="331">SSH_AGAIN</references>
        <references refid="libssh_8h_1a5b35a5038ad8eac4a4e4c00c6239e6e2a0f166cff4fa03faf4e4c11ad854a4996" compoundref="libssh_8h" startline="166">SSH_AUTH_AGAIN</references>
        <references refid="libssh_8h_1a5b35a5038ad8eac4a4e4c00c6239e6e2a33d82f552d20734c17e770af637e3e17" compoundref="libssh_8h" startline="167">SSH_AUTH_ERROR</references>
        <references refid="libssh_8h_1ad10dd2f5826e2d92a30bd8af3404574d" compoundref="libssh_8h" startline="173">SSH_AUTH_METHOD_PASSWORD</references>
        <references refid="auth_8h_1a0d3114986a741a14dc3ac03f7d8eafefaedccdf68a9f5857c7f31ac557b2a57b6" compoundref="auth_8h" startline="84">SSH_AUTH_STATE_PASSWORD_AUTH_SENT</references>
        <references refid="buffer_8h_1ae17848a86043f0abfc60c1c4f6126ccd" compoundref="buffer_8h" startline="49">ssh_buffer_pack</references>
        <references refid="libssh_8h_1ac8802ff7f5348d0145dab5242623f740">ssh_buffer_reinit</references>
        <references refid="group__libssh__buffer_1gade0108b17f43b5269b92456a785df126" compoundref="buffer_8c" startline="176" endline="179">ssh_buffer_set_secure</references>
        <references refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" compoundref="libssh_8h" startline="330">SSH_ERROR</references>
        <references refid="libssh_8h_1a036b2b00fb04337a4d06d719d1b62be1a86ff0b2e8da6ad8628efc556b6ce1887" compoundref="libssh_8h" startline="286">SSH_FATAL</references>
        <references refid="packet_8h_1a7e6c7ed74c23ace432476aa8a6841140" compoundref="packet_8c" startline="1761" endline="1843">ssh_packet_send</references>
        <references refid="session_8h_1abb7a4342b889601983497b3f094957e1a95e070b4edb4f7f647d8129c3c2782d3" compoundref="session_8h" startline="63">SSH_PENDING_CALL_AUTH_PASSWORD</references>
        <references refid="session_8h_1abb7a4342b889601983497b3f094957e1a33be3f7cd03fe7fced1eeacd369cad94" compoundref="session_8h" startline="60">SSH_PENDING_CALL_NONE</references>
        <references refid="priv_8h_1a55177b3e8db90ca9adb435c44281963c" compoundref="priv_8h" startline="258">ssh_set_error</references>
        <references refid="priv_8h_1ae280c413c792e04237f000841ac8ce44" compoundref="priv_8h" startline="265">ssh_set_error_oom</references>
        <references refid="group__libssh__auth_1gabff6b3898d3bf45b62cc3ed3774eaa83" compoundref="auth_8c" startline="142" endline="186">ssh_userauth_get_response</references>
        <references refid="group__libssh__auth_1ga812fb86c3dd4a6245bc7d01beaa9cfe8" compoundref="auth_8c" startline="69" endline="79">ssh_userauth_request_service</references>
        <references refid="structssh__session__struct_1af0805877d21d43e81423ead52345c64b" compoundref="session_8h" startline="156">ssh_session_struct::state</references>
        <references refid="proxy_8c_1a9b20c006bd90a09e1465fb668700e81d" compoundref="proxy_8c" startline="35">username</references>
        <references refid="structssh__session__struct_1a8ed5d5d3116679fd7b8f2c0e1db92726" compoundref="session_8h" startline="210">ssh_session_struct::username</references>
        <referencedby refid="tests_2authentication_8c_1a91e95146a766cad292c79cca6b169f3d" compoundref="tests_2authentication_8c" startline="49" endline="74">authenticate</referencedby>
        <referencedby refid="examples_2authentication_8c_1a442e0c31c0c57f60ec1f5eaaceebf436" compoundref="examples_2authentication_8c" startline="141" endline="241">authenticate_console</referencedby>
        <referencedby refid="torture__auth_8c_1acab4c789da42f078db39e0e8dec81bc4" compoundref="torture__auth_8c" startline="386" endline="407">torture_auth_password</referencedby>
        <referencedby refid="torture__auth_8c_1a144cbca03a69c33a0137bbcbd69873cf" compoundref="torture__auth_8c" startline="409" endline="438">torture_auth_password_nonblocking</referencedby>
        <referencedby refid="torture__server_8c_1a209f1dfc209f45f52226ee57825f596b" compoundref="torture__server_8c" startline="355" endline="390">torture_server_auth_password</referencedby>
        <referencedby refid="torture__server_8c_1a65c15130edce6143731c7bff27153650" compoundref="torture__server_8c" startline="476" endline="518">torture_server_unknown_global_request</referencedby>
        <referencedby refid="torture_8c_1aa1653e389922c4762e71dbd2ab2d7cda" compoundref="torture_8c" startline="262" endline="353">torture_ssh_session</referencedby>
        <referencedby refid="classssh_1_1Session_1ac2d10826877bec6598961614eb62f0f7" compoundref="libsshpp_8hpp" startline="259" endline="263">ssh::Session::userauthPassword</referencedby>
      </memberdef>
      <memberdef kind="function" id="group__libssh__auth_1ga5cc49db459d6e27c8645a20bbd0f5f88" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>int ssh_userauth_agent_pubkey</definition>
        <argsstring>(ssh_session session, const char *username, ssh_public_key publickey)</argsstring>
        <name>ssh_userauth_agent_pubkey</name>
        <param>
          <type><ref refid="libssh_8h_1a02d3754de040612632cdd499c20f92f6" kindref="member">ssh_session</ref></type>
          <declname>session</declname>
        </param>
        <param>
          <type>const char *</type>
          <declname>username</declname>
        </param>
        <param>
          <type><ref refid="legacy_8h_1a5720dd2559600d96da21266e7fd09ab4" kindref="member">ssh_public_key</ref></type>
          <declname>publickey</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="libssh-mirror/src/auth.c" line="1311" column="5" bodyfile="libssh-mirror/src/auth.c" bodystart="1311" bodyend="1336"/>
        <references refid="torture__crypto_8c_1a42363914b961236c71004e83b3b66a1b" compoundref="torture__crypto_8c" startline="9">key</references>
        <references refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" compoundref="pkd__daemon_8c" startline="62">rc</references>
        <references refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" compoundref="torture__session__keys_8c" startline="61">session</references>
        <references refid="libssh_8h_1a5b35a5038ad8eac4a4e4c00c6239e6e2a33d82f552d20734c17e770af637e3e17" compoundref="libssh_8h" startline="167">SSH_AUTH_ERROR</references>
        <references refid="pki_8h_1a916bbdaba2e1b30d69f34a2df20dc7b8" compoundref="pki_8h" startline="50">SSH_KEY_FLAG_PUBLIC</references>
        <references refid="group__libssh__pki_1ga08808beb83a42ccd6f1c710ddeb1b4c2" compoundref="pki_8c" startline="205" endline="210">ssh_key_free</references>
        <references refid="group__libssh__pki_1gabfebce03474a4d014aa779d5dbf057b0" compoundref="pki_8c" startline="123" endline="130">ssh_key_new</references>
        <references refid="group__libssh__pki_1ga302919f046a4af504e5a2a9924b031c1" compoundref="pki_8c" startline="283" endline="326">ssh_key_type_to_char</references>
        <references refid="group__libssh__auth_1ga691078be9ea2a55fed97c7488395af5a" compoundref="auth_8c" startline="726" endline="825">ssh_userauth_agent_publickey</references>
        <references refid="structssh__public__key__struct_1a69d5a807f16ad377646d15c87886ae0e" compoundref="keys_8h" startline="29">ssh_public_key_struct::type</references>
        <references refid="proxy_8c_1a9b20c006bd90a09e1465fb668700e81d" compoundref="proxy_8c" startline="35">username</references>
      </memberdef>
      <memberdef kind="function" id="group__libssh__auth_1gac17384e2e1723b50cd041d775c0175a8" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="auth_8h_1abd88982f6190217dbe437b339001286d" kindref="member">ssh_kbdint</ref></type>
        <definition>ssh_kbdint ssh_kbdint_new</definition>
        <argsstring>(void)</argsstring>
        <name>ssh_kbdint_new</name>
        <param>
          <type>void</type>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="libssh-mirror/src/auth.c" line="1339" column="12" bodyfile="libssh-mirror/src/auth.c" bodystart="1339" bodyend="1348"/>
        <referencedby refid="group__libssh__server_1gaacbc31ce3b39ac93061164feec822c77" compoundref="server_8c" startline="847" endline="951">ssh_message_auth_interactive_request</referencedby>
        <referencedby refid="group__libssh__auth_1ga09059b696a82df0fb633977d2749e10a" compoundref="auth_8c" startline="1550" endline="1635">SSH_PACKET_CALLBACK</referencedby>
      </memberdef>
      <memberdef kind="function" id="group__libssh__auth_1ga43266010b4cc11e277658c4c6c4a5500" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void ssh_kbdint_free</definition>
        <argsstring>(ssh_kbdint kbd)</argsstring>
        <name>ssh_kbdint_free</name>
        <param>
          <type><ref refid="auth_8h_1abd88982f6190217dbe437b339001286d" kindref="member">ssh_kbdint</ref></type>
          <declname>kbd</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="libssh-mirror/src/auth.c" line="1351" column="6" bodyfile="libssh-mirror/src/auth.c" bodystart="1351" bodyend="1385"/>
        <references refid="structssh__kbdint__struct_1aae334dcc6b8fe544b25f4377360db554" compoundref="auth_8h" startline="44">ssh_kbdint_struct::answers</references>
        <references refid="structssh__kbdint__struct_1a53c38b9a2468c1d79954408e9b7bc7aa" compoundref="auth_8h" startline="43">ssh_kbdint_struct::echo</references>
        <references refid="group__libssh__misc_1ga51869b401cb0f3e711527bc9a730fbff" compoundref="misc_8c" startline="1461" endline="1474">explicit_bzero</references>
        <references refid="structssh__kbdint__struct_1a22c149b9323116ac704fabc4c6a5caa6" compoundref="auth_8h" startline="41">ssh_kbdint_struct::instruction</references>
        <references refid="structssh__kbdint__struct_1a8c7f5532d4b52ab7f81bacdf8394c51c" compoundref="auth_8h" startline="40">ssh_kbdint_struct::name</references>
        <references refid="structssh__kbdint__struct_1af297b39443720d689feb400020c0988f" compoundref="auth_8h" startline="39">ssh_kbdint_struct::nanswers</references>
        <references refid="structssh__kbdint__struct_1a316bac1f096accc10024c7e787e0e3d6" compoundref="auth_8h" startline="38">ssh_kbdint_struct::nprompts</references>
        <references refid="structssh__kbdint__struct_1a3b528280ac48b0713c1f963ee9f3574b" compoundref="auth_8h" startline="42">ssh_kbdint_struct::prompts</references>
        <references refid="sshd__direct-tcpip_8c_1aed3129b7674034c979192bcca6b0ad8c" compoundref="sshd__direct-tcpip_8c" startline="36">SAFE_FREE</references>
        <referencedby refid="group__libssh__session_1gae5af27a98a7488e9f5ded6b37c274156" compoundref="session_8c" startline="191" endline="326">ssh_free</referencedby>
        <referencedby refid="group__libssh__server_1gaacbc31ce3b39ac93061164feec822c77" compoundref="server_8c" startline="847" endline="951">ssh_message_auth_interactive_request</referencedby>
        <referencedby refid="group__libssh__auth_1ga09059b696a82df0fb633977d2749e10a" compoundref="auth_8c" startline="1550" endline="1635">SSH_PACKET_CALLBACK</referencedby>
        <referencedby refid="group__libssh__auth_1gaaa68e6aec2da509b246b7cba071408d3" compoundref="auth_8c" startline="1493" endline="1542">ssh_userauth_kbdint_send</referencedby>
      </memberdef>
      <memberdef kind="function" id="group__libssh__auth_1gac042e71960b1aa80d8245125feeb249a" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void ssh_kbdint_clean</definition>
        <argsstring>(ssh_kbdint kbd)</argsstring>
        <name>ssh_kbdint_clean</name>
        <param>
          <type><ref refid="auth_8h_1abd88982f6190217dbe437b339001286d" kindref="member">ssh_kbdint</ref></type>
          <declname>kbd</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="libssh-mirror/src/auth.c" line="1387" column="6" bodyfile="libssh-mirror/src/auth.c" bodystart="1387" bodyend="1419"/>
        <references refid="structssh__kbdint__struct_1aae334dcc6b8fe544b25f4377360db554" compoundref="auth_8h" startline="44">ssh_kbdint_struct::answers</references>
        <references refid="structssh__kbdint__struct_1a53c38b9a2468c1d79954408e9b7bc7aa" compoundref="auth_8h" startline="43">ssh_kbdint_struct::echo</references>
        <references refid="group__libssh__misc_1ga51869b401cb0f3e711527bc9a730fbff" compoundref="misc_8c" startline="1461" endline="1474">explicit_bzero</references>
        <references refid="structssh__kbdint__struct_1a22c149b9323116ac704fabc4c6a5caa6" compoundref="auth_8h" startline="41">ssh_kbdint_struct::instruction</references>
        <references refid="structssh__kbdint__struct_1a8c7f5532d4b52ab7f81bacdf8394c51c" compoundref="auth_8h" startline="40">ssh_kbdint_struct::name</references>
        <references refid="structssh__kbdint__struct_1af297b39443720d689feb400020c0988f" compoundref="auth_8h" startline="39">ssh_kbdint_struct::nanswers</references>
        <references refid="structssh__kbdint__struct_1a316bac1f096accc10024c7e787e0e3d6" compoundref="auth_8h" startline="38">ssh_kbdint_struct::nprompts</references>
        <references refid="structssh__kbdint__struct_1a3b528280ac48b0713c1f963ee9f3574b" compoundref="auth_8h" startline="42">ssh_kbdint_struct::prompts</references>
        <references refid="sshd__direct-tcpip_8c_1aed3129b7674034c979192bcca6b0ad8c" compoundref="sshd__direct-tcpip_8c" startline="36">SAFE_FREE</references>
        <referencedby refid="group__libssh__server_1gaacbc31ce3b39ac93061164feec822c77" compoundref="server_8c" startline="847" endline="951">ssh_message_auth_interactive_request</referencedby>
        <referencedby refid="group__libssh__auth_1ga09059b696a82df0fb633977d2749e10a" compoundref="auth_8c" startline="1550" endline="1635">SSH_PACKET_CALLBACK</referencedby>
      </memberdef>
      <memberdef kind="function" id="group__libssh__auth_1gac689d3761c0dc4ebee9971ecc482d9a4" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>static int ssh_userauth_kbdint_init</definition>
        <argsstring>(ssh_session session, const char *username, const char *submethods)</argsstring>
        <name>ssh_userauth_kbdint_init</name>
        <param>
          <type><ref refid="libssh_8h_1a02d3754de040612632cdd499c20f92f6" kindref="member">ssh_session</ref></type>
          <declname>session</declname>
        </param>
        <param>
          <type>const char *</type>
          <declname>username</declname>
        </param>
        <param>
          <type>const char *</type>
          <declname>submethods</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="libssh-mirror/src/auth.c" line="1424" column="12" bodyfile="libssh-mirror/src/auth.c" bodystart="1424" bodyend="1480"/>
        <references refid="structssh__session__struct_1a3d57e01582c0c9099f7f319513321fe8">ssh_session_struct::auth</references>
        <references refid="structssh__session__struct_1a1c29cf990c1d0df6e1b0971d4f3d1f3e">ssh_session_struct::opts</references>
        <references refid="structssh__session__struct_1af0aed60c1e529bbfdcb483fd80bf98a0" compoundref="session_8h" startline="140">ssh_session_struct::out_buffer</references>
        <references refid="structssh__session__struct_1a5552665043089000065df39c5a5a7094" compoundref="session_8h" startline="146">ssh_session_struct::pending_call_state</references>
        <references refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" compoundref="pkd__daemon_8c" startline="62">rc</references>
        <references refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" compoundref="torture__session__keys_8c" startline="61">session</references>
        <references refid="ssh2_8h_1a423ea81df02faff2d59b730af16ac59e" compoundref="ssh2_8h" startline="27">SSH2_MSG_USERAUTH_REQUEST</references>
        <references refid="libssh_8h_1a9c57e4f6482106336045a4d25a55f28e" compoundref="libssh_8h" startline="331">SSH_AGAIN</references>
        <references refid="libssh_8h_1a5b35a5038ad8eac4a4e4c00c6239e6e2a0f166cff4fa03faf4e4c11ad854a4996" compoundref="libssh_8h" startline="166">SSH_AUTH_AGAIN</references>
        <references refid="libssh_8h_1a5b35a5038ad8eac4a4e4c00c6239e6e2a33d82f552d20734c17e770af637e3e17" compoundref="libssh_8h" startline="167">SSH_AUTH_ERROR</references>
        <references refid="auth_8h_1a0d3114986a741a14dc3ac03f7d8eafefa6d785d00012593230e88f00debb19179" compoundref="auth_8h" startline="72">SSH_AUTH_STATE_KBDINT_SENT</references>
        <references refid="buffer_8h_1ae17848a86043f0abfc60c1c4f6126ccd" compoundref="buffer_8h" startline="49">ssh_buffer_pack</references>
        <references refid="libssh_8h_1ac8802ff7f5348d0145dab5242623f740">ssh_buffer_reinit</references>
        <references refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" compoundref="libssh_8h" startline="330">SSH_ERROR</references>
        <references refid="priv_8h_1aa21fd8a7a609329603b7b16da7939fca" compoundref="priv_8h" startline="240">SSH_LOG</references>
        <references refid="libssh_8h_1a5e4247396f11fdc228d356a408c81715" compoundref="libssh_8h" startline="374">SSH_LOG_DEBUG</references>
        <references refid="libssh_8h_1ac1ee1d1e917456d4760a94a18015377d" compoundref="libssh_8h" startline="329">SSH_OK</references>
        <references refid="packet_8h_1a7e6c7ed74c23ace432476aa8a6841140" compoundref="packet_8c" startline="1761" endline="1843">ssh_packet_send</references>
        <references refid="session_8h_1abb7a4342b889601983497b3f094957e1afa2439f8a91fc9c57f773b3264a498fc" compoundref="session_8h" startline="67">SSH_PENDING_CALL_AUTH_KBDINT_INIT</references>
        <references refid="session_8h_1abb7a4342b889601983497b3f094957e1a33be3f7cd03fe7fced1eeacd369cad94" compoundref="session_8h" startline="60">SSH_PENDING_CALL_NONE</references>
        <references refid="priv_8h_1a351ea86857d33b3ba80b396e05c4517c" compoundref="priv_8h" startline="269">ssh_set_error_invalid</references>
        <references refid="priv_8h_1ae280c413c792e04237f000841ac8ce44" compoundref="priv_8h" startline="265">ssh_set_error_oom</references>
        <references refid="group__libssh__auth_1gabff6b3898d3bf45b62cc3ed3774eaa83" compoundref="auth_8c" startline="142" endline="186">ssh_userauth_get_response</references>
        <references refid="group__libssh__auth_1ga812fb86c3dd4a6245bc7d01beaa9cfe8" compoundref="auth_8c" startline="69" endline="79">ssh_userauth_request_service</references>
        <references refid="structssh__session__struct_1af0805877d21d43e81423ead52345c64b" compoundref="session_8h" startline="156">ssh_session_struct::state</references>
        <references refid="proxy_8c_1a9b20c006bd90a09e1465fb668700e81d" compoundref="proxy_8c" startline="35">username</references>
        <references refid="structssh__session__struct_1a8ed5d5d3116679fd7b8f2c0e1db92726" compoundref="session_8h" startline="210">ssh_session_struct::username</references>
        <referencedby refid="group__libssh__auth_1ga6b3b1c2a045286d9476b0252791a07d2" compoundref="auth_8c" startline="1664" endline="1694">ssh_userauth_kbdint</referencedby>
      </memberdef>
      <memberdef kind="function" id="group__libssh__auth_1gaaa68e6aec2da509b246b7cba071408d3" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>static int ssh_userauth_kbdint_send</definition>
        <argsstring>(ssh_session session)</argsstring>
        <name>ssh_userauth_kbdint_send</name>
        <param>
          <type><ref refid="libssh_8h_1a02d3754de040612632cdd499c20f92f6" kindref="member">ssh_session</ref></type>
          <declname>session</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="libssh-mirror/src/auth.c" line="1493" column="12" bodyfile="libssh-mirror/src/auth.c" bodystart="1493" bodyend="1542"/>
        <references refid="structssh__kbdint__struct_1aae334dcc6b8fe544b25f4377360db554" compoundref="auth_8h" startline="44">ssh_kbdint_struct::answers</references>
        <references refid="structssh__session__struct_1a3d57e01582c0c9099f7f319513321fe8">ssh_session_struct::auth</references>
        <references refid="structssh__session__struct_1aa859857ac7a99808ffc537e08087e541" compoundref="session_8h" startline="158">ssh_session_struct::current_method</references>
        <references refid="structssh__session__struct_1a9cba44c19f35693037bc9bb1e0651d17" compoundref="session_8h" startline="180">ssh_session_struct::kbdint</references>
        <references refid="structssh__kbdint__struct_1a316bac1f096accc10024c7e787e0e3d6" compoundref="auth_8h" startline="38">ssh_kbdint_struct::nprompts</references>
        <references refid="structssh__session__struct_1af0aed60c1e529bbfdcb483fd80bf98a0" compoundref="session_8h" startline="140">ssh_session_struct::out_buffer</references>
        <references refid="structssh__session__struct_1a5552665043089000065df39c5a5a7094" compoundref="session_8h" startline="146">ssh_session_struct::pending_call_state</references>
        <references refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" compoundref="pkd__daemon_8c" startline="62">rc</references>
        <references refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" compoundref="torture__session__keys_8c" startline="61">session</references>
        <references refid="ssh2_8h_1a084c04a458a6b7fba56d7bf6b2d3a58b" compoundref="ssh2_8h" startline="35">SSH2_MSG_USERAUTH_INFO_RESPONSE</references>
        <references refid="libssh_8h_1a5b35a5038ad8eac4a4e4c00c6239e6e2a0f166cff4fa03faf4e4c11ad854a4996" compoundref="libssh_8h" startline="166">SSH_AUTH_AGAIN</references>
        <references refid="libssh_8h_1a5b35a5038ad8eac4a4e4c00c6239e6e2a33d82f552d20734c17e770af637e3e17" compoundref="libssh_8h" startline="167">SSH_AUTH_ERROR</references>
        <references refid="libssh_8h_1a4c64484fdce4756309799d0e2a4e926a" compoundref="libssh_8h" startline="176">SSH_AUTH_METHOD_INTERACTIVE</references>
        <references refid="auth_8h_1a0d3114986a741a14dc3ac03f7d8eafefa6d785d00012593230e88f00debb19179" compoundref="auth_8h" startline="72">SSH_AUTH_STATE_KBDINT_SENT</references>
        <references refid="buffer_8h_1ae17848a86043f0abfc60c1c4f6126ccd" compoundref="buffer_8h" startline="49">ssh_buffer_pack</references>
        <references refid="libssh_8h_1ac8802ff7f5348d0145dab5242623f740">ssh_buffer_reinit</references>
        <references refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" compoundref="libssh_8h" startline="330">SSH_ERROR</references>
        <references refid="group__libssh__auth_1ga43266010b4cc11e277658c4c6c4a5500" compoundref="auth_8c" startline="1351" endline="1385">ssh_kbdint_free</references>
        <references refid="priv_8h_1aa21fd8a7a609329603b7b16da7939fca" compoundref="priv_8h" startline="240">SSH_LOG</references>
        <references refid="libssh_8h_1a5e4247396f11fdc228d356a408c81715" compoundref="libssh_8h" startline="374">SSH_LOG_DEBUG</references>
        <references refid="packet_8h_1a7e6c7ed74c23ace432476aa8a6841140" compoundref="packet_8c" startline="1761" endline="1843">ssh_packet_send</references>
        <references refid="session_8h_1abb7a4342b889601983497b3f094957e1a964524d093fc2ba649020c4ce5460b94" compoundref="session_8h" startline="68">SSH_PENDING_CALL_AUTH_KBDINT_SEND</references>
        <references refid="session_8h_1abb7a4342b889601983497b3f094957e1a33be3f7cd03fe7fced1eeacd369cad94" compoundref="session_8h" startline="60">SSH_PENDING_CALL_NONE</references>
        <references refid="priv_8h_1a351ea86857d33b3ba80b396e05c4517c" compoundref="priv_8h" startline="269">ssh_set_error_invalid</references>
        <references refid="priv_8h_1ae280c413c792e04237f000841ac8ce44" compoundref="priv_8h" startline="265">ssh_set_error_oom</references>
        <references refid="group__libssh__auth_1gabff6b3898d3bf45b62cc3ed3774eaa83" compoundref="auth_8c" startline="142" endline="186">ssh_userauth_get_response</references>
        <references refid="structssh__session__struct_1af0805877d21d43e81423ead52345c64b" compoundref="session_8h" startline="156">ssh_session_struct::state</references>
        <referencedby refid="group__libssh__auth_1ga6b3b1c2a045286d9476b0252791a07d2" compoundref="auth_8c" startline="1664" endline="1694">ssh_userauth_kbdint</referencedby>
      </memberdef>
      <memberdef kind="function" id="group__libssh__auth_1ga09059b696a82df0fb633977d2749e10a" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type></type>
        <definition>SSH_PACKET_CALLBACK</definition>
        <argsstring>(ssh_packet_userauth_info_request)</argsstring>
        <name>SSH_PACKET_CALLBACK</name>
        <param>
          <type>ssh_packet_userauth_info_request</type>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="libssh-mirror/src/auth.c" line="1550" column="1" bodyfile="libssh-mirror/src/auth.c" bodystart="1550" bodyend="1635"/>
        <references refid="structssh__session__struct_1a3d57e01582c0c9099f7f319513321fe8">ssh_session_struct::auth</references>
        <references refid="structssh__kbdint__struct_1a53c38b9a2468c1d79954408e9b7bc7aa" compoundref="auth_8h" startline="43">ssh_kbdint_struct::echo</references>
        <references refid="structssh__kbdint__struct_1a22c149b9323116ac704fabc4c6a5caa6" compoundref="auth_8h" startline="41">ssh_kbdint_struct::instruction</references>
        <references refid="structssh__session__struct_1a9cba44c19f35693037bc9bb1e0651d17" compoundref="session_8h" startline="180">ssh_session_struct::kbdint</references>
        <references refid="priv_8h_1a16b639610e39b29f5a1114e2dcf4ac6f" compoundref="priv_8h" startline="187">KBDINT_MAX_PROMPT</references>
        <references refid="structssh__kbdint__struct_1a8c7f5532d4b52ab7f81bacdf8394c51c" compoundref="auth_8h" startline="40">ssh_kbdint_struct::name</references>
        <references refid="structssh__kbdint__struct_1af297b39443720d689feb400020c0988f" compoundref="auth_8h" startline="39">ssh_kbdint_struct::nanswers</references>
        <references refid="structssh__kbdint__struct_1a316bac1f096accc10024c7e787e0e3d6" compoundref="auth_8h" startline="38">ssh_kbdint_struct::nprompts</references>
        <references refid="structssh__kbdint__struct_1a3b528280ac48b0713c1f963ee9f3574b" compoundref="auth_8h" startline="42">ssh_kbdint_struct::prompts</references>
        <references refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" compoundref="pkd__daemon_8c" startline="62">rc</references>
        <references refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" compoundref="torture__session__keys_8c" startline="61">session</references>
        <references refid="auth_8h_1a0d3114986a741a14dc3ac03f7d8eafefa97ddb5eeec18ad7d054ec5795e6e16d6" compoundref="auth_8h" startline="68">SSH_AUTH_STATE_INFO</references>
        <references refid="buffer_8h_1ab51014ef9a47e7cdbd235af3e62b81ee" compoundref="buffer_8h" startline="59">ssh_buffer_unpack</references>
        <references refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" compoundref="libssh_8h" startline="330">SSH_ERROR</references>
        <references refid="libssh_8h_1a036b2b00fb04337a4d06d719d1b62be1a86ff0b2e8da6ad8628efc556b6ce1887" compoundref="libssh_8h" startline="286">SSH_FATAL</references>
        <references refid="group__libssh__auth_1gac042e71960b1aa80d8245125feeb249a" compoundref="auth_8c" startline="1387" endline="1419">ssh_kbdint_clean</references>
        <references refid="group__libssh__auth_1ga43266010b4cc11e277658c4c6c4a5500" compoundref="auth_8c" startline="1351" endline="1385">ssh_kbdint_free</references>
        <references refid="group__libssh__auth_1gac17384e2e1723b50cd041d775c0175a8" compoundref="auth_8c" startline="1339" endline="1348">ssh_kbdint_new</references>
        <references refid="priv_8h_1aa21fd8a7a609329603b7b16da7939fca" compoundref="priv_8h" startline="240">SSH_LOG</references>
        <references refid="libssh_8h_1a5e4247396f11fdc228d356a408c81715" compoundref="libssh_8h" startline="374">SSH_LOG_DEBUG</references>
        <references refid="libssh_8h_1ac1ee1d1e917456d4760a94a18015377d" compoundref="libssh_8h" startline="329">SSH_OK</references>
        <references refid="group__libssh__callbacks_1gac29df803aa1295d6a498c1b081f3b494" compoundref="callbacks_8h" startline="517">SSH_PACKET_USED</references>
        <references refid="priv_8h_1a55177b3e8db90ca9adb435c44281963c" compoundref="priv_8h" startline="258">ssh_set_error</references>
        <references refid="priv_8h_1ae280c413c792e04237f000841ac8ce44" compoundref="priv_8h" startline="265">ssh_set_error_oom</references>
        <references refid="libssh_8h_1a5bc8710c8633117ff449d15489fca051" compoundref="libssh_8h" startline="790">SSH_STRING_FREE</references>
        <references refid="structssh__session__struct_1af0805877d21d43e81423ead52345c64b" compoundref="session_8h" startline="156">ssh_session_struct::state</references>
        <references refid="ssh__client_8c_1a14871705f45ccdc5bb9f4549efd8e119" compoundref="ssh__client_8c" startline="48">user</references>
      </memberdef>
      <memberdef kind="function" id="group__libssh__auth_1ga6b3b1c2a045286d9476b0252791a07d2" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>int ssh_userauth_kbdint</definition>
        <argsstring>(ssh_session session, const char *user, const char *submethods)</argsstring>
        <name>ssh_userauth_kbdint</name>
        <param>
          <type><ref refid="libssh_8h_1a02d3754de040612632cdd499c20f92f6" kindref="member">ssh_session</ref></type>
          <declname>session</declname>
        </param>
        <param>
          <type>const char *</type>
          <declname>user</declname>
        </param>
        <param>
          <type>const char *</type>
          <declname>submethods</declname>
        </param>
        <briefdescription>
<para>Try to authenticate through the &quot;keyboard-interactive&quot; method. </para>
        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername direction="in">session</parametername>
</parameternamelist>
<parameterdescription>
<para>The ssh session to use.</para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">user</parametername>
</parameternamelist>
<parameterdescription>
<para>The username to authenticate. You can specify NULL if ssh_option_set_username() has been used. You cannot try two different logins in a row.</para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">submethods</parametername>
</parameternamelist>
<parameterdescription>
<para>Undocumented. Set it to NULL.</para>
</parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>SSH_AUTH_ERROR: A serious error happened<linebreak/>
 SSH_AUTH_DENIED: Authentication failed : use another method<linebreak/>
 SSH_AUTH_PARTIAL: You&apos;ve been partially authenticated, you still have to use another method<linebreak/>
 SSH_AUTH_SUCCESS: Authentication success<linebreak/>
 SSH_AUTH_INFO: The server asked some questions. Use <ref refid="group__libssh__auth_1gacb996ff4979670db009a71a90172ece9" kindref="member">ssh_userauth_kbdint_getnprompts()</ref> and such.<linebreak/>
 SSH_AUTH_AGAIN: In nonblocking mode, you&apos;ve got to call this again later.</para>
</simplesect>
<simplesect kind="see"><para><ref refid="group__libssh__auth_1gacb996ff4979670db009a71a90172ece9" kindref="member">ssh_userauth_kbdint_getnprompts()</ref> </para>
</simplesect>
<simplesect kind="see"><para><ref refid="group__libssh__auth_1gaf920b6f8ed1e3c53cc2a683230098657" kindref="member">ssh_userauth_kbdint_getname()</ref> </para>
</simplesect>
<simplesect kind="see"><para><ref refid="group__libssh__auth_1gaa757fbdbd4f95261bbbbc12b1ec33078" kindref="member">ssh_userauth_kbdint_getinstruction()</ref> </para>
</simplesect>
<simplesect kind="see"><para><ref refid="group__libssh__auth_1ga4e7466c30852a3339003af7046fab396" kindref="member">ssh_userauth_kbdint_getprompt()</ref> </para>
</simplesect>
<simplesect kind="see"><para><ref refid="group__libssh__auth_1ga75e44b1f27059a00080f80fac0107a20" kindref="member">ssh_userauth_kbdint_setanswer()</ref> </para>
</simplesect>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="libssh-mirror/src/auth.c" line="1664" column="5" bodyfile="libssh-mirror/src/auth.c" bodystart="1664" bodyend="1694"/>
        <references refid="structssh__session__struct_1a9cba44c19f35693037bc9bb1e0651d17" compoundref="session_8h" startline="180">ssh_session_struct::kbdint</references>
        <references refid="structssh__session__struct_1a5552665043089000065df39c5a5a7094" compoundref="session_8h" startline="146">ssh_session_struct::pending_call_state</references>
        <references refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" compoundref="pkd__daemon_8c" startline="62">rc</references>
        <references refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" compoundref="torture__session__keys_8c" startline="61">session</references>
        <references refid="libssh_8h_1a5b35a5038ad8eac4a4e4c00c6239e6e2a33d82f552d20734c17e770af637e3e17" compoundref="libssh_8h" startline="167">SSH_AUTH_ERROR</references>
        <references refid="libssh_8h_1a036b2b00fb04337a4d06d719d1b62be1a86ff0b2e8da6ad8628efc556b6ce1887" compoundref="libssh_8h" startline="286">SSH_FATAL</references>
        <references refid="session_8h_1abb7a4342b889601983497b3f094957e1afa2439f8a91fc9c57f773b3264a498fc" compoundref="session_8h" startline="67">SSH_PENDING_CALL_AUTH_KBDINT_INIT</references>
        <references refid="session_8h_1abb7a4342b889601983497b3f094957e1a964524d093fc2ba649020c4ce5460b94" compoundref="session_8h" startline="68">SSH_PENDING_CALL_AUTH_KBDINT_SEND</references>
        <references refid="session_8h_1abb7a4342b889601983497b3f094957e1a33be3f7cd03fe7fced1eeacd369cad94" compoundref="session_8h" startline="60">SSH_PENDING_CALL_NONE</references>
        <references refid="priv_8h_1a55177b3e8db90ca9adb435c44281963c" compoundref="priv_8h" startline="258">ssh_set_error</references>
        <references refid="group__libssh__auth_1gac689d3761c0dc4ebee9971ecc482d9a4" compoundref="auth_8c" startline="1424" endline="1480">ssh_userauth_kbdint_init</references>
        <references refid="group__libssh__auth_1gaaa68e6aec2da509b246b7cba071408d3" compoundref="auth_8c" startline="1493" endline="1542">ssh_userauth_kbdint_send</references>
        <references refid="ssh__client_8c_1a14871705f45ccdc5bb9f4549efd8e119" compoundref="ssh__client_8c" startline="48">user</references>
        <referencedby refid="torture_8c_1a0a74e450caa8d70e60a4c6304df20dcf" compoundref="torture_8c" startline="79" endline="115">_torture_auth_kbdint</referencedby>
        <referencedby refid="tests_2authentication_8c_1a3207e3c92d80db9b5bcd4b7114eab195" compoundref="tests_2authentication_8c" startline="15" endline="47">auth_kbdint</referencedby>
        <referencedby refid="examples_2authentication_8c_1a358ed06284cff4e8ee596d31238e5731" compoundref="examples_2authentication_8c" startline="27" endline="101">authenticate_kbdint</referencedby>
        <referencedby refid="torture__auth_8c_1a4b7c297eeeae3bb821a5480574439b78" compoundref="torture__auth_8c" startline="307" endline="340">torture_auth_kbdint</referencedby>
        <referencedby refid="torture__auth_8c_1a8c1979b9feebe5c34354456ff4260ee4" compoundref="torture__auth_8c" startline="342" endline="384">torture_auth_kbdint_nonblocking</referencedby>
        <referencedby refid="torture__server__auth__kbdint_8c_1a1ae155752732ad519ce76bedf8b2a5b7" compoundref="torture__server__auth__kbdint_8c" startline="686" endline="746">torture_server_auth_kbdint</referencedby>
        <referencedby refid="classssh_1_1Session_1a0ea9676a938f2410177b2bfb3e8bf427" compoundref="libsshpp_8hpp" startline="214" endline="218">ssh::Session::userauthKbdint</referencedby>
      </memberdef>
      <memberdef kind="function" id="group__libssh__auth_1gacb996ff4979670db009a71a90172ece9" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>int ssh_userauth_kbdint_getnprompts</definition>
        <argsstring>(ssh_session session)</argsstring>
        <name>ssh_userauth_kbdint_getnprompts</name>
        <param>
          <type><ref refid="libssh_8h_1a02d3754de040612632cdd499c20f92f6" kindref="member">ssh_session</ref></type>
          <declname>session</declname>
        </param>
        <briefdescription>
<para>Get the number of prompts (questions) the server has given. </para>
        </briefdescription>
        <detaileddescription>
<para>Once you have called <ref refid="group__libssh__auth_1ga6b3b1c2a045286d9476b0252791a07d2" kindref="member">ssh_userauth_kbdint()</ref> and received SSH_AUTH_INFO return code, this function can be used to retrieve information about the keyboard interactive authentication questions sent by the remote host.</para>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername direction="in">session</parametername>
</parameternamelist>
<parameterdescription>
<para>The ssh session to use.</para>
</parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>The number of prompts. </para>
</simplesect>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="libssh-mirror/src/auth.c" line="1707" column="5" bodyfile="libssh-mirror/src/auth.c" bodystart="1707" bodyend="1716"/>
        <references refid="structssh__session__struct_1a9cba44c19f35693037bc9bb1e0651d17" compoundref="session_8h" startline="180">ssh_session_struct::kbdint</references>
        <references refid="structssh__kbdint__struct_1a316bac1f096accc10024c7e787e0e3d6" compoundref="auth_8h" startline="38">ssh_kbdint_struct::nprompts</references>
        <references refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" compoundref="torture__session__keys_8c" startline="61">session</references>
        <references refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" compoundref="libssh_8h" startline="330">SSH_ERROR</references>
        <references refid="priv_8h_1a351ea86857d33b3ba80b396e05c4517c" compoundref="priv_8h" startline="269">ssh_set_error_invalid</references>
        <referencedby refid="torture_8c_1a0a74e450caa8d70e60a4c6304df20dcf" compoundref="torture_8c" startline="79" endline="115">_torture_auth_kbdint</referencedby>
        <referencedby refid="tests_2authentication_8c_1a3207e3c92d80db9b5bcd4b7114eab195" compoundref="tests_2authentication_8c" startline="15" endline="47">auth_kbdint</referencedby>
        <referencedby refid="examples_2authentication_8c_1a358ed06284cff4e8ee596d31238e5731" compoundref="examples_2authentication_8c" startline="27" endline="101">authenticate_kbdint</referencedby>
        <referencedby refid="torture__auth_8c_1a4b7c297eeeae3bb821a5480574439b78" compoundref="torture__auth_8c" startline="307" endline="340">torture_auth_kbdint</referencedby>
        <referencedby refid="torture__auth_8c_1a8c1979b9feebe5c34354456ff4260ee4" compoundref="torture__auth_8c" startline="342" endline="384">torture_auth_kbdint_nonblocking</referencedby>
        <referencedby refid="torture__server__auth__kbdint_8c_1a1ae155752732ad519ce76bedf8b2a5b7" compoundref="torture__server__auth__kbdint_8c" startline="686" endline="746">torture_server_auth_kbdint</referencedby>
        <referencedby refid="classssh_1_1Session_1a0bf86917b042bd96896768fe089c3f39" compoundref="libsshpp_8hpp" startline="224" endline="226">ssh::Session::userauthKbdintGetNPrompts</referencedby>
      </memberdef>
      <memberdef kind="function" id="group__libssh__auth_1gaf920b6f8ed1e3c53cc2a683230098657" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>const char *</type>
        <definition>const char* ssh_userauth_kbdint_getname</definition>
        <argsstring>(ssh_session session)</argsstring>
        <name>ssh_userauth_kbdint_getname</name>
        <param>
          <type><ref refid="libssh_8h_1a02d3754de040612632cdd499c20f92f6" kindref="member">ssh_session</ref></type>
          <declname>session</declname>
        </param>
        <briefdescription>
<para>Get the &quot;name&quot; of the message block. </para>
        </briefdescription>
        <detaileddescription>
<para>Once you have called <ref refid="group__libssh__auth_1ga6b3b1c2a045286d9476b0252791a07d2" kindref="member">ssh_userauth_kbdint()</ref> and received SSH_AUTH_INFO return code, this function can be used to retrieve information about the keyboard interactive authentication questions sent by the remote host.</para>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername direction="in">session</parametername>
</parameternamelist>
<parameterdescription>
<para>The ssh session to use.</para>
</parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>The name of the message block. Do not free it. </para>
</simplesect>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="libssh-mirror/src/auth.c" line="1729" column="12" bodyfile="libssh-mirror/src/auth.c" bodystart="1729" bodyend="1738"/>
        <references refid="structssh__session__struct_1a9cba44c19f35693037bc9bb1e0651d17" compoundref="session_8h" startline="180">ssh_session_struct::kbdint</references>
        <references refid="structssh__kbdint__struct_1a8c7f5532d4b52ab7f81bacdf8394c51c" compoundref="auth_8h" startline="40">ssh_kbdint_struct::name</references>
        <references refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" compoundref="torture__session__keys_8c" startline="61">session</references>
        <references refid="priv_8h_1a351ea86857d33b3ba80b396e05c4517c" compoundref="priv_8h" startline="269">ssh_set_error_invalid</references>
        <referencedby refid="tests_2authentication_8c_1a3207e3c92d80db9b5bcd4b7114eab195" compoundref="tests_2authentication_8c" startline="15" endline="47">auth_kbdint</referencedby>
        <referencedby refid="examples_2authentication_8c_1a358ed06284cff4e8ee596d31238e5731" compoundref="examples_2authentication_8c" startline="27" endline="101">authenticate_kbdint</referencedby>
      </memberdef>
      <memberdef kind="function" id="group__libssh__auth_1gaa757fbdbd4f95261bbbbc12b1ec33078" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>const char *</type>
        <definition>const char* ssh_userauth_kbdint_getinstruction</definition>
        <argsstring>(ssh_session session)</argsstring>
        <name>ssh_userauth_kbdint_getinstruction</name>
        <param>
          <type><ref refid="libssh_8h_1a02d3754de040612632cdd499c20f92f6" kindref="member">ssh_session</ref></type>
          <declname>session</declname>
        </param>
        <briefdescription>
<para>Get the &quot;instruction&quot; of the message block. </para>
        </briefdescription>
        <detaileddescription>
<para>Once you have called <ref refid="group__libssh__auth_1ga6b3b1c2a045286d9476b0252791a07d2" kindref="member">ssh_userauth_kbdint()</ref> and received SSH_AUTH_INFO return code, this function can be used to retrieve information about the keyboard interactive authentication questions sent by the remote host.</para>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername direction="in">session</parametername>
</parameternamelist>
<parameterdescription>
<para>The ssh session to use.</para>
</parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>The instruction of the message block. </para>
</simplesect>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="libssh-mirror/src/auth.c" line="1752" column="12" bodyfile="libssh-mirror/src/auth.c" bodystart="1752" bodyend="1760"/>
        <references refid="structssh__kbdint__struct_1a22c149b9323116ac704fabc4c6a5caa6" compoundref="auth_8h" startline="41">ssh_kbdint_struct::instruction</references>
        <references refid="structssh__session__struct_1a9cba44c19f35693037bc9bb1e0651d17" compoundref="session_8h" startline="180">ssh_session_struct::kbdint</references>
        <references refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" compoundref="torture__session__keys_8c" startline="61">session</references>
        <references refid="priv_8h_1a351ea86857d33b3ba80b396e05c4517c" compoundref="priv_8h" startline="269">ssh_set_error_invalid</references>
        <referencedby refid="tests_2authentication_8c_1a3207e3c92d80db9b5bcd4b7114eab195" compoundref="tests_2authentication_8c" startline="15" endline="47">auth_kbdint</referencedby>
        <referencedby refid="examples_2authentication_8c_1a358ed06284cff4e8ee596d31238e5731" compoundref="examples_2authentication_8c" startline="27" endline="101">authenticate_kbdint</referencedby>
      </memberdef>
      <memberdef kind="function" id="group__libssh__auth_1ga4e7466c30852a3339003af7046fab396" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>const char *</type>
        <definition>const char* ssh_userauth_kbdint_getprompt</definition>
        <argsstring>(ssh_session session, unsigned int i, char *echo)</argsstring>
        <name>ssh_userauth_kbdint_getprompt</name>
        <param>
          <type><ref refid="libssh_8h_1a02d3754de040612632cdd499c20f92f6" kindref="member">ssh_session</ref></type>
          <declname>session</declname>
        </param>
        <param>
          <type>unsigned int</type>
          <declname>i</declname>
        </param>
        <param>
          <type>char *</type>
          <declname>echo</declname>
        </param>
        <briefdescription>
<para>Get a prompt from a message block. </para>
        </briefdescription>
        <detaileddescription>
<para>Once you have called <ref refid="group__libssh__auth_1ga6b3b1c2a045286d9476b0252791a07d2" kindref="member">ssh_userauth_kbdint()</ref> and received SSH_AUTH_INFO return code, this function can be used to retrieve information about the keyboard interactive authentication questions sent by the remote host.</para>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername direction="in">session</parametername>
</parameternamelist>
<parameterdescription>
<para>The ssh session to use.</para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">i</parametername>
</parameternamelist>
<parameterdescription>
<para>The index number of the i&apos;th prompt.</para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="out">echo</parametername>
</parameternamelist>
<parameterdescription>
<para>This is an optional variable. You can obtain a boolean if the user input should be echoed or hidden. For passwords it is usually hidden.</para>
</parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>A pointer to the prompt. Do not free it.</para>
</simplesect>
<programlisting><codeline><highlight class="normal">const<sp/>char<sp/>prompt;</highlight></codeline>
<codeline><highlight class="normal">char<sp/>echo;</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">prompt<sp/>=<sp/>ssh_userauth_kbdint_getprompt(session,<sp/>0,<sp/>&amp;echo);</highlight></codeline>
<codeline><highlight class="normal">if<sp/>(echo)<sp/>...</highlight></codeline>
</programlisting> </para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="libssh-mirror/src/auth.c" line="1787" column="12" bodyfile="libssh-mirror/src/auth.c" bodystart="1787" bodyend="1805"/>
        <references refid="samplesshd-kbdint_8c_1aed50069385b2de326e5bbed79b19affd" compoundref="samplesshd-kbdint_8c" startline="189">echo</references>
        <references refid="structssh__kbdint__struct_1a53c38b9a2468c1d79954408e9b7bc7aa" compoundref="auth_8h" startline="43">ssh_kbdint_struct::echo</references>
        <references refid="structssh__session__struct_1a9cba44c19f35693037bc9bb1e0651d17" compoundref="session_8h" startline="180">ssh_session_struct::kbdint</references>
        <references refid="structssh__kbdint__struct_1a316bac1f096accc10024c7e787e0e3d6" compoundref="auth_8h" startline="38">ssh_kbdint_struct::nprompts</references>
        <references refid="structssh__kbdint__struct_1a3b528280ac48b0713c1f963ee9f3574b" compoundref="auth_8h" startline="42">ssh_kbdint_struct::prompts</references>
        <references refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" compoundref="torture__session__keys_8c" startline="61">session</references>
        <references refid="priv_8h_1a351ea86857d33b3ba80b396e05c4517c" compoundref="priv_8h" startline="269">ssh_set_error_invalid</references>
        <referencedby refid="torture_8c_1a0a74e450caa8d70e60a4c6304df20dcf" compoundref="torture_8c" startline="79" endline="115">_torture_auth_kbdint</referencedby>
        <referencedby refid="tests_2authentication_8c_1a3207e3c92d80db9b5bcd4b7114eab195" compoundref="tests_2authentication_8c" startline="15" endline="47">auth_kbdint</referencedby>
        <referencedby refid="examples_2authentication_8c_1a358ed06284cff4e8ee596d31238e5731" compoundref="examples_2authentication_8c" startline="27" endline="101">authenticate_kbdint</referencedby>
      </memberdef>
      <memberdef kind="function" id="group__libssh__auth_1ga75e44b1f27059a00080f80fac0107a20" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>int ssh_userauth_kbdint_setanswer</definition>
        <argsstring>(ssh_session session, unsigned int i, const char *answer)</argsstring>
        <name>ssh_userauth_kbdint_setanswer</name>
        <param>
          <type><ref refid="libssh_8h_1a02d3754de040612632cdd499c20f92f6" kindref="member">ssh_session</ref></type>
          <declname>session</declname>
        </param>
        <param>
          <type>unsigned int</type>
          <declname>i</declname>
        </param>
        <param>
          <type>const char *</type>
          <declname>answer</declname>
        </param>
        <briefdescription>
<para>Set the answer for a question from a message block. </para>
        </briefdescription>
        <detaileddescription>
<para>If you have called <ref refid="group__libssh__auth_1ga6b3b1c2a045286d9476b0252791a07d2" kindref="member">ssh_userauth_kbdint()</ref> and got SSH_AUTH_INFO, this function returns the questions from the server.</para>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername direction="in">session</parametername>
</parameternamelist>
<parameterdescription>
<para>The ssh session to use.</para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">i</parametername>
</parameternamelist>
<parameterdescription>
<para>index The number of the ith prompt.</para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">answer</parametername>
</parameternamelist>
<parameterdescription>
<para>The answer to give to the server. The answer MUST be encoded UTF-8. It is up to the server how to interpret the value and validate it. However, if you read the answer in some other encoding, you MUST convert it to UTF-8.</para>
</parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>0 on success, &lt; 0 on error. </para>
</simplesect>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="libssh-mirror/src/auth.c" line="1862" column="5" bodyfile="libssh-mirror/src/auth.c" bodystart="1862" bodyend="1894"/>
        <references refid="structssh__kbdint__struct_1aae334dcc6b8fe544b25f4377360db554" compoundref="auth_8h" startline="44">ssh_kbdint_struct::answers</references>
        <references refid="group__libssh__misc_1ga51869b401cb0f3e711527bc9a730fbff" compoundref="misc_8c" startline="1461" endline="1474">explicit_bzero</references>
        <references refid="structssh__session__struct_1a9cba44c19f35693037bc9bb1e0651d17" compoundref="session_8h" startline="180">ssh_session_struct::kbdint</references>
        <references refid="structssh__kbdint__struct_1a316bac1f096accc10024c7e787e0e3d6" compoundref="auth_8h" startline="38">ssh_kbdint_struct::nprompts</references>
        <references refid="sshd__direct-tcpip_8c_1aed3129b7674034c979192bcca6b0ad8c" compoundref="sshd__direct-tcpip_8c" startline="36">SAFE_FREE</references>
        <references refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" compoundref="torture__session__keys_8c" startline="61">session</references>
        <references refid="priv_8h_1a351ea86857d33b3ba80b396e05c4517c" compoundref="priv_8h" startline="269">ssh_set_error_invalid</references>
        <references refid="priv_8h_1ae280c413c792e04237f000841ac8ce44" compoundref="priv_8h" startline="265">ssh_set_error_oom</references>
        <referencedby refid="torture_8c_1a0a74e450caa8d70e60a4c6304df20dcf" compoundref="torture_8c" startline="79" endline="115">_torture_auth_kbdint</referencedby>
        <referencedby refid="tests_2authentication_8c_1a3207e3c92d80db9b5bcd4b7114eab195" compoundref="tests_2authentication_8c" startline="15" endline="47">auth_kbdint</referencedby>
        <referencedby refid="examples_2authentication_8c_1a358ed06284cff4e8ee596d31238e5731" compoundref="examples_2authentication_8c" startline="27" endline="101">authenticate_kbdint</referencedby>
        <referencedby refid="torture__auth_8c_1a4b7c297eeeae3bb821a5480574439b78" compoundref="torture__auth_8c" startline="307" endline="340">torture_auth_kbdint</referencedby>
        <referencedby refid="torture__auth_8c_1a8c1979b9feebe5c34354456ff4260ee4" compoundref="torture__auth_8c" startline="342" endline="384">torture_auth_kbdint_nonblocking</referencedby>
        <referencedby refid="torture__server__auth__kbdint_8c_1a1ae155752732ad519ce76bedf8b2a5b7" compoundref="torture__server__auth__kbdint_8c" startline="686" endline="746">torture_server_auth_kbdint</referencedby>
        <referencedby refid="classssh_1_1Session_1a71ba225d12071f5290b49f8ac24c0f2d" compoundref="libsshpp_8hpp" startline="244" endline="249">ssh::Session::userauthKbdintSetAnswer</referencedby>
      </memberdef>
      <memberdef kind="function" id="group__libssh__auth_1ga2758b0e86a848fe0d1d3d263d2a34d28" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>int ssh_userauth_gssapi</definition>
        <argsstring>(ssh_session session)</argsstring>
        <name>ssh_userauth_gssapi</name>
        <param>
          <type><ref refid="libssh_8h_1a02d3754de040612632cdd499c20f92f6" kindref="member">ssh_session</ref></type>
          <declname>session</declname>
        </param>
        <briefdescription>
<para>Try to authenticate through the &quot;gssapi-with-mic&quot; method. </para>
        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername direction="in">session</parametername>
</parameternamelist>
<parameterdescription>
<para>The ssh session to use.</para>
</parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>SSH_AUTH_ERROR: A serious error happened<linebreak/>
 SSH_AUTH_DENIED: Authentication failed : use another method<linebreak/>
 SSH_AUTH_PARTIAL: You&apos;ve been partially authenticated, you still have to use another method<linebreak/>
 SSH_AUTH_SUCCESS: Authentication success<linebreak/>
 SSH_AUTH_AGAIN: In nonblocking mode, you&apos;ve got to call this again later. </para>
</simplesect>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="libssh-mirror/src/auth.c" line="1909" column="5" bodyfile="libssh-mirror/src/auth.c" bodystart="1909" bodyend="1953"/>
        <referencedby refid="examples_2authentication_8c_1a442e0c31c0c57f60ec1f5eaaceebf436" compoundref="examples_2authentication_8c" startline="141" endline="241">authenticate_console</referencedby>
        <referencedby refid="proxy_8c_1a3c04138a5bfe5d72780bb7e82a18e627" compoundref="proxy_8c" startline="215" endline="346">main</referencedby>
      </memberdef>
      </sectiondef>
    <briefdescription>
    </briefdescription>
    <detaileddescription>
    </detaileddescription>
    <programlisting>
<codeline lineno="1"><highlight class="comment">/*</highlight></codeline>
<codeline lineno="2"><highlight class="comment"><sp/>*<sp/>auth.c<sp/>-<sp/>Authentication<sp/>with<sp/>SSH<sp/>protocols</highlight></codeline>
<codeline lineno="3"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="4"><highlight class="comment"><sp/>*<sp/>This<sp/>file<sp/>is<sp/>part<sp/>of<sp/>the<sp/>SSH<sp/>Library</highlight></codeline>
<codeline lineno="5"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="6"><highlight class="comment"><sp/>*<sp/>Copyright<sp/>(c)<sp/>2003-2013<sp/>by<sp/>Aris<sp/>Adamantiadis<sp/>&lt;aris@0xbadc0de.be&gt;</highlight></codeline>
<codeline lineno="7"><highlight class="comment"><sp/>*<sp/>Copyright<sp/>(c)<sp/>2008-2013<sp/>Andreas<sp/>Schneider<sp/>&lt;asn@cryptomilk.org&gt;</highlight></codeline>
<codeline lineno="8"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="9"><highlight class="comment"><sp/>*<sp/>The<sp/>SSH<sp/>Library<sp/>is<sp/>free<sp/>software;<sp/>you<sp/>can<sp/>redistribute<sp/>it<sp/>and/or<sp/>modify</highlight></codeline>
<codeline lineno="10"><highlight class="comment"><sp/>*<sp/>it<sp/>under<sp/>the<sp/>terms<sp/>of<sp/>the<sp/>GNU<sp/>Lesser<sp/>General<sp/>Public<sp/>License<sp/>as<sp/>published<sp/>by</highlight></codeline>
<codeline lineno="11"><highlight class="comment"><sp/>*<sp/>the<sp/>Free<sp/>Software<sp/>Foundation;<sp/>either<sp/>version<sp/>2.1<sp/>of<sp/>the<sp/>License,<sp/>or<sp/>(at<sp/>your</highlight></codeline>
<codeline lineno="12"><highlight class="comment"><sp/>*<sp/>option)<sp/>any<sp/>later<sp/>version.</highlight></codeline>
<codeline lineno="13"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="14"><highlight class="comment"><sp/>*<sp/>The<sp/>SSH<sp/>Library<sp/>is<sp/>distributed<sp/>in<sp/>the<sp/>hope<sp/>that<sp/>it<sp/>will<sp/>be<sp/>useful,<sp/>but</highlight></codeline>
<codeline lineno="15"><highlight class="comment"><sp/>*<sp/>WITHOUT<sp/>ANY<sp/>WARRANTY;<sp/>without<sp/>even<sp/>the<sp/>implied<sp/>warranty<sp/>of<sp/>MERCHANTABILITY</highlight></codeline>
<codeline lineno="16"><highlight class="comment"><sp/>*<sp/>or<sp/>FITNESS<sp/>FOR<sp/>A<sp/>PARTICULAR<sp/>PURPOSE.<sp/><sp/>See<sp/>the<sp/>GNU<sp/>Lesser<sp/>General<sp/>Public</highlight></codeline>
<codeline lineno="17"><highlight class="comment"><sp/>*<sp/>License<sp/>for<sp/>more<sp/>details.</highlight></codeline>
<codeline lineno="18"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="19"><highlight class="comment"><sp/>*<sp/>You<sp/>should<sp/>have<sp/>received<sp/>a<sp/>copy<sp/>of<sp/>the<sp/>GNU<sp/>Lesser<sp/>General<sp/>Public<sp/>License</highlight></codeline>
<codeline lineno="20"><highlight class="comment"><sp/>*<sp/>along<sp/>with<sp/>the<sp/>SSH<sp/>Library;<sp/>see<sp/>the<sp/>file<sp/>COPYING.<sp/><sp/>If<sp/>not,<sp/>write<sp/>to</highlight></codeline>
<codeline lineno="21"><highlight class="comment"><sp/>*<sp/>the<sp/>Free<sp/>Software<sp/>Foundation,<sp/>Inc.,<sp/>59<sp/>Temple<sp/>Place<sp/>-<sp/>Suite<sp/>330,<sp/>Boston,</highlight></codeline>
<codeline lineno="22"><highlight class="comment"><sp/>*<sp/>MA<sp/>02111-1307,<sp/>USA.</highlight></codeline>
<codeline lineno="23"><highlight class="comment"><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="24"><highlight class="normal"></highlight></codeline>
<codeline lineno="25"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="config_8h" kindref="compound">config.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="26"><highlight class="normal"></highlight></codeline>
<codeline lineno="27"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;stdio.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="28"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;<ref refid="string_8h" kindref="compound">string.h</ref>&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="29"><highlight class="normal"></highlight></codeline>
<codeline lineno="30"><highlight class="normal"></highlight><highlight class="preprocessor">#ifndef<sp/>_WIN32</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="31"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;netinet/in.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="32"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;arpa/inet.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="33"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="34"><highlight class="normal"></highlight></codeline>
<codeline lineno="35"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="priv_8h" kindref="compound">libssh/priv.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="36"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="crypto_8h" kindref="compound">libssh/crypto.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="37"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="ssh2_8h" kindref="compound">libssh/ssh2.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="38"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="buffer_8h" kindref="compound">libssh/buffer.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="39"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="agent_8h" kindref="compound">libssh/agent.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="40"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="misc_8h" kindref="compound">libssh/misc.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="41"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="packet_8h" kindref="compound">libssh/packet.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="42"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="session_8h" kindref="compound">libssh/session.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="43"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="keys_8h" kindref="compound">libssh/keys.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="44"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="auth_8h" kindref="compound">libssh/auth.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="45"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="pki_8h" kindref="compound">libssh/pki.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="46"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="gssapi_8h" kindref="compound">libssh/gssapi.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="47"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="legacy_8h" kindref="compound">libssh/legacy.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="48"><highlight class="normal"></highlight></codeline>
<codeline lineno="69" refid="group__libssh__auth_1ga812fb86c3dd4a6245bc7d01beaa9cfe8" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="group__libssh__auth_1ga812fb86c3dd4a6245bc7d01beaa9cfe8" kindref="member">ssh_userauth_request_service</ref>(<ref refid="structssh__session__struct" kindref="compound">ssh_session</ref><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>)<sp/>{</highlight></codeline>
<codeline lineno="70"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref>;</highlight></codeline>
<codeline lineno="71"><highlight class="normal"></highlight></codeline>
<codeline lineno="72"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="libssh_8h_1abf8db7680a5214da800ad02d8599f073" kindref="member">ssh_service_request</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>,<sp/></highlight><highlight class="stringliteral">&quot;ssh-userauth&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="73"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>((<ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>!=<sp/><ref refid="libssh_8h_1ac1ee1d1e917456d4760a94a18015377d" kindref="member">SSH_OK</ref>)<sp/>&amp;&amp;<sp/>(<ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>!=<sp/><ref refid="libssh_8h_1a9c57e4f6482106336045a4d25a55f28e" kindref="member">SSH_AGAIN</ref>))<sp/>{</highlight></codeline>
<codeline lineno="74"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="priv_8h_1aa21fd8a7a609329603b7b16da7939fca" kindref="member">SSH_LOG</ref>(<ref refid="libssh_8h_1ab3c2f1accd58d32987f02d8aebdc1fc4" kindref="member">SSH_LOG_WARN</ref>,</highlight></codeline>
<codeline lineno="75"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Failed<sp/>to<sp/>request<sp/>\&quot;ssh-userauth\&quot;<sp/>service&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="76"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="77"><highlight class="normal"></highlight></codeline>
<codeline lineno="78"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref>;</highlight></codeline>
<codeline lineno="79"><highlight class="normal">}</highlight></codeline>
<codeline lineno="80"><highlight class="normal"></highlight></codeline>
<codeline lineno="81" refid="group__libssh__auth_1ga4eba018b5d45cc32999cb76b06440c55" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="group__libssh__auth_1ga4eba018b5d45cc32999cb76b06440c55" kindref="member">ssh_auth_response_termination</ref>(</highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>*<ref refid="ssh__client_8c_1a14871705f45ccdc5bb9f4549efd8e119" kindref="member">user</ref>)<sp/>{</highlight></codeline>
<codeline lineno="82"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="structssh__session__struct" kindref="compound">ssh_session</ref><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref><sp/>=<sp/>(<ref refid="libssh_8h_1a02d3754de040612632cdd499c20f92f6" kindref="member">ssh_session</ref>)<ref refid="ssh__client_8c_1a14871705f45ccdc5bb9f4549efd8e119" kindref="member">user</ref>;</highlight></codeline>
<codeline lineno="83"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">switch</highlight><highlight class="normal"><sp/>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a3d57e01582c0c9099f7f319513321fe8" kindref="member">auth</ref>.<ref refid="structssh__session__struct_1af0805877d21d43e81423ead52345c64b" kindref="member">state</ref>)<sp/>{</highlight></codeline>
<codeline lineno="84"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="auth_8h_1a0d3114986a741a14dc3ac03f7d8eafefa3ec3c08deba889e791cdca82edeb2ce6" kindref="member">SSH_AUTH_STATE_NONE</ref>:</highlight></codeline>
<codeline lineno="85"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="auth_8h_1a0d3114986a741a14dc3ac03f7d8eafefa6d785d00012593230e88f00debb19179" kindref="member">SSH_AUTH_STATE_KBDINT_SENT</ref>:</highlight></codeline>
<codeline lineno="86"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="auth_8h_1a0d3114986a741a14dc3ac03f7d8eafefa12492663176bc8d81ec1f5f832ee7250" kindref="member">SSH_AUTH_STATE_GSSAPI_REQUEST_SENT</ref>:</highlight></codeline>
<codeline lineno="87"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="auth_8h_1a0d3114986a741a14dc3ac03f7d8eafefa91300865963f77efc3044542fbd6ce36" kindref="member">SSH_AUTH_STATE_GSSAPI_TOKEN</ref>:</highlight></codeline>
<codeline lineno="88"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="auth_8h_1a0d3114986a741a14dc3ac03f7d8eafefab046bd91ca00b04b47ce0c7b670423ba" kindref="member">SSH_AUTH_STATE_GSSAPI_MIC_SENT</ref>:</highlight></codeline>
<codeline lineno="89"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="auth_8h_1a0d3114986a741a14dc3ac03f7d8eafefa867ade5fd7a5853b32a1935a47bd9776" kindref="member">SSH_AUTH_STATE_PUBKEY_AUTH_SENT</ref>:</highlight></codeline>
<codeline lineno="90"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="auth_8h_1a0d3114986a741a14dc3ac03f7d8eafefaeb9522ba4289c7bf7575802e7182cc3d" kindref="member">SSH_AUTH_STATE_PUBKEY_OFFER_SENT</ref>:</highlight></codeline>
<codeline lineno="91"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="auth_8h_1a0d3114986a741a14dc3ac03f7d8eafefaedccdf68a9f5857c7f31ac557b2a57b6" kindref="member">SSH_AUTH_STATE_PASSWORD_AUTH_SENT</ref>:</highlight></codeline>
<codeline lineno="92"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="auth_8h_1a0d3114986a741a14dc3ac03f7d8eafefa1aebfec92e739cd95a40eafe1b468444" kindref="member">SSH_AUTH_STATE_AUTH_NONE_SENT</ref>:</highlight></codeline>
<codeline lineno="93"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>0;</highlight></codeline>
<codeline lineno="94"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">default</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="95"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>1;</highlight></codeline>
<codeline lineno="96"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="97"><highlight class="normal">}</highlight></codeline>
<codeline lineno="98"><highlight class="normal"></highlight></codeline>
<codeline lineno="99" refid="group__libssh__auth_1gafd0aab143e9cce0a3781144fe74dd7ab" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*<ref refid="group__libssh__auth_1gafd0aab143e9cce0a3781144fe74dd7ab" kindref="member">ssh_auth_get_current_method</ref>(<ref refid="structssh__session__struct" kindref="compound">ssh_session</ref><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>)</highlight></codeline>
<codeline lineno="100"><highlight class="normal">{</highlight></codeline>
<codeline lineno="101"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*method<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;unknown&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="102"><highlight class="normal"></highlight></codeline>
<codeline lineno="103"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">switch</highlight><highlight class="normal"><sp/>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a3d57e01582c0c9099f7f319513321fe8" kindref="member">auth</ref>.<ref refid="structssh__session__struct_1aa859857ac7a99808ffc537e08087e541" kindref="member">current_method</ref>)<sp/>{</highlight></codeline>
<codeline lineno="104"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="libssh_8h_1af37d502f88abb23d55e6c35aacc6b340" kindref="member">SSH_AUTH_METHOD_NONE</ref>:</highlight></codeline>
<codeline lineno="105"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>method<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;none&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="106"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="107"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="libssh_8h_1ad10dd2f5826e2d92a30bd8af3404574d" kindref="member">SSH_AUTH_METHOD_PASSWORD</ref>:</highlight></codeline>
<codeline lineno="108"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>method<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;password&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="109"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="110"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="libssh_8h_1aff27d66c1f5ba3871e72b5a61573f44a" kindref="member">SSH_AUTH_METHOD_PUBLICKEY</ref>:</highlight></codeline>
<codeline lineno="111"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>method<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;publickey&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="112"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="113"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="libssh_8h_1a47af3117d9ab19c61afeebfbfac8cfc4" kindref="member">SSH_AUTH_METHOD_HOSTBASED</ref>:</highlight></codeline>
<codeline lineno="114"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>method<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;hostbased&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="115"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="116"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="libssh_8h_1a4c64484fdce4756309799d0e2a4e926a" kindref="member">SSH_AUTH_METHOD_INTERACTIVE</ref>:</highlight></codeline>
<codeline lineno="117"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>method<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;keyboard<sp/>interactive&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="118"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="119"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="libssh_8h_1aa17667dad32ec77112a201b1b4b858e8" kindref="member">SSH_AUTH_METHOD_GSSAPI_MIC</ref>:</highlight></codeline>
<codeline lineno="120"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>method<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;gssapi&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="121"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="122"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">default</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="123"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="124"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="125"><highlight class="normal"></highlight></codeline>
<codeline lineno="126"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>method;</highlight></codeline>
<codeline lineno="127"><highlight class="normal">}</highlight></codeline>
<codeline lineno="128"><highlight class="normal"></highlight></codeline>
<codeline lineno="142" refid="group__libssh__auth_1gabff6b3898d3bf45b62cc3ed3774eaa83" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="group__libssh__auth_1gabff6b3898d3bf45b62cc3ed3774eaa83" kindref="member">ssh_userauth_get_response</ref>(<ref refid="structssh__session__struct" kindref="compound">ssh_session</ref><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>)<sp/>{</highlight></codeline>
<codeline lineno="143"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="libssh_8h_1a5b35a5038ad8eac4a4e4c00c6239e6e2a33d82f552d20734c17e770af637e3e17" kindref="member">SSH_AUTH_ERROR</ref>;</highlight></codeline>
<codeline lineno="144"><highlight class="normal"></highlight></codeline>
<codeline lineno="145"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="group__libssh__session_1ga4b84e1ae757c0d4007a5eefdf4651694" kindref="member">ssh_handle_packets_termination</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>,<sp/><ref refid="session_8h_1a1d6b747c5003e24c3461096c76580b15" kindref="member">SSH_TIMEOUT_USER</ref>,</highlight></codeline>
<codeline lineno="146"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="group__libssh__auth_1ga4eba018b5d45cc32999cb76b06440c55" kindref="member">ssh_auth_response_termination</ref>,<sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>);</highlight></codeline>
<codeline lineno="147"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>==<sp/><ref refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" kindref="member">SSH_ERROR</ref>)<sp/>{</highlight></codeline>
<codeline lineno="148"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="libssh_8h_1a5b35a5038ad8eac4a4e4c00c6239e6e2a33d82f552d20734c17e770af637e3e17" kindref="member">SSH_AUTH_ERROR</ref>;</highlight></codeline>
<codeline lineno="149"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="150"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!<ref refid="group__libssh__auth_1ga4eba018b5d45cc32999cb76b06440c55" kindref="member">ssh_auth_response_termination</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>))<sp/>{</highlight></codeline>
<codeline lineno="151"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="libssh_8h_1a5b35a5038ad8eac4a4e4c00c6239e6e2a0f166cff4fa03faf4e4c11ad854a4996" kindref="member">SSH_AUTH_AGAIN</ref>;</highlight></codeline>
<codeline lineno="152"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="153"><highlight class="normal"></highlight></codeline>
<codeline lineno="154"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">switch</highlight><highlight class="normal">(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a3d57e01582c0c9099f7f319513321fe8" kindref="member">auth</ref>.<ref refid="structssh__session__struct_1af0805877d21d43e81423ead52345c64b" kindref="member">state</ref>)<sp/>{</highlight></codeline>
<codeline lineno="155"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="auth_8h_1a0d3114986a741a14dc3ac03f7d8eafefa331579d75bb0aa08050ca67a12861387" kindref="member">SSH_AUTH_STATE_ERROR</ref>:</highlight></codeline>
<codeline lineno="156"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="libssh_8h_1a5b35a5038ad8eac4a4e4c00c6239e6e2a33d82f552d20734c17e770af637e3e17" kindref="member">SSH_AUTH_ERROR</ref>;</highlight></codeline>
<codeline lineno="157"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="158"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="auth_8h_1a0d3114986a741a14dc3ac03f7d8eafefa2274da14b3dc9f07b5fe6493045c356c" kindref="member">SSH_AUTH_STATE_FAILED</ref>:</highlight></codeline>
<codeline lineno="159"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="libssh_8h_1a5b35a5038ad8eac4a4e4c00c6239e6e2ac3d2d6d092a7adc147b7f859a0b252d2" kindref="member">SSH_AUTH_DENIED</ref>;</highlight></codeline>
<codeline lineno="160"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="161"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="auth_8h_1a0d3114986a741a14dc3ac03f7d8eafefa97ddb5eeec18ad7d054ec5795e6e16d6" kindref="member">SSH_AUTH_STATE_INFO</ref>:</highlight></codeline>
<codeline lineno="162"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="libssh_8h_1a5b35a5038ad8eac4a4e4c00c6239e6e2a644612ea6c0e8413a3ff82547b74ce3a" kindref="member">SSH_AUTH_INFO</ref>;</highlight></codeline>
<codeline lineno="163"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="164"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="auth_8h_1a0d3114986a741a14dc3ac03f7d8eafefa36be1b8a3aec2b226f03077dc1e6f962" kindref="member">SSH_AUTH_STATE_PARTIAL</ref>:</highlight></codeline>
<codeline lineno="165"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="libssh_8h_1a5b35a5038ad8eac4a4e4c00c6239e6e2a3bb06206cff7b6f818099d6019418eea" kindref="member">SSH_AUTH_PARTIAL</ref>;</highlight></codeline>
<codeline lineno="166"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="167"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="auth_8h_1a0d3114986a741a14dc3ac03f7d8eafefa8d27800e44e1c7e3a5f30594443f78ef" kindref="member">SSH_AUTH_STATE_PK_OK</ref>:</highlight></codeline>
<codeline lineno="168"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="auth_8h_1a0d3114986a741a14dc3ac03f7d8eafefa8e24c237c09404d0c93a1d3b5f8f3945" kindref="member">SSH_AUTH_STATE_SUCCESS</ref>:</highlight></codeline>
<codeline lineno="169"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="libssh_8h_1a5b35a5038ad8eac4a4e4c00c6239e6e2ab145398ebf554c3cc5d6acfb241c5235" kindref="member">SSH_AUTH_SUCCESS</ref>;</highlight></codeline>
<codeline lineno="170"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="171"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="auth_8h_1a0d3114986a741a14dc3ac03f7d8eafefa6d785d00012593230e88f00debb19179" kindref="member">SSH_AUTH_STATE_KBDINT_SENT</ref>:</highlight></codeline>
<codeline lineno="172"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="auth_8h_1a0d3114986a741a14dc3ac03f7d8eafefa12492663176bc8d81ec1f5f832ee7250" kindref="member">SSH_AUTH_STATE_GSSAPI_REQUEST_SENT</ref>:</highlight></codeline>
<codeline lineno="173"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="auth_8h_1a0d3114986a741a14dc3ac03f7d8eafefa91300865963f77efc3044542fbd6ce36" kindref="member">SSH_AUTH_STATE_GSSAPI_TOKEN</ref>:</highlight></codeline>
<codeline lineno="174"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="auth_8h_1a0d3114986a741a14dc3ac03f7d8eafefab046bd91ca00b04b47ce0c7b670423ba" kindref="member">SSH_AUTH_STATE_GSSAPI_MIC_SENT</ref>:</highlight></codeline>
<codeline lineno="175"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="auth_8h_1a0d3114986a741a14dc3ac03f7d8eafefaeb9522ba4289c7bf7575802e7182cc3d" kindref="member">SSH_AUTH_STATE_PUBKEY_OFFER_SENT</ref>:</highlight></codeline>
<codeline lineno="176"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="auth_8h_1a0d3114986a741a14dc3ac03f7d8eafefa867ade5fd7a5853b32a1935a47bd9776" kindref="member">SSH_AUTH_STATE_PUBKEY_AUTH_SENT</ref>:</highlight></codeline>
<codeline lineno="177"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="auth_8h_1a0d3114986a741a14dc3ac03f7d8eafefaedccdf68a9f5857c7f31ac557b2a57b6" kindref="member">SSH_AUTH_STATE_PASSWORD_AUTH_SENT</ref>:</highlight></codeline>
<codeline lineno="178"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="auth_8h_1a0d3114986a741a14dc3ac03f7d8eafefa1aebfec92e739cd95a40eafe1b468444" kindref="member">SSH_AUTH_STATE_AUTH_NONE_SENT</ref>:</highlight></codeline>
<codeline lineno="179"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="auth_8h_1a0d3114986a741a14dc3ac03f7d8eafefa3ec3c08deba889e791cdca82edeb2ce6" kindref="member">SSH_AUTH_STATE_NONE</ref>:</highlight></codeline>
<codeline lineno="180"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>not<sp/>reached<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="181"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="libssh_8h_1a5b35a5038ad8eac4a4e4c00c6239e6e2a33d82f552d20734c17e770af637e3e17" kindref="member">SSH_AUTH_ERROR</ref>;</highlight></codeline>
<codeline lineno="182"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="183"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="184"><highlight class="normal"></highlight></codeline>
<codeline lineno="185"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref>;</highlight></codeline>
<codeline lineno="186"><highlight class="normal">}</highlight></codeline>
<codeline lineno="187"><highlight class="normal"></highlight></codeline>
<codeline lineno="195" refid="group__libssh__auth_1ga1fc1f11c7ba0469c866c42956450ebf7" refkind="member"><highlight class="normal"><ref refid="group__libssh__auth_1ga1fc1f11c7ba0469c866c42956450ebf7" kindref="member">SSH_PACKET_CALLBACK</ref>(ssh_packet_userauth_banner)<sp/>{</highlight></codeline>
<codeline lineno="196"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="structssh__string__struct" kindref="compound">ssh_string</ref><sp/>banner;</highlight></codeline>
<codeline lineno="197"><highlight class="normal"><sp/><sp/><sp/><sp/>(void)type;</highlight></codeline>
<codeline lineno="198"><highlight class="normal"><sp/><sp/><sp/><sp/>(void)<ref refid="ssh__client_8c_1a14871705f45ccdc5bb9f4549efd8e119" kindref="member">user</ref>;</highlight></codeline>
<codeline lineno="199"><highlight class="normal"></highlight></codeline>
<codeline lineno="200"><highlight class="normal"><sp/><sp/><sp/><sp/>banner<sp/>=<sp/><ref refid="buffer_8h_1ae9ba83ddeaf673b2d15be5312495ed7e" kindref="member">ssh_buffer_get_ssh_string</ref>(packet);</highlight></codeline>
<codeline lineno="201"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(banner<sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="202"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="priv_8h_1aa21fd8a7a609329603b7b16da7939fca" kindref="member">SSH_LOG</ref>(<ref refid="libssh_8h_1ab3c2f1accd58d32987f02d8aebdc1fc4" kindref="member">SSH_LOG_WARN</ref>,</highlight></codeline>
<codeline lineno="203"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Invalid<sp/>SSH_USERAUTH_BANNER<sp/>packet&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="204"><highlight class="normal"><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="205"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="priv_8h_1aa21fd8a7a609329603b7b16da7939fca" kindref="member">SSH_LOG</ref>(<ref refid="libssh_8h_1a5e4247396f11fdc228d356a408c81715" kindref="member">SSH_LOG_DEBUG</ref>,</highlight></codeline>
<codeline lineno="206"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Received<sp/>SSH_USERAUTH_BANNER<sp/>packet&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="207"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a556cfe2037fb907bb21d1aa6a10a8944" kindref="member">banner</ref><sp/>!=<sp/>NULL)</highlight></codeline>
<codeline lineno="208"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="libssh_8h_1a5bc8710c8633117ff449d15489fca051" kindref="member">SSH_STRING_FREE</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a556cfe2037fb907bb21d1aa6a10a8944" kindref="member">banner</ref>);</highlight></codeline>
<codeline lineno="209"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a556cfe2037fb907bb21d1aa6a10a8944" kindref="member">banner</ref><sp/>=<sp/>banner;</highlight></codeline>
<codeline lineno="210"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="211"><highlight class="normal"></highlight></codeline>
<codeline lineno="212"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="group__libssh__callbacks_1gac29df803aa1295d6a498c1b081f3b494" kindref="member">SSH_PACKET_USED</ref>;</highlight></codeline>
<codeline lineno="213"><highlight class="normal">}</highlight></codeline>
<codeline lineno="214"><highlight class="normal"></highlight></codeline>
<codeline lineno="222" refid="group__libssh__auth_1ga89e83a8f415d2d6783b25b5f96226208" refkind="member"><highlight class="normal"><ref refid="group__libssh__auth_1ga1fc1f11c7ba0469c866c42956450ebf7" kindref="member">SSH_PACKET_CALLBACK</ref>(ssh_packet_userauth_failure)<sp/>{</highlight></codeline>
<codeline lineno="223"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*current_method<sp/>=<sp/><ref refid="group__libssh__auth_1gafd0aab143e9cce0a3781144fe74dd7ab" kindref="member">ssh_auth_get_current_method</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>);</highlight></codeline>
<codeline lineno="224"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*auth_methods<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="225"><highlight class="normal"><sp/><sp/><sp/><sp/>uint8_t<sp/>partial<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="226"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref>;</highlight></codeline>
<codeline lineno="227"><highlight class="normal"><sp/><sp/><sp/><sp/>(void)<sp/>type;</highlight></codeline>
<codeline lineno="228"><highlight class="normal"><sp/><sp/><sp/><sp/>(void)<sp/><ref refid="ssh__client_8c_1a14871705f45ccdc5bb9f4549efd8e119" kindref="member">user</ref>;</highlight></codeline>
<codeline lineno="229"><highlight class="normal"></highlight></codeline>
<codeline lineno="230"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="buffer_8h_1ab51014ef9a47e7cdbd235af3e62b81ee" kindref="member">ssh_buffer_unpack</ref>(packet,<sp/></highlight><highlight class="stringliteral">&quot;sb&quot;</highlight><highlight class="normal">,<sp/>&amp;auth_methods,<sp/>&amp;partial);</highlight></codeline>
<codeline lineno="231"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>!=<sp/><ref refid="libssh_8h_1ac1ee1d1e917456d4760a94a18015377d" kindref="member">SSH_OK</ref>)<sp/>{</highlight></codeline>
<codeline lineno="232"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="priv_8h_1a55177b3e8db90ca9adb435c44281963c" kindref="member">ssh_set_error</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>,<sp/><ref refid="libssh_8h_1a036b2b00fb04337a4d06d719d1b62be1a86ff0b2e8da6ad8628efc556b6ce1887" kindref="member">SSH_FATAL</ref>,</highlight></codeline>
<codeline lineno="233"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Invalid<sp/>SSH_MSG_USERAUTH_FAILURE<sp/>message&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="234"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a3d57e01582c0c9099f7f319513321fe8" kindref="member">auth</ref>.<ref refid="structssh__session__struct_1af0805877d21d43e81423ead52345c64b" kindref="member">state</ref><sp/>=<sp/><ref refid="auth_8h_1a0d3114986a741a14dc3ac03f7d8eafefa331579d75bb0aa08050ca67a12861387" kindref="member">SSH_AUTH_STATE_ERROR</ref>;</highlight></codeline>
<codeline lineno="235"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">goto</highlight><highlight class="normal"><sp/>end;</highlight></codeline>
<codeline lineno="236"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="237"><highlight class="normal"></highlight></codeline>
<codeline lineno="238"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(partial)<sp/>{</highlight></codeline>
<codeline lineno="239"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a3d57e01582c0c9099f7f319513321fe8" kindref="member">auth</ref>.<ref refid="structssh__session__struct_1af0805877d21d43e81423ead52345c64b" kindref="member">state</ref><sp/>=<sp/><ref refid="auth_8h_1a0d3114986a741a14dc3ac03f7d8eafefa36be1b8a3aec2b226f03077dc1e6f962" kindref="member">SSH_AUTH_STATE_PARTIAL</ref>;</highlight></codeline>
<codeline lineno="240"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="priv_8h_1aa21fd8a7a609329603b7b16da7939fca" kindref="member">SSH_LOG</ref>(<ref refid="libssh_8h_1a930fb852177813d4718c5d1911568740" kindref="member">SSH_LOG_INFO</ref>,</highlight></codeline>
<codeline lineno="241"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Partial<sp/>success<sp/>for<sp/>&apos;%s&apos;.<sp/>Authentication<sp/>that<sp/>can<sp/>continue:<sp/>%s&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="242"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>current_method,</highlight></codeline>
<codeline lineno="243"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>auth_methods);</highlight></codeline>
<codeline lineno="244"><highlight class="normal"><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="245"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a3d57e01582c0c9099f7f319513321fe8" kindref="member">auth</ref>.<ref refid="structssh__session__struct_1af0805877d21d43e81423ead52345c64b" kindref="member">state</ref><sp/>=<sp/><ref refid="auth_8h_1a0d3114986a741a14dc3ac03f7d8eafefa2274da14b3dc9f07b5fe6493045c356c" kindref="member">SSH_AUTH_STATE_FAILED</ref>;</highlight></codeline>
<codeline lineno="246"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="priv_8h_1a55177b3e8db90ca9adb435c44281963c" kindref="member">ssh_set_error</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>,<sp/><ref refid="libssh_8h_1a036b2b00fb04337a4d06d719d1b62be1ad1339fb4b92a9d25bdb99df5de5c4f88" kindref="member">SSH_REQUEST_DENIED</ref>,</highlight></codeline>
<codeline lineno="247"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Access<sp/>denied<sp/>for<sp/>&apos;%s&apos;.<sp/>Authentication<sp/>that<sp/>can<sp/>continue:<sp/>%s&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="248"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>current_method,</highlight></codeline>
<codeline lineno="249"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>auth_methods);</highlight></codeline>
<codeline lineno="250"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="priv_8h_1aa21fd8a7a609329603b7b16da7939fca" kindref="member">SSH_LOG</ref>(<ref refid="libssh_8h_1a930fb852177813d4718c5d1911568740" kindref="member">SSH_LOG_INFO</ref>,</highlight></codeline>
<codeline lineno="251"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;%s&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="252"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="group__libssh__error_1ga9241586665bf21f823806473fc386258" kindref="member">ssh_get_error</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>));</highlight></codeline>
<codeline lineno="253"><highlight class="normal"></highlight></codeline>
<codeline lineno="254"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="255"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a3d57e01582c0c9099f7f319513321fe8" kindref="member">auth</ref>.<ref refid="structssh__session__struct_1a3e967ac3134cae87dae1f6a794424073" kindref="member">supported_methods</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="256"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(strstr(auth_methods,<sp/></highlight><highlight class="stringliteral">&quot;password&quot;</highlight><highlight class="normal">)<sp/>!=<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="257"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a3d57e01582c0c9099f7f319513321fe8" kindref="member">auth</ref>.<ref refid="structssh__session__struct_1a3e967ac3134cae87dae1f6a794424073" kindref="member">supported_methods</ref><sp/>|=<sp/><ref refid="libssh_8h_1ad10dd2f5826e2d92a30bd8af3404574d" kindref="member">SSH_AUTH_METHOD_PASSWORD</ref>;</highlight></codeline>
<codeline lineno="258"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="259"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(strstr(auth_methods,<sp/></highlight><highlight class="stringliteral">&quot;keyboard-interactive&quot;</highlight><highlight class="normal">)<sp/>!=<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="260"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a3d57e01582c0c9099f7f319513321fe8" kindref="member">auth</ref>.<ref refid="structssh__session__struct_1a3e967ac3134cae87dae1f6a794424073" kindref="member">supported_methods</ref><sp/>|=<sp/><ref refid="libssh_8h_1a4c64484fdce4756309799d0e2a4e926a" kindref="member">SSH_AUTH_METHOD_INTERACTIVE</ref>;</highlight></codeline>
<codeline lineno="261"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="262"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(strstr(auth_methods,<sp/></highlight><highlight class="stringliteral">&quot;publickey&quot;</highlight><highlight class="normal">)<sp/>!=<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="263"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a3d57e01582c0c9099f7f319513321fe8" kindref="member">auth</ref>.<ref refid="structssh__session__struct_1a3e967ac3134cae87dae1f6a794424073" kindref="member">supported_methods</ref><sp/>|=<sp/><ref refid="libssh_8h_1aff27d66c1f5ba3871e72b5a61573f44a" kindref="member">SSH_AUTH_METHOD_PUBLICKEY</ref>;</highlight></codeline>
<codeline lineno="264"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="265"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(strstr(auth_methods,<sp/></highlight><highlight class="stringliteral">&quot;hostbased&quot;</highlight><highlight class="normal">)<sp/>!=<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="266"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a3d57e01582c0c9099f7f319513321fe8" kindref="member">auth</ref>.<ref refid="structssh__session__struct_1a3e967ac3134cae87dae1f6a794424073" kindref="member">supported_methods</ref><sp/>|=<sp/><ref refid="libssh_8h_1a47af3117d9ab19c61afeebfbfac8cfc4" kindref="member">SSH_AUTH_METHOD_HOSTBASED</ref>;</highlight></codeline>
<codeline lineno="267"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="268"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(strstr(auth_methods,<sp/></highlight><highlight class="stringliteral">&quot;gssapi-with-mic&quot;</highlight><highlight class="normal">)<sp/>!=<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="269"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a3d57e01582c0c9099f7f319513321fe8" kindref="member">auth</ref>.<ref refid="structssh__session__struct_1a3e967ac3134cae87dae1f6a794424073" kindref="member">supported_methods</ref><sp/>|=<sp/><ref refid="libssh_8h_1aa17667dad32ec77112a201b1b4b858e8" kindref="member">SSH_AUTH_METHOD_GSSAPI_MIC</ref>;</highlight></codeline>
<codeline lineno="270"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="271"><highlight class="normal"></highlight></codeline>
<codeline lineno="272"><highlight class="normal">end:</highlight></codeline>
<codeline lineno="273"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a3d57e01582c0c9099f7f319513321fe8" kindref="member">auth</ref>.<ref refid="structssh__session__struct_1aa859857ac7a99808ffc537e08087e541" kindref="member">current_method</ref><sp/>=<sp/><ref refid="libssh_8h_1aac3fef0944d87a778c92bd1dc9f3c153" kindref="member">SSH_AUTH_METHOD_UNKNOWN</ref>;</highlight></codeline>
<codeline lineno="274"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="sshd__direct-tcpip_8c_1aed3129b7674034c979192bcca6b0ad8c" kindref="member">SAFE_FREE</ref>(auth_methods);</highlight></codeline>
<codeline lineno="275"><highlight class="normal"></highlight></codeline>
<codeline lineno="276"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="group__libssh__callbacks_1gac29df803aa1295d6a498c1b081f3b494" kindref="member">SSH_PACKET_USED</ref>;</highlight></codeline>
<codeline lineno="277"><highlight class="normal">}</highlight></codeline>
<codeline lineno="278"><highlight class="normal"></highlight></codeline>
<codeline lineno="286" refid="group__libssh__auth_1gadbd916c2423b2097647263645e0dd422" refkind="member"><highlight class="normal"><ref refid="group__libssh__auth_1ga1fc1f11c7ba0469c866c42956450ebf7" kindref="member">SSH_PACKET_CALLBACK</ref>(ssh_packet_userauth_success)</highlight></codeline>
<codeline lineno="287"><highlight class="normal">{</highlight></codeline>
<codeline lineno="288"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">struct<sp/></highlight><highlight class="normal"><ref refid="structssh__crypto__struct" kindref="compound">ssh_crypto_struct</ref><sp/>*crypto<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="289"><highlight class="normal"></highlight></codeline>
<codeline lineno="290"><highlight class="normal"><sp/><sp/>(void)packet;</highlight></codeline>
<codeline lineno="291"><highlight class="normal"><sp/><sp/>(void)type;</highlight></codeline>
<codeline lineno="292"><highlight class="normal"><sp/><sp/>(void)<ref refid="ssh__client_8c_1a14871705f45ccdc5bb9f4549efd8e119" kindref="member">user</ref>;</highlight></codeline>
<codeline lineno="293"><highlight class="normal"></highlight></codeline>
<codeline lineno="294"><highlight class="normal"><sp/><sp/><ref refid="priv_8h_1aa21fd8a7a609329603b7b16da7939fca" kindref="member">SSH_LOG</ref>(<ref refid="libssh_8h_1a5e4247396f11fdc228d356a408c81715" kindref="member">SSH_LOG_DEBUG</ref>,<sp/></highlight><highlight class="stringliteral">&quot;Authentication<sp/>successful&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="295"><highlight class="normal"><sp/><sp/><ref refid="priv_8h_1aa21fd8a7a609329603b7b16da7939fca" kindref="member">SSH_LOG</ref>(<ref refid="libssh_8h_1a466c84d8dd5b1ba9162d491f31117a6b" kindref="member">SSH_LOG_TRACE</ref>,<sp/></highlight><highlight class="stringliteral">&quot;Received<sp/>SSH_USERAUTH_SUCCESS&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="296"><highlight class="normal"></highlight></codeline>
<codeline lineno="297"><highlight class="normal"><sp/><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a3d57e01582c0c9099f7f319513321fe8" kindref="member">auth</ref>.<ref refid="structssh__session__struct_1af0805877d21d43e81423ead52345c64b" kindref="member">state</ref><sp/>=<sp/><ref refid="auth_8h_1a0d3114986a741a14dc3ac03f7d8eafefa8e24c237c09404d0c93a1d3b5f8f3945" kindref="member">SSH_AUTH_STATE_SUCCESS</ref>;</highlight></codeline>
<codeline lineno="298"><highlight class="normal"><sp/><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a6f74d1a1eb6ed715b1073b67caa18460" kindref="member">session_state</ref><sp/>=<sp/><ref refid="session_8h_1a9bbd1d5ae11485e27279be6ad461992caced7c62fd9f24fe8f6672d50b8219f60" kindref="member">SSH_SESSION_STATE_AUTHENTICATED</ref>;</highlight></codeline>
<codeline lineno="299"><highlight class="normal"><sp/><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a997060832a3419d8fe884d3da855ef4c" kindref="member">flags</ref><sp/>|=<sp/><ref refid="session_8h_1ae54e87f0565e24b25aed1372b3493a2b" kindref="member">SSH_SESSION_FLAG_AUTHENTICATED</ref>;</highlight></codeline>
<codeline lineno="300"><highlight class="normal"></highlight></codeline>
<codeline lineno="301"><highlight class="normal"><sp/><sp/>crypto<sp/>=<sp/><ref refid="packet_8h_1af36b281d11b6c0affbc0faaf1ec52fbe" kindref="member">ssh_packet_get_current_crypto</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>,<sp/><ref refid="wrapper_8h_1a9ebe789b5f29a369c7799ec6ce17f1a9a4a51e00d57fa481f88149a9d7cd83c91" kindref="member">SSH_DIRECTION_OUT</ref>);</highlight></codeline>
<codeline lineno="302"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(crypto<sp/>!=<sp/>NULL<sp/>&amp;&amp;<sp/>crypto-&gt;<ref refid="structssh__crypto__struct_1a180198c8214743d490536a6855244355" kindref="member">delayed_compress_out</ref>)<sp/>{</highlight></codeline>
<codeline lineno="303"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="priv_8h_1aa21fd8a7a609329603b7b16da7939fca" kindref="member">SSH_LOG</ref>(<ref refid="libssh_8h_1a5e4247396f11fdc228d356a408c81715" kindref="member">SSH_LOG_DEBUG</ref>,<sp/></highlight><highlight class="stringliteral">&quot;Enabling<sp/>delayed<sp/>compression<sp/>OUT&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="304"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>crypto-&gt;<ref refid="structssh__crypto__struct_1a2d1c6e8bd0458906a8dffa7ea982fa2d" kindref="member">do_compress_out</ref><sp/>=<sp/>1;</highlight></codeline>
<codeline lineno="305"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="306"><highlight class="normal"></highlight></codeline>
<codeline lineno="307"><highlight class="normal"><sp/><sp/>crypto<sp/>=<sp/><ref refid="packet_8h_1af36b281d11b6c0affbc0faaf1ec52fbe" kindref="member">ssh_packet_get_current_crypto</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>,<sp/><ref refid="wrapper_8h_1a9ebe789b5f29a369c7799ec6ce17f1a9a86b8de4a56d77c10ee93f4cb0ab82d71" kindref="member">SSH_DIRECTION_IN</ref>);</highlight></codeline>
<codeline lineno="308"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(crypto<sp/>!=<sp/>NULL<sp/>&amp;&amp;<sp/>crypto-&gt;<ref refid="structssh__crypto__struct_1a264a702f7930c64683183b9334fa19d0" kindref="member">delayed_compress_in</ref>)<sp/>{</highlight></codeline>
<codeline lineno="309"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="priv_8h_1aa21fd8a7a609329603b7b16da7939fca" kindref="member">SSH_LOG</ref>(<ref refid="libssh_8h_1a5e4247396f11fdc228d356a408c81715" kindref="member">SSH_LOG_DEBUG</ref>,<sp/></highlight><highlight class="stringliteral">&quot;Enabling<sp/>delayed<sp/>compression<sp/>IN&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="310"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>crypto-&gt;<ref refid="structssh__crypto__struct_1a9322f181b21f808d19918940335ecf40" kindref="member">do_compress_in</ref><sp/>=<sp/>1;</highlight></codeline>
<codeline lineno="311"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="312"><highlight class="normal"></highlight></codeline>
<codeline lineno="313"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Reset<sp/>errors<sp/>by<sp/>previous<sp/>authentication<sp/>methods.<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="314"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="group__libssh__error_1gafa4e94327a2833d9e0eba2480a4988f7" kindref="member">ssh_reset_error</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>);</highlight></codeline>
<codeline lineno="315"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a3d57e01582c0c9099f7f319513321fe8" kindref="member">auth</ref>.<ref refid="structssh__session__struct_1aa859857ac7a99808ffc537e08087e541" kindref="member">current_method</ref><sp/>=<sp/><ref refid="libssh_8h_1aac3fef0944d87a778c92bd1dc9f3c153" kindref="member">SSH_AUTH_METHOD_UNKNOWN</ref>;</highlight></codeline>
<codeline lineno="316"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="group__libssh__callbacks_1gac29df803aa1295d6a498c1b081f3b494" kindref="member">SSH_PACKET_USED</ref>;</highlight></codeline>
<codeline lineno="317"><highlight class="normal">}</highlight></codeline>
<codeline lineno="318"><highlight class="normal"></highlight></codeline>
<codeline lineno="327" refid="group__libssh__auth_1gabcd6b05236558e07e8dc564a68f0a4a6" refkind="member"><highlight class="normal"><ref refid="group__libssh__auth_1ga1fc1f11c7ba0469c866c42956450ebf7" kindref="member">SSH_PACKET_CALLBACK</ref>(ssh_packet_userauth_pk_ok)<sp/>{</highlight></codeline>
<codeline lineno="328"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref>;</highlight></codeline>
<codeline lineno="329"><highlight class="normal"></highlight></codeline>
<codeline lineno="330"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="priv_8h_1aa21fd8a7a609329603b7b16da7939fca" kindref="member">SSH_LOG</ref>(<ref refid="libssh_8h_1a466c84d8dd5b1ba9162d491f31117a6b" kindref="member">SSH_LOG_TRACE</ref>,</highlight></codeline>
<codeline lineno="331"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Received<sp/>SSH_USERAUTH_PK_OK/INFO_REQUEST/GSSAPI_RESPONSE&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="332"><highlight class="normal"></highlight></codeline>
<codeline lineno="333"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a3d57e01582c0c9099f7f319513321fe8" kindref="member">auth</ref>.<ref refid="structssh__session__struct_1af0805877d21d43e81423ead52345c64b" kindref="member">state</ref><sp/>==<sp/><ref refid="auth_8h_1a0d3114986a741a14dc3ac03f7d8eafefa6d785d00012593230e88f00debb19179" kindref="member">SSH_AUTH_STATE_KBDINT_SENT</ref>)<sp/>{</highlight></codeline>
<codeline lineno="334"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Assuming<sp/>we<sp/>are<sp/>in<sp/>keyboard-interactive<sp/>context<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="335"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="priv_8h_1aa21fd8a7a609329603b7b16da7939fca" kindref="member">SSH_LOG</ref>(<ref refid="libssh_8h_1a466c84d8dd5b1ba9162d491f31117a6b" kindref="member">SSH_LOG_TRACE</ref>,</highlight></codeline>
<codeline lineno="336"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;keyboard-interactive<sp/>context,<sp/>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="337"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;assuming<sp/>SSH_USERAUTH_INFO_REQUEST&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="338"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/>ssh_packet_userauth_info_request(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>,type,packet,<ref refid="ssh__client_8c_1a14871705f45ccdc5bb9f4549efd8e119" kindref="member">user</ref>);</highlight></codeline>
<codeline lineno="339"><highlight class="normal"></highlight><highlight class="preprocessor">#ifdef<sp/>WITH_GSSAPI</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="340"><highlight class="normal"><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a3d57e01582c0c9099f7f319513321fe8" kindref="member">auth</ref>.<ref refid="structssh__session__struct_1af0805877d21d43e81423ead52345c64b" kindref="member">state</ref><sp/>==<sp/><ref refid="auth_8h_1a0d3114986a741a14dc3ac03f7d8eafefa12492663176bc8d81ec1f5f832ee7250" kindref="member">SSH_AUTH_STATE_GSSAPI_REQUEST_SENT</ref>)<sp/>{</highlight></codeline>
<codeline lineno="341"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/>ssh_packet_userauth_gssapi_response(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>,<sp/>type,<sp/>packet,<sp/><ref refid="ssh__client_8c_1a14871705f45ccdc5bb9f4549efd8e119" kindref="member">user</ref>);</highlight></codeline>
<codeline lineno="342"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="343"><highlight class="normal"><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a3d57e01582c0c9099f7f319513321fe8" kindref="member">auth</ref>.<ref refid="structssh__session__struct_1af0805877d21d43e81423ead52345c64b" kindref="member">state</ref><sp/>==<sp/><ref refid="auth_8h_1a0d3114986a741a14dc3ac03f7d8eafefaeb9522ba4289c7bf7575802e7182cc3d" kindref="member">SSH_AUTH_STATE_PUBKEY_OFFER_SENT</ref>)<sp/>{</highlight></codeline>
<codeline lineno="344"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a3d57e01582c0c9099f7f319513321fe8" kindref="member">auth</ref>.<ref refid="structssh__session__struct_1af0805877d21d43e81423ead52345c64b" kindref="member">state</ref><sp/>=<sp/><ref refid="auth_8h_1a0d3114986a741a14dc3ac03f7d8eafefa8d27800e44e1c7e3a5f30594443f78ef" kindref="member">SSH_AUTH_STATE_PK_OK</ref>;</highlight></codeline>
<codeline lineno="345"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="priv_8h_1aa21fd8a7a609329603b7b16da7939fca" kindref="member">SSH_LOG</ref>(<ref refid="libssh_8h_1a466c84d8dd5b1ba9162d491f31117a6b" kindref="member">SSH_LOG_TRACE</ref>,<sp/></highlight><highlight class="stringliteral">&quot;Assuming<sp/>SSH_USERAUTH_PK_OK&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="346"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="group__libssh__callbacks_1gac29df803aa1295d6a498c1b081f3b494" kindref="member">SSH_PACKET_USED</ref>;</highlight></codeline>
<codeline lineno="347"><highlight class="normal"><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="348"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a3d57e01582c0c9099f7f319513321fe8" kindref="member">auth</ref>.<ref refid="structssh__session__struct_1af0805877d21d43e81423ead52345c64b" kindref="member">state</ref><sp/>=<sp/><ref refid="auth_8h_1a0d3114986a741a14dc3ac03f7d8eafefa331579d75bb0aa08050ca67a12861387" kindref="member">SSH_AUTH_STATE_ERROR</ref>;</highlight></codeline>
<codeline lineno="349"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="priv_8h_1aa21fd8a7a609329603b7b16da7939fca" kindref="member">SSH_LOG</ref>(<ref refid="libssh_8h_1a466c84d8dd5b1ba9162d491f31117a6b" kindref="member">SSH_LOG_TRACE</ref>,<sp/></highlight><highlight class="stringliteral">&quot;SSH_USERAUTH_PK_OK<sp/>received<sp/>in<sp/>wrong<sp/>state&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="350"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="group__libssh__callbacks_1gac29df803aa1295d6a498c1b081f3b494" kindref="member">SSH_PACKET_USED</ref>;</highlight></codeline>
<codeline lineno="351"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="352"><highlight class="normal"></highlight></codeline>
<codeline lineno="353"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref>;</highlight></codeline>
<codeline lineno="354"><highlight class="normal">}</highlight></codeline>
<codeline lineno="355"><highlight class="normal"></highlight></codeline>
<codeline lineno="376" refid="group__libssh__auth_1ga35d44897a44b4bb3b7c01108c1812a37" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="group__libssh__auth_1ga35d44897a44b4bb3b7c01108c1812a37" kindref="member">ssh_userauth_list</ref>(<ref refid="structssh__session__struct" kindref="compound">ssh_session</ref><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*<ref refid="proxy_8c_1a9b20c006bd90a09e1465fb668700e81d" kindref="member">username</ref>)</highlight></codeline>
<codeline lineno="377"><highlight class="normal">{</highlight></codeline>
<codeline lineno="378"><highlight class="normal"><sp/><sp/><sp/><sp/>(void)<sp/><ref refid="proxy_8c_1a9b20c006bd90a09e1465fb668700e81d" kindref="member">username</ref>;<sp/></highlight><highlight class="comment">/*<sp/>unused<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="379"><highlight class="normal"></highlight></codeline>
<codeline lineno="380"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref><sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="381"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>0;</highlight></codeline>
<codeline lineno="382"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="383"><highlight class="normal"></highlight></codeline>
<codeline lineno="384"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a3d57e01582c0c9099f7f319513321fe8" kindref="member">auth</ref>.<ref refid="structssh__session__struct_1a3e967ac3134cae87dae1f6a794424073" kindref="member">supported_methods</ref>;</highlight></codeline>
<codeline lineno="385"><highlight class="normal">}</highlight></codeline>
<codeline lineno="386"><highlight class="normal"></highlight></codeline>
<codeline lineno="406" refid="group__libssh__auth_1ga58e7c265236edbc97a2f117d3f23b4dd" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="group__libssh__auth_1ga58e7c265236edbc97a2f117d3f23b4dd" kindref="member">ssh_userauth_none</ref>(<ref refid="structssh__session__struct" kindref="compound">ssh_session</ref><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*<ref refid="proxy_8c_1a9b20c006bd90a09e1465fb668700e81d" kindref="member">username</ref>)<sp/>{</highlight></codeline>
<codeline lineno="407"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref>;</highlight></codeline>
<codeline lineno="408"><highlight class="normal"></highlight></codeline>
<codeline lineno="409"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">switch</highlight><highlight class="normal">(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a5552665043089000065df39c5a5a7094" kindref="member">pending_call_state</ref>)<sp/>{</highlight></codeline>
<codeline lineno="410"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="session_8h_1abb7a4342b889601983497b3f094957e1a33be3f7cd03fe7fced1eeacd369cad94" kindref="member">SSH_PENDING_CALL_NONE</ref>:</highlight></codeline>
<codeline lineno="411"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="412"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="session_8h_1abb7a4342b889601983497b3f094957e1a3ee5993b383a7d6a1bfd35e2e0ed3ed1" kindref="member">SSH_PENDING_CALL_AUTH_NONE</ref>:</highlight></codeline>
<codeline lineno="413"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">goto</highlight><highlight class="normal"><sp/>pending;</highlight></codeline>
<codeline lineno="414"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">default</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="415"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="priv_8h_1a55177b3e8db90ca9adb435c44281963c" kindref="member">ssh_set_error</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>,<sp/><ref refid="libssh_8h_1a036b2b00fb04337a4d06d719d1b62be1a86ff0b2e8da6ad8628efc556b6ce1887" kindref="member">SSH_FATAL</ref>,</highlight></codeline>
<codeline lineno="416"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Wrong<sp/>state<sp/>(%d)<sp/>during<sp/>pending<sp/>SSH<sp/>call&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="417"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a5552665043089000065df39c5a5a7094" kindref="member">pending_call_state</ref>);</highlight></codeline>
<codeline lineno="418"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="libssh_8h_1a5b35a5038ad8eac4a4e4c00c6239e6e2a33d82f552d20734c17e770af637e3e17" kindref="member">SSH_AUTH_ERROR</ref>;</highlight></codeline>
<codeline lineno="419"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="420"><highlight class="normal"></highlight></codeline>
<codeline lineno="421"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="group__libssh__auth_1ga812fb86c3dd4a6245bc7d01beaa9cfe8" kindref="member">ssh_userauth_request_service</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>);</highlight></codeline>
<codeline lineno="422"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>==<sp/><ref refid="libssh_8h_1a9c57e4f6482106336045a4d25a55f28e" kindref="member">SSH_AGAIN</ref>)<sp/>{</highlight></codeline>
<codeline lineno="423"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="libssh_8h_1a5b35a5038ad8eac4a4e4c00c6239e6e2a0f166cff4fa03faf4e4c11ad854a4996" kindref="member">SSH_AUTH_AGAIN</ref>;</highlight></codeline>
<codeline lineno="424"><highlight class="normal"><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>==<sp/><ref refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" kindref="member">SSH_ERROR</ref>)<sp/>{</highlight></codeline>
<codeline lineno="425"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="libssh_8h_1a5b35a5038ad8eac4a4e4c00c6239e6e2a33d82f552d20734c17e770af637e3e17" kindref="member">SSH_AUTH_ERROR</ref>;</highlight></codeline>
<codeline lineno="426"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="427"><highlight class="normal"></highlight></codeline>
<codeline lineno="428"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>request<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="429"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="buffer_8h_1ae17848a86043f0abfc60c1c4f6126ccd" kindref="member">ssh_buffer_pack</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1af0aed60c1e529bbfdcb483fd80bf98a0" kindref="member">out_buffer</ref>,<sp/></highlight><highlight class="stringliteral">&quot;bsss&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="430"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ssh2_8h_1a423ea81df02faff2d59b730af16ac59e" kindref="member">SSH2_MSG_USERAUTH_REQUEST</ref>,</highlight></codeline>
<codeline lineno="431"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="proxy_8c_1a9b20c006bd90a09e1465fb668700e81d" kindref="member">username</ref><sp/>?<sp/><ref refid="proxy_8c_1a9b20c006bd90a09e1465fb668700e81d" kindref="member">username</ref><sp/>:<sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a1c29cf990c1d0df6e1b0971d4f3d1f3e" kindref="member">opts</ref>.<ref refid="structssh__session__struct_1a8ed5d5d3116679fd7b8f2c0e1db92726" kindref="member">username</ref>,</highlight></codeline>
<codeline lineno="432"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;ssh-connection&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="433"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;none&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="434"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>);</highlight></codeline>
<codeline lineno="435"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>&lt;<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="436"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">goto</highlight><highlight class="normal"><sp/>fail;</highlight></codeline>
<codeline lineno="437"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="438"><highlight class="normal"></highlight></codeline>
<codeline lineno="439"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a3d57e01582c0c9099f7f319513321fe8" kindref="member">auth</ref>.<ref refid="structssh__session__struct_1aa859857ac7a99808ffc537e08087e541" kindref="member">current_method</ref><sp/>=<sp/><ref refid="libssh_8h_1af37d502f88abb23d55e6c35aacc6b340" kindref="member">SSH_AUTH_METHOD_NONE</ref>;</highlight></codeline>
<codeline lineno="440"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a3d57e01582c0c9099f7f319513321fe8" kindref="member">auth</ref>.<ref refid="structssh__session__struct_1af0805877d21d43e81423ead52345c64b" kindref="member">state</ref><sp/>=<sp/><ref refid="auth_8h_1a0d3114986a741a14dc3ac03f7d8eafefa1aebfec92e739cd95a40eafe1b468444" kindref="member">SSH_AUTH_STATE_AUTH_NONE_SENT</ref>;</highlight></codeline>
<codeline lineno="441"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a5552665043089000065df39c5a5a7094" kindref="member">pending_call_state</ref><sp/>=<sp/><ref refid="session_8h_1abb7a4342b889601983497b3f094957e1a3ee5993b383a7d6a1bfd35e2e0ed3ed1" kindref="member">SSH_PENDING_CALL_AUTH_NONE</ref>;</highlight></codeline>
<codeline lineno="442"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="packet_8h_1a7e6c7ed74c23ace432476aa8a6841140" kindref="member">ssh_packet_send</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>);</highlight></codeline>
<codeline lineno="443"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>==<sp/><ref refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" kindref="member">SSH_ERROR</ref>)<sp/>{</highlight></codeline>
<codeline lineno="444"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="libssh_8h_1a5b35a5038ad8eac4a4e4c00c6239e6e2a33d82f552d20734c17e770af637e3e17" kindref="member">SSH_AUTH_ERROR</ref>;</highlight></codeline>
<codeline lineno="445"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="446"><highlight class="normal"></highlight></codeline>
<codeline lineno="447"><highlight class="normal">pending:</highlight></codeline>
<codeline lineno="448"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="group__libssh__auth_1gabff6b3898d3bf45b62cc3ed3774eaa83" kindref="member">ssh_userauth_get_response</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>);</highlight></codeline>
<codeline lineno="449"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>!=<sp/><ref refid="libssh_8h_1a5b35a5038ad8eac4a4e4c00c6239e6e2a0f166cff4fa03faf4e4c11ad854a4996" kindref="member">SSH_AUTH_AGAIN</ref>)<sp/>{</highlight></codeline>
<codeline lineno="450"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a5552665043089000065df39c5a5a7094" kindref="member">pending_call_state</ref><sp/>=<sp/><ref refid="session_8h_1abb7a4342b889601983497b3f094957e1a33be3f7cd03fe7fced1eeacd369cad94" kindref="member">SSH_PENDING_CALL_NONE</ref>;</highlight></codeline>
<codeline lineno="451"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="452"><highlight class="normal"></highlight></codeline>
<codeline lineno="453"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref>;</highlight></codeline>
<codeline lineno="454"><highlight class="normal">fail:</highlight></codeline>
<codeline lineno="455"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="priv_8h_1ae280c413c792e04237f000841ac8ce44" kindref="member">ssh_set_error_oom</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>);</highlight></codeline>
<codeline lineno="456"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="libssh_8h_1ac8802ff7f5348d0145dab5242623f740" kindref="member">ssh_buffer_reinit</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1af0aed60c1e529bbfdcb483fd80bf98a0" kindref="member">out_buffer</ref>);</highlight></codeline>
<codeline lineno="457"><highlight class="normal"></highlight></codeline>
<codeline lineno="458"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="libssh_8h_1a5b35a5038ad8eac4a4e4c00c6239e6e2a33d82f552d20734c17e770af637e3e17" kindref="member">SSH_AUTH_ERROR</ref>;</highlight></codeline>
<codeline lineno="459"><highlight class="normal">}</highlight></codeline>
<codeline lineno="460"><highlight class="normal"></highlight></codeline>
<codeline lineno="489" refid="group__libssh__auth_1ga592f673c4d417a6a46cd4876ac8287aa" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="group__libssh__auth_1ga592f673c4d417a6a46cd4876ac8287aa" kindref="member">ssh_userauth_try_publickey</ref>(<ref refid="structssh__session__struct" kindref="compound">ssh_session</ref><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>,</highlight></codeline>
<codeline lineno="490"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*<ref refid="proxy_8c_1a9b20c006bd90a09e1465fb668700e81d" kindref="member">username</ref>,</highlight></codeline>
<codeline lineno="491"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="structssh__key__struct" kindref="compound">ssh_key</ref><sp/><ref refid="curve25519-sha256_0dlibssh_8org_8txt_1a555595207a1407936ebb264ebdbf434c" kindref="member">pubkey</ref>)</highlight></codeline>
<codeline lineno="492"><highlight class="normal">{</highlight></codeline>
<codeline lineno="493"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="structssh__string__struct" kindref="compound">ssh_string</ref><sp/>pubkey_s<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="494"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*sig_type_c<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="495"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref>;</highlight></codeline>
<codeline lineno="496"><highlight class="normal"></highlight></codeline>
<codeline lineno="497"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref><sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="498"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="libssh_8h_1a5b35a5038ad8eac4a4e4c00c6239e6e2a33d82f552d20734c17e770af637e3e17" kindref="member">SSH_AUTH_ERROR</ref>;</highlight></codeline>
<codeline lineno="499"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="500"><highlight class="normal"></highlight></codeline>
<codeline lineno="501"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="curve25519-sha256_0dlibssh_8org_8txt_1a555595207a1407936ebb264ebdbf434c" kindref="member">pubkey</ref><sp/>==<sp/>NULL<sp/>||<sp/>!<ref refid="group__libssh__pki_1ga9bc688b5cbc400320ac44896eba21924" kindref="member">ssh_key_is_public</ref>(<ref refid="curve25519-sha256_0dlibssh_8org_8txt_1a555595207a1407936ebb264ebdbf434c" kindref="member">pubkey</ref>))<sp/>{</highlight></codeline>
<codeline lineno="502"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="priv_8h_1a55177b3e8db90ca9adb435c44281963c" kindref="member">ssh_set_error</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>,<sp/><ref refid="libssh_8h_1a036b2b00fb04337a4d06d719d1b62be1a86ff0b2e8da6ad8628efc556b6ce1887" kindref="member">SSH_FATAL</ref>,<sp/></highlight><highlight class="stringliteral">&quot;Invalid<sp/>pubkey&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="503"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="libssh_8h_1a5b35a5038ad8eac4a4e4c00c6239e6e2a33d82f552d20734c17e770af637e3e17" kindref="member">SSH_AUTH_ERROR</ref>;</highlight></codeline>
<codeline lineno="504"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="505"><highlight class="normal"></highlight></codeline>
<codeline lineno="506"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">switch</highlight><highlight class="normal">(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a5552665043089000065df39c5a5a7094" kindref="member">pending_call_state</ref>)<sp/>{</highlight></codeline>
<codeline lineno="507"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="session_8h_1abb7a4342b889601983497b3f094957e1a33be3f7cd03fe7fced1eeacd369cad94" kindref="member">SSH_PENDING_CALL_NONE</ref>:</highlight></codeline>
<codeline lineno="508"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="509"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="session_8h_1abb7a4342b889601983497b3f094957e1acc1374f13198a1db57344b049d626c4a" kindref="member">SSH_PENDING_CALL_AUTH_OFFER_PUBKEY</ref>:</highlight></codeline>
<codeline lineno="510"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">goto</highlight><highlight class="normal"><sp/>pending;</highlight></codeline>
<codeline lineno="511"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">default</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="512"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="priv_8h_1a55177b3e8db90ca9adb435c44281963c" kindref="member">ssh_set_error</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>,</highlight></codeline>
<codeline lineno="513"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="libssh_8h_1a036b2b00fb04337a4d06d719d1b62be1a86ff0b2e8da6ad8628efc556b6ce1887" kindref="member">SSH_FATAL</ref>,</highlight></codeline>
<codeline lineno="514"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Wrong<sp/>state<sp/>(%d)<sp/>during<sp/>pending<sp/>SSH<sp/>call&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="515"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a5552665043089000065df39c5a5a7094" kindref="member">pending_call_state</ref>);</highlight></codeline>
<codeline lineno="516"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" kindref="member">SSH_ERROR</ref>;</highlight></codeline>
<codeline lineno="517"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="518"><highlight class="normal"></highlight></codeline>
<codeline lineno="519"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Check<sp/>if<sp/>the<sp/>given<sp/>public<sp/>key<sp/>algorithm<sp/>is<sp/>allowed<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="520"><highlight class="normal"><sp/><sp/><sp/><sp/>sig_type_c<sp/>=<sp/><ref refid="group__libssh__pki_1ga7ad4109947adef7dbe7f9b8d1577cc88" kindref="member">ssh_key_get_signature_algorithm</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>,<sp/><ref refid="curve25519-sha256_0dlibssh_8org_8txt_1a555595207a1407936ebb264ebdbf434c" kindref="member">pubkey</ref>-&gt;type);</highlight></codeline>
<codeline lineno="521"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(sig_type_c<sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="522"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="priv_8h_1a55177b3e8db90ca9adb435c44281963c" kindref="member">ssh_set_error</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>,<sp/><ref refid="libssh_8h_1a036b2b00fb04337a4d06d719d1b62be1ad1339fb4b92a9d25bdb99df5de5c4f88" kindref="member">SSH_REQUEST_DENIED</ref>,</highlight></codeline>
<codeline lineno="523"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Invalid<sp/>key<sp/>type<sp/>(unknown)&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="524"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="libssh_8h_1a5b35a5038ad8eac4a4e4c00c6239e6e2ac3d2d6d092a7adc147b7f859a0b252d2" kindref="member">SSH_AUTH_DENIED</ref>;</highlight></codeline>
<codeline lineno="525"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="526"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!<ref refid="group__libssh__pki_1ga79010baa7b7ca9d4467910ff863e669d" kindref="member">ssh_key_algorithm_allowed</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>,<sp/>sig_type_c))<sp/>{</highlight></codeline>
<codeline lineno="527"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="priv_8h_1a55177b3e8db90ca9adb435c44281963c" kindref="member">ssh_set_error</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>,<sp/><ref refid="libssh_8h_1a036b2b00fb04337a4d06d719d1b62be1ad1339fb4b92a9d25bdb99df5de5c4f88" kindref="member">SSH_REQUEST_DENIED</ref>,</highlight></codeline>
<codeline lineno="528"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;The<sp/>key<sp/>algorithm<sp/>&apos;%s&apos;<sp/>is<sp/>not<sp/>allowed<sp/>to<sp/>be<sp/>used<sp/>by&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="529"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;<sp/>PUBLICKEY_ACCEPTED_TYPES<sp/>configuration<sp/>option&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="530"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sig_type_c);</highlight></codeline>
<codeline lineno="531"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="libssh_8h_1a5b35a5038ad8eac4a4e4c00c6239e6e2ac3d2d6d092a7adc147b7f859a0b252d2" kindref="member">SSH_AUTH_DENIED</ref>;</highlight></codeline>
<codeline lineno="532"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="533"><highlight class="normal"></highlight></codeline>
<codeline lineno="534"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="group__libssh__auth_1ga812fb86c3dd4a6245bc7d01beaa9cfe8" kindref="member">ssh_userauth_request_service</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>);</highlight></codeline>
<codeline lineno="535"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>==<sp/><ref refid="libssh_8h_1a9c57e4f6482106336045a4d25a55f28e" kindref="member">SSH_AGAIN</ref>)<sp/>{</highlight></codeline>
<codeline lineno="536"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="libssh_8h_1a5b35a5038ad8eac4a4e4c00c6239e6e2a0f166cff4fa03faf4e4c11ad854a4996" kindref="member">SSH_AUTH_AGAIN</ref>;</highlight></codeline>
<codeline lineno="537"><highlight class="normal"><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>==<sp/><ref refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" kindref="member">SSH_ERROR</ref>)<sp/>{</highlight></codeline>
<codeline lineno="538"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="libssh_8h_1a5b35a5038ad8eac4a4e4c00c6239e6e2a33d82f552d20734c17e770af637e3e17" kindref="member">SSH_AUTH_ERROR</ref>;</highlight></codeline>
<codeline lineno="539"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="540"><highlight class="normal"></highlight></codeline>
<codeline lineno="541"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>public<sp/>key<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="542"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="group__libssh__pki_1gaadeaf6dc35e99214de0af82c3c431649" kindref="member">ssh_pki_export_pubkey_blob</ref>(<ref refid="curve25519-sha256_0dlibssh_8org_8txt_1a555595207a1407936ebb264ebdbf434c" kindref="member">pubkey</ref>,<sp/>&amp;pubkey_s);</highlight></codeline>
<codeline lineno="543"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>&lt;<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="544"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">goto</highlight><highlight class="normal"><sp/>fail;</highlight></codeline>
<codeline lineno="545"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="546"><highlight class="normal"></highlight></codeline>
<codeline lineno="547"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>request<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="548"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="buffer_8h_1ae17848a86043f0abfc60c1c4f6126ccd" kindref="member">ssh_buffer_pack</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1af0aed60c1e529bbfdcb483fd80bf98a0" kindref="member">out_buffer</ref>,<sp/></highlight><highlight class="stringliteral">&quot;bsssbsS&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="549"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ssh2_8h_1a423ea81df02faff2d59b730af16ac59e" kindref="member">SSH2_MSG_USERAUTH_REQUEST</ref>,</highlight></codeline>
<codeline lineno="550"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="proxy_8c_1a9b20c006bd90a09e1465fb668700e81d" kindref="member">username</ref><sp/>?<sp/><ref refid="proxy_8c_1a9b20c006bd90a09e1465fb668700e81d" kindref="member">username</ref><sp/>:<sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a1c29cf990c1d0df6e1b0971d4f3d1f3e" kindref="member">opts</ref>.<ref refid="structssh__session__struct_1a8ed5d5d3116679fd7b8f2c0e1db92726" kindref="member">username</ref>,</highlight></codeline>
<codeline lineno="551"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;ssh-connection&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="552"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;publickey&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="553"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0,<sp/></highlight><highlight class="comment">/*<sp/>private<sp/>key<sp/>?<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="554"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sig_type_c,<sp/></highlight><highlight class="comment">/*<sp/>algo<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="555"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pubkey_s<sp/></highlight><highlight class="comment">/*<sp/>public<sp/>key<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="556"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>);</highlight></codeline>
<codeline lineno="557"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>&lt;<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="558"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">goto</highlight><highlight class="normal"><sp/>fail;</highlight></codeline>
<codeline lineno="559"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="560"><highlight class="normal"></highlight></codeline>
<codeline lineno="561"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="libssh_8h_1a5bc8710c8633117ff449d15489fca051" kindref="member">SSH_STRING_FREE</ref>(pubkey_s);</highlight></codeline>
<codeline lineno="562"><highlight class="normal"></highlight></codeline>
<codeline lineno="563"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a3d57e01582c0c9099f7f319513321fe8" kindref="member">auth</ref>.<ref refid="structssh__session__struct_1aa859857ac7a99808ffc537e08087e541" kindref="member">current_method</ref><sp/>=<sp/><ref refid="libssh_8h_1aff27d66c1f5ba3871e72b5a61573f44a" kindref="member">SSH_AUTH_METHOD_PUBLICKEY</ref>;</highlight></codeline>
<codeline lineno="564"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a3d57e01582c0c9099f7f319513321fe8" kindref="member">auth</ref>.<ref refid="structssh__session__struct_1af0805877d21d43e81423ead52345c64b" kindref="member">state</ref><sp/>=<sp/><ref refid="auth_8h_1a0d3114986a741a14dc3ac03f7d8eafefaeb9522ba4289c7bf7575802e7182cc3d" kindref="member">SSH_AUTH_STATE_PUBKEY_OFFER_SENT</ref>;</highlight></codeline>
<codeline lineno="565"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a5552665043089000065df39c5a5a7094" kindref="member">pending_call_state</ref><sp/>=<sp/><ref refid="session_8h_1abb7a4342b889601983497b3f094957e1acc1374f13198a1db57344b049d626c4a" kindref="member">SSH_PENDING_CALL_AUTH_OFFER_PUBKEY</ref>;</highlight></codeline>
<codeline lineno="566"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="packet_8h_1a7e6c7ed74c23ace432476aa8a6841140" kindref="member">ssh_packet_send</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>);</highlight></codeline>
<codeline lineno="567"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>==<sp/><ref refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" kindref="member">SSH_ERROR</ref>)<sp/>{</highlight></codeline>
<codeline lineno="568"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="libssh_8h_1a5b35a5038ad8eac4a4e4c00c6239e6e2a33d82f552d20734c17e770af637e3e17" kindref="member">SSH_AUTH_ERROR</ref>;</highlight></codeline>
<codeline lineno="569"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="570"><highlight class="normal"></highlight></codeline>
<codeline lineno="571"><highlight class="normal">pending:</highlight></codeline>
<codeline lineno="572"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="group__libssh__auth_1gabff6b3898d3bf45b62cc3ed3774eaa83" kindref="member">ssh_userauth_get_response</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>);</highlight></codeline>
<codeline lineno="573"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>!=<sp/><ref refid="libssh_8h_1a5b35a5038ad8eac4a4e4c00c6239e6e2a0f166cff4fa03faf4e4c11ad854a4996" kindref="member">SSH_AUTH_AGAIN</ref>)<sp/>{</highlight></codeline>
<codeline lineno="574"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a5552665043089000065df39c5a5a7094" kindref="member">pending_call_state</ref><sp/>=<sp/><ref refid="session_8h_1abb7a4342b889601983497b3f094957e1a33be3f7cd03fe7fced1eeacd369cad94" kindref="member">SSH_PENDING_CALL_NONE</ref>;</highlight></codeline>
<codeline lineno="575"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="576"><highlight class="normal"></highlight></codeline>
<codeline lineno="577"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref>;</highlight></codeline>
<codeline lineno="578"><highlight class="normal">fail:</highlight></codeline>
<codeline lineno="579"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="libssh_8h_1a5bc8710c8633117ff449d15489fca051" kindref="member">SSH_STRING_FREE</ref>(pubkey_s);</highlight></codeline>
<codeline lineno="580"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="priv_8h_1ae280c413c792e04237f000841ac8ce44" kindref="member">ssh_set_error_oom</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>);</highlight></codeline>
<codeline lineno="581"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="libssh_8h_1ac8802ff7f5348d0145dab5242623f740" kindref="member">ssh_buffer_reinit</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1af0aed60c1e529bbfdcb483fd80bf98a0" kindref="member">out_buffer</ref>);</highlight></codeline>
<codeline lineno="582"><highlight class="normal"></highlight></codeline>
<codeline lineno="583"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="libssh_8h_1a5b35a5038ad8eac4a4e4c00c6239e6e2a33d82f552d20734c17e770af637e3e17" kindref="member">SSH_AUTH_ERROR</ref>;</highlight></codeline>
<codeline lineno="584"><highlight class="normal">}</highlight></codeline>
<codeline lineno="585"><highlight class="normal"></highlight></codeline>
<codeline lineno="609" refid="group__libssh__auth_1gaa38c4f3194ef36720da7eddb0aa99e23" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="group__libssh__auth_1gaa38c4f3194ef36720da7eddb0aa99e23" kindref="member">ssh_userauth_publickey</ref>(<ref refid="structssh__session__struct" kindref="compound">ssh_session</ref><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>,</highlight></codeline>
<codeline lineno="610"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*<ref refid="proxy_8c_1a9b20c006bd90a09e1465fb668700e81d" kindref="member">username</ref>,</highlight></codeline>
<codeline lineno="611"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="structssh__key__struct" kindref="compound">ssh_key</ref><sp/><ref refid="curve25519-sha256_0dlibssh_8org_8txt_1a5d18fd02a76effa0a15b1decb554cc12" kindref="member">privkey</ref>)</highlight></codeline>
<codeline lineno="612"><highlight class="normal">{</highlight></codeline>
<codeline lineno="613"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="structssh__string__struct" kindref="compound">ssh_string</ref><sp/>str<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="614"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref>;</highlight></codeline>
<codeline lineno="615"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*sig_type_c<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="616"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">enum</highlight><highlight class="normal"><sp/><ref refid="libssh_8h_1a244b017e5993fde29fe9e9b1f04a7bce" kindref="member">ssh_keytypes_e</ref><sp/>key_type;</highlight></codeline>
<codeline lineno="617"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">enum</highlight><highlight class="normal"><sp/><ref refid="priv_8h_1a776ae60987846ddc64c85308d5b6a441" kindref="member">ssh_digest_e</ref><sp/>hash_type;</highlight></codeline>
<codeline lineno="618"><highlight class="normal"></highlight></codeline>
<codeline lineno="619"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref><sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="620"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="libssh_8h_1a5b35a5038ad8eac4a4e4c00c6239e6e2a33d82f552d20734c17e770af637e3e17" kindref="member">SSH_AUTH_ERROR</ref>;</highlight></codeline>
<codeline lineno="621"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="622"><highlight class="normal"></highlight></codeline>
<codeline lineno="623"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="curve25519-sha256_0dlibssh_8org_8txt_1a5d18fd02a76effa0a15b1decb554cc12" kindref="member">privkey</ref><sp/>==<sp/>NULL<sp/>||<sp/>!<ref refid="group__libssh__pki_1ga09de68aba0a7c4e31d8ba7df43b637c5" kindref="member">ssh_key_is_private</ref>(<ref refid="curve25519-sha256_0dlibssh_8org_8txt_1a5d18fd02a76effa0a15b1decb554cc12" kindref="member">privkey</ref>))<sp/>{</highlight></codeline>
<codeline lineno="624"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="priv_8h_1a55177b3e8db90ca9adb435c44281963c" kindref="member">ssh_set_error</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>,<sp/><ref refid="libssh_8h_1a036b2b00fb04337a4d06d719d1b62be1a86ff0b2e8da6ad8628efc556b6ce1887" kindref="member">SSH_FATAL</ref>,<sp/></highlight><highlight class="stringliteral">&quot;Invalid<sp/>private<sp/>key&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="625"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="libssh_8h_1a5b35a5038ad8eac4a4e4c00c6239e6e2a33d82f552d20734c17e770af637e3e17" kindref="member">SSH_AUTH_ERROR</ref>;</highlight></codeline>
<codeline lineno="626"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="627"><highlight class="normal"></highlight></codeline>
<codeline lineno="628"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">switch</highlight><highlight class="normal">(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a5552665043089000065df39c5a5a7094" kindref="member">pending_call_state</ref>)<sp/>{</highlight></codeline>
<codeline lineno="629"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="session_8h_1abb7a4342b889601983497b3f094957e1a33be3f7cd03fe7fced1eeacd369cad94" kindref="member">SSH_PENDING_CALL_NONE</ref>:</highlight></codeline>
<codeline lineno="630"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="631"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="session_8h_1abb7a4342b889601983497b3f094957e1a85ca960326af12df3bd2abca946f1617" kindref="member">SSH_PENDING_CALL_AUTH_PUBKEY</ref>:</highlight></codeline>
<codeline lineno="632"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">goto</highlight><highlight class="normal"><sp/>pending;</highlight></codeline>
<codeline lineno="633"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">default</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="634"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="priv_8h_1a55177b3e8db90ca9adb435c44281963c" kindref="member">ssh_set_error</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>,</highlight></codeline>
<codeline lineno="635"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="libssh_8h_1a036b2b00fb04337a4d06d719d1b62be1a86ff0b2e8da6ad8628efc556b6ce1887" kindref="member">SSH_FATAL</ref>,</highlight></codeline>
<codeline lineno="636"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Bad<sp/>call<sp/>during<sp/>pending<sp/>SSH<sp/>call<sp/>in<sp/>ssh_userauth_try_publickey&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="637"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="libssh_8h_1a5b35a5038ad8eac4a4e4c00c6239e6e2a33d82f552d20734c17e770af637e3e17" kindref="member">SSH_AUTH_ERROR</ref>;</highlight></codeline>
<codeline lineno="638"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="639"><highlight class="normal"></highlight></codeline>
<codeline lineno="640"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Cert<sp/>auth<sp/>requires<sp/>presenting<sp/>the<sp/>cert<sp/>type<sp/>name<sp/>(*-cert@openssh.com)<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="641"><highlight class="normal"><sp/><sp/><sp/><sp/>key_type<sp/>=<sp/><ref refid="curve25519-sha256_0dlibssh_8org_8txt_1a5d18fd02a76effa0a15b1decb554cc12" kindref="member">privkey</ref>-&gt;cert<sp/>!=<sp/>NULL<sp/>?<sp/><ref refid="curve25519-sha256_0dlibssh_8org_8txt_1a5d18fd02a76effa0a15b1decb554cc12" kindref="member">privkey</ref>-&gt;cert_type<sp/>:<sp/><ref refid="curve25519-sha256_0dlibssh_8org_8txt_1a5d18fd02a76effa0a15b1decb554cc12" kindref="member">privkey</ref>-&gt;type;</highlight></codeline>
<codeline lineno="642"><highlight class="normal"></highlight></codeline>
<codeline lineno="643"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Check<sp/>if<sp/>the<sp/>given<sp/>public<sp/>key<sp/>algorithm<sp/>is<sp/>allowed<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="644"><highlight class="normal"><sp/><sp/><sp/><sp/>sig_type_c<sp/>=<sp/><ref refid="group__libssh__pki_1ga7ad4109947adef7dbe7f9b8d1577cc88" kindref="member">ssh_key_get_signature_algorithm</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>,<sp/>key_type);</highlight></codeline>
<codeline lineno="645"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(sig_type_c<sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="646"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="priv_8h_1a55177b3e8db90ca9adb435c44281963c" kindref="member">ssh_set_error</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>,<sp/><ref refid="libssh_8h_1a036b2b00fb04337a4d06d719d1b62be1ad1339fb4b92a9d25bdb99df5de5c4f88" kindref="member">SSH_REQUEST_DENIED</ref>,</highlight></codeline>
<codeline lineno="647"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Invalid<sp/>key<sp/>type<sp/>(unknown)&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="648"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="libssh_8h_1a5b35a5038ad8eac4a4e4c00c6239e6e2ac3d2d6d092a7adc147b7f859a0b252d2" kindref="member">SSH_AUTH_DENIED</ref>;</highlight></codeline>
<codeline lineno="649"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="650"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!<ref refid="group__libssh__pki_1ga79010baa7b7ca9d4467910ff863e669d" kindref="member">ssh_key_algorithm_allowed</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>,<sp/>sig_type_c))<sp/>{</highlight></codeline>
<codeline lineno="651"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="priv_8h_1a55177b3e8db90ca9adb435c44281963c" kindref="member">ssh_set_error</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>,<sp/><ref refid="libssh_8h_1a036b2b00fb04337a4d06d719d1b62be1ad1339fb4b92a9d25bdb99df5de5c4f88" kindref="member">SSH_REQUEST_DENIED</ref>,</highlight></codeline>
<codeline lineno="652"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;The<sp/>key<sp/>algorithm<sp/>&apos;%s&apos;<sp/>is<sp/>not<sp/>allowed<sp/>to<sp/>be<sp/>used<sp/>by&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="653"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;<sp/>PUBLICKEY_ACCEPTED_TYPES<sp/>configuration<sp/>option&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="654"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sig_type_c);</highlight></codeline>
<codeline lineno="655"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="libssh_8h_1a5b35a5038ad8eac4a4e4c00c6239e6e2ac3d2d6d092a7adc147b7f859a0b252d2" kindref="member">SSH_AUTH_DENIED</ref>;</highlight></codeline>
<codeline lineno="656"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="657"><highlight class="normal"></highlight></codeline>
<codeline lineno="658"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="group__libssh__auth_1ga812fb86c3dd4a6245bc7d01beaa9cfe8" kindref="member">ssh_userauth_request_service</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>);</highlight></codeline>
<codeline lineno="659"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>==<sp/><ref refid="libssh_8h_1a9c57e4f6482106336045a4d25a55f28e" kindref="member">SSH_AGAIN</ref>)<sp/>{</highlight></codeline>
<codeline lineno="660"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="libssh_8h_1a5b35a5038ad8eac4a4e4c00c6239e6e2a0f166cff4fa03faf4e4c11ad854a4996" kindref="member">SSH_AUTH_AGAIN</ref>;</highlight></codeline>
<codeline lineno="661"><highlight class="normal"><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>==<sp/><ref refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" kindref="member">SSH_ERROR</ref>)<sp/>{</highlight></codeline>
<codeline lineno="662"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="libssh_8h_1a5b35a5038ad8eac4a4e4c00c6239e6e2a33d82f552d20734c17e770af637e3e17" kindref="member">SSH_AUTH_ERROR</ref>;</highlight></codeline>
<codeline lineno="663"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="664"><highlight class="normal"></highlight></codeline>
<codeline lineno="665"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>get<sp/>public<sp/>key<sp/>or<sp/>cert<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="666"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="group__libssh__pki_1gaadeaf6dc35e99214de0af82c3c431649" kindref="member">ssh_pki_export_pubkey_blob</ref>(<ref refid="curve25519-sha256_0dlibssh_8org_8txt_1a5d18fd02a76effa0a15b1decb554cc12" kindref="member">privkey</ref>,<sp/>&amp;str);</highlight></codeline>
<codeline lineno="667"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>&lt;<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="668"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">goto</highlight><highlight class="normal"><sp/>fail;</highlight></codeline>
<codeline lineno="669"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="670"><highlight class="normal"></highlight></codeline>
<codeline lineno="671"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>request<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="672"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="buffer_8h_1ae17848a86043f0abfc60c1c4f6126ccd" kindref="member">ssh_buffer_pack</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1af0aed60c1e529bbfdcb483fd80bf98a0" kindref="member">out_buffer</ref>,<sp/></highlight><highlight class="stringliteral">&quot;bsssbsS&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="673"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ssh2_8h_1a423ea81df02faff2d59b730af16ac59e" kindref="member">SSH2_MSG_USERAUTH_REQUEST</ref>,</highlight></codeline>
<codeline lineno="674"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="proxy_8c_1a9b20c006bd90a09e1465fb668700e81d" kindref="member">username</ref><sp/>?<sp/><ref refid="proxy_8c_1a9b20c006bd90a09e1465fb668700e81d" kindref="member">username</ref><sp/>:<sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a1c29cf990c1d0df6e1b0971d4f3d1f3e" kindref="member">opts</ref>.<ref refid="structssh__session__struct_1a8ed5d5d3116679fd7b8f2c0e1db92726" kindref="member">username</ref>,</highlight></codeline>
<codeline lineno="675"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;ssh-connection&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="676"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;publickey&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="677"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>1,<sp/></highlight><highlight class="comment">/*<sp/>private<sp/>key<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="678"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sig_type_c,<sp/></highlight><highlight class="comment">/*<sp/>algo<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="679"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>str<sp/></highlight><highlight class="comment">/*<sp/>public<sp/>key<sp/>or<sp/>cert<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="680"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>);</highlight></codeline>
<codeline lineno="681"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>&lt;<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="682"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">goto</highlight><highlight class="normal"><sp/>fail;</highlight></codeline>
<codeline lineno="683"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="684"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="libssh_8h_1a5bc8710c8633117ff449d15489fca051" kindref="member">SSH_STRING_FREE</ref>(str);</highlight></codeline>
<codeline lineno="685"><highlight class="normal"></highlight></codeline>
<codeline lineno="686"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Get<sp/>the<sp/>hash<sp/>type<sp/>to<sp/>be<sp/>used<sp/>in<sp/>the<sp/>signature<sp/>based<sp/>on<sp/>the<sp/>key<sp/>type<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="687"><highlight class="normal"><sp/><sp/><sp/><sp/>hash_type<sp/>=<sp/><ref refid="group__libssh__pki_1ga10eb6e34355baea3a0dd8431188ca790" kindref="member">ssh_key_type_to_hash</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>,<sp/><ref refid="curve25519-sha256_0dlibssh_8org_8txt_1a5d18fd02a76effa0a15b1decb554cc12" kindref="member">privkey</ref>-&gt;type);</highlight></codeline>
<codeline lineno="688"><highlight class="normal"></highlight></codeline>
<codeline lineno="689"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>sign<sp/>the<sp/>buffer<sp/>with<sp/>the<sp/>private<sp/>key<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="690"><highlight class="normal"><sp/><sp/><sp/><sp/>str<sp/>=<sp/><ref refid="group__libssh__pki_1gab366c5e63b468061d201397939bc6a82" kindref="member">ssh_pki_do_sign</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>,<sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1af0aed60c1e529bbfdcb483fd80bf98a0" kindref="member">out_buffer</ref>,<sp/><ref refid="curve25519-sha256_0dlibssh_8org_8txt_1a5d18fd02a76effa0a15b1decb554cc12" kindref="member">privkey</ref>,<sp/>hash_type);</highlight></codeline>
<codeline lineno="691"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(str<sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="692"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">goto</highlight><highlight class="normal"><sp/>fail;</highlight></codeline>
<codeline lineno="693"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="694"><highlight class="normal"></highlight></codeline>
<codeline lineno="695"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="buffer_8h_1a75f9cd3d07f2039b0cd1821a7eb0d7f8" kindref="member">ssh_buffer_add_ssh_string</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1af0aed60c1e529bbfdcb483fd80bf98a0" kindref="member">out_buffer</ref>,<sp/>str);</highlight></codeline>
<codeline lineno="696"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="libssh_8h_1a5bc8710c8633117ff449d15489fca051" kindref="member">SSH_STRING_FREE</ref>(str);</highlight></codeline>
<codeline lineno="697"><highlight class="normal"><sp/><sp/><sp/><sp/>str<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="698"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>&lt;<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="699"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">goto</highlight><highlight class="normal"><sp/>fail;</highlight></codeline>
<codeline lineno="700"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="701"><highlight class="normal"></highlight></codeline>
<codeline lineno="702"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a3d57e01582c0c9099f7f319513321fe8" kindref="member">auth</ref>.<ref refid="structssh__session__struct_1aa859857ac7a99808ffc537e08087e541" kindref="member">current_method</ref><sp/>=<sp/><ref refid="libssh_8h_1aff27d66c1f5ba3871e72b5a61573f44a" kindref="member">SSH_AUTH_METHOD_PUBLICKEY</ref>;</highlight></codeline>
<codeline lineno="703"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a3d57e01582c0c9099f7f319513321fe8" kindref="member">auth</ref>.<ref refid="structssh__session__struct_1af0805877d21d43e81423ead52345c64b" kindref="member">state</ref><sp/>=<sp/><ref refid="auth_8h_1a0d3114986a741a14dc3ac03f7d8eafefa867ade5fd7a5853b32a1935a47bd9776" kindref="member">SSH_AUTH_STATE_PUBKEY_AUTH_SENT</ref>;</highlight></codeline>
<codeline lineno="704"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a5552665043089000065df39c5a5a7094" kindref="member">pending_call_state</ref><sp/>=<sp/><ref refid="session_8h_1abb7a4342b889601983497b3f094957e1a85ca960326af12df3bd2abca946f1617" kindref="member">SSH_PENDING_CALL_AUTH_PUBKEY</ref>;</highlight></codeline>
<codeline lineno="705"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="packet_8h_1a7e6c7ed74c23ace432476aa8a6841140" kindref="member">ssh_packet_send</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>);</highlight></codeline>
<codeline lineno="706"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>==<sp/><ref refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" kindref="member">SSH_ERROR</ref>)<sp/>{</highlight></codeline>
<codeline lineno="707"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="libssh_8h_1a5b35a5038ad8eac4a4e4c00c6239e6e2a33d82f552d20734c17e770af637e3e17" kindref="member">SSH_AUTH_ERROR</ref>;</highlight></codeline>
<codeline lineno="708"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="709"><highlight class="normal"></highlight></codeline>
<codeline lineno="710"><highlight class="normal">pending:</highlight></codeline>
<codeline lineno="711"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="group__libssh__auth_1gabff6b3898d3bf45b62cc3ed3774eaa83" kindref="member">ssh_userauth_get_response</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>);</highlight></codeline>
<codeline lineno="712"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>!=<sp/><ref refid="libssh_8h_1a5b35a5038ad8eac4a4e4c00c6239e6e2a0f166cff4fa03faf4e4c11ad854a4996" kindref="member">SSH_AUTH_AGAIN</ref>)<sp/>{</highlight></codeline>
<codeline lineno="713"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a5552665043089000065df39c5a5a7094" kindref="member">pending_call_state</ref><sp/>=<sp/><ref refid="session_8h_1abb7a4342b889601983497b3f094957e1a33be3f7cd03fe7fced1eeacd369cad94" kindref="member">SSH_PENDING_CALL_NONE</ref>;</highlight></codeline>
<codeline lineno="714"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="715"><highlight class="normal"></highlight></codeline>
<codeline lineno="716"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref>;</highlight></codeline>
<codeline lineno="717"><highlight class="normal">fail:</highlight></codeline>
<codeline lineno="718"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="libssh_8h_1a5bc8710c8633117ff449d15489fca051" kindref="member">SSH_STRING_FREE</ref>(str);</highlight></codeline>
<codeline lineno="719"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="priv_8h_1ae280c413c792e04237f000841ac8ce44" kindref="member">ssh_set_error_oom</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>);</highlight></codeline>
<codeline lineno="720"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="libssh_8h_1ac8802ff7f5348d0145dab5242623f740" kindref="member">ssh_buffer_reinit</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1af0aed60c1e529bbfdcb483fd80bf98a0" kindref="member">out_buffer</ref>);</highlight></codeline>
<codeline lineno="721"><highlight class="normal"></highlight></codeline>
<codeline lineno="722"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="libssh_8h_1a5b35a5038ad8eac4a4e4c00c6239e6e2a33d82f552d20734c17e770af637e3e17" kindref="member">SSH_AUTH_ERROR</ref>;</highlight></codeline>
<codeline lineno="723"><highlight class="normal">}</highlight></codeline>
<codeline lineno="724"><highlight class="normal"></highlight></codeline>
<codeline lineno="725"><highlight class="normal"></highlight><highlight class="preprocessor">#ifndef<sp/>_WIN32</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="726" refid="group__libssh__auth_1ga691078be9ea2a55fed97c7488395af5a" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="group__libssh__auth_1ga691078be9ea2a55fed97c7488395af5a" kindref="member">ssh_userauth_agent_publickey</ref>(<ref refid="structssh__session__struct" kindref="compound">ssh_session</ref><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>,</highlight></codeline>
<codeline lineno="727"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*<ref refid="proxy_8c_1a9b20c006bd90a09e1465fb668700e81d" kindref="member">username</ref>,</highlight></codeline>
<codeline lineno="728"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structssh__key__struct" kindref="compound">ssh_key</ref><sp/><ref refid="curve25519-sha256_0dlibssh_8org_8txt_1a555595207a1407936ebb264ebdbf434c" kindref="member">pubkey</ref>)</highlight></codeline>
<codeline lineno="729"><highlight class="normal">{</highlight></codeline>
<codeline lineno="730"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="structssh__string__struct" kindref="compound">ssh_string</ref><sp/>pubkey_s<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="731"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="structssh__string__struct" kindref="compound">ssh_string</ref><sp/>sig_blob<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="732"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*sig_type_c<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="733"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref>;</highlight></codeline>
<codeline lineno="734"><highlight class="normal"></highlight></codeline>
<codeline lineno="735"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">switch</highlight><highlight class="normal">(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a5552665043089000065df39c5a5a7094" kindref="member">pending_call_state</ref>)<sp/>{</highlight></codeline>
<codeline lineno="736"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="session_8h_1abb7a4342b889601983497b3f094957e1a33be3f7cd03fe7fced1eeacd369cad94" kindref="member">SSH_PENDING_CALL_NONE</ref>:</highlight></codeline>
<codeline lineno="737"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="738"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="session_8h_1abb7a4342b889601983497b3f094957e1a099a4746aa5830db8c84495e1e0481e4" kindref="member">SSH_PENDING_CALL_AUTH_AGENT</ref>:</highlight></codeline>
<codeline lineno="739"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">goto</highlight><highlight class="normal"><sp/>pending;</highlight></codeline>
<codeline lineno="740"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">default</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="741"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="priv_8h_1a55177b3e8db90ca9adb435c44281963c" kindref="member">ssh_set_error</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>,</highlight></codeline>
<codeline lineno="742"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="libssh_8h_1a036b2b00fb04337a4d06d719d1b62be1a86ff0b2e8da6ad8628efc556b6ce1887" kindref="member">SSH_FATAL</ref>,</highlight></codeline>
<codeline lineno="743"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Bad<sp/>call<sp/>during<sp/>pending<sp/>SSH<sp/>call<sp/>in<sp/>ssh_userauth_try_publickey&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="744"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" kindref="member">SSH_ERROR</ref>;</highlight></codeline>
<codeline lineno="745"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="746"><highlight class="normal"></highlight></codeline>
<codeline lineno="747"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="group__libssh__auth_1ga812fb86c3dd4a6245bc7d01beaa9cfe8" kindref="member">ssh_userauth_request_service</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>);</highlight></codeline>
<codeline lineno="748"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>==<sp/><ref refid="libssh_8h_1a9c57e4f6482106336045a4d25a55f28e" kindref="member">SSH_AGAIN</ref>)<sp/>{</highlight></codeline>
<codeline lineno="749"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="libssh_8h_1a5b35a5038ad8eac4a4e4c00c6239e6e2a0f166cff4fa03faf4e4c11ad854a4996" kindref="member">SSH_AUTH_AGAIN</ref>;</highlight></codeline>
<codeline lineno="750"><highlight class="normal"><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>==<sp/><ref refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" kindref="member">SSH_ERROR</ref>)<sp/>{</highlight></codeline>
<codeline lineno="751"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="libssh_8h_1a5b35a5038ad8eac4a4e4c00c6239e6e2a33d82f552d20734c17e770af637e3e17" kindref="member">SSH_AUTH_ERROR</ref>;</highlight></codeline>
<codeline lineno="752"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="753"><highlight class="normal"></highlight></codeline>
<codeline lineno="754"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>public<sp/>key<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="755"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="group__libssh__pki_1gaadeaf6dc35e99214de0af82c3c431649" kindref="member">ssh_pki_export_pubkey_blob</ref>(<ref refid="curve25519-sha256_0dlibssh_8org_8txt_1a555595207a1407936ebb264ebdbf434c" kindref="member">pubkey</ref>,<sp/>&amp;pubkey_s);</highlight></codeline>
<codeline lineno="756"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>&lt;<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="757"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">goto</highlight><highlight class="normal"><sp/>fail;</highlight></codeline>
<codeline lineno="758"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="759"><highlight class="normal"></highlight></codeline>
<codeline lineno="760"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Check<sp/>if<sp/>the<sp/>given<sp/>public<sp/>key<sp/>algorithm<sp/>is<sp/>allowed<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="761"><highlight class="normal"><sp/><sp/><sp/><sp/>sig_type_c<sp/>=<sp/><ref refid="group__libssh__pki_1ga7ad4109947adef7dbe7f9b8d1577cc88" kindref="member">ssh_key_get_signature_algorithm</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>,<sp/><ref refid="curve25519-sha256_0dlibssh_8org_8txt_1a555595207a1407936ebb264ebdbf434c" kindref="member">pubkey</ref>-&gt;type);</highlight></codeline>
<codeline lineno="762"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(sig_type_c<sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="763"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="priv_8h_1a55177b3e8db90ca9adb435c44281963c" kindref="member">ssh_set_error</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>,<sp/><ref refid="libssh_8h_1a036b2b00fb04337a4d06d719d1b62be1ad1339fb4b92a9d25bdb99df5de5c4f88" kindref="member">SSH_REQUEST_DENIED</ref>,</highlight></codeline>
<codeline lineno="764"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Invalid<sp/>key<sp/>type<sp/>(unknown)&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="765"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="libssh_8h_1a5bc8710c8633117ff449d15489fca051" kindref="member">SSH_STRING_FREE</ref>(pubkey_s);</highlight></codeline>
<codeline lineno="766"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="libssh_8h_1a5b35a5038ad8eac4a4e4c00c6239e6e2ac3d2d6d092a7adc147b7f859a0b252d2" kindref="member">SSH_AUTH_DENIED</ref>;</highlight></codeline>
<codeline lineno="767"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="768"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!<ref refid="group__libssh__pki_1ga79010baa7b7ca9d4467910ff863e669d" kindref="member">ssh_key_algorithm_allowed</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>,<sp/>sig_type_c))<sp/>{</highlight></codeline>
<codeline lineno="769"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="priv_8h_1a55177b3e8db90ca9adb435c44281963c" kindref="member">ssh_set_error</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>,<sp/><ref refid="libssh_8h_1a036b2b00fb04337a4d06d719d1b62be1ad1339fb4b92a9d25bdb99df5de5c4f88" kindref="member">SSH_REQUEST_DENIED</ref>,</highlight></codeline>
<codeline lineno="770"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;The<sp/>key<sp/>algorithm<sp/>&apos;%s&apos;<sp/>is<sp/>not<sp/>allowed<sp/>to<sp/>be<sp/>used<sp/>by&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="771"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;<sp/>PUBLICKEY_ACCEPTED_TYPES<sp/>configuration<sp/>option&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="772"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sig_type_c);</highlight></codeline>
<codeline lineno="773"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="libssh_8h_1a5bc8710c8633117ff449d15489fca051" kindref="member">SSH_STRING_FREE</ref>(pubkey_s);</highlight></codeline>
<codeline lineno="774"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="libssh_8h_1a5b35a5038ad8eac4a4e4c00c6239e6e2ac3d2d6d092a7adc147b7f859a0b252d2" kindref="member">SSH_AUTH_DENIED</ref>;</highlight></codeline>
<codeline lineno="775"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="776"><highlight class="normal"></highlight></codeline>
<codeline lineno="777"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>request<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="778"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="buffer_8h_1ae17848a86043f0abfc60c1c4f6126ccd" kindref="member">ssh_buffer_pack</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1af0aed60c1e529bbfdcb483fd80bf98a0" kindref="member">out_buffer</ref>,<sp/></highlight><highlight class="stringliteral">&quot;bsssbsS&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="779"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ssh2_8h_1a423ea81df02faff2d59b730af16ac59e" kindref="member">SSH2_MSG_USERAUTH_REQUEST</ref>,</highlight></codeline>
<codeline lineno="780"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="proxy_8c_1a9b20c006bd90a09e1465fb668700e81d" kindref="member">username</ref><sp/>?<sp/><ref refid="proxy_8c_1a9b20c006bd90a09e1465fb668700e81d" kindref="member">username</ref><sp/>:<sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a1c29cf990c1d0df6e1b0971d4f3d1f3e" kindref="member">opts</ref>.<ref refid="structssh__session__struct_1a8ed5d5d3116679fd7b8f2c0e1db92726" kindref="member">username</ref>,</highlight></codeline>
<codeline lineno="781"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;ssh-connection&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="782"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;publickey&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="783"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>1,<sp/></highlight><highlight class="comment">/*<sp/>private<sp/>key<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="784"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sig_type_c,<sp/></highlight><highlight class="comment">/*<sp/>algo<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="785"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pubkey_s<sp/></highlight><highlight class="comment">/*<sp/>public<sp/>key<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="786"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>);</highlight></codeline>
<codeline lineno="787"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="libssh_8h_1a5bc8710c8633117ff449d15489fca051" kindref="member">SSH_STRING_FREE</ref>(pubkey_s);</highlight></codeline>
<codeline lineno="788"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>&lt;<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="789"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">goto</highlight><highlight class="normal"><sp/>fail;</highlight></codeline>
<codeline lineno="790"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="791"><highlight class="normal"></highlight></codeline>
<codeline lineno="792"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>sign<sp/>the<sp/>buffer<sp/>with<sp/>the<sp/>private<sp/>key<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="793"><highlight class="normal"><sp/><sp/><sp/><sp/>sig_blob<sp/>=<sp/><ref refid="group__libssh__pki_1ga030b5e767d97bd26053a5644b083c133" kindref="member">ssh_pki_do_sign_agent</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>,<sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1af0aed60c1e529bbfdcb483fd80bf98a0" kindref="member">out_buffer</ref>,<sp/><ref refid="curve25519-sha256_0dlibssh_8org_8txt_1a555595207a1407936ebb264ebdbf434c" kindref="member">pubkey</ref>);</highlight></codeline>
<codeline lineno="794"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(sig_blob<sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="795"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">goto</highlight><highlight class="normal"><sp/>fail;</highlight></codeline>
<codeline lineno="796"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="797"><highlight class="normal"></highlight></codeline>
<codeline lineno="798"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="buffer_8h_1a75f9cd3d07f2039b0cd1821a7eb0d7f8" kindref="member">ssh_buffer_add_ssh_string</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1af0aed60c1e529bbfdcb483fd80bf98a0" kindref="member">out_buffer</ref>,<sp/>sig_blob);</highlight></codeline>
<codeline lineno="799"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="libssh_8h_1a5bc8710c8633117ff449d15489fca051" kindref="member">SSH_STRING_FREE</ref>(sig_blob);</highlight></codeline>
<codeline lineno="800"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>&lt;<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="801"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">goto</highlight><highlight class="normal"><sp/>fail;</highlight></codeline>
<codeline lineno="802"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="803"><highlight class="normal"></highlight></codeline>
<codeline lineno="804"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a3d57e01582c0c9099f7f319513321fe8" kindref="member">auth</ref>.<ref refid="structssh__session__struct_1aa859857ac7a99808ffc537e08087e541" kindref="member">current_method</ref><sp/>=<sp/><ref refid="libssh_8h_1aff27d66c1f5ba3871e72b5a61573f44a" kindref="member">SSH_AUTH_METHOD_PUBLICKEY</ref>;</highlight></codeline>
<codeline lineno="805"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a3d57e01582c0c9099f7f319513321fe8" kindref="member">auth</ref>.<ref refid="structssh__session__struct_1af0805877d21d43e81423ead52345c64b" kindref="member">state</ref><sp/>=<sp/><ref refid="auth_8h_1a0d3114986a741a14dc3ac03f7d8eafefa867ade5fd7a5853b32a1935a47bd9776" kindref="member">SSH_AUTH_STATE_PUBKEY_AUTH_SENT</ref>;</highlight></codeline>
<codeline lineno="806"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a5552665043089000065df39c5a5a7094" kindref="member">pending_call_state</ref><sp/>=<sp/><ref refid="session_8h_1abb7a4342b889601983497b3f094957e1a099a4746aa5830db8c84495e1e0481e4" kindref="member">SSH_PENDING_CALL_AUTH_AGENT</ref>;</highlight></codeline>
<codeline lineno="807"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="packet_8h_1a7e6c7ed74c23ace432476aa8a6841140" kindref="member">ssh_packet_send</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>);</highlight></codeline>
<codeline lineno="808"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>==<sp/><ref refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" kindref="member">SSH_ERROR</ref>)<sp/>{</highlight></codeline>
<codeline lineno="809"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="libssh_8h_1a5b35a5038ad8eac4a4e4c00c6239e6e2a33d82f552d20734c17e770af637e3e17" kindref="member">SSH_AUTH_ERROR</ref>;</highlight></codeline>
<codeline lineno="810"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="811"><highlight class="normal"></highlight></codeline>
<codeline lineno="812"><highlight class="normal">pending:</highlight></codeline>
<codeline lineno="813"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="group__libssh__auth_1gabff6b3898d3bf45b62cc3ed3774eaa83" kindref="member">ssh_userauth_get_response</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>);</highlight></codeline>
<codeline lineno="814"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>!=<sp/><ref refid="libssh_8h_1a5b35a5038ad8eac4a4e4c00c6239e6e2a0f166cff4fa03faf4e4c11ad854a4996" kindref="member">SSH_AUTH_AGAIN</ref>)<sp/>{</highlight></codeline>
<codeline lineno="815"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a5552665043089000065df39c5a5a7094" kindref="member">pending_call_state</ref><sp/>=<sp/><ref refid="session_8h_1abb7a4342b889601983497b3f094957e1a33be3f7cd03fe7fced1eeacd369cad94" kindref="member">SSH_PENDING_CALL_NONE</ref>;</highlight></codeline>
<codeline lineno="816"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="817"><highlight class="normal"></highlight></codeline>
<codeline lineno="818"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref>;</highlight></codeline>
<codeline lineno="819"><highlight class="normal">fail:</highlight></codeline>
<codeline lineno="820"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="priv_8h_1ae280c413c792e04237f000841ac8ce44" kindref="member">ssh_set_error_oom</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>);</highlight></codeline>
<codeline lineno="821"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="libssh_8h_1ac8802ff7f5348d0145dab5242623f740" kindref="member">ssh_buffer_reinit</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1af0aed60c1e529bbfdcb483fd80bf98a0" kindref="member">out_buffer</ref>);</highlight></codeline>
<codeline lineno="822"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="libssh_8h_1a5bc8710c8633117ff449d15489fca051" kindref="member">SSH_STRING_FREE</ref>(pubkey_s);</highlight></codeline>
<codeline lineno="823"><highlight class="normal"></highlight></codeline>
<codeline lineno="824"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="libssh_8h_1a5b35a5038ad8eac4a4e4c00c6239e6e2a33d82f552d20734c17e770af637e3e17" kindref="member">SSH_AUTH_ERROR</ref>;</highlight></codeline>
<codeline lineno="825"><highlight class="normal">}</highlight></codeline>
<codeline lineno="826"><highlight class="normal"></highlight></codeline>
<codeline lineno="827" refid="group__libssh__auth_1ga288d00c21fe2d652607792379d90b7cf" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">enum</highlight><highlight class="normal"><sp/><ref refid="group__libssh__auth_1ga288d00c21fe2d652607792379d90b7cf" kindref="member">ssh_agent_state_e</ref><sp/>{</highlight></codeline>
<codeline lineno="828" refid="group__libssh__auth_1gga288d00c21fe2d652607792379d90b7cfa5965e2ae4d759e633b54e038783fb118" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="group__libssh__auth_1gga288d00c21fe2d652607792379d90b7cfa5965e2ae4d759e633b54e038783fb118" kindref="member">SSH_AGENT_STATE_NONE</ref><sp/>=<sp/>0,</highlight></codeline>
<codeline lineno="829" refid="group__libssh__auth_1gga288d00c21fe2d652607792379d90b7cfa2c08668800684d1e8b900b73b6681bb6" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="group__libssh__auth_1gga288d00c21fe2d652607792379d90b7cfa2c08668800684d1e8b900b73b6681bb6" kindref="member">SSH_AGENT_STATE_PUBKEY</ref>,</highlight></codeline>
<codeline lineno="830"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="group__libssh__auth_1gga288d00c21fe2d652607792379d90b7cfaadc9127e305c239a7e60de4bb569c89d" kindref="member">SSH_AGENT_STATE_AUTH</ref></highlight></codeline>
<codeline lineno="831" refid="group__libssh__auth_1gga288d00c21fe2d652607792379d90b7cfaadc9127e305c239a7e60de4bb569c89d" refkind="member"><highlight class="normal">};</highlight></codeline>
<codeline lineno="832"><highlight class="normal"></highlight></codeline>
<codeline lineno="833" refid="structssh__agent__state__struct" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">struct<sp/></highlight><highlight class="normal"><ref refid="structssh__agent__state__struct" kindref="compound">ssh_agent_state_struct</ref><sp/>{</highlight></codeline>
<codeline lineno="834"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">enum</highlight><highlight class="normal"><sp/><ref refid="group__libssh__auth_1ga288d00c21fe2d652607792379d90b7cf" kindref="member">ssh_agent_state_e</ref><sp/><ref refid="structssh__agent__state__struct_1aff904ec87c3104dfb7bb6915ef9a88b6" kindref="member">state</ref>;</highlight></codeline>
<codeline lineno="835" refid="structssh__agent__state__struct_1afa9e6b41763fccd5322c84555862d316" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="structssh__key__struct" kindref="compound">ssh_key</ref><sp/><ref refid="structssh__agent__state__struct_1afa9e6b41763fccd5322c84555862d316" kindref="member">pubkey</ref>;</highlight></codeline>
<codeline lineno="836" refid="structssh__agent__state__struct_1a046c39264f78a0ab557bad16b8951572" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*<ref refid="structssh__agent__state__struct_1a046c39264f78a0ab557bad16b8951572" kindref="member">comment</ref>;</highlight></codeline>
<codeline lineno="837"><highlight class="normal">};</highlight></codeline>
<codeline lineno="838"><highlight class="normal"></highlight></codeline>
<codeline lineno="839"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>Internal<sp/>function<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="840" refid="group__libssh__auth_1ga7d4487088981015ec0b1c66befc1c7dd" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="group__libssh__auth_1ga7d4487088981015ec0b1c66befc1c7dd" kindref="member">ssh_agent_state_free</ref>(</highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>*data)<sp/>{</highlight></codeline>
<codeline lineno="841"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">struct<sp/></highlight><highlight class="normal"><ref refid="structssh__agent__state__struct" kindref="compound">ssh_agent_state_struct</ref><sp/>*<ref refid="structssh__agent__state__struct_1aff904ec87c3104dfb7bb6915ef9a88b6" kindref="member">state</ref><sp/>=<sp/>data;</highlight></codeline>
<codeline lineno="842"><highlight class="normal"></highlight></codeline>
<codeline lineno="843"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="structssh__agent__state__struct_1aff904ec87c3104dfb7bb6915ef9a88b6" kindref="member">state</ref>)<sp/>{</highlight></codeline>
<codeline lineno="844"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="libssh_8h_1a892d8251a4be8c99d31d0bb599174c0c" kindref="member">SSH_STRING_FREE_CHAR</ref>(<ref refid="structssh__agent__state__struct_1aff904ec87c3104dfb7bb6915ef9a88b6" kindref="member">state</ref>-&gt;comment);</highlight></codeline>
<codeline lineno="845"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="group__libssh__pki_1ga08808beb83a42ccd6f1c710ddeb1b4c2" kindref="member">ssh_key_free</ref>(<ref refid="structssh__agent__state__struct_1aff904ec87c3104dfb7bb6915ef9a88b6" kindref="member">state</ref>-&gt;pubkey);</highlight></codeline>
<codeline lineno="846"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>free<sp/>(<ref refid="structssh__agent__state__struct_1aff904ec87c3104dfb7bb6915ef9a88b6" kindref="member">state</ref>);</highlight></codeline>
<codeline lineno="847"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="848"><highlight class="normal">}</highlight></codeline>
<codeline lineno="849"><highlight class="normal"></highlight></codeline>
<codeline lineno="872" refid="group__libssh__auth_1ga7d84f3f89f65455b80b10e2643d80719" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="group__libssh__auth_1ga7d84f3f89f65455b80b10e2643d80719" kindref="member">ssh_userauth_agent</ref>(<ref refid="structssh__session__struct" kindref="compound">ssh_session</ref><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>,</highlight></codeline>
<codeline lineno="873"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*<ref refid="proxy_8c_1a9b20c006bd90a09e1465fb668700e81d" kindref="member">username</ref>)<sp/>{</highlight></codeline>
<codeline lineno="874"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="libssh_8h_1a5b35a5038ad8eac4a4e4c00c6239e6e2a33d82f552d20734c17e770af637e3e17" kindref="member">SSH_AUTH_ERROR</ref>;</highlight></codeline>
<codeline lineno="875"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">struct<sp/></highlight><highlight class="normal"><ref refid="structssh__agent__state__struct" kindref="compound">ssh_agent_state_struct</ref><sp/>*<ref refid="structssh__agent__state__struct_1aff904ec87c3104dfb7bb6915ef9a88b6" kindref="member">state</ref>;</highlight></codeline>
<codeline lineno="876"><highlight class="normal"></highlight></codeline>
<codeline lineno="877"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref><sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="878"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="libssh_8h_1a5b35a5038ad8eac4a4e4c00c6239e6e2a33d82f552d20734c17e770af637e3e17" kindref="member">SSH_AUTH_ERROR</ref>;</highlight></codeline>
<codeline lineno="879"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="880"><highlight class="normal"></highlight></codeline>
<codeline lineno="881"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!<ref refid="agent_8h_1a8ecb166e690f4b0bf35af42184f28407" kindref="member">ssh_agent_is_running</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>))<sp/>{</highlight></codeline>
<codeline lineno="882"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="libssh_8h_1a5b35a5038ad8eac4a4e4c00c6239e6e2ac3d2d6d092a7adc147b7f859a0b252d2" kindref="member">SSH_AUTH_DENIED</ref>;</highlight></codeline>
<codeline lineno="883"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="884"><highlight class="normal"></highlight></codeline>
<codeline lineno="885"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a5c92e3c7c116f8162038fdca66361641" kindref="member">agent_state</ref>)<sp/>{</highlight></codeline>
<codeline lineno="886"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a5c92e3c7c116f8162038fdca66361641" kindref="member">agent_state</ref><sp/>=<sp/>malloc(</highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(</highlight><highlight class="keyword">struct</highlight><highlight class="normal"><sp/><ref refid="structssh__agent__state__struct" kindref="compound">ssh_agent_state_struct</ref>));</highlight></codeline>
<codeline lineno="887"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a5c92e3c7c116f8162038fdca66361641" kindref="member">agent_state</ref>)<sp/>{</highlight></codeline>
<codeline lineno="888"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="priv_8h_1ae280c413c792e04237f000841ac8ce44" kindref="member">ssh_set_error_oom</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>);</highlight></codeline>
<codeline lineno="889"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="libssh_8h_1a5b35a5038ad8eac4a4e4c00c6239e6e2a33d82f552d20734c17e770af637e3e17" kindref="member">SSH_AUTH_ERROR</ref>;</highlight></codeline>
<codeline lineno="890"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="891"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="priv_8h_1a65e0a55b6af58e00b0a584d665af60ab" kindref="member">ZERO_STRUCTP</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a5c92e3c7c116f8162038fdca66361641" kindref="member">agent_state</ref>);</highlight></codeline>
<codeline lineno="892"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a5c92e3c7c116f8162038fdca66361641" kindref="member">agent_state</ref>-&gt;<ref refid="structssh__agent__state__struct_1aff904ec87c3104dfb7bb6915ef9a88b6" kindref="member">state</ref>=<ref refid="group__libssh__auth_1gga288d00c21fe2d652607792379d90b7cfa5965e2ae4d759e633b54e038783fb118" kindref="member">SSH_AGENT_STATE_NONE</ref>;</highlight></codeline>
<codeline lineno="893"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="894"><highlight class="normal"></highlight></codeline>
<codeline lineno="895"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="structssh__agent__state__struct_1aff904ec87c3104dfb7bb6915ef9a88b6" kindref="member">state</ref><sp/>=<sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a5c92e3c7c116f8162038fdca66361641" kindref="member">agent_state</ref>;</highlight></codeline>
<codeline lineno="896"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="structssh__agent__state__struct_1aff904ec87c3104dfb7bb6915ef9a88b6" kindref="member">state</ref>-&gt;pubkey<sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="897"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structssh__agent__state__struct_1aff904ec87c3104dfb7bb6915ef9a88b6" kindref="member">state</ref>-&gt;pubkey<sp/>=<sp/><ref refid="agent_8h_1a470bb8d667532292562a8567cbd708de" kindref="member">ssh_agent_get_first_ident</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>,<sp/>&amp;<ref refid="structssh__agent__state__struct_1aff904ec87c3104dfb7bb6915ef9a88b6" kindref="member">state</ref>-&gt;comment);</highlight></codeline>
<codeline lineno="898"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="899"><highlight class="normal"></highlight></codeline>
<codeline lineno="900"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="structssh__agent__state__struct_1aff904ec87c3104dfb7bb6915ef9a88b6" kindref="member">state</ref>-&gt;pubkey<sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="901"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="libssh_8h_1a5b35a5038ad8eac4a4e4c00c6239e6e2ac3d2d6d092a7adc147b7f859a0b252d2" kindref="member">SSH_AUTH_DENIED</ref>;</highlight></codeline>
<codeline lineno="902"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="903"><highlight class="normal"></highlight></codeline>
<codeline lineno="904"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>(<ref refid="structssh__agent__state__struct_1aff904ec87c3104dfb7bb6915ef9a88b6" kindref="member">state</ref>-&gt;pubkey<sp/>!=<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="905"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="structssh__agent__state__struct_1aff904ec87c3104dfb7bb6915ef9a88b6" kindref="member">state</ref>-&gt;state<sp/>==<sp/><ref refid="group__libssh__auth_1gga288d00c21fe2d652607792379d90b7cfa5965e2ae4d759e633b54e038783fb118" kindref="member">SSH_AGENT_STATE_NONE</ref>)<sp/>{</highlight></codeline>
<codeline lineno="906"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="priv_8h_1aa21fd8a7a609329603b7b16da7939fca" kindref="member">SSH_LOG</ref>(<ref refid="libssh_8h_1a5e4247396f11fdc228d356a408c81715" kindref="member">SSH_LOG_DEBUG</ref>,</highlight></codeline>
<codeline lineno="907"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Trying<sp/>identity<sp/>%s&quot;</highlight><highlight class="normal">,<sp/><ref refid="structssh__agent__state__struct_1aff904ec87c3104dfb7bb6915ef9a88b6" kindref="member">state</ref>-&gt;comment);</highlight></codeline>
<codeline lineno="908"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="909"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="structssh__agent__state__struct_1aff904ec87c3104dfb7bb6915ef9a88b6" kindref="member">state</ref>-&gt;state<sp/>==<sp/><ref refid="group__libssh__auth_1gga288d00c21fe2d652607792379d90b7cfa5965e2ae4d759e633b54e038783fb118" kindref="member">SSH_AGENT_STATE_NONE</ref><sp/>||</highlight></codeline>
<codeline lineno="910"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structssh__agent__state__struct_1aff904ec87c3104dfb7bb6915ef9a88b6" kindref="member">state</ref>-&gt;state<sp/>==<sp/><ref refid="group__libssh__auth_1gga288d00c21fe2d652607792379d90b7cfa2c08668800684d1e8b900b73b6681bb6" kindref="member">SSH_AGENT_STATE_PUBKEY</ref>)<sp/>{</highlight></codeline>
<codeline lineno="911"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="group__libssh__auth_1ga592f673c4d417a6a46cd4876ac8287aa" kindref="member">ssh_userauth_try_publickey</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>,<sp/><ref refid="proxy_8c_1a9b20c006bd90a09e1465fb668700e81d" kindref="member">username</ref>,<sp/><ref refid="structssh__agent__state__struct_1aff904ec87c3104dfb7bb6915ef9a88b6" kindref="member">state</ref>-&gt;pubkey);</highlight></codeline>
<codeline lineno="912"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>==<sp/><ref refid="libssh_8h_1a5b35a5038ad8eac4a4e4c00c6239e6e2a33d82f552d20734c17e770af637e3e17" kindref="member">SSH_AUTH_ERROR</ref>)<sp/>{</highlight></codeline>
<codeline lineno="913"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="group__libssh__auth_1ga7d4487088981015ec0b1c66befc1c7dd" kindref="member">ssh_agent_state_free</ref><sp/>(<ref refid="structssh__agent__state__struct_1aff904ec87c3104dfb7bb6915ef9a88b6" kindref="member">state</ref>);</highlight></codeline>
<codeline lineno="914"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a5c92e3c7c116f8162038fdca66361641" kindref="member">agent_state</ref><sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="915"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref>;</highlight></codeline>
<codeline lineno="916"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>==<sp/><ref refid="libssh_8h_1a5b35a5038ad8eac4a4e4c00c6239e6e2a0f166cff4fa03faf4e4c11ad854a4996" kindref="member">SSH_AUTH_AGAIN</ref>)<sp/>{</highlight></codeline>
<codeline lineno="917"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structssh__agent__state__struct_1aff904ec87c3104dfb7bb6915ef9a88b6" kindref="member">state</ref>-&gt;state<sp/>=<sp/><ref refid="group__libssh__auth_1gga288d00c21fe2d652607792379d90b7cfa2c08668800684d1e8b900b73b6681bb6" kindref="member">SSH_AGENT_STATE_PUBKEY</ref>;</highlight></codeline>
<codeline lineno="918"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref>;</highlight></codeline>
<codeline lineno="919"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>!=<sp/><ref refid="libssh_8h_1a5b35a5038ad8eac4a4e4c00c6239e6e2ab145398ebf554c3cc5d6acfb241c5235" kindref="member">SSH_AUTH_SUCCESS</ref>)<sp/>{</highlight></codeline>
<codeline lineno="920"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="priv_8h_1aa21fd8a7a609329603b7b16da7939fca" kindref="member">SSH_LOG</ref>(<ref refid="libssh_8h_1a5e4247396f11fdc228d356a408c81715" kindref="member">SSH_LOG_DEBUG</ref>,</highlight></codeline>
<codeline lineno="921"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Public<sp/>key<sp/>of<sp/>%s<sp/>refused<sp/>by<sp/>server&quot;</highlight><highlight class="normal">,<sp/><ref refid="structssh__agent__state__struct_1aff904ec87c3104dfb7bb6915ef9a88b6" kindref="member">state</ref>-&gt;comment);</highlight></codeline>
<codeline lineno="922"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="libssh_8h_1a892d8251a4be8c99d31d0bb599174c0c" kindref="member">SSH_STRING_FREE_CHAR</ref>(<ref refid="structssh__agent__state__struct_1aff904ec87c3104dfb7bb6915ef9a88b6" kindref="member">state</ref>-&gt;comment);</highlight></codeline>
<codeline lineno="923"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structssh__agent__state__struct_1aff904ec87c3104dfb7bb6915ef9a88b6" kindref="member">state</ref>-&gt;comment<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="924"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="group__libssh__pki_1ga08808beb83a42ccd6f1c710ddeb1b4c2" kindref="member">ssh_key_free</ref>(<ref refid="structssh__agent__state__struct_1aff904ec87c3104dfb7bb6915ef9a88b6" kindref="member">state</ref>-&gt;pubkey);</highlight></codeline>
<codeline lineno="925"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structssh__agent__state__struct_1aff904ec87c3104dfb7bb6915ef9a88b6" kindref="member">state</ref>-&gt;pubkey<sp/>=<sp/><ref refid="agent_8h_1a730a3c31e6bef0b7f88f0061dc5deb3f" kindref="member">ssh_agent_get_next_ident</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>,<sp/>&amp;<ref refid="structssh__agent__state__struct_1aff904ec87c3104dfb7bb6915ef9a88b6" kindref="member">state</ref>-&gt;comment);</highlight></codeline>
<codeline lineno="926"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structssh__agent__state__struct_1aff904ec87c3104dfb7bb6915ef9a88b6" kindref="member">state</ref>-&gt;state<sp/>=<sp/><ref refid="group__libssh__auth_1gga288d00c21fe2d652607792379d90b7cfa5965e2ae4d759e633b54e038783fb118" kindref="member">SSH_AGENT_STATE_NONE</ref>;</highlight></codeline>
<codeline lineno="927"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">continue</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="928"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="929"><highlight class="normal"></highlight></codeline>
<codeline lineno="930"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="priv_8h_1aa21fd8a7a609329603b7b16da7939fca" kindref="member">SSH_LOG</ref>(<ref refid="libssh_8h_1a5e4247396f11fdc228d356a408c81715" kindref="member">SSH_LOG_DEBUG</ref>,</highlight></codeline>
<codeline lineno="931"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Public<sp/>key<sp/>of<sp/>%s<sp/>accepted<sp/>by<sp/>server&quot;</highlight><highlight class="normal">,<sp/><ref refid="structssh__agent__state__struct_1aff904ec87c3104dfb7bb6915ef9a88b6" kindref="member">state</ref>-&gt;comment);</highlight></codeline>
<codeline lineno="932"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structssh__agent__state__struct_1aff904ec87c3104dfb7bb6915ef9a88b6" kindref="member">state</ref>-&gt;state<sp/>=<sp/><ref refid="group__libssh__auth_1gga288d00c21fe2d652607792379d90b7cfaadc9127e305c239a7e60de4bb569c89d" kindref="member">SSH_AGENT_STATE_AUTH</ref>;</highlight></codeline>
<codeline lineno="933"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="934"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="structssh__agent__state__struct_1aff904ec87c3104dfb7bb6915ef9a88b6" kindref="member">state</ref>-&gt;state<sp/>==<sp/><ref refid="group__libssh__auth_1gga288d00c21fe2d652607792379d90b7cfaadc9127e305c239a7e60de4bb569c89d" kindref="member">SSH_AGENT_STATE_AUTH</ref>)<sp/>{</highlight></codeline>
<codeline lineno="935"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="group__libssh__auth_1ga691078be9ea2a55fed97c7488395af5a" kindref="member">ssh_userauth_agent_publickey</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>,<sp/><ref refid="proxy_8c_1a9b20c006bd90a09e1465fb668700e81d" kindref="member">username</ref>,<sp/><ref refid="structssh__agent__state__struct_1aff904ec87c3104dfb7bb6915ef9a88b6" kindref="member">state</ref>-&gt;pubkey);</highlight></codeline>
<codeline lineno="936"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>==<sp/><ref refid="libssh_8h_1a5b35a5038ad8eac4a4e4c00c6239e6e2a0f166cff4fa03faf4e4c11ad854a4996" kindref="member">SSH_AUTH_AGAIN</ref>)</highlight></codeline>
<codeline lineno="937"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref>;</highlight></codeline>
<codeline lineno="938"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="libssh_8h_1a892d8251a4be8c99d31d0bb599174c0c" kindref="member">SSH_STRING_FREE_CHAR</ref>(<ref refid="structssh__agent__state__struct_1aff904ec87c3104dfb7bb6915ef9a88b6" kindref="member">state</ref>-&gt;comment);</highlight></codeline>
<codeline lineno="939"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structssh__agent__state__struct_1aff904ec87c3104dfb7bb6915ef9a88b6" kindref="member">state</ref>-&gt;comment<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="940"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>==<sp/><ref refid="libssh_8h_1a5b35a5038ad8eac4a4e4c00c6239e6e2a33d82f552d20734c17e770af637e3e17" kindref="member">SSH_AUTH_ERROR</ref><sp/>||<sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>==<sp/><ref refid="libssh_8h_1a5b35a5038ad8eac4a4e4c00c6239e6e2a3bb06206cff7b6f818099d6019418eea" kindref="member">SSH_AUTH_PARTIAL</ref>)<sp/>{</highlight></codeline>
<codeline lineno="941"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="group__libssh__auth_1ga7d4487088981015ec0b1c66befc1c7dd" kindref="member">ssh_agent_state_free</ref><sp/>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a5c92e3c7c116f8162038fdca66361641" kindref="member">agent_state</ref>);</highlight></codeline>
<codeline lineno="942"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a5c92e3c7c116f8162038fdca66361641" kindref="member">agent_state</ref><sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="943"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref>;</highlight></codeline>
<codeline lineno="944"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>!=<sp/><ref refid="libssh_8h_1a5b35a5038ad8eac4a4e4c00c6239e6e2ab145398ebf554c3cc5d6acfb241c5235" kindref="member">SSH_AUTH_SUCCESS</ref>)<sp/>{</highlight></codeline>
<codeline lineno="945"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="priv_8h_1aa21fd8a7a609329603b7b16da7939fca" kindref="member">SSH_LOG</ref>(<ref refid="libssh_8h_1a930fb852177813d4718c5d1911568740" kindref="member">SSH_LOG_INFO</ref>,</highlight></codeline>
<codeline lineno="946"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Server<sp/>accepted<sp/>public<sp/>key<sp/>but<sp/>refused<sp/>the<sp/>signature&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="947"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="group__libssh__pki_1ga08808beb83a42ccd6f1c710ddeb1b4c2" kindref="member">ssh_key_free</ref>(<ref refid="structssh__agent__state__struct_1aff904ec87c3104dfb7bb6915ef9a88b6" kindref="member">state</ref>-&gt;pubkey);</highlight></codeline>
<codeline lineno="948"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structssh__agent__state__struct_1aff904ec87c3104dfb7bb6915ef9a88b6" kindref="member">state</ref>-&gt;pubkey<sp/>=<sp/><ref refid="agent_8h_1a730a3c31e6bef0b7f88f0061dc5deb3f" kindref="member">ssh_agent_get_next_ident</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>,<sp/>&amp;<ref refid="structssh__agent__state__struct_1aff904ec87c3104dfb7bb6915ef9a88b6" kindref="member">state</ref>-&gt;comment);</highlight></codeline>
<codeline lineno="949"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structssh__agent__state__struct_1aff904ec87c3104dfb7bb6915ef9a88b6" kindref="member">state</ref>-&gt;state<sp/>=<sp/><ref refid="group__libssh__auth_1gga288d00c21fe2d652607792379d90b7cfa5965e2ae4d759e633b54e038783fb118" kindref="member">SSH_AGENT_STATE_NONE</ref>;</highlight></codeline>
<codeline lineno="950"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">continue</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="951"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="952"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="group__libssh__auth_1ga7d4487088981015ec0b1c66befc1c7dd" kindref="member">ssh_agent_state_free</ref><sp/>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a5c92e3c7c116f8162038fdca66361641" kindref="member">agent_state</ref>);</highlight></codeline>
<codeline lineno="953"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a5c92e3c7c116f8162038fdca66361641" kindref="member">agent_state</ref><sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="954"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="libssh_8h_1a5b35a5038ad8eac4a4e4c00c6239e6e2ab145398ebf554c3cc5d6acfb241c5235" kindref="member">SSH_AUTH_SUCCESS</ref>;</highlight></codeline>
<codeline lineno="955"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="956"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="957"><highlight class="normal"></highlight></codeline>
<codeline lineno="958"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="group__libssh__auth_1ga7d4487088981015ec0b1c66befc1c7dd" kindref="member">ssh_agent_state_free</ref><sp/>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a5c92e3c7c116f8162038fdca66361641" kindref="member">agent_state</ref>);</highlight></codeline>
<codeline lineno="959"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a5c92e3c7c116f8162038fdca66361641" kindref="member">agent_state</ref><sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="960"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref>;</highlight></codeline>
<codeline lineno="961"><highlight class="normal">}</highlight></codeline>
<codeline lineno="962"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="963"><highlight class="normal"></highlight></codeline>
<codeline lineno="964" refid="group__libssh__auth_1gac65f4923889fe6f2b91021872463b4c4" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">enum</highlight><highlight class="normal"><sp/><ref refid="group__libssh__auth_1gac65f4923889fe6f2b91021872463b4c4" kindref="member">ssh_auth_auto_state_e</ref><sp/>{</highlight></codeline>
<codeline lineno="965" refid="group__libssh__auth_1ggac65f4923889fe6f2b91021872463b4c4a7423bce4e2477ab036c8ce272fd7642f" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="group__libssh__auth_1ggac65f4923889fe6f2b91021872463b4c4a7423bce4e2477ab036c8ce272fd7642f" kindref="member">SSH_AUTH_AUTO_STATE_NONE</ref><sp/>=<sp/>0,</highlight></codeline>
<codeline lineno="966" refid="group__libssh__auth_1ggac65f4923889fe6f2b91021872463b4c4a82677b8f55353fe73bdd8ddb9958d367" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="group__libssh__auth_1ggac65f4923889fe6f2b91021872463b4c4a82677b8f55353fe73bdd8ddb9958d367" kindref="member">SSH_AUTH_AUTO_STATE_PUBKEY</ref>,</highlight></codeline>
<codeline lineno="967" refid="group__libssh__auth_1ggac65f4923889fe6f2b91021872463b4c4a0f73343ecb44ed535c5d53cede05485a" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="group__libssh__auth_1ggac65f4923889fe6f2b91021872463b4c4a0f73343ecb44ed535c5d53cede05485a" kindref="member">SSH_AUTH_AUTO_STATE_KEY_IMPORTED</ref>,</highlight></codeline>
<codeline lineno="968"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="group__libssh__auth_1ggac65f4923889fe6f2b91021872463b4c4ad484a042d380c408bc75ef844e8e0e9c" kindref="member">SSH_AUTH_AUTO_STATE_PUBKEY_ACCEPTED</ref></highlight></codeline>
<codeline lineno="969" refid="group__libssh__auth_1ggac65f4923889fe6f2b91021872463b4c4ad484a042d380c408bc75ef844e8e0e9c" refkind="member"><highlight class="normal">};</highlight></codeline>
<codeline lineno="970"><highlight class="normal"></highlight></codeline>
<codeline lineno="971" refid="structssh__auth__auto__state__struct" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">struct<sp/></highlight><highlight class="normal"><ref refid="structssh__auth__auto__state__struct" kindref="compound">ssh_auth_auto_state_struct</ref><sp/>{</highlight></codeline>
<codeline lineno="972"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">enum</highlight><highlight class="normal"><sp/><ref refid="group__libssh__auth_1gac65f4923889fe6f2b91021872463b4c4" kindref="member">ssh_auth_auto_state_e</ref><sp/><ref refid="structssh__auth__auto__state__struct_1ad79845cdd57294bad689bf52b1be697d" kindref="member">state</ref>;</highlight></codeline>
<codeline lineno="973" refid="structssh__auth__auto__state__struct_1a832c9dbe3e68236c57201ddc5f5c54f7" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">struct<sp/></highlight><highlight class="normal"><ref refid="structssh__iterator" kindref="compound">ssh_iterator</ref><sp/>*<ref refid="structssh__auth__auto__state__struct_1a832c9dbe3e68236c57201ddc5f5c54f7" kindref="member">it</ref>;</highlight></codeline>
<codeline lineno="974" refid="structssh__auth__auto__state__struct_1a2ae28a5384510a193150958d9aaa05ec" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="structssh__key__struct" kindref="compound">ssh_key</ref><sp/><ref refid="structssh__auth__auto__state__struct_1a2ae28a5384510a193150958d9aaa05ec" kindref="member">privkey</ref>;</highlight></codeline>
<codeline lineno="975" refid="structssh__auth__auto__state__struct_1acf1b4c368df37ef74e1da78c73321ae6" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="structssh__key__struct" kindref="compound">ssh_key</ref><sp/><ref refid="structssh__auth__auto__state__struct_1acf1b4c368df37ef74e1da78c73321ae6" kindref="member">pubkey</ref>;</highlight></codeline>
<codeline lineno="976"><highlight class="normal">};</highlight></codeline>
<codeline lineno="977"><highlight class="normal"></highlight></codeline>
<codeline lineno="1007" refid="group__libssh__auth_1ga53e6771b250c061463ed98b6e5b6e0af" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="group__libssh__auth_1ga53e6771b250c061463ed98b6e5b6e0af" kindref="member">ssh_userauth_publickey_auto</ref>(<ref refid="structssh__session__struct" kindref="compound">ssh_session</ref><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>,</highlight></codeline>
<codeline lineno="1008"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*<ref refid="proxy_8c_1a9b20c006bd90a09e1465fb668700e81d" kindref="member">username</ref>,</highlight></codeline>
<codeline lineno="1009"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*passphrase)</highlight></codeline>
<codeline lineno="1010"><highlight class="normal">{</highlight></codeline>
<codeline lineno="1011"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="libssh_8h_1a3b54d7be70dcc98a107e41e11000a3e1" kindref="member">ssh_auth_callback</ref><sp/>auth_fn<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="1012"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>*auth_data<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="1013"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">struct<sp/></highlight><highlight class="normal"><ref refid="structssh__auth__auto__state__struct" kindref="compound">ssh_auth_auto_state_struct</ref><sp/>*<ref refid="structssh__auth__auto__state__struct_1ad79845cdd57294bad689bf52b1be697d" kindref="member">state</ref>;</highlight></codeline>
<codeline lineno="1014"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref>;</highlight></codeline>
<codeline lineno="1015"><highlight class="normal"></highlight></codeline>
<codeline lineno="1016"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref><sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="1017"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="libssh_8h_1a5b35a5038ad8eac4a4e4c00c6239e6e2a33d82f552d20734c17e770af637e3e17" kindref="member">SSH_AUTH_ERROR</ref>;</highlight></codeline>
<codeline lineno="1018"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1019"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!<sp/>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a1c29cf990c1d0df6e1b0971d4f3d1f3e" kindref="member">opts</ref>.<ref refid="structssh__session__struct_1a997060832a3419d8fe884d3da855ef4c" kindref="member">flags</ref><sp/>&amp;<sp/><ref refid="session_8h_1a4a21bc2bfa096997458dcfccbda31434" kindref="member">SSH_OPT_FLAG_PUBKEY_AUTH</ref>))<sp/>{</highlight></codeline>
<codeline lineno="1020"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a3d57e01582c0c9099f7f319513321fe8" kindref="member">auth</ref>.<ref refid="structssh__session__struct_1a3e967ac3134cae87dae1f6a794424073" kindref="member">supported_methods</ref><sp/>&amp;=<sp/>~<ref refid="libssh_8h_1aff27d66c1f5ba3871e72b5a61573f44a" kindref="member">SSH_AUTH_METHOD_PUBLICKEY</ref>;</highlight></codeline>
<codeline lineno="1021"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="libssh_8h_1a5b35a5038ad8eac4a4e4c00c6239e6e2ac3d2d6d092a7adc147b7f859a0b252d2" kindref="member">SSH_AUTH_DENIED</ref>;</highlight></codeline>
<codeline lineno="1022"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1023"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1acad23ad6d8bee359da41b9ed0faa6eaa" kindref="member">common</ref>.<ref refid="structssh__common__struct_1a2f42939ea278698d861c7617b7529eb7" kindref="member">callbacks</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1024"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>auth_fn<sp/>=<sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1acad23ad6d8bee359da41b9ed0faa6eaa" kindref="member">common</ref>.<ref refid="structssh__common__struct_1a2f42939ea278698d861c7617b7529eb7" kindref="member">callbacks</ref>-&gt;<ref refid="structssh__callbacks__struct_1a5f79b2d36329d0ce6e9ac2cd3b77b046" kindref="member">auth_function</ref>;</highlight></codeline>
<codeline lineno="1025"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>auth_data<sp/>=<sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1acad23ad6d8bee359da41b9ed0faa6eaa" kindref="member">common</ref>.<ref refid="structssh__common__struct_1a2f42939ea278698d861c7617b7529eb7" kindref="member">callbacks</ref>-&gt;<ref refid="structssh__callbacks__struct_1aa5cdca2ba78d7582d8eff77ef7995700" kindref="member">userdata</ref>;</highlight></codeline>
<codeline lineno="1026"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1027"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a3d57e01582c0c9099f7f319513321fe8" kindref="member">auth</ref>.<ref refid="structssh__session__struct_1a704e97e502aaee91fc79507a3458a87d" kindref="member">auto_state</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1028"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a3d57e01582c0c9099f7f319513321fe8" kindref="member">auth</ref>.<ref refid="structssh__session__struct_1a704e97e502aaee91fc79507a3458a87d" kindref="member">auto_state</ref><sp/>=</highlight></codeline>
<codeline lineno="1029"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>calloc(1,<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(</highlight><highlight class="keyword">struct</highlight><highlight class="normal"><sp/><ref refid="structssh__auth__auto__state__struct" kindref="compound">ssh_auth_auto_state_struct</ref>));</highlight></codeline>
<codeline lineno="1030"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a3d57e01582c0c9099f7f319513321fe8" kindref="member">auth</ref>.<ref refid="structssh__session__struct_1a704e97e502aaee91fc79507a3458a87d" kindref="member">auto_state</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1031"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="priv_8h_1ae280c413c792e04237f000841ac8ce44" kindref="member">ssh_set_error_oom</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>);</highlight></codeline>
<codeline lineno="1032"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="libssh_8h_1a5b35a5038ad8eac4a4e4c00c6239e6e2a33d82f552d20734c17e770af637e3e17" kindref="member">SSH_AUTH_ERROR</ref>;</highlight></codeline>
<codeline lineno="1033"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1034"><highlight class="normal"></highlight></codeline>
<codeline lineno="1035"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Set<sp/>state<sp/>explicitly<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1036"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a3d57e01582c0c9099f7f319513321fe8" kindref="member">auth</ref>.<ref refid="structssh__session__struct_1a704e97e502aaee91fc79507a3458a87d" kindref="member">auto_state</ref>-&gt;<ref refid="structssh__auth__auto__state__struct_1ad79845cdd57294bad689bf52b1be697d" kindref="member">state</ref><sp/>=<sp/><ref refid="group__libssh__auth_1ggac65f4923889fe6f2b91021872463b4c4a7423bce4e2477ab036c8ce272fd7642f" kindref="member">SSH_AUTH_AUTO_STATE_NONE</ref>;</highlight></codeline>
<codeline lineno="1037"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1038"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="structssh__auth__auto__state__struct_1ad79845cdd57294bad689bf52b1be697d" kindref="member">state</ref><sp/>=<sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a3d57e01582c0c9099f7f319513321fe8" kindref="member">auth</ref>.<ref refid="structssh__session__struct_1a704e97e502aaee91fc79507a3458a87d" kindref="member">auto_state</ref>;</highlight></codeline>
<codeline lineno="1039"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="structssh__auth__auto__state__struct_1ad79845cdd57294bad689bf52b1be697d" kindref="member">state</ref>-&gt;state<sp/>==<sp/><ref refid="group__libssh__auth_1ggac65f4923889fe6f2b91021872463b4c4a7423bce4e2477ab036c8ce272fd7642f" kindref="member">SSH_AUTH_AUTO_STATE_NONE</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1040"><highlight class="normal"></highlight><highlight class="preprocessor">#ifndef<sp/>_WIN32</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1041"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Try<sp/>authentication<sp/>with<sp/>ssh-agent<sp/>first<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1042"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="group__libssh__auth_1ga7d84f3f89f65455b80b10e2643d80719" kindref="member">ssh_userauth_agent</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>,<sp/><ref refid="proxy_8c_1a9b20c006bd90a09e1465fb668700e81d" kindref="member">username</ref>);</highlight></codeline>
<codeline lineno="1043"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>==<sp/><ref refid="libssh_8h_1a5b35a5038ad8eac4a4e4c00c6239e6e2ab145398ebf554c3cc5d6acfb241c5235" kindref="member">SSH_AUTH_SUCCESS</ref><sp/>||</highlight></codeline>
<codeline lineno="1044"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>==<sp/><ref refid="libssh_8h_1a5b35a5038ad8eac4a4e4c00c6239e6e2a3bb06206cff7b6f818099d6019418eea" kindref="member">SSH_AUTH_PARTIAL</ref><sp/>||</highlight></codeline>
<codeline lineno="1045"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>==<sp/><ref refid="libssh_8h_1a5b35a5038ad8eac4a4e4c00c6239e6e2a0f166cff4fa03faf4e4c11ad854a4996" kindref="member">SSH_AUTH_AGAIN</ref><sp/>)<sp/>{</highlight></codeline>
<codeline lineno="1046"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref>;</highlight></codeline>
<codeline lineno="1047"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1048"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1049"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structssh__auth__auto__state__struct_1ad79845cdd57294bad689bf52b1be697d" kindref="member">state</ref>-&gt;state<sp/>=<sp/><ref refid="group__libssh__auth_1ggac65f4923889fe6f2b91021872463b4c4a82677b8f55353fe73bdd8ddb9958d367" kindref="member">SSH_AUTH_AUTO_STATE_PUBKEY</ref>;</highlight></codeline>
<codeline lineno="1050"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1051"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="structssh__auth__auto__state__struct_1ad79845cdd57294bad689bf52b1be697d" kindref="member">state</ref>-&gt;it<sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="1052"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structssh__auth__auto__state__struct_1ad79845cdd57294bad689bf52b1be697d" kindref="member">state</ref>-&gt;it<sp/>=<sp/><ref refid="group__libssh__misc_1gad36d247bfcae7965d6aca8245d061e0d" kindref="member">ssh_list_get_iterator</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a1c29cf990c1d0df6e1b0971d4f3d1f3e" kindref="member">opts</ref>.<ref refid="structssh__session__struct_1aab5ecfb12d53a23b21dbf61790aa7e94" kindref="member">identity</ref>);</highlight></codeline>
<codeline lineno="1053"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1054"><highlight class="normal"></highlight></codeline>
<codeline lineno="1055"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>(<ref refid="structssh__auth__auto__state__struct_1ad79845cdd57294bad689bf52b1be697d" kindref="member">state</ref>-&gt;it<sp/>!=<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="1056"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*privkey_file<sp/>=<sp/><ref refid="structssh__auth__auto__state__struct_1ad79845cdd57294bad689bf52b1be697d" kindref="member">state</ref>-&gt;it-&gt;data;</highlight></codeline>
<codeline lineno="1057"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>pubkey_file[1024]<sp/>=<sp/>{0};</highlight></codeline>
<codeline lineno="1058"><highlight class="normal"></highlight></codeline>
<codeline lineno="1059"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="structssh__auth__auto__state__struct_1ad79845cdd57294bad689bf52b1be697d" kindref="member">state</ref>-&gt;state<sp/>==<sp/><ref refid="group__libssh__auth_1ggac65f4923889fe6f2b91021872463b4c4a82677b8f55353fe73bdd8ddb9958d367" kindref="member">SSH_AUTH_AUTO_STATE_PUBKEY</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1060"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="priv_8h_1aa21fd8a7a609329603b7b16da7939fca" kindref="member">SSH_LOG</ref>(<ref refid="libssh_8h_1a5e4247396f11fdc228d356a408c81715" kindref="member">SSH_LOG_DEBUG</ref>,</highlight></codeline>
<codeline lineno="1061"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Trying<sp/>to<sp/>authenticate<sp/>with<sp/>%s&quot;</highlight><highlight class="normal">,<sp/>privkey_file);</highlight></codeline>
<codeline lineno="1062"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structssh__auth__auto__state__struct_1ad79845cdd57294bad689bf52b1be697d" kindref="member">state</ref>-&gt;privkey<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="1063"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structssh__auth__auto__state__struct_1ad79845cdd57294bad689bf52b1be697d" kindref="member">state</ref>-&gt;pubkey<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="1064"><highlight class="normal"></highlight></codeline>
<codeline lineno="1065"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="group__libssh__pki_1ga991cafa534b76035ec5cc4c9c0367458" kindref="member">ssh_pki_is_uri</ref>(privkey_file))<sp/>{</highlight></codeline>
<codeline lineno="1066"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*pub_uri_from_priv<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="1067"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="priv_8h_1aa21fd8a7a609329603b7b16da7939fca" kindref="member">SSH_LOG</ref>(<ref refid="libssh_8h_1a930fb852177813d4718c5d1911568740" kindref="member">SSH_LOG_INFO</ref>,</highlight></codeline>
<codeline lineno="1068"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Authenticating<sp/>with<sp/>PKCS<sp/>#11<sp/>URI.&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="1069"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pub_uri_from_priv<sp/>=<sp/><ref refid="group__libssh__pki_1gaa94ec2542a8dc9fb32c0989680a1e20f" kindref="member">ssh_pki_export_pub_uri_from_priv_uri</ref>(privkey_file);</highlight></codeline>
<codeline lineno="1070"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pub_uri_from_priv<sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="1071"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" kindref="member">SSH_ERROR</ref>;</highlight></codeline>
<codeline lineno="1072"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="1073"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>snprintf(pubkey_file,<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(pubkey_file),<sp/></highlight><highlight class="stringliteral">&quot;%s&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="1074"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pub_uri_from_priv);</highlight></codeline>
<codeline lineno="1075"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="sshd__direct-tcpip_8c_1aed3129b7674034c979192bcca6b0ad8c" kindref="member">SAFE_FREE</ref>(pub_uri_from_priv);</highlight></codeline>
<codeline lineno="1076"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1077"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="1078"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>snprintf(pubkey_file,<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(pubkey_file),<sp/></highlight><highlight class="stringliteral">&quot;%s.pub&quot;</highlight><highlight class="normal">,<sp/>privkey_file);</highlight></codeline>
<codeline lineno="1079"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1080"><highlight class="normal"></highlight></codeline>
<codeline lineno="1081"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="group__libssh__pki_1gaffb08168b870fb9e86cc7649c8987eb0" kindref="member">ssh_pki_import_pubkey_file</ref>(pubkey_file,<sp/>&amp;<ref refid="structssh__auth__auto__state__struct_1ad79845cdd57294bad689bf52b1be697d" kindref="member">state</ref>-&gt;pubkey);</highlight></codeline>
<codeline lineno="1082"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>==<sp/><ref refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" kindref="member">SSH_ERROR</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1083"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="priv_8h_1a55177b3e8db90ca9adb435c44281963c" kindref="member">ssh_set_error</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>,</highlight></codeline>
<codeline lineno="1084"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="libssh_8h_1a036b2b00fb04337a4d06d719d1b62be1a86ff0b2e8da6ad8628efc556b6ce1887" kindref="member">SSH_FATAL</ref>,</highlight></codeline>
<codeline lineno="1085"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Failed<sp/>to<sp/>import<sp/>public<sp/>key:<sp/>%s&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="1086"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pubkey_file);</highlight></codeline>
<codeline lineno="1087"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="sshd__direct-tcpip_8c_1aed3129b7674034c979192bcca6b0ad8c" kindref="member">SAFE_FREE</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a3d57e01582c0c9099f7f319513321fe8" kindref="member">auth</ref>.<ref refid="structssh__session__struct_1a704e97e502aaee91fc79507a3458a87d" kindref="member">auto_state</ref>);</highlight></codeline>
<codeline lineno="1088"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="libssh_8h_1a5b35a5038ad8eac4a4e4c00c6239e6e2a33d82f552d20734c17e770af637e3e17" kindref="member">SSH_AUTH_ERROR</ref>;</highlight></codeline>
<codeline lineno="1089"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>==<sp/><ref refid="libssh_8h_1a8f938067bd84c30bd28b7c2705a37beb" kindref="member">SSH_EOF</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1090"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Read<sp/>the<sp/>private<sp/>key<sp/>and<sp/>save<sp/>the<sp/>public<sp/>key<sp/>to<sp/>file<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1091"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="group__libssh__pki_1ga1c8f84137606b1585006302499100ee0" kindref="member">ssh_pki_import_privkey_file</ref>(privkey_file,</highlight></codeline>
<codeline lineno="1092"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>passphrase,</highlight></codeline>
<codeline lineno="1093"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>auth_fn,</highlight></codeline>
<codeline lineno="1094"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>auth_data,</highlight></codeline>
<codeline lineno="1095"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&amp;<ref refid="structssh__auth__auto__state__struct_1ad79845cdd57294bad689bf52b1be697d" kindref="member">state</ref>-&gt;privkey);</highlight></codeline>
<codeline lineno="1096"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>==<sp/><ref refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" kindref="member">SSH_ERROR</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1097"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="priv_8h_1a55177b3e8db90ca9adb435c44281963c" kindref="member">ssh_set_error</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>,</highlight></codeline>
<codeline lineno="1098"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="libssh_8h_1a036b2b00fb04337a4d06d719d1b62be1a86ff0b2e8da6ad8628efc556b6ce1887" kindref="member">SSH_FATAL</ref>,</highlight></codeline>
<codeline lineno="1099"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Failed<sp/>to<sp/>read<sp/>private<sp/>key:<sp/>%s&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="1100"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>privkey_file);</highlight></codeline>
<codeline lineno="1101"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structssh__auth__auto__state__struct_1ad79845cdd57294bad689bf52b1be697d" kindref="member">state</ref>-&gt;it=<ref refid="structssh__auth__auto__state__struct_1ad79845cdd57294bad689bf52b1be697d" kindref="member">state</ref>-&gt;it-&gt;next;</highlight></codeline>
<codeline lineno="1102"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">continue</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1103"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>==<sp/><ref refid="libssh_8h_1a8f938067bd84c30bd28b7c2705a37beb" kindref="member">SSH_EOF</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1104"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>If<sp/>the<sp/>file<sp/>doesn&apos;t<sp/>exist,<sp/>continue<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1105"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="priv_8h_1aa21fd8a7a609329603b7b16da7939fca" kindref="member">SSH_LOG</ref>(<ref refid="libssh_8h_1a5e4247396f11fdc228d356a408c81715" kindref="member">SSH_LOG_DEBUG</ref>,</highlight></codeline>
<codeline lineno="1106"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Private<sp/>key<sp/>%s<sp/>doesn&apos;t<sp/>exist.&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="1107"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>privkey_file);</highlight></codeline>
<codeline lineno="1108"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structssh__auth__auto__state__struct_1ad79845cdd57294bad689bf52b1be697d" kindref="member">state</ref>-&gt;it=<ref refid="structssh__auth__auto__state__struct_1ad79845cdd57294bad689bf52b1be697d" kindref="member">state</ref>-&gt;it-&gt;next;</highlight></codeline>
<codeline lineno="1109"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">continue</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1110"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1111"><highlight class="normal"></highlight></codeline>
<codeline lineno="1112"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="group__libssh__pki_1ga5777bc537da6a447b2a9aa9eceff9877" kindref="member">ssh_pki_export_privkey_to_pubkey</ref>(<ref refid="structssh__auth__auto__state__struct_1ad79845cdd57294bad689bf52b1be697d" kindref="member">state</ref>-&gt;privkey,<sp/>&amp;<ref refid="structssh__auth__auto__state__struct_1ad79845cdd57294bad689bf52b1be697d" kindref="member">state</ref>-&gt;pubkey);</highlight></codeline>
<codeline lineno="1113"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>==<sp/><ref refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" kindref="member">SSH_ERROR</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1114"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="group__libssh__pki_1ga08808beb83a42ccd6f1c710ddeb1b4c2" kindref="member">ssh_key_free</ref>(<ref refid="structssh__auth__auto__state__struct_1ad79845cdd57294bad689bf52b1be697d" kindref="member">state</ref>-&gt;privkey);</highlight></codeline>
<codeline lineno="1115"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="sshd__direct-tcpip_8c_1aed3129b7674034c979192bcca6b0ad8c" kindref="member">SAFE_FREE</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a3d57e01582c0c9099f7f319513321fe8" kindref="member">auth</ref>.<ref refid="structssh__session__struct_1a704e97e502aaee91fc79507a3458a87d" kindref="member">auto_state</ref>);</highlight></codeline>
<codeline lineno="1116"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="libssh_8h_1a5b35a5038ad8eac4a4e4c00c6239e6e2a33d82f552d20734c17e770af637e3e17" kindref="member">SSH_AUTH_ERROR</ref>;</highlight></codeline>
<codeline lineno="1117"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1118"><highlight class="normal"></highlight></codeline>
<codeline lineno="1119"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="group__libssh__pki_1ga576cb3a5c7f40a0e20a88b14a023613d" kindref="member">ssh_pki_export_pubkey_file</ref>(<ref refid="structssh__auth__auto__state__struct_1ad79845cdd57294bad689bf52b1be697d" kindref="member">state</ref>-&gt;pubkey,<sp/>pubkey_file);</highlight></codeline>
<codeline lineno="1120"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>==<sp/><ref refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" kindref="member">SSH_ERROR</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1121"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="priv_8h_1aa21fd8a7a609329603b7b16da7939fca" kindref="member">SSH_LOG</ref>(<ref refid="libssh_8h_1ab3c2f1accd58d32987f02d8aebdc1fc4" kindref="member">SSH_LOG_WARN</ref>,</highlight></codeline>
<codeline lineno="1122"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Could<sp/>not<sp/>write<sp/>public<sp/>key<sp/>to<sp/>file:<sp/>%s&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="1123"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pubkey_file);</highlight></codeline>
<codeline lineno="1124"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1125"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1126"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structssh__auth__auto__state__struct_1ad79845cdd57294bad689bf52b1be697d" kindref="member">state</ref>-&gt;state<sp/>=<sp/><ref refid="group__libssh__auth_1ggac65f4923889fe6f2b91021872463b4c4a0f73343ecb44ed535c5d53cede05485a" kindref="member">SSH_AUTH_AUTO_STATE_KEY_IMPORTED</ref>;</highlight></codeline>
<codeline lineno="1127"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1128"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="structssh__auth__auto__state__struct_1ad79845cdd57294bad689bf52b1be697d" kindref="member">state</ref>-&gt;state<sp/>==<sp/><ref refid="group__libssh__auth_1ggac65f4923889fe6f2b91021872463b4c4a0f73343ecb44ed535c5d53cede05485a" kindref="member">SSH_AUTH_AUTO_STATE_KEY_IMPORTED</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1129"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="group__libssh__auth_1ga592f673c4d417a6a46cd4876ac8287aa" kindref="member">ssh_userauth_try_publickey</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>,<sp/><ref refid="proxy_8c_1a9b20c006bd90a09e1465fb668700e81d" kindref="member">username</ref>,<sp/><ref refid="structssh__auth__auto__state__struct_1ad79845cdd57294bad689bf52b1be697d" kindref="member">state</ref>-&gt;pubkey);</highlight></codeline>
<codeline lineno="1130"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>==<sp/><ref refid="libssh_8h_1a5b35a5038ad8eac4a4e4c00c6239e6e2a33d82f552d20734c17e770af637e3e17" kindref="member">SSH_AUTH_ERROR</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1131"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="priv_8h_1aa21fd8a7a609329603b7b16da7939fca" kindref="member">SSH_LOG</ref>(<ref refid="libssh_8h_1ab3c2f1accd58d32987f02d8aebdc1fc4" kindref="member">SSH_LOG_WARN</ref>,</highlight></codeline>
<codeline lineno="1132"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Public<sp/>key<sp/>authentication<sp/>error<sp/>for<sp/>%s&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="1133"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>privkey_file);</highlight></codeline>
<codeline lineno="1134"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="group__libssh__pki_1ga08808beb83a42ccd6f1c710ddeb1b4c2" kindref="member">ssh_key_free</ref>(<ref refid="structssh__auth__auto__state__struct_1ad79845cdd57294bad689bf52b1be697d" kindref="member">state</ref>-&gt;privkey);</highlight></codeline>
<codeline lineno="1135"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="group__libssh__pki_1ga08808beb83a42ccd6f1c710ddeb1b4c2" kindref="member">ssh_key_free</ref>(<ref refid="structssh__auth__auto__state__struct_1ad79845cdd57294bad689bf52b1be697d" kindref="member">state</ref>-&gt;pubkey);</highlight></codeline>
<codeline lineno="1136"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="sshd__direct-tcpip_8c_1aed3129b7674034c979192bcca6b0ad8c" kindref="member">SAFE_FREE</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a3d57e01582c0c9099f7f319513321fe8" kindref="member">auth</ref>.<ref refid="structssh__session__struct_1a704e97e502aaee91fc79507a3458a87d" kindref="member">auto_state</ref>);</highlight></codeline>
<codeline lineno="1137"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref>;</highlight></codeline>
<codeline lineno="1138"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>==<sp/><ref refid="libssh_8h_1a5b35a5038ad8eac4a4e4c00c6239e6e2a0f166cff4fa03faf4e4c11ad854a4996" kindref="member">SSH_AUTH_AGAIN</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1139"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref>;</highlight></codeline>
<codeline lineno="1140"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>!=<sp/><ref refid="libssh_8h_1a5b35a5038ad8eac4a4e4c00c6239e6e2ab145398ebf554c3cc5d6acfb241c5235" kindref="member">SSH_AUTH_SUCCESS</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1141"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="priv_8h_1aa21fd8a7a609329603b7b16da7939fca" kindref="member">SSH_LOG</ref>(<ref refid="libssh_8h_1a5e4247396f11fdc228d356a408c81715" kindref="member">SSH_LOG_DEBUG</ref>,</highlight></codeline>
<codeline lineno="1142"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Public<sp/>key<sp/>for<sp/>%s<sp/>refused<sp/>by<sp/>server&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="1143"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>privkey_file);</highlight></codeline>
<codeline lineno="1144"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="group__libssh__pki_1ga08808beb83a42ccd6f1c710ddeb1b4c2" kindref="member">ssh_key_free</ref>(<ref refid="structssh__auth__auto__state__struct_1ad79845cdd57294bad689bf52b1be697d" kindref="member">state</ref>-&gt;privkey);</highlight></codeline>
<codeline lineno="1145"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structssh__auth__auto__state__struct_1ad79845cdd57294bad689bf52b1be697d" kindref="member">state</ref>-&gt;privkey<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="1146"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="group__libssh__pki_1ga08808beb83a42ccd6f1c710ddeb1b4c2" kindref="member">ssh_key_free</ref>(<ref refid="structssh__auth__auto__state__struct_1ad79845cdd57294bad689bf52b1be697d" kindref="member">state</ref>-&gt;pubkey);</highlight></codeline>
<codeline lineno="1147"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structssh__auth__auto__state__struct_1ad79845cdd57294bad689bf52b1be697d" kindref="member">state</ref>-&gt;pubkey<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="1148"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structssh__auth__auto__state__struct_1ad79845cdd57294bad689bf52b1be697d" kindref="member">state</ref>-&gt;it=<ref refid="structssh__auth__auto__state__struct_1ad79845cdd57294bad689bf52b1be697d" kindref="member">state</ref>-&gt;it-&gt;next;</highlight></codeline>
<codeline lineno="1149"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structssh__auth__auto__state__struct_1ad79845cdd57294bad689bf52b1be697d" kindref="member">state</ref>-&gt;state<sp/>=<sp/><ref refid="group__libssh__auth_1ggac65f4923889fe6f2b91021872463b4c4a82677b8f55353fe73bdd8ddb9958d367" kindref="member">SSH_AUTH_AUTO_STATE_PUBKEY</ref>;</highlight></codeline>
<codeline lineno="1150"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">continue</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1151"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1152"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structssh__auth__auto__state__struct_1ad79845cdd57294bad689bf52b1be697d" kindref="member">state</ref>-&gt;state<sp/>=<sp/><ref refid="group__libssh__auth_1ggac65f4923889fe6f2b91021872463b4c4ad484a042d380c408bc75ef844e8e0e9c" kindref="member">SSH_AUTH_AUTO_STATE_PUBKEY_ACCEPTED</ref>;</highlight></codeline>
<codeline lineno="1153"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1154"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="structssh__auth__auto__state__struct_1ad79845cdd57294bad689bf52b1be697d" kindref="member">state</ref>-&gt;state<sp/>==<sp/><ref refid="group__libssh__auth_1ggac65f4923889fe6f2b91021872463b4c4ad484a042d380c408bc75ef844e8e0e9c" kindref="member">SSH_AUTH_AUTO_STATE_PUBKEY_ACCEPTED</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1155"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Public<sp/>key<sp/>has<sp/>been<sp/>accepted<sp/>by<sp/>the<sp/>server<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1156"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="structssh__auth__auto__state__struct_1ad79845cdd57294bad689bf52b1be697d" kindref="member">state</ref>-&gt;privkey<sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="1157"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="group__libssh__pki_1ga1c8f84137606b1585006302499100ee0" kindref="member">ssh_pki_import_privkey_file</ref>(privkey_file,</highlight></codeline>
<codeline lineno="1158"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>passphrase,</highlight></codeline>
<codeline lineno="1159"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>auth_fn,</highlight></codeline>
<codeline lineno="1160"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>auth_data,</highlight></codeline>
<codeline lineno="1161"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&amp;<ref refid="structssh__auth__auto__state__struct_1ad79845cdd57294bad689bf52b1be697d" kindref="member">state</ref>-&gt;privkey);</highlight></codeline>
<codeline lineno="1162"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>==<sp/><ref refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" kindref="member">SSH_ERROR</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1163"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="group__libssh__pki_1ga08808beb83a42ccd6f1c710ddeb1b4c2" kindref="member">ssh_key_free</ref>(<ref refid="structssh__auth__auto__state__struct_1ad79845cdd57294bad689bf52b1be697d" kindref="member">state</ref>-&gt;pubkey);</highlight></codeline>
<codeline lineno="1164"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structssh__auth__auto__state__struct_1ad79845cdd57294bad689bf52b1be697d" kindref="member">state</ref>-&gt;pubkey=NULL;</highlight></codeline>
<codeline lineno="1165"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="priv_8h_1a55177b3e8db90ca9adb435c44281963c" kindref="member">ssh_set_error</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>,</highlight></codeline>
<codeline lineno="1166"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="libssh_8h_1a036b2b00fb04337a4d06d719d1b62be1a86ff0b2e8da6ad8628efc556b6ce1887" kindref="member">SSH_FATAL</ref>,</highlight></codeline>
<codeline lineno="1167"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Failed<sp/>to<sp/>read<sp/>private<sp/>key:<sp/>%s&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="1168"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>privkey_file);</highlight></codeline>
<codeline lineno="1169"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structssh__auth__auto__state__struct_1ad79845cdd57294bad689bf52b1be697d" kindref="member">state</ref>-&gt;it=<ref refid="structssh__auth__auto__state__struct_1ad79845cdd57294bad689bf52b1be697d" kindref="member">state</ref>-&gt;it-&gt;next;</highlight></codeline>
<codeline lineno="1170"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structssh__auth__auto__state__struct_1ad79845cdd57294bad689bf52b1be697d" kindref="member">state</ref>-&gt;state<sp/>=<sp/><ref refid="group__libssh__auth_1ggac65f4923889fe6f2b91021872463b4c4a82677b8f55353fe73bdd8ddb9958d367" kindref="member">SSH_AUTH_AUTO_STATE_PUBKEY</ref>;</highlight></codeline>
<codeline lineno="1171"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">continue</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1172"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>==<sp/><ref refid="libssh_8h_1a8f938067bd84c30bd28b7c2705a37beb" kindref="member">SSH_EOF</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1173"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>If<sp/>the<sp/>file<sp/>doesn&apos;t<sp/>exist,<sp/>continue<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1174"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="group__libssh__pki_1ga08808beb83a42ccd6f1c710ddeb1b4c2" kindref="member">ssh_key_free</ref>(<ref refid="structssh__auth__auto__state__struct_1ad79845cdd57294bad689bf52b1be697d" kindref="member">state</ref>-&gt;pubkey);</highlight></codeline>
<codeline lineno="1175"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structssh__auth__auto__state__struct_1ad79845cdd57294bad689bf52b1be697d" kindref="member">state</ref>-&gt;pubkey<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="1176"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="priv_8h_1aa21fd8a7a609329603b7b16da7939fca" kindref="member">SSH_LOG</ref>(<ref refid="libssh_8h_1a930fb852177813d4718c5d1911568740" kindref="member">SSH_LOG_INFO</ref>,</highlight></codeline>
<codeline lineno="1177"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Private<sp/>key<sp/>%s<sp/>doesn&apos;t<sp/>exist.&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="1178"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>privkey_file);</highlight></codeline>
<codeline lineno="1179"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structssh__auth__auto__state__struct_1ad79845cdd57294bad689bf52b1be697d" kindref="member">state</ref>-&gt;it<sp/>=<sp/><ref refid="structssh__auth__auto__state__struct_1ad79845cdd57294bad689bf52b1be697d" kindref="member">state</ref>-&gt;it-&gt;next;</highlight></codeline>
<codeline lineno="1180"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structssh__auth__auto__state__struct_1ad79845cdd57294bad689bf52b1be697d" kindref="member">state</ref>-&gt;state<sp/>=<sp/><ref refid="group__libssh__auth_1ggac65f4923889fe6f2b91021872463b4c4a82677b8f55353fe73bdd8ddb9958d367" kindref="member">SSH_AUTH_AUTO_STATE_PUBKEY</ref>;</highlight></codeline>
<codeline lineno="1181"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">continue</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1182"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1183"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1184"><highlight class="normal"></highlight></codeline>
<codeline lineno="1185"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="group__libssh__auth_1gaa38c4f3194ef36720da7eddb0aa99e23" kindref="member">ssh_userauth_publickey</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>,<sp/><ref refid="proxy_8c_1a9b20c006bd90a09e1465fb668700e81d" kindref="member">username</ref>,<sp/><ref refid="structssh__auth__auto__state__struct_1ad79845cdd57294bad689bf52b1be697d" kindref="member">state</ref>-&gt;privkey);</highlight></codeline>
<codeline lineno="1186"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>!=<sp/><ref refid="libssh_8h_1a5b35a5038ad8eac4a4e4c00c6239e6e2a0f166cff4fa03faf4e4c11ad854a4996" kindref="member">SSH_AUTH_AGAIN</ref><sp/>&amp;&amp;<sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>!=<sp/><ref refid="libssh_8h_1a5b35a5038ad8eac4a4e4c00c6239e6e2ac3d2d6d092a7adc147b7f859a0b252d2" kindref="member">SSH_AUTH_DENIED</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1187"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="group__libssh__pki_1ga08808beb83a42ccd6f1c710ddeb1b4c2" kindref="member">ssh_key_free</ref>(<ref refid="structssh__auth__auto__state__struct_1ad79845cdd57294bad689bf52b1be697d" kindref="member">state</ref>-&gt;privkey);</highlight></codeline>
<codeline lineno="1188"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="group__libssh__pki_1ga08808beb83a42ccd6f1c710ddeb1b4c2" kindref="member">ssh_key_free</ref>(<ref refid="structssh__auth__auto__state__struct_1ad79845cdd57294bad689bf52b1be697d" kindref="member">state</ref>-&gt;pubkey);</highlight></codeline>
<codeline lineno="1189"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="sshd__direct-tcpip_8c_1aed3129b7674034c979192bcca6b0ad8c" kindref="member">SAFE_FREE</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a3d57e01582c0c9099f7f319513321fe8" kindref="member">auth</ref>.<ref refid="structssh__session__struct_1a704e97e502aaee91fc79507a3458a87d" kindref="member">auto_state</ref>);</highlight></codeline>
<codeline lineno="1190"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>==<sp/><ref refid="libssh_8h_1a5b35a5038ad8eac4a4e4c00c6239e6e2ab145398ebf554c3cc5d6acfb241c5235" kindref="member">SSH_AUTH_SUCCESS</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1191"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="priv_8h_1aa21fd8a7a609329603b7b16da7939fca" kindref="member">SSH_LOG</ref>(<ref refid="libssh_8h_1a930fb852177813d4718c5d1911568740" kindref="member">SSH_LOG_INFO</ref>,</highlight></codeline>
<codeline lineno="1192"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Successfully<sp/>authenticated<sp/>using<sp/>%s&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="1193"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>privkey_file);</highlight></codeline>
<codeline lineno="1194"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1195"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref>;</highlight></codeline>
<codeline lineno="1196"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1197"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>==<sp/><ref refid="libssh_8h_1a5b35a5038ad8eac4a4e4c00c6239e6e2a0f166cff4fa03faf4e4c11ad854a4996" kindref="member">SSH_AUTH_AGAIN</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1198"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref>;</highlight></codeline>
<codeline lineno="1199"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1200"><highlight class="normal"></highlight></codeline>
<codeline lineno="1201"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="priv_8h_1aa21fd8a7a609329603b7b16da7939fca" kindref="member">SSH_LOG</ref>(<ref refid="libssh_8h_1ab3c2f1accd58d32987f02d8aebdc1fc4" kindref="member">SSH_LOG_WARN</ref>,</highlight></codeline>
<codeline lineno="1202"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;The<sp/>server<sp/>accepted<sp/>the<sp/>public<sp/>key<sp/>but<sp/>refused<sp/>the<sp/>signature&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="1203"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structssh__auth__auto__state__struct_1ad79845cdd57294bad689bf52b1be697d" kindref="member">state</ref>-&gt;it<sp/>=<sp/><ref refid="structssh__auth__auto__state__struct_1ad79845cdd57294bad689bf52b1be697d" kindref="member">state</ref>-&gt;it-&gt;next;</highlight></codeline>
<codeline lineno="1204"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structssh__auth__auto__state__struct_1ad79845cdd57294bad689bf52b1be697d" kindref="member">state</ref>-&gt;state<sp/>=<sp/><ref refid="group__libssh__auth_1ggac65f4923889fe6f2b91021872463b4c4a82677b8f55353fe73bdd8ddb9958d367" kindref="member">SSH_AUTH_AUTO_STATE_PUBKEY</ref>;</highlight></codeline>
<codeline lineno="1205"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>continue<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1206"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1207"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1208"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="priv_8h_1aa21fd8a7a609329603b7b16da7939fca" kindref="member">SSH_LOG</ref>(<ref refid="libssh_8h_1a930fb852177813d4718c5d1911568740" kindref="member">SSH_LOG_INFO</ref>,</highlight></codeline>
<codeline lineno="1209"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Tried<sp/>every<sp/>public<sp/>key,<sp/>none<sp/>matched&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="1210"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="sshd__direct-tcpip_8c_1aed3129b7674034c979192bcca6b0ad8c" kindref="member">SAFE_FREE</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a3d57e01582c0c9099f7f319513321fe8" kindref="member">auth</ref>.<ref refid="structssh__session__struct_1a704e97e502aaee91fc79507a3458a87d" kindref="member">auto_state</ref>);</highlight></codeline>
<codeline lineno="1211"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="libssh_8h_1a5b35a5038ad8eac4a4e4c00c6239e6e2ac3d2d6d092a7adc147b7f859a0b252d2" kindref="member">SSH_AUTH_DENIED</ref>;</highlight></codeline>
<codeline lineno="1212"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1213"><highlight class="normal"></highlight></codeline>
<codeline lineno="1246" refid="group__libssh__auth_1ga50c0c150f8c4703e7ee49b3e3e3ca215" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="group__libssh__auth_1ga50c0c150f8c4703e7ee49b3e3e3ca215" kindref="member">ssh_userauth_password</ref>(<ref refid="structssh__session__struct" kindref="compound">ssh_session</ref><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>,</highlight></codeline>
<codeline lineno="1247"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*<ref refid="proxy_8c_1a9b20c006bd90a09e1465fb668700e81d" kindref="member">username</ref>,</highlight></codeline>
<codeline lineno="1248"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*password)<sp/>{</highlight></codeline>
<codeline lineno="1249"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref>;</highlight></codeline>
<codeline lineno="1250"><highlight class="normal"></highlight></codeline>
<codeline lineno="1251"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">switch</highlight><highlight class="normal">(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a5552665043089000065df39c5a5a7094" kindref="member">pending_call_state</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1252"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="session_8h_1abb7a4342b889601983497b3f094957e1a33be3f7cd03fe7fced1eeacd369cad94" kindref="member">SSH_PENDING_CALL_NONE</ref>:</highlight></codeline>
<codeline lineno="1253"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1254"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="session_8h_1abb7a4342b889601983497b3f094957e1a95e070b4edb4f7f647d8129c3c2782d3" kindref="member">SSH_PENDING_CALL_AUTH_PASSWORD</ref>:</highlight></codeline>
<codeline lineno="1255"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">goto</highlight><highlight class="normal"><sp/>pending;</highlight></codeline>
<codeline lineno="1256"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">default</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="1257"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="priv_8h_1a55177b3e8db90ca9adb435c44281963c" kindref="member">ssh_set_error</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>,</highlight></codeline>
<codeline lineno="1258"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="libssh_8h_1a036b2b00fb04337a4d06d719d1b62be1a86ff0b2e8da6ad8628efc556b6ce1887" kindref="member">SSH_FATAL</ref>,</highlight></codeline>
<codeline lineno="1259"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Wrong<sp/>state<sp/>(%d)<sp/>during<sp/>pending<sp/>SSH<sp/>call&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="1260"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a5552665043089000065df39c5a5a7094" kindref="member">pending_call_state</ref>);</highlight></codeline>
<codeline lineno="1261"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" kindref="member">SSH_ERROR</ref>;</highlight></codeline>
<codeline lineno="1262"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1263"><highlight class="normal"></highlight></codeline>
<codeline lineno="1264"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="group__libssh__auth_1ga812fb86c3dd4a6245bc7d01beaa9cfe8" kindref="member">ssh_userauth_request_service</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>);</highlight></codeline>
<codeline lineno="1265"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>==<sp/><ref refid="libssh_8h_1a9c57e4f6482106336045a4d25a55f28e" kindref="member">SSH_AGAIN</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1266"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="libssh_8h_1a5b35a5038ad8eac4a4e4c00c6239e6e2a0f166cff4fa03faf4e4c11ad854a4996" kindref="member">SSH_AUTH_AGAIN</ref>;</highlight></codeline>
<codeline lineno="1267"><highlight class="normal"><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>==<sp/><ref refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" kindref="member">SSH_ERROR</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1268"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="libssh_8h_1a5b35a5038ad8eac4a4e4c00c6239e6e2a33d82f552d20734c17e770af637e3e17" kindref="member">SSH_AUTH_ERROR</ref>;</highlight></codeline>
<codeline lineno="1269"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1270"><highlight class="normal"></highlight></codeline>
<codeline lineno="1271"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>request<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1272"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="buffer_8h_1ae17848a86043f0abfc60c1c4f6126ccd" kindref="member">ssh_buffer_pack</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1af0aed60c1e529bbfdcb483fd80bf98a0" kindref="member">out_buffer</ref>,<sp/></highlight><highlight class="stringliteral">&quot;bsssbs&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="1273"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ssh2_8h_1a423ea81df02faff2d59b730af16ac59e" kindref="member">SSH2_MSG_USERAUTH_REQUEST</ref>,</highlight></codeline>
<codeline lineno="1274"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="proxy_8c_1a9b20c006bd90a09e1465fb668700e81d" kindref="member">username</ref><sp/>?<sp/><ref refid="proxy_8c_1a9b20c006bd90a09e1465fb668700e81d" kindref="member">username</ref><sp/>:<sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a1c29cf990c1d0df6e1b0971d4f3d1f3e" kindref="member">opts</ref>.<ref refid="structssh__session__struct_1a8ed5d5d3116679fd7b8f2c0e1db92726" kindref="member">username</ref>,</highlight></codeline>
<codeline lineno="1275"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;ssh-connection&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="1276"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;password&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="1277"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0,<sp/></highlight><highlight class="comment">/*<sp/>false<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1278"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>password</highlight></codeline>
<codeline lineno="1279"><highlight class="normal"><sp/><sp/><sp/><sp/>);</highlight></codeline>
<codeline lineno="1280"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>&lt;<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="1281"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">goto</highlight><highlight class="normal"><sp/>fail;</highlight></codeline>
<codeline lineno="1282"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1283"><highlight class="normal"></highlight></codeline>
<codeline lineno="1284"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Set<sp/>the<sp/>buffer<sp/>as<sp/>secure<sp/>to<sp/>be<sp/>explicitly<sp/>zeroed<sp/>when<sp/>freed<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1285"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="group__libssh__buffer_1gade0108b17f43b5269b92456a785df126" kindref="member">ssh_buffer_set_secure</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1af0aed60c1e529bbfdcb483fd80bf98a0" kindref="member">out_buffer</ref>);</highlight></codeline>
<codeline lineno="1286"><highlight class="normal"></highlight></codeline>
<codeline lineno="1287"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a3d57e01582c0c9099f7f319513321fe8" kindref="member">auth</ref>.<ref refid="structssh__session__struct_1aa859857ac7a99808ffc537e08087e541" kindref="member">current_method</ref><sp/>=<sp/><ref refid="libssh_8h_1ad10dd2f5826e2d92a30bd8af3404574d" kindref="member">SSH_AUTH_METHOD_PASSWORD</ref>;</highlight></codeline>
<codeline lineno="1288"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a3d57e01582c0c9099f7f319513321fe8" kindref="member">auth</ref>.<ref refid="structssh__session__struct_1af0805877d21d43e81423ead52345c64b" kindref="member">state</ref><sp/>=<sp/><ref refid="auth_8h_1a0d3114986a741a14dc3ac03f7d8eafefaedccdf68a9f5857c7f31ac557b2a57b6" kindref="member">SSH_AUTH_STATE_PASSWORD_AUTH_SENT</ref>;</highlight></codeline>
<codeline lineno="1289"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a5552665043089000065df39c5a5a7094" kindref="member">pending_call_state</ref><sp/>=<sp/><ref refid="session_8h_1abb7a4342b889601983497b3f094957e1a95e070b4edb4f7f647d8129c3c2782d3" kindref="member">SSH_PENDING_CALL_AUTH_PASSWORD</ref>;</highlight></codeline>
<codeline lineno="1290"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="packet_8h_1a7e6c7ed74c23ace432476aa8a6841140" kindref="member">ssh_packet_send</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>);</highlight></codeline>
<codeline lineno="1291"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>==<sp/><ref refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" kindref="member">SSH_ERROR</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1292"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="libssh_8h_1a5b35a5038ad8eac4a4e4c00c6239e6e2a33d82f552d20734c17e770af637e3e17" kindref="member">SSH_AUTH_ERROR</ref>;</highlight></codeline>
<codeline lineno="1293"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1294"><highlight class="normal"></highlight></codeline>
<codeline lineno="1295"><highlight class="normal">pending:</highlight></codeline>
<codeline lineno="1296"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="group__libssh__auth_1gabff6b3898d3bf45b62cc3ed3774eaa83" kindref="member">ssh_userauth_get_response</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>);</highlight></codeline>
<codeline lineno="1297"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>!=<sp/><ref refid="libssh_8h_1a5b35a5038ad8eac4a4e4c00c6239e6e2a0f166cff4fa03faf4e4c11ad854a4996" kindref="member">SSH_AUTH_AGAIN</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1298"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a5552665043089000065df39c5a5a7094" kindref="member">pending_call_state</ref><sp/>=<sp/><ref refid="session_8h_1abb7a4342b889601983497b3f094957e1a33be3f7cd03fe7fced1eeacd369cad94" kindref="member">SSH_PENDING_CALL_NONE</ref>;</highlight></codeline>
<codeline lineno="1299"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1300"><highlight class="normal"></highlight></codeline>
<codeline lineno="1301"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref>;</highlight></codeline>
<codeline lineno="1302"><highlight class="normal">fail:</highlight></codeline>
<codeline lineno="1303"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="priv_8h_1ae280c413c792e04237f000841ac8ce44" kindref="member">ssh_set_error_oom</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>);</highlight></codeline>
<codeline lineno="1304"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="libssh_8h_1ac8802ff7f5348d0145dab5242623f740" kindref="member">ssh_buffer_reinit</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1af0aed60c1e529bbfdcb483fd80bf98a0" kindref="member">out_buffer</ref>);</highlight></codeline>
<codeline lineno="1305"><highlight class="normal"></highlight></codeline>
<codeline lineno="1306"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="libssh_8h_1a5b35a5038ad8eac4a4e4c00c6239e6e2a33d82f552d20734c17e770af637e3e17" kindref="member">SSH_AUTH_ERROR</ref>;</highlight></codeline>
<codeline lineno="1307"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1308"><highlight class="normal"></highlight></codeline>
<codeline lineno="1309"><highlight class="normal"></highlight><highlight class="preprocessor">#ifndef<sp/>_WIN32</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1310"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>LEGACY<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1311" refid="group__libssh__auth_1ga5cc49db459d6e27c8645a20bbd0f5f88" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="group__libssh__auth_1ga5cc49db459d6e27c8645a20bbd0f5f88" kindref="member">ssh_userauth_agent_pubkey</ref>(<ref refid="structssh__session__struct" kindref="compound">ssh_session</ref><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>,</highlight></codeline>
<codeline lineno="1312"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*<ref refid="proxy_8c_1a9b20c006bd90a09e1465fb668700e81d" kindref="member">username</ref>,</highlight></codeline>
<codeline lineno="1313"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structssh__public__key__struct" kindref="compound">ssh_public_key</ref><sp/>publickey)</highlight></codeline>
<codeline lineno="1314"><highlight class="normal">{</highlight></codeline>
<codeline lineno="1315"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="structssh__key__struct" kindref="compound">ssh_key</ref><sp/><ref refid="torture__crypto_8c_1a42363914b961236c71004e83b3b66a1b" kindref="member">key</ref>;</highlight></codeline>
<codeline lineno="1316"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref>;</highlight></codeline>
<codeline lineno="1317"><highlight class="normal"></highlight></codeline>
<codeline lineno="1318"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="torture__crypto_8c_1a42363914b961236c71004e83b3b66a1b" kindref="member">key</ref><sp/>=<sp/><ref refid="group__libssh__pki_1gabfebce03474a4d014aa779d5dbf057b0" kindref="member">ssh_key_new</ref>();</highlight></codeline>
<codeline lineno="1319"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="torture__crypto_8c_1a42363914b961236c71004e83b3b66a1b" kindref="member">key</ref><sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="1320"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="libssh_8h_1a5b35a5038ad8eac4a4e4c00c6239e6e2a33d82f552d20734c17e770af637e3e17" kindref="member">SSH_AUTH_ERROR</ref>;</highlight></codeline>
<codeline lineno="1321"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1322"><highlight class="normal"></highlight></codeline>
<codeline lineno="1323"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="torture__crypto_8c_1a42363914b961236c71004e83b3b66a1b" kindref="member">key</ref>-&gt;type<sp/>=<sp/>publickey-&gt;<ref refid="structssh__public__key__struct_1a69d5a807f16ad377646d15c87886ae0e" kindref="member">type</ref>;</highlight></codeline>
<codeline lineno="1324"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="torture__crypto_8c_1a42363914b961236c71004e83b3b66a1b" kindref="member">key</ref>-&gt;type_c<sp/>=<sp/><ref refid="group__libssh__pki_1ga302919f046a4af504e5a2a9924b031c1" kindref="member">ssh_key_type_to_char</ref>(<ref refid="torture__crypto_8c_1a42363914b961236c71004e83b3b66a1b" kindref="member">key</ref>-&gt;type);</highlight></codeline>
<codeline lineno="1325"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="torture__crypto_8c_1a42363914b961236c71004e83b3b66a1b" kindref="member">key</ref>-&gt;flags<sp/>=<sp/><ref refid="pki_8h_1a916bbdaba2e1b30d69f34a2df20dc7b8" kindref="member">SSH_KEY_FLAG_PUBLIC</ref>;</highlight></codeline>
<codeline lineno="1326"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="torture__crypto_8c_1a42363914b961236c71004e83b3b66a1b" kindref="member">key</ref>-&gt;dsa<sp/>=<sp/>publickey-&gt;dsa_pub;</highlight></codeline>
<codeline lineno="1327"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="torture__crypto_8c_1a42363914b961236c71004e83b3b66a1b" kindref="member">key</ref>-&gt;rsa<sp/>=<sp/>publickey-&gt;rsa_pub;</highlight></codeline>
<codeline lineno="1328"><highlight class="normal"></highlight></codeline>
<codeline lineno="1329"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="group__libssh__auth_1ga691078be9ea2a55fed97c7488395af5a" kindref="member">ssh_userauth_agent_publickey</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>,<sp/><ref refid="proxy_8c_1a9b20c006bd90a09e1465fb668700e81d" kindref="member">username</ref>,<sp/><ref refid="torture__crypto_8c_1a42363914b961236c71004e83b3b66a1b" kindref="member">key</ref>);</highlight></codeline>
<codeline lineno="1330"><highlight class="normal"></highlight></codeline>
<codeline lineno="1331"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="torture__crypto_8c_1a42363914b961236c71004e83b3b66a1b" kindref="member">key</ref>-&gt;dsa<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="1332"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="torture__crypto_8c_1a42363914b961236c71004e83b3b66a1b" kindref="member">key</ref>-&gt;rsa<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="1333"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="group__libssh__pki_1ga08808beb83a42ccd6f1c710ddeb1b4c2" kindref="member">ssh_key_free</ref>(<ref refid="torture__crypto_8c_1a42363914b961236c71004e83b3b66a1b" kindref="member">key</ref>);</highlight></codeline>
<codeline lineno="1334"><highlight class="normal"></highlight></codeline>
<codeline lineno="1335"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref>;</highlight></codeline>
<codeline lineno="1336"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1337"><highlight class="normal"></highlight><highlight class="preprocessor">#endif<sp/></highlight><highlight class="comment">/*<sp/>_WIN32<sp/>*/</highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1338"><highlight class="normal"></highlight></codeline>
<codeline lineno="1339" refid="group__libssh__auth_1gac17384e2e1723b50cd041d775c0175a8" refkind="member"><highlight class="normal"><ref refid="structssh__kbdint__struct" kindref="compound">ssh_kbdint</ref><sp/><ref refid="group__libssh__auth_1gac17384e2e1723b50cd041d775c0175a8" kindref="member">ssh_kbdint_new</ref>(</highlight><highlight class="keywordtype">void</highlight><highlight class="normal">)<sp/>{</highlight></codeline>
<codeline lineno="1340"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="structssh__kbdint__struct" kindref="compound">ssh_kbdint</ref><sp/>kbd;</highlight></codeline>
<codeline lineno="1341"><highlight class="normal"></highlight></codeline>
<codeline lineno="1342"><highlight class="normal"><sp/><sp/><sp/><sp/>kbd<sp/>=<sp/>calloc(1,<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(</highlight><highlight class="keyword">struct</highlight><highlight class="normal"><sp/><ref refid="structssh__kbdint__struct" kindref="compound">ssh_kbdint_struct</ref>));</highlight></codeline>
<codeline lineno="1343"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(kbd<sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="1344"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>NULL;</highlight></codeline>
<codeline lineno="1345"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1346"><highlight class="normal"></highlight></codeline>
<codeline lineno="1347"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>kbd;</highlight></codeline>
<codeline lineno="1348"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1349"><highlight class="normal"></highlight></codeline>
<codeline lineno="1350"><highlight class="normal"></highlight></codeline>
<codeline lineno="1351" refid="group__libssh__auth_1ga43266010b4cc11e277658c4c6c4a5500" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="group__libssh__auth_1ga43266010b4cc11e277658c4c6c4a5500" kindref="member">ssh_kbdint_free</ref>(<ref refid="structssh__kbdint__struct" kindref="compound">ssh_kbdint</ref><sp/>kbd)<sp/>{</highlight></codeline>
<codeline lineno="1352"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/>i,<sp/>n;</highlight></codeline>
<codeline lineno="1353"><highlight class="normal"></highlight></codeline>
<codeline lineno="1354"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(kbd<sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="1355"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1356"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1357"><highlight class="normal"></highlight></codeline>
<codeline lineno="1358"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="sshd__direct-tcpip_8c_1aed3129b7674034c979192bcca6b0ad8c" kindref="member">SAFE_FREE</ref>(kbd-&gt;<ref refid="structssh__kbdint__struct_1a8c7f5532d4b52ab7f81bacdf8394c51c" kindref="member">name</ref>);</highlight></codeline>
<codeline lineno="1359"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="sshd__direct-tcpip_8c_1aed3129b7674034c979192bcca6b0ad8c" kindref="member">SAFE_FREE</ref>(kbd-&gt;<ref refid="structssh__kbdint__struct_1a22c149b9323116ac704fabc4c6a5caa6" kindref="member">instruction</ref>);</highlight></codeline>
<codeline lineno="1360"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="sshd__direct-tcpip_8c_1aed3129b7674034c979192bcca6b0ad8c" kindref="member">SAFE_FREE</ref>(kbd-&gt;<ref refid="structssh__kbdint__struct_1a53c38b9a2468c1d79954408e9b7bc7aa" kindref="member">echo</ref>);</highlight></codeline>
<codeline lineno="1361"><highlight class="normal"></highlight></codeline>
<codeline lineno="1362"><highlight class="normal"><sp/><sp/><sp/><sp/>n<sp/>=<sp/>kbd-&gt;<ref refid="structssh__kbdint__struct_1a316bac1f096accc10024c7e787e0e3d6" kindref="member">nprompts</ref>;</highlight></codeline>
<codeline lineno="1363"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(kbd-&gt;<ref refid="structssh__kbdint__struct_1a3b528280ac48b0713c1f963ee9f3574b" kindref="member">prompts</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1364"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/>n;<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="1365"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(kbd-&gt;<ref refid="structssh__kbdint__struct_1a3b528280ac48b0713c1f963ee9f3574b" kindref="member">prompts</ref>[i]<sp/>!=<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="1366"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="group__libssh__misc_1ga51869b401cb0f3e711527bc9a730fbff" kindref="member">explicit_bzero</ref>(kbd-&gt;<ref refid="structssh__kbdint__struct_1a3b528280ac48b0713c1f963ee9f3574b" kindref="member">prompts</ref>[i],<sp/>strlen(kbd-&gt;<ref refid="structssh__kbdint__struct_1a3b528280ac48b0713c1f963ee9f3574b" kindref="member">prompts</ref>[i]));</highlight></codeline>
<codeline lineno="1367"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1368"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="sshd__direct-tcpip_8c_1aed3129b7674034c979192bcca6b0ad8c" kindref="member">SAFE_FREE</ref>(kbd-&gt;<ref refid="structssh__kbdint__struct_1a3b528280ac48b0713c1f963ee9f3574b" kindref="member">prompts</ref>[i]);</highlight></codeline>
<codeline lineno="1369"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1370"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="sshd__direct-tcpip_8c_1aed3129b7674034c979192bcca6b0ad8c" kindref="member">SAFE_FREE</ref>(kbd-&gt;<ref refid="structssh__kbdint__struct_1a3b528280ac48b0713c1f963ee9f3574b" kindref="member">prompts</ref>);</highlight></codeline>
<codeline lineno="1371"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1372"><highlight class="normal"></highlight></codeline>
<codeline lineno="1373"><highlight class="normal"><sp/><sp/><sp/><sp/>n<sp/>=<sp/>kbd-&gt;<ref refid="structssh__kbdint__struct_1af297b39443720d689feb400020c0988f" kindref="member">nanswers</ref>;</highlight></codeline>
<codeline lineno="1374"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(kbd-&gt;<ref refid="structssh__kbdint__struct_1aae334dcc6b8fe544b25f4377360db554" kindref="member">answers</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1375"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/>n;<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="1376"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(kbd-&gt;<ref refid="structssh__kbdint__struct_1aae334dcc6b8fe544b25f4377360db554" kindref="member">answers</ref>[i]<sp/>!=<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="1377"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="group__libssh__misc_1ga51869b401cb0f3e711527bc9a730fbff" kindref="member">explicit_bzero</ref>(kbd-&gt;<ref refid="structssh__kbdint__struct_1aae334dcc6b8fe544b25f4377360db554" kindref="member">answers</ref>[i],<sp/>strlen(kbd-&gt;<ref refid="structssh__kbdint__struct_1aae334dcc6b8fe544b25f4377360db554" kindref="member">answers</ref>[i]));</highlight></codeline>
<codeline lineno="1378"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1379"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="sshd__direct-tcpip_8c_1aed3129b7674034c979192bcca6b0ad8c" kindref="member">SAFE_FREE</ref>(kbd-&gt;<ref refid="structssh__kbdint__struct_1aae334dcc6b8fe544b25f4377360db554" kindref="member">answers</ref>[i]);</highlight></codeline>
<codeline lineno="1380"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1381"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="sshd__direct-tcpip_8c_1aed3129b7674034c979192bcca6b0ad8c" kindref="member">SAFE_FREE</ref>(kbd-&gt;<ref refid="structssh__kbdint__struct_1aae334dcc6b8fe544b25f4377360db554" kindref="member">answers</ref>);</highlight></codeline>
<codeline lineno="1382"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1383"><highlight class="normal"></highlight></codeline>
<codeline lineno="1384"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="sshd__direct-tcpip_8c_1aed3129b7674034c979192bcca6b0ad8c" kindref="member">SAFE_FREE</ref>(kbd);</highlight></codeline>
<codeline lineno="1385"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1386"><highlight class="normal"></highlight></codeline>
<codeline lineno="1387" refid="group__libssh__auth_1gac042e71960b1aa80d8245125feeb249a" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="group__libssh__auth_1gac042e71960b1aa80d8245125feeb249a" kindref="member">ssh_kbdint_clean</ref>(<ref refid="structssh__kbdint__struct" kindref="compound">ssh_kbdint</ref><sp/>kbd)<sp/>{</highlight></codeline>
<codeline lineno="1388"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/>i,<sp/>n;</highlight></codeline>
<codeline lineno="1389"><highlight class="normal"></highlight></codeline>
<codeline lineno="1390"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(kbd<sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="1391"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1392"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1393"><highlight class="normal"></highlight></codeline>
<codeline lineno="1394"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="sshd__direct-tcpip_8c_1aed3129b7674034c979192bcca6b0ad8c" kindref="member">SAFE_FREE</ref>(kbd-&gt;<ref refid="structssh__kbdint__struct_1a8c7f5532d4b52ab7f81bacdf8394c51c" kindref="member">name</ref>);</highlight></codeline>
<codeline lineno="1395"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="sshd__direct-tcpip_8c_1aed3129b7674034c979192bcca6b0ad8c" kindref="member">SAFE_FREE</ref>(kbd-&gt;<ref refid="structssh__kbdint__struct_1a22c149b9323116ac704fabc4c6a5caa6" kindref="member">instruction</ref>);</highlight></codeline>
<codeline lineno="1396"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="sshd__direct-tcpip_8c_1aed3129b7674034c979192bcca6b0ad8c" kindref="member">SAFE_FREE</ref>(kbd-&gt;<ref refid="structssh__kbdint__struct_1a53c38b9a2468c1d79954408e9b7bc7aa" kindref="member">echo</ref>);</highlight></codeline>
<codeline lineno="1397"><highlight class="normal"></highlight></codeline>
<codeline lineno="1398"><highlight class="normal"><sp/><sp/><sp/><sp/>n<sp/>=<sp/>kbd-&gt;<ref refid="structssh__kbdint__struct_1a316bac1f096accc10024c7e787e0e3d6" kindref="member">nprompts</ref>;</highlight></codeline>
<codeline lineno="1399"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(kbd-&gt;<ref refid="structssh__kbdint__struct_1a3b528280ac48b0713c1f963ee9f3574b" kindref="member">prompts</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1400"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/>n;<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="1401"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="group__libssh__misc_1ga51869b401cb0f3e711527bc9a730fbff" kindref="member">explicit_bzero</ref>(kbd-&gt;<ref refid="structssh__kbdint__struct_1a3b528280ac48b0713c1f963ee9f3574b" kindref="member">prompts</ref>[i],<sp/>strlen(kbd-&gt;<ref refid="structssh__kbdint__struct_1a3b528280ac48b0713c1f963ee9f3574b" kindref="member">prompts</ref>[i]));</highlight></codeline>
<codeline lineno="1402"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="sshd__direct-tcpip_8c_1aed3129b7674034c979192bcca6b0ad8c" kindref="member">SAFE_FREE</ref>(kbd-&gt;<ref refid="structssh__kbdint__struct_1a3b528280ac48b0713c1f963ee9f3574b" kindref="member">prompts</ref>[i]);</highlight></codeline>
<codeline lineno="1403"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1404"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="sshd__direct-tcpip_8c_1aed3129b7674034c979192bcca6b0ad8c" kindref="member">SAFE_FREE</ref>(kbd-&gt;<ref refid="structssh__kbdint__struct_1a3b528280ac48b0713c1f963ee9f3574b" kindref="member">prompts</ref>);</highlight></codeline>
<codeline lineno="1405"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1406"><highlight class="normal"></highlight></codeline>
<codeline lineno="1407"><highlight class="normal"><sp/><sp/><sp/><sp/>n<sp/>=<sp/>kbd-&gt;<ref refid="structssh__kbdint__struct_1af297b39443720d689feb400020c0988f" kindref="member">nanswers</ref>;</highlight></codeline>
<codeline lineno="1408"><highlight class="normal"></highlight></codeline>
<codeline lineno="1409"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(kbd-&gt;<ref refid="structssh__kbdint__struct_1aae334dcc6b8fe544b25f4377360db554" kindref="member">answers</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1410"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/>n;<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="1411"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="group__libssh__misc_1ga51869b401cb0f3e711527bc9a730fbff" kindref="member">explicit_bzero</ref>(kbd-&gt;<ref refid="structssh__kbdint__struct_1aae334dcc6b8fe544b25f4377360db554" kindref="member">answers</ref>[i],<sp/>strlen(kbd-&gt;<ref refid="structssh__kbdint__struct_1aae334dcc6b8fe544b25f4377360db554" kindref="member">answers</ref>[i]));</highlight></codeline>
<codeline lineno="1412"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="sshd__direct-tcpip_8c_1aed3129b7674034c979192bcca6b0ad8c" kindref="member">SAFE_FREE</ref>(kbd-&gt;<ref refid="structssh__kbdint__struct_1aae334dcc6b8fe544b25f4377360db554" kindref="member">answers</ref>[i]);</highlight></codeline>
<codeline lineno="1413"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1414"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="sshd__direct-tcpip_8c_1aed3129b7674034c979192bcca6b0ad8c" kindref="member">SAFE_FREE</ref>(kbd-&gt;<ref refid="structssh__kbdint__struct_1aae334dcc6b8fe544b25f4377360db554" kindref="member">answers</ref>);</highlight></codeline>
<codeline lineno="1415"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1416"><highlight class="normal"></highlight></codeline>
<codeline lineno="1417"><highlight class="normal"><sp/><sp/><sp/><sp/>kbd-&gt;<ref refid="structssh__kbdint__struct_1a316bac1f096accc10024c7e787e0e3d6" kindref="member">nprompts</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="1418"><highlight class="normal"><sp/><sp/><sp/><sp/>kbd-&gt;<ref refid="structssh__kbdint__struct_1af297b39443720d689feb400020c0988f" kindref="member">nanswers</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="1419"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1420"><highlight class="normal"></highlight></codeline>
<codeline lineno="1421"><highlight class="normal"></highlight><highlight class="comment">/*</highlight></codeline>
<codeline lineno="1422"><highlight class="comment"><sp/>*<sp/>This<sp/>function<sp/>sends<sp/>the<sp/>first<sp/>packet<sp/>as<sp/>explained<sp/>in<sp/>RFC<sp/>3066<sp/>section<sp/>3.1.</highlight></codeline>
<codeline lineno="1423"><highlight class="comment"><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1424" refid="group__libssh__auth_1gac689d3761c0dc4ebee9971ecc482d9a4" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="group__libssh__auth_1gac689d3761c0dc4ebee9971ecc482d9a4" kindref="member">ssh_userauth_kbdint_init</ref>(<ref refid="structssh__session__struct" kindref="compound">ssh_session</ref><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>,</highlight></codeline>
<codeline lineno="1425"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*<ref refid="proxy_8c_1a9b20c006bd90a09e1465fb668700e81d" kindref="member">username</ref>,</highlight></codeline>
<codeline lineno="1426"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*submethods)</highlight></codeline>
<codeline lineno="1427"><highlight class="normal">{</highlight></codeline>
<codeline lineno="1428"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref>;</highlight></codeline>
<codeline lineno="1429"><highlight class="normal"></highlight></codeline>
<codeline lineno="1430"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a5552665043089000065df39c5a5a7094" kindref="member">pending_call_state</ref><sp/>==<sp/><ref refid="session_8h_1abb7a4342b889601983497b3f094957e1afa2439f8a91fc9c57f773b3264a498fc" kindref="member">SSH_PENDING_CALL_AUTH_KBDINT_INIT</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1431"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">goto</highlight><highlight class="normal"><sp/>pending;</highlight></codeline>
<codeline lineno="1432"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1433"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a5552665043089000065df39c5a5a7094" kindref="member">pending_call_state</ref><sp/>!=<sp/><ref refid="session_8h_1abb7a4342b889601983497b3f094957e1a33be3f7cd03fe7fced1eeacd369cad94" kindref="member">SSH_PENDING_CALL_NONE</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1434"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="priv_8h_1a351ea86857d33b3ba80b396e05c4517c" kindref="member">ssh_set_error_invalid</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>);</highlight></codeline>
<codeline lineno="1435"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" kindref="member">SSH_ERROR</ref>;</highlight></codeline>
<codeline lineno="1436"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1437"><highlight class="normal"></highlight></codeline>
<codeline lineno="1438"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="group__libssh__auth_1ga812fb86c3dd4a6245bc7d01beaa9cfe8" kindref="member">ssh_userauth_request_service</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>);</highlight></codeline>
<codeline lineno="1439"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>==<sp/><ref refid="libssh_8h_1a9c57e4f6482106336045a4d25a55f28e" kindref="member">SSH_AGAIN</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1440"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="libssh_8h_1a5b35a5038ad8eac4a4e4c00c6239e6e2a0f166cff4fa03faf4e4c11ad854a4996" kindref="member">SSH_AUTH_AGAIN</ref>;</highlight></codeline>
<codeline lineno="1441"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1442"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>!=<sp/><ref refid="libssh_8h_1ac1ee1d1e917456d4760a94a18015377d" kindref="member">SSH_OK</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1443"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="libssh_8h_1a5b35a5038ad8eac4a4e4c00c6239e6e2a33d82f552d20734c17e770af637e3e17" kindref="member">SSH_AUTH_ERROR</ref>;</highlight></codeline>
<codeline lineno="1444"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1445"><highlight class="normal"></highlight></codeline>
<codeline lineno="1446"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>request<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1447"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="buffer_8h_1ae17848a86043f0abfc60c1c4f6126ccd" kindref="member">ssh_buffer_pack</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1af0aed60c1e529bbfdcb483fd80bf98a0" kindref="member">out_buffer</ref>,<sp/></highlight><highlight class="stringliteral">&quot;bsssss&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="1448"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ssh2_8h_1a423ea81df02faff2d59b730af16ac59e" kindref="member">SSH2_MSG_USERAUTH_REQUEST</ref>,</highlight></codeline>
<codeline lineno="1449"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="proxy_8c_1a9b20c006bd90a09e1465fb668700e81d" kindref="member">username</ref><sp/>?<sp/><ref refid="proxy_8c_1a9b20c006bd90a09e1465fb668700e81d" kindref="member">username</ref><sp/>:<sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a1c29cf990c1d0df6e1b0971d4f3d1f3e" kindref="member">opts</ref>.<ref refid="structssh__session__struct_1a8ed5d5d3116679fd7b8f2c0e1db92726" kindref="member">username</ref>,</highlight></codeline>
<codeline lineno="1450"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;ssh-connection&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="1451"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;keyboard-interactive&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="1452"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;</highlight><highlight class="normal">,<sp/></highlight><highlight class="comment">/*<sp/>lang<sp/>(ignore<sp/>it)<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1453"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>submethods<sp/>?<sp/>submethods<sp/>:<sp/></highlight><highlight class="stringliteral">&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1454"><highlight class="normal"><sp/><sp/><sp/><sp/>);</highlight></codeline>
<codeline lineno="1455"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>&lt;<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="1456"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">goto</highlight><highlight class="normal"><sp/>fail;</highlight></codeline>
<codeline lineno="1457"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1458"><highlight class="normal"></highlight></codeline>
<codeline lineno="1459"><highlight class="normal"></highlight></codeline>
<codeline lineno="1460"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a3d57e01582c0c9099f7f319513321fe8" kindref="member">auth</ref>.<ref refid="structssh__session__struct_1af0805877d21d43e81423ead52345c64b" kindref="member">state</ref><sp/>=<sp/><ref refid="auth_8h_1a0d3114986a741a14dc3ac03f7d8eafefa6d785d00012593230e88f00debb19179" kindref="member">SSH_AUTH_STATE_KBDINT_SENT</ref>;</highlight></codeline>
<codeline lineno="1461"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a5552665043089000065df39c5a5a7094" kindref="member">pending_call_state</ref><sp/>=<sp/><ref refid="session_8h_1abb7a4342b889601983497b3f094957e1afa2439f8a91fc9c57f773b3264a498fc" kindref="member">SSH_PENDING_CALL_AUTH_KBDINT_INIT</ref>;</highlight></codeline>
<codeline lineno="1462"><highlight class="normal"></highlight></codeline>
<codeline lineno="1463"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="priv_8h_1aa21fd8a7a609329603b7b16da7939fca" kindref="member">SSH_LOG</ref>(<ref refid="libssh_8h_1a5e4247396f11fdc228d356a408c81715" kindref="member">SSH_LOG_DEBUG</ref>,</highlight></codeline>
<codeline lineno="1464"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Sending<sp/>keyboard-interactive<sp/>init<sp/>request&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="1465"><highlight class="normal"></highlight></codeline>
<codeline lineno="1466"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="packet_8h_1a7e6c7ed74c23ace432476aa8a6841140" kindref="member">ssh_packet_send</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>);</highlight></codeline>
<codeline lineno="1467"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>==<sp/><ref refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" kindref="member">SSH_ERROR</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1468"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="libssh_8h_1a5b35a5038ad8eac4a4e4c00c6239e6e2a33d82f552d20734c17e770af637e3e17" kindref="member">SSH_AUTH_ERROR</ref>;</highlight></codeline>
<codeline lineno="1469"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1470"><highlight class="normal">pending:</highlight></codeline>
<codeline lineno="1471"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="group__libssh__auth_1gabff6b3898d3bf45b62cc3ed3774eaa83" kindref="member">ssh_userauth_get_response</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>);</highlight></codeline>
<codeline lineno="1472"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>!=<sp/><ref refid="libssh_8h_1a5b35a5038ad8eac4a4e4c00c6239e6e2a0f166cff4fa03faf4e4c11ad854a4996" kindref="member">SSH_AUTH_AGAIN</ref>)</highlight></codeline>
<codeline lineno="1473"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a5552665043089000065df39c5a5a7094" kindref="member">pending_call_state</ref><sp/>=<sp/><ref refid="session_8h_1abb7a4342b889601983497b3f094957e1a33be3f7cd03fe7fced1eeacd369cad94" kindref="member">SSH_PENDING_CALL_NONE</ref>;</highlight></codeline>
<codeline lineno="1474"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref>;</highlight></codeline>
<codeline lineno="1475"><highlight class="normal">fail:</highlight></codeline>
<codeline lineno="1476"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="priv_8h_1ae280c413c792e04237f000841ac8ce44" kindref="member">ssh_set_error_oom</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>);</highlight></codeline>
<codeline lineno="1477"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="libssh_8h_1ac8802ff7f5348d0145dab5242623f740" kindref="member">ssh_buffer_reinit</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1af0aed60c1e529bbfdcb483fd80bf98a0" kindref="member">out_buffer</ref>);</highlight></codeline>
<codeline lineno="1478"><highlight class="normal"></highlight></codeline>
<codeline lineno="1479"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="libssh_8h_1a5b35a5038ad8eac4a4e4c00c6239e6e2a33d82f552d20734c17e770af637e3e17" kindref="member">SSH_AUTH_ERROR</ref>;</highlight></codeline>
<codeline lineno="1480"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1481"><highlight class="normal"></highlight></codeline>
<codeline lineno="1493" refid="group__libssh__auth_1gaaa68e6aec2da509b246b7cba071408d3" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="group__libssh__auth_1gaaa68e6aec2da509b246b7cba071408d3" kindref="member">ssh_userauth_kbdint_send</ref>(<ref refid="structssh__session__struct" kindref="compound">ssh_session</ref><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>)</highlight></codeline>
<codeline lineno="1494"><highlight class="normal">{</highlight></codeline>
<codeline lineno="1495"><highlight class="normal"><sp/><sp/><sp/><sp/>uint32_t<sp/>i;</highlight></codeline>
<codeline lineno="1496"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref>;</highlight></codeline>
<codeline lineno="1497"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a5552665043089000065df39c5a5a7094" kindref="member">pending_call_state</ref><sp/>==<sp/><ref refid="session_8h_1abb7a4342b889601983497b3f094957e1a964524d093fc2ba649020c4ce5460b94" kindref="member">SSH_PENDING_CALL_AUTH_KBDINT_SEND</ref>)</highlight></codeline>
<codeline lineno="1498"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">goto</highlight><highlight class="normal"><sp/>pending;</highlight></codeline>
<codeline lineno="1499"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a5552665043089000065df39c5a5a7094" kindref="member">pending_call_state</ref><sp/>!=<sp/><ref refid="session_8h_1abb7a4342b889601983497b3f094957e1a33be3f7cd03fe7fced1eeacd369cad94" kindref="member">SSH_PENDING_CALL_NONE</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1500"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="priv_8h_1a351ea86857d33b3ba80b396e05c4517c" kindref="member">ssh_set_error_invalid</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>);</highlight></codeline>
<codeline lineno="1501"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" kindref="member">SSH_ERROR</ref>;</highlight></codeline>
<codeline lineno="1502"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1503"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="buffer_8h_1ae17848a86043f0abfc60c1c4f6126ccd" kindref="member">ssh_buffer_pack</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1af0aed60c1e529bbfdcb483fd80bf98a0" kindref="member">out_buffer</ref>,<sp/></highlight><highlight class="stringliteral">&quot;bd&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="1504"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ssh2_8h_1a084c04a458a6b7fba56d7bf6b2d3a58b" kindref="member">SSH2_MSG_USERAUTH_INFO_RESPONSE</ref>,</highlight></codeline>
<codeline lineno="1505"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a9cba44c19f35693037bc9bb1e0651d17" kindref="member">kbdint</ref>-&gt;<ref refid="structssh__kbdint__struct_1a316bac1f096accc10024c7e787e0e3d6" kindref="member">nprompts</ref>);</highlight></codeline>
<codeline lineno="1506"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>&lt;<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="1507"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">goto</highlight><highlight class="normal"><sp/>fail;</highlight></codeline>
<codeline lineno="1508"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1509"><highlight class="normal"></highlight></codeline>
<codeline lineno="1510"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a9cba44c19f35693037bc9bb1e0651d17" kindref="member">kbdint</ref>-&gt;<ref refid="structssh__kbdint__struct_1a316bac1f096accc10024c7e787e0e3d6" kindref="member">nprompts</ref>;<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="1511"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="buffer_8h_1ae17848a86043f0abfc60c1c4f6126ccd" kindref="member">ssh_buffer_pack</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1af0aed60c1e529bbfdcb483fd80bf98a0" kindref="member">out_buffer</ref>,<sp/></highlight><highlight class="stringliteral">&quot;s&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="1512"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a9cba44c19f35693037bc9bb1e0651d17" kindref="member">kbdint</ref>-&gt;<ref refid="structssh__kbdint__struct_1aae334dcc6b8fe544b25f4377360db554" kindref="member">answers</ref><sp/>&amp;&amp;<sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a9cba44c19f35693037bc9bb1e0651d17" kindref="member">kbdint</ref>-&gt;<ref refid="structssh__kbdint__struct_1aae334dcc6b8fe544b25f4377360db554" kindref="member">answers</ref>[i]<sp/>?</highlight></codeline>
<codeline lineno="1513"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a9cba44c19f35693037bc9bb1e0651d17" kindref="member">kbdint</ref>-&gt;<ref refid="structssh__kbdint__struct_1aae334dcc6b8fe544b25f4377360db554" kindref="member">answers</ref>[i]:</highlight><highlight class="stringliteral">&quot;&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="1514"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>&lt;<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="1515"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">goto</highlight><highlight class="normal"><sp/>fail;</highlight></codeline>
<codeline lineno="1516"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1517"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1518"><highlight class="normal"></highlight></codeline>
<codeline lineno="1519"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a3d57e01582c0c9099f7f319513321fe8" kindref="member">auth</ref>.<ref refid="structssh__session__struct_1aa859857ac7a99808ffc537e08087e541" kindref="member">current_method</ref><sp/>=<sp/><ref refid="libssh_8h_1a4c64484fdce4756309799d0e2a4e926a" kindref="member">SSH_AUTH_METHOD_INTERACTIVE</ref>;</highlight></codeline>
<codeline lineno="1520"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a3d57e01582c0c9099f7f319513321fe8" kindref="member">auth</ref>.<ref refid="structssh__session__struct_1af0805877d21d43e81423ead52345c64b" kindref="member">state</ref><sp/>=<sp/><ref refid="auth_8h_1a0d3114986a741a14dc3ac03f7d8eafefa6d785d00012593230e88f00debb19179" kindref="member">SSH_AUTH_STATE_KBDINT_SENT</ref>;</highlight></codeline>
<codeline lineno="1521"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a5552665043089000065df39c5a5a7094" kindref="member">pending_call_state</ref><sp/>=<sp/><ref refid="session_8h_1abb7a4342b889601983497b3f094957e1a964524d093fc2ba649020c4ce5460b94" kindref="member">SSH_PENDING_CALL_AUTH_KBDINT_SEND</ref>;</highlight></codeline>
<codeline lineno="1522"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="group__libssh__auth_1ga43266010b4cc11e277658c4c6c4a5500" kindref="member">ssh_kbdint_free</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a9cba44c19f35693037bc9bb1e0651d17" kindref="member">kbdint</ref>);</highlight></codeline>
<codeline lineno="1523"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a9cba44c19f35693037bc9bb1e0651d17" kindref="member">kbdint</ref><sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="1524"><highlight class="normal"></highlight></codeline>
<codeline lineno="1525"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="priv_8h_1aa21fd8a7a609329603b7b16da7939fca" kindref="member">SSH_LOG</ref>(<ref refid="libssh_8h_1a5e4247396f11fdc228d356a408c81715" kindref="member">SSH_LOG_DEBUG</ref>,</highlight></codeline>
<codeline lineno="1526"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Sending<sp/>keyboard-interactive<sp/>response<sp/>packet&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="1527"><highlight class="normal"></highlight></codeline>
<codeline lineno="1528"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="packet_8h_1a7e6c7ed74c23ace432476aa8a6841140" kindref="member">ssh_packet_send</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>);</highlight></codeline>
<codeline lineno="1529"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>==<sp/><ref refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" kindref="member">SSH_ERROR</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1530"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="libssh_8h_1a5b35a5038ad8eac4a4e4c00c6239e6e2a33d82f552d20734c17e770af637e3e17" kindref="member">SSH_AUTH_ERROR</ref>;</highlight></codeline>
<codeline lineno="1531"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1532"><highlight class="normal">pending:</highlight></codeline>
<codeline lineno="1533"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="group__libssh__auth_1gabff6b3898d3bf45b62cc3ed3774eaa83" kindref="member">ssh_userauth_get_response</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>);</highlight></codeline>
<codeline lineno="1534"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>!=<sp/><ref refid="libssh_8h_1a5b35a5038ad8eac4a4e4c00c6239e6e2a0f166cff4fa03faf4e4c11ad854a4996" kindref="member">SSH_AUTH_AGAIN</ref>)</highlight></codeline>
<codeline lineno="1535"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a5552665043089000065df39c5a5a7094" kindref="member">pending_call_state</ref><sp/>=<sp/><ref refid="session_8h_1abb7a4342b889601983497b3f094957e1a33be3f7cd03fe7fced1eeacd369cad94" kindref="member">SSH_PENDING_CALL_NONE</ref>;</highlight></codeline>
<codeline lineno="1536"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref>;</highlight></codeline>
<codeline lineno="1537"><highlight class="normal">fail:</highlight></codeline>
<codeline lineno="1538"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="priv_8h_1ae280c413c792e04237f000841ac8ce44" kindref="member">ssh_set_error_oom</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>);</highlight></codeline>
<codeline lineno="1539"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="libssh_8h_1ac8802ff7f5348d0145dab5242623f740" kindref="member">ssh_buffer_reinit</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1af0aed60c1e529bbfdcb483fd80bf98a0" kindref="member">out_buffer</ref>);</highlight></codeline>
<codeline lineno="1540"><highlight class="normal"></highlight></codeline>
<codeline lineno="1541"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="libssh_8h_1a5b35a5038ad8eac4a4e4c00c6239e6e2a33d82f552d20734c17e770af637e3e17" kindref="member">SSH_AUTH_ERROR</ref>;</highlight></codeline>
<codeline lineno="1542"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1543"><highlight class="normal"></highlight></codeline>
<codeline lineno="1550" refid="group__libssh__auth_1ga09059b696a82df0fb633977d2749e10a" refkind="member"><highlight class="normal"><ref refid="group__libssh__auth_1ga1fc1f11c7ba0469c866c42956450ebf7" kindref="member">SSH_PACKET_CALLBACK</ref>(ssh_packet_userauth_info_request)<sp/>{</highlight></codeline>
<codeline lineno="1551"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="structssh__string__struct" kindref="compound">ssh_string</ref><sp/>tmp<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="1552"><highlight class="normal"><sp/><sp/><sp/><sp/>uint32_t<sp/>nprompts;</highlight></codeline>
<codeline lineno="1553"><highlight class="normal"><sp/><sp/><sp/><sp/>uint32_t<sp/>i;</highlight></codeline>
<codeline lineno="1554"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref>;</highlight></codeline>
<codeline lineno="1555"><highlight class="normal"><sp/><sp/><sp/><sp/>(void)<ref refid="ssh__client_8c_1a14871705f45ccdc5bb9f4549efd8e119" kindref="member">user</ref>;</highlight></codeline>
<codeline lineno="1556"><highlight class="normal"><sp/><sp/><sp/><sp/>(void)type;</highlight></codeline>
<codeline lineno="1557"><highlight class="normal"></highlight></codeline>
<codeline lineno="1558"><highlight class="normal"></highlight></codeline>
<codeline lineno="1559"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a9cba44c19f35693037bc9bb1e0651d17" kindref="member">kbdint</ref><sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="1560"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a9cba44c19f35693037bc9bb1e0651d17" kindref="member">kbdint</ref><sp/>=<sp/><ref refid="group__libssh__auth_1gac17384e2e1723b50cd041d775c0175a8" kindref="member">ssh_kbdint_new</ref>();</highlight></codeline>
<codeline lineno="1561"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a9cba44c19f35693037bc9bb1e0651d17" kindref="member">kbdint</ref><sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="1562"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="priv_8h_1ae280c413c792e04237f000841ac8ce44" kindref="member">ssh_set_error_oom</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>);</highlight></codeline>
<codeline lineno="1563"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="group__libssh__callbacks_1gac29df803aa1295d6a498c1b081f3b494" kindref="member">SSH_PACKET_USED</ref>;</highlight></codeline>
<codeline lineno="1564"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1565"><highlight class="normal"><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="1566"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="group__libssh__auth_1gac042e71960b1aa80d8245125feeb249a" kindref="member">ssh_kbdint_clean</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a9cba44c19f35693037bc9bb1e0651d17" kindref="member">kbdint</ref>);</highlight></codeline>
<codeline lineno="1567"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1568"><highlight class="normal"></highlight></codeline>
<codeline lineno="1569"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="buffer_8h_1ab51014ef9a47e7cdbd235af3e62b81ee" kindref="member">ssh_buffer_unpack</ref>(packet,<sp/></highlight><highlight class="stringliteral">&quot;ssSd&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="1570"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&amp;<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a9cba44c19f35693037bc9bb1e0651d17" kindref="member">kbdint</ref>-&gt;<ref refid="structssh__kbdint__struct_1a8c7f5532d4b52ab7f81bacdf8394c51c" kindref="member">name</ref>,<sp/></highlight><highlight class="comment">/*<sp/>name<sp/>of<sp/>the<sp/>&quot;asking&quot;<sp/>window<sp/>shown<sp/>to<sp/>client<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1571"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&amp;<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a9cba44c19f35693037bc9bb1e0651d17" kindref="member">kbdint</ref>-&gt;<ref refid="structssh__kbdint__struct_1a22c149b9323116ac704fabc4c6a5caa6" kindref="member">instruction</ref>,</highlight></codeline>
<codeline lineno="1572"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&amp;tmp,<sp/></highlight><highlight class="comment">/*<sp/>to<sp/>ignore<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1573"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&amp;nprompts</highlight></codeline>
<codeline lineno="1574"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>);</highlight></codeline>
<codeline lineno="1575"><highlight class="normal"></highlight></codeline>
<codeline lineno="1576"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>We<sp/>don&apos;t<sp/>care<sp/>about<sp/>tmp<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1577"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="libssh_8h_1a5bc8710c8633117ff449d15489fca051" kindref="member">SSH_STRING_FREE</ref>(tmp);</highlight></codeline>
<codeline lineno="1578"><highlight class="normal"></highlight></codeline>
<codeline lineno="1579"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>!=<sp/><ref refid="libssh_8h_1ac1ee1d1e917456d4760a94a18015377d" kindref="member">SSH_OK</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1580"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="priv_8h_1a55177b3e8db90ca9adb435c44281963c" kindref="member">ssh_set_error</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>,<sp/><ref refid="libssh_8h_1a036b2b00fb04337a4d06d719d1b62be1a86ff0b2e8da6ad8628efc556b6ce1887" kindref="member">SSH_FATAL</ref>,<sp/></highlight><highlight class="stringliteral">&quot;Invalid<sp/>USERAUTH_INFO_REQUEST<sp/>msg&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="1581"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="group__libssh__auth_1ga43266010b4cc11e277658c4c6c4a5500" kindref="member">ssh_kbdint_free</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a9cba44c19f35693037bc9bb1e0651d17" kindref="member">kbdint</ref>);</highlight></codeline>
<codeline lineno="1582"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a9cba44c19f35693037bc9bb1e0651d17" kindref="member">kbdint</ref><sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="1583"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="group__libssh__callbacks_1gac29df803aa1295d6a498c1b081f3b494" kindref="member">SSH_PACKET_USED</ref>;</highlight></codeline>
<codeline lineno="1584"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1585"><highlight class="normal"></highlight></codeline>
<codeline lineno="1586"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="priv_8h_1aa21fd8a7a609329603b7b16da7939fca" kindref="member">SSH_LOG</ref>(<ref refid="libssh_8h_1a5e4247396f11fdc228d356a408c81715" kindref="member">SSH_LOG_DEBUG</ref>,</highlight></codeline>
<codeline lineno="1587"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;%d<sp/>keyboard-interactive<sp/>prompts&quot;</highlight><highlight class="normal">,<sp/>nprompts);</highlight></codeline>
<codeline lineno="1588"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(nprompts<sp/>&gt;<sp/><ref refid="priv_8h_1a16b639610e39b29f5a1114e2dcf4ac6f" kindref="member">KBDINT_MAX_PROMPT</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1589"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="priv_8h_1a55177b3e8db90ca9adb435c44281963c" kindref="member">ssh_set_error</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>,<sp/><ref refid="libssh_8h_1a036b2b00fb04337a4d06d719d1b62be1a86ff0b2e8da6ad8628efc556b6ce1887" kindref="member">SSH_FATAL</ref>,</highlight></codeline>
<codeline lineno="1590"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Too<sp/>much<sp/>prompts<sp/>requested<sp/>by<sp/>the<sp/>server:<sp/>%u<sp/>(0x%.4x)&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="1591"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nprompts,<sp/>nprompts);</highlight></codeline>
<codeline lineno="1592"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="group__libssh__auth_1ga43266010b4cc11e277658c4c6c4a5500" kindref="member">ssh_kbdint_free</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a9cba44c19f35693037bc9bb1e0651d17" kindref="member">kbdint</ref>);</highlight></codeline>
<codeline lineno="1593"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a9cba44c19f35693037bc9bb1e0651d17" kindref="member">kbdint</ref><sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="1594"><highlight class="normal"></highlight></codeline>
<codeline lineno="1595"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="group__libssh__callbacks_1gac29df803aa1295d6a498c1b081f3b494" kindref="member">SSH_PACKET_USED</ref>;</highlight></codeline>
<codeline lineno="1596"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1597"><highlight class="normal"></highlight></codeline>
<codeline lineno="1598"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a9cba44c19f35693037bc9bb1e0651d17" kindref="member">kbdint</ref>-&gt;<ref refid="structssh__kbdint__struct_1a316bac1f096accc10024c7e787e0e3d6" kindref="member">nprompts</ref><sp/>=<sp/>nprompts;</highlight></codeline>
<codeline lineno="1599"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a9cba44c19f35693037bc9bb1e0651d17" kindref="member">kbdint</ref>-&gt;<ref refid="structssh__kbdint__struct_1af297b39443720d689feb400020c0988f" kindref="member">nanswers</ref><sp/>=<sp/>nprompts;</highlight></codeline>
<codeline lineno="1600"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a9cba44c19f35693037bc9bb1e0651d17" kindref="member">kbdint</ref>-&gt;<ref refid="structssh__kbdint__struct_1a3b528280ac48b0713c1f963ee9f3574b" kindref="member">prompts</ref><sp/>=<sp/>calloc(nprompts,<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(</highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*));</highlight></codeline>
<codeline lineno="1601"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a9cba44c19f35693037bc9bb1e0651d17" kindref="member">kbdint</ref>-&gt;<ref refid="structssh__kbdint__struct_1a3b528280ac48b0713c1f963ee9f3574b" kindref="member">prompts</ref><sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="1602"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a9cba44c19f35693037bc9bb1e0651d17" kindref="member">kbdint</ref>-&gt;<ref refid="structssh__kbdint__struct_1a316bac1f096accc10024c7e787e0e3d6" kindref="member">nprompts</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="1603"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="priv_8h_1ae280c413c792e04237f000841ac8ce44" kindref="member">ssh_set_error_oom</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>);</highlight></codeline>
<codeline lineno="1604"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="group__libssh__auth_1ga43266010b4cc11e277658c4c6c4a5500" kindref="member">ssh_kbdint_free</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a9cba44c19f35693037bc9bb1e0651d17" kindref="member">kbdint</ref>);</highlight></codeline>
<codeline lineno="1605"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a9cba44c19f35693037bc9bb1e0651d17" kindref="member">kbdint</ref><sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="1606"><highlight class="normal"></highlight></codeline>
<codeline lineno="1607"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="group__libssh__callbacks_1gac29df803aa1295d6a498c1b081f3b494" kindref="member">SSH_PACKET_USED</ref>;</highlight></codeline>
<codeline lineno="1608"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1609"><highlight class="normal"></highlight></codeline>
<codeline lineno="1610"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a9cba44c19f35693037bc9bb1e0651d17" kindref="member">kbdint</ref>-&gt;<ref refid="structssh__kbdint__struct_1a53c38b9a2468c1d79954408e9b7bc7aa" kindref="member">echo</ref><sp/>=<sp/>calloc(nprompts,<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(</highlight><highlight class="keywordtype">unsigned</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal">));</highlight></codeline>
<codeline lineno="1611"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a9cba44c19f35693037bc9bb1e0651d17" kindref="member">kbdint</ref>-&gt;<ref refid="structssh__kbdint__struct_1a53c38b9a2468c1d79954408e9b7bc7aa" kindref="member">echo</ref><sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="1612"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a9cba44c19f35693037bc9bb1e0651d17" kindref="member">kbdint</ref>-&gt;<ref refid="structssh__kbdint__struct_1a316bac1f096accc10024c7e787e0e3d6" kindref="member">nprompts</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="1613"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="priv_8h_1ae280c413c792e04237f000841ac8ce44" kindref="member">ssh_set_error_oom</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>);</highlight></codeline>
<codeline lineno="1614"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="group__libssh__auth_1ga43266010b4cc11e277658c4c6c4a5500" kindref="member">ssh_kbdint_free</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a9cba44c19f35693037bc9bb1e0651d17" kindref="member">kbdint</ref>);</highlight></codeline>
<codeline lineno="1615"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a9cba44c19f35693037bc9bb1e0651d17" kindref="member">kbdint</ref><sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="1616"><highlight class="normal"></highlight></codeline>
<codeline lineno="1617"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="group__libssh__callbacks_1gac29df803aa1295d6a498c1b081f3b494" kindref="member">SSH_PACKET_USED</ref>;</highlight></codeline>
<codeline lineno="1618"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1619"><highlight class="normal"></highlight></codeline>
<codeline lineno="1620"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/>nprompts;<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="1621"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="buffer_8h_1ab51014ef9a47e7cdbd235af3e62b81ee" kindref="member">ssh_buffer_unpack</ref>(packet,<sp/></highlight><highlight class="stringliteral">&quot;sb&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="1622"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&amp;<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a9cba44c19f35693037bc9bb1e0651d17" kindref="member">kbdint</ref>-&gt;<ref refid="structssh__kbdint__struct_1a3b528280ac48b0713c1f963ee9f3574b" kindref="member">prompts</ref>[i],</highlight></codeline>
<codeline lineno="1623"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&amp;<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a9cba44c19f35693037bc9bb1e0651d17" kindref="member">kbdint</ref>-&gt;<ref refid="structssh__kbdint__struct_1a53c38b9a2468c1d79954408e9b7bc7aa" kindref="member">echo</ref>[i]);</highlight></codeline>
<codeline lineno="1624"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>==<sp/><ref refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" kindref="member">SSH_ERROR</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1625"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="priv_8h_1a55177b3e8db90ca9adb435c44281963c" kindref="member">ssh_set_error</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>,<sp/><ref refid="libssh_8h_1a036b2b00fb04337a4d06d719d1b62be1a86ff0b2e8da6ad8628efc556b6ce1887" kindref="member">SSH_FATAL</ref>,<sp/></highlight><highlight class="stringliteral">&quot;Short<sp/>INFO_REQUEST<sp/>packet&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="1626"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="group__libssh__auth_1ga43266010b4cc11e277658c4c6c4a5500" kindref="member">ssh_kbdint_free</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a9cba44c19f35693037bc9bb1e0651d17" kindref="member">kbdint</ref>);</highlight></codeline>
<codeline lineno="1627"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a9cba44c19f35693037bc9bb1e0651d17" kindref="member">kbdint</ref><sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="1628"><highlight class="normal"></highlight></codeline>
<codeline lineno="1629"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="group__libssh__callbacks_1gac29df803aa1295d6a498c1b081f3b494" kindref="member">SSH_PACKET_USED</ref>;</highlight></codeline>
<codeline lineno="1630"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1631"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1632"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a3d57e01582c0c9099f7f319513321fe8" kindref="member">auth</ref>.<ref refid="structssh__session__struct_1af0805877d21d43e81423ead52345c64b" kindref="member">state</ref>=<ref refid="auth_8h_1a0d3114986a741a14dc3ac03f7d8eafefa97ddb5eeec18ad7d054ec5795e6e16d6" kindref="member">SSH_AUTH_STATE_INFO</ref>;</highlight></codeline>
<codeline lineno="1633"><highlight class="normal"></highlight></codeline>
<codeline lineno="1634"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="group__libssh__callbacks_1gac29df803aa1295d6a498c1b081f3b494" kindref="member">SSH_PACKET_USED</ref>;</highlight></codeline>
<codeline lineno="1635"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1636"><highlight class="normal"></highlight></codeline>
<codeline lineno="1664" refid="group__libssh__auth_1ga6b3b1c2a045286d9476b0252791a07d2" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="group__libssh__auth_1ga6b3b1c2a045286d9476b0252791a07d2" kindref="member">ssh_userauth_kbdint</ref>(<ref refid="structssh__session__struct" kindref="compound">ssh_session</ref><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*<ref refid="ssh__client_8c_1a14871705f45ccdc5bb9f4549efd8e119" kindref="member">user</ref>,</highlight></codeline>
<codeline lineno="1665"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*submethods)<sp/>{</highlight></codeline>
<codeline lineno="1666"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="libssh_8h_1a5b35a5038ad8eac4a4e4c00c6239e6e2a33d82f552d20734c17e770af637e3e17" kindref="member">SSH_AUTH_ERROR</ref>;</highlight></codeline>
<codeline lineno="1667"><highlight class="normal"></highlight></codeline>
<codeline lineno="1668"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref><sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="1669"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="libssh_8h_1a5b35a5038ad8eac4a4e4c00c6239e6e2a33d82f552d20734c17e770af637e3e17" kindref="member">SSH_AUTH_ERROR</ref>;</highlight></codeline>
<codeline lineno="1670"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1671"><highlight class="normal"></highlight></codeline>
<codeline lineno="1672"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>((<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a5552665043089000065df39c5a5a7094" kindref="member">pending_call_state</ref><sp/>==<sp/><ref refid="session_8h_1abb7a4342b889601983497b3f094957e1a33be3f7cd03fe7fced1eeacd369cad94" kindref="member">SSH_PENDING_CALL_NONE</ref><sp/>&amp;&amp;<sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a9cba44c19f35693037bc9bb1e0651d17" kindref="member">kbdint</ref><sp/>==<sp/>NULL)<sp/>||</highlight></codeline>
<codeline lineno="1673"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a5552665043089000065df39c5a5a7094" kindref="member">pending_call_state</ref><sp/>==<sp/><ref refid="session_8h_1abb7a4342b889601983497b3f094957e1afa2439f8a91fc9c57f773b3264a498fc" kindref="member">SSH_PENDING_CALL_AUTH_KBDINT_INIT</ref>)</highlight></codeline>
<codeline lineno="1674"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="group__libssh__auth_1gac689d3761c0dc4ebee9971ecc482d9a4" kindref="member">ssh_userauth_kbdint_init</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>,<sp/><ref refid="ssh__client_8c_1a14871705f45ccdc5bb9f4549efd8e119" kindref="member">user</ref>,<sp/>submethods);</highlight></codeline>
<codeline lineno="1675"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a5552665043089000065df39c5a5a7094" kindref="member">pending_call_state</ref><sp/>==<sp/><ref refid="session_8h_1abb7a4342b889601983497b3f094957e1a964524d093fc2ba649020c4ce5460b94" kindref="member">SSH_PENDING_CALL_AUTH_KBDINT_SEND</ref><sp/>||</highlight></codeline>
<codeline lineno="1676"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a9cba44c19f35693037bc9bb1e0651d17" kindref="member">kbdint</ref><sp/>!=<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="1677"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*</highlight></codeline>
<codeline lineno="1678"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>If<sp/>we<sp/>are<sp/>at<sp/>this<sp/>point,<sp/>it<sp/>is<sp/>because<sp/>session-&gt;kbdint<sp/>exists.</highlight></codeline>
<codeline lineno="1679"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>It<sp/>means<sp/>the<sp/>user<sp/>has<sp/>set<sp/>some<sp/>information<sp/>there<sp/>we<sp/>need<sp/>to<sp/>send</highlight></codeline>
<codeline lineno="1680"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>the<sp/>server<sp/>and<sp/>then<sp/>we<sp/>need<sp/>to<sp/>ack<sp/>the<sp/>status<sp/>(new<sp/>questions<sp/>or<sp/>ok</highlight></codeline>
<codeline lineno="1681"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>pass<sp/>in).</highlight></codeline>
<codeline lineno="1682"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>It<sp/>is<sp/>possible<sp/>that<sp/>session-&gt;kbdint<sp/>is<sp/>NULL<sp/>while<sp/>we&apos;re<sp/>waiting<sp/>for</highlight></codeline>
<codeline lineno="1683"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>a<sp/>reply,<sp/>hence<sp/>the<sp/>test<sp/>for<sp/>the<sp/>pending<sp/>call.</highlight></codeline>
<codeline lineno="1684"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1685"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="group__libssh__auth_1gaaa68e6aec2da509b246b7cba071408d3" kindref="member">ssh_userauth_kbdint_send</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>);</highlight></codeline>
<codeline lineno="1686"><highlight class="normal"><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="1687"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>We<sp/>are<sp/>here<sp/>because<sp/>session-&gt;kbdint<sp/>==<sp/>NULL<sp/>&amp;<sp/>state<sp/>!=<sp/>NONE.</highlight></codeline>
<codeline lineno="1688"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>This<sp/>should<sp/>not<sp/>happen</highlight></codeline>
<codeline lineno="1689"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1690"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="libssh_8h_1a5b35a5038ad8eac4a4e4c00c6239e6e2a33d82f552d20734c17e770af637e3e17" kindref="member">SSH_AUTH_ERROR</ref>;</highlight></codeline>
<codeline lineno="1691"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="priv_8h_1a55177b3e8db90ca9adb435c44281963c" kindref="member">ssh_set_error</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>,<sp/><ref refid="libssh_8h_1a036b2b00fb04337a4d06d719d1b62be1a86ff0b2e8da6ad8628efc556b6ce1887" kindref="member">SSH_FATAL</ref>,<sp/></highlight><highlight class="stringliteral">&quot;Invalid<sp/>state<sp/>in<sp/>%s&quot;</highlight><highlight class="normal">,<sp/>__func__);</highlight></codeline>
<codeline lineno="1692"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1693"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref>;</highlight></codeline>
<codeline lineno="1694"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1695"><highlight class="normal"></highlight></codeline>
<codeline lineno="1707" refid="group__libssh__auth_1gacb996ff4979670db009a71a90172ece9" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="group__libssh__auth_1gacb996ff4979670db009a71a90172ece9" kindref="member">ssh_userauth_kbdint_getnprompts</ref>(<ref refid="structssh__session__struct" kindref="compound">ssh_session</ref><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1708"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref><sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="1709"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" kindref="member">SSH_ERROR</ref>;</highlight></codeline>
<codeline lineno="1710"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1711"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a9cba44c19f35693037bc9bb1e0651d17" kindref="member">kbdint</ref><sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="1712"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="priv_8h_1a351ea86857d33b3ba80b396e05c4517c" kindref="member">ssh_set_error_invalid</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>);</highlight></codeline>
<codeline lineno="1713"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" kindref="member">SSH_ERROR</ref>;</highlight></codeline>
<codeline lineno="1714"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1715"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a9cba44c19f35693037bc9bb1e0651d17" kindref="member">kbdint</ref>-&gt;<ref refid="structssh__kbdint__struct_1a316bac1f096accc10024c7e787e0e3d6" kindref="member">nprompts</ref>;</highlight></codeline>
<codeline lineno="1716"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1717"><highlight class="normal"></highlight></codeline>
<codeline lineno="1729" refid="group__libssh__auth_1gaf920b6f8ed1e3c53cc2a683230098657" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*<ref refid="group__libssh__auth_1gaf920b6f8ed1e3c53cc2a683230098657" kindref="member">ssh_userauth_kbdint_getname</ref>(<ref refid="structssh__session__struct" kindref="compound">ssh_session</ref><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1730"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref><sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="1731"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>NULL;</highlight></codeline>
<codeline lineno="1732"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1733"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a9cba44c19f35693037bc9bb1e0651d17" kindref="member">kbdint</ref><sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="1734"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="priv_8h_1a351ea86857d33b3ba80b396e05c4517c" kindref="member">ssh_set_error_invalid</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>);</highlight></codeline>
<codeline lineno="1735"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>NULL;</highlight></codeline>
<codeline lineno="1736"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1737"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a9cba44c19f35693037bc9bb1e0651d17" kindref="member">kbdint</ref>-&gt;<ref refid="structssh__kbdint__struct_1a8c7f5532d4b52ab7f81bacdf8394c51c" kindref="member">name</ref>;</highlight></codeline>
<codeline lineno="1738"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1739"><highlight class="normal"></highlight></codeline>
<codeline lineno="1752" refid="group__libssh__auth_1gaa757fbdbd4f95261bbbbc12b1ec33078" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*<ref refid="group__libssh__auth_1gaa757fbdbd4f95261bbbbc12b1ec33078" kindref="member">ssh_userauth_kbdint_getinstruction</ref>(<ref refid="structssh__session__struct" kindref="compound">ssh_session</ref><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1753"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref><sp/>==<sp/>NULL)</highlight></codeline>
<codeline lineno="1754"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>NULL;</highlight></codeline>
<codeline lineno="1755"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a9cba44c19f35693037bc9bb1e0651d17" kindref="member">kbdint</ref><sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="1756"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="priv_8h_1a351ea86857d33b3ba80b396e05c4517c" kindref="member">ssh_set_error_invalid</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>);</highlight></codeline>
<codeline lineno="1757"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>NULL;</highlight></codeline>
<codeline lineno="1758"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1759"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a9cba44c19f35693037bc9bb1e0651d17" kindref="member">kbdint</ref>-&gt;<ref refid="structssh__kbdint__struct_1a22c149b9323116ac704fabc4c6a5caa6" kindref="member">instruction</ref>;</highlight></codeline>
<codeline lineno="1760"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1761"><highlight class="normal"></highlight></codeline>
<codeline lineno="1787" refid="group__libssh__auth_1ga4e7466c30852a3339003af7046fab396" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*<ref refid="group__libssh__auth_1ga4e7466c30852a3339003af7046fab396" kindref="member">ssh_userauth_kbdint_getprompt</ref>(<ref refid="structssh__session__struct" kindref="compound">ssh_session</ref><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>,<sp/></highlight><highlight class="keywordtype">unsigned</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i,</highlight></codeline>
<codeline lineno="1788"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*<ref refid="samplesshd-kbdint_8c_1aed50069385b2de326e5bbed79b19affd" kindref="member">echo</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1789"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref><sp/>==<sp/>NULL)</highlight></codeline>
<codeline lineno="1790"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>NULL;</highlight></codeline>
<codeline lineno="1791"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a9cba44c19f35693037bc9bb1e0651d17" kindref="member">kbdint</ref><sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="1792"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="priv_8h_1a351ea86857d33b3ba80b396e05c4517c" kindref="member">ssh_set_error_invalid</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>);</highlight></codeline>
<codeline lineno="1793"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>NULL;</highlight></codeline>
<codeline lineno="1794"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1795"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(i<sp/>&gt;<sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a9cba44c19f35693037bc9bb1e0651d17" kindref="member">kbdint</ref>-&gt;<ref refid="structssh__kbdint__struct_1a316bac1f096accc10024c7e787e0e3d6" kindref="member">nprompts</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1796"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="priv_8h_1a351ea86857d33b3ba80b396e05c4517c" kindref="member">ssh_set_error_invalid</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>);</highlight></codeline>
<codeline lineno="1797"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>NULL;</highlight></codeline>
<codeline lineno="1798"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1799"><highlight class="normal"></highlight></codeline>
<codeline lineno="1800"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="samplesshd-kbdint_8c_1aed50069385b2de326e5bbed79b19affd" kindref="member">echo</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1801"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<ref refid="samplesshd-kbdint_8c_1aed50069385b2de326e5bbed79b19affd" kindref="member">echo</ref><sp/>=<sp/>(char)<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a9cba44c19f35693037bc9bb1e0651d17" kindref="member">kbdint</ref>-&gt;<ref refid="structssh__kbdint__struct_1a53c38b9a2468c1d79954408e9b7bc7aa" kindref="member">echo</ref>[i];</highlight></codeline>
<codeline lineno="1802"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1803"><highlight class="normal"></highlight></codeline>
<codeline lineno="1804"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a9cba44c19f35693037bc9bb1e0651d17" kindref="member">kbdint</ref>-&gt;<ref refid="structssh__kbdint__struct_1a3b528280ac48b0713c1f963ee9f3574b" kindref="member">prompts</ref>[i];</highlight></codeline>
<codeline lineno="1805"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1806"><highlight class="normal"></highlight></codeline>
<codeline lineno="1807"><highlight class="normal"></highlight><highlight class="preprocessor">#ifdef<sp/>WITH_SERVER</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1815"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="libssh_8h_1ad37d6c9c337f3bf2044760aa0dfab841" kindref="member">ssh_userauth_kbdint_getnanswers</ref>(<ref refid="structssh__session__struct" kindref="compound">ssh_session</ref><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1816"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref><sp/>==<sp/>NULL<sp/>||<sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a9cba44c19f35693037bc9bb1e0651d17" kindref="member">kbdint</ref><sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="1817"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" kindref="member">SSH_ERROR</ref>;</highlight></codeline>
<codeline lineno="1818"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1819"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a9cba44c19f35693037bc9bb1e0651d17" kindref="member">kbdint</ref>-&gt;<ref refid="structssh__kbdint__struct_1af297b39443720d689feb400020c0988f" kindref="member">nanswers</ref>;</highlight></codeline>
<codeline lineno="1820"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1821"><highlight class="normal"></highlight></codeline>
<codeline lineno="1831"><highlight class="normal"></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*<ref refid="libssh_8h_1a9f8640ab0ff416d274983db44631860c" kindref="member">ssh_userauth_kbdint_getanswer</ref>(<ref refid="structssh__session__struct" kindref="compound">ssh_session</ref><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>,<sp/></highlight><highlight class="keywordtype">unsigned</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i)<sp/>{</highlight></codeline>
<codeline lineno="1832"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref><sp/>==<sp/>NULL<sp/>||<sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a9cba44c19f35693037bc9bb1e0651d17" kindref="member">kbdint</ref><sp/>==<sp/>NULL</highlight></codeline>
<codeline lineno="1833"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>||<sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a9cba44c19f35693037bc9bb1e0651d17" kindref="member">kbdint</ref>-&gt;<ref refid="structssh__kbdint__struct_1aae334dcc6b8fe544b25f4377360db554" kindref="member">answers</ref><sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="1834"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>NULL;</highlight></codeline>
<codeline lineno="1835"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1836"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(i<sp/>&gt;=<sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a9cba44c19f35693037bc9bb1e0651d17" kindref="member">kbdint</ref>-&gt;<ref refid="structssh__kbdint__struct_1af297b39443720d689feb400020c0988f" kindref="member">nanswers</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1837"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>NULL;</highlight></codeline>
<codeline lineno="1838"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1839"><highlight class="normal"></highlight></codeline>
<codeline lineno="1840"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a9cba44c19f35693037bc9bb1e0651d17" kindref="member">kbdint</ref>-&gt;<ref refid="structssh__kbdint__struct_1aae334dcc6b8fe544b25f4377360db554" kindref="member">answers</ref>[i];</highlight></codeline>
<codeline lineno="1841"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1842"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1843"><highlight class="normal"></highlight></codeline>
<codeline lineno="1862" refid="group__libssh__auth_1ga75e44b1f27059a00080f80fac0107a20" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="group__libssh__auth_1ga75e44b1f27059a00080f80fac0107a20" kindref="member">ssh_userauth_kbdint_setanswer</ref>(<ref refid="structssh__session__struct" kindref="compound">ssh_session</ref><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>,<sp/></highlight><highlight class="keywordtype">unsigned</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i,</highlight></codeline>
<codeline lineno="1863"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*answer)<sp/>{</highlight></codeline>
<codeline lineno="1864"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref><sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="1865"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>-1;</highlight></codeline>
<codeline lineno="1866"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1867"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(answer<sp/>==<sp/>NULL<sp/>||<sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a9cba44c19f35693037bc9bb1e0651d17" kindref="member">kbdint</ref><sp/>==<sp/>NULL<sp/>||</highlight></codeline>
<codeline lineno="1868"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>i<sp/>&gt;=<sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a9cba44c19f35693037bc9bb1e0651d17" kindref="member">kbdint</ref>-&gt;<ref refid="structssh__kbdint__struct_1a316bac1f096accc10024c7e787e0e3d6" kindref="member">nprompts</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1869"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="priv_8h_1a351ea86857d33b3ba80b396e05c4517c" kindref="member">ssh_set_error_invalid</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>);</highlight></codeline>
<codeline lineno="1870"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>-1;</highlight></codeline>
<codeline lineno="1871"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1872"><highlight class="normal"></highlight></codeline>
<codeline lineno="1873"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a9cba44c19f35693037bc9bb1e0651d17" kindref="member">kbdint</ref>-&gt;<ref refid="structssh__kbdint__struct_1aae334dcc6b8fe544b25f4377360db554" kindref="member">answers</ref><sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="1874"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a9cba44c19f35693037bc9bb1e0651d17" kindref="member">kbdint</ref>-&gt;<ref refid="structssh__kbdint__struct_1aae334dcc6b8fe544b25f4377360db554" kindref="member">answers</ref><sp/>=<sp/>calloc(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a9cba44c19f35693037bc9bb1e0651d17" kindref="member">kbdint</ref>-&gt;<ref refid="structssh__kbdint__struct_1a316bac1f096accc10024c7e787e0e3d6" kindref="member">nprompts</ref>,<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(</highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*));</highlight></codeline>
<codeline lineno="1875"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a9cba44c19f35693037bc9bb1e0651d17" kindref="member">kbdint</ref>-&gt;<ref refid="structssh__kbdint__struct_1aae334dcc6b8fe544b25f4377360db554" kindref="member">answers</ref><sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="1876"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="priv_8h_1ae280c413c792e04237f000841ac8ce44" kindref="member">ssh_set_error_oom</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>);</highlight></codeline>
<codeline lineno="1877"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>-1;</highlight></codeline>
<codeline lineno="1878"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1879"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1880"><highlight class="normal"></highlight></codeline>
<codeline lineno="1881"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a9cba44c19f35693037bc9bb1e0651d17" kindref="member">kbdint</ref>-&gt;<ref refid="structssh__kbdint__struct_1aae334dcc6b8fe544b25f4377360db554" kindref="member">answers</ref>[i])<sp/>{</highlight></codeline>
<codeline lineno="1882"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="group__libssh__misc_1ga51869b401cb0f3e711527bc9a730fbff" kindref="member">explicit_bzero</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a9cba44c19f35693037bc9bb1e0651d17" kindref="member">kbdint</ref>-&gt;<ref refid="structssh__kbdint__struct_1aae334dcc6b8fe544b25f4377360db554" kindref="member">answers</ref>[i],</highlight></codeline>
<codeline lineno="1883"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>strlen(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a9cba44c19f35693037bc9bb1e0651d17" kindref="member">kbdint</ref>-&gt;<ref refid="structssh__kbdint__struct_1aae334dcc6b8fe544b25f4377360db554" kindref="member">answers</ref>[i]));</highlight></codeline>
<codeline lineno="1884"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="sshd__direct-tcpip_8c_1aed3129b7674034c979192bcca6b0ad8c" kindref="member">SAFE_FREE</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a9cba44c19f35693037bc9bb1e0651d17" kindref="member">kbdint</ref>-&gt;<ref refid="structssh__kbdint__struct_1aae334dcc6b8fe544b25f4377360db554" kindref="member">answers</ref>[i]);</highlight></codeline>
<codeline lineno="1885"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1886"><highlight class="normal"></highlight></codeline>
<codeline lineno="1887"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a9cba44c19f35693037bc9bb1e0651d17" kindref="member">kbdint</ref>-&gt;<ref refid="structssh__kbdint__struct_1aae334dcc6b8fe544b25f4377360db554" kindref="member">answers</ref>[i]<sp/>=<sp/>strdup(answer);</highlight></codeline>
<codeline lineno="1888"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a9cba44c19f35693037bc9bb1e0651d17" kindref="member">kbdint</ref>-&gt;<ref refid="structssh__kbdint__struct_1aae334dcc6b8fe544b25f4377360db554" kindref="member">answers</ref>[i]<sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="1889"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="priv_8h_1ae280c413c792e04237f000841ac8ce44" kindref="member">ssh_set_error_oom</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>);</highlight></codeline>
<codeline lineno="1890"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>-1;</highlight></codeline>
<codeline lineno="1891"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1892"><highlight class="normal"></highlight></codeline>
<codeline lineno="1893"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>0;</highlight></codeline>
<codeline lineno="1894"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1895"><highlight class="normal"></highlight></codeline>
<codeline lineno="1909" refid="structssh__agent__state__struct_1aff904ec87c3104dfb7bb6915ef9a88b6" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="group__libssh__auth_1ga2758b0e86a848fe0d1d3d263d2a34d28" kindref="member">ssh_userauth_gssapi</ref>(<ref refid="structssh__session__struct" kindref="compound">ssh_session</ref><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1910"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="libssh_8h_1a5b35a5038ad8eac4a4e4c00c6239e6e2ac3d2d6d092a7adc147b7f859a0b252d2" kindref="member">SSH_AUTH_DENIED</ref>;</highlight></codeline>
<codeline lineno="1911"><highlight class="normal"></highlight><highlight class="preprocessor">#ifdef<sp/>WITH_GSSAPI</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1912"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">switch</highlight><highlight class="normal">(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a5552665043089000065df39c5a5a7094" kindref="member">pending_call_state</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1913"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="session_8h_1abb7a4342b889601983497b3f094957e1a33be3f7cd03fe7fced1eeacd369cad94" kindref="member">SSH_PENDING_CALL_NONE</ref>:</highlight></codeline>
<codeline lineno="1914"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1915"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="session_8h_1abb7a4342b889601983497b3f094957e1ae2e9a86524484e605a8f6ed3a80d9dcd" kindref="member">SSH_PENDING_CALL_AUTH_GSSAPI_MIC</ref>:</highlight></codeline>
<codeline lineno="1916"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">goto</highlight><highlight class="normal"><sp/>pending;</highlight></codeline>
<codeline lineno="1917"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">default</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="1918"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="priv_8h_1a55177b3e8db90ca9adb435c44281963c" kindref="member">ssh_set_error</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>,</highlight></codeline>
<codeline lineno="1919"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="libssh_8h_1a036b2b00fb04337a4d06d719d1b62be1a86ff0b2e8da6ad8628efc556b6ce1887" kindref="member">SSH_FATAL</ref>,</highlight></codeline>
<codeline lineno="1920"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Wrong<sp/>state<sp/>(%d)<sp/>during<sp/>pending<sp/>SSH<sp/>call&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="1921"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a5552665043089000065df39c5a5a7094" kindref="member">pending_call_state</ref>);</highlight></codeline>
<codeline lineno="1922"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" kindref="member">SSH_ERROR</ref>;</highlight></codeline>
<codeline lineno="1923"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1924"><highlight class="normal"></highlight></codeline>
<codeline lineno="1925"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="group__libssh__auth_1ga812fb86c3dd4a6245bc7d01beaa9cfe8" kindref="member">ssh_userauth_request_service</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>);</highlight></codeline>
<codeline lineno="1926"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>==<sp/><ref refid="libssh_8h_1a9c57e4f6482106336045a4d25a55f28e" kindref="member">SSH_AGAIN</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1927"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="libssh_8h_1a5b35a5038ad8eac4a4e4c00c6239e6e2a0f166cff4fa03faf4e4c11ad854a4996" kindref="member">SSH_AUTH_AGAIN</ref>;</highlight></codeline>
<codeline lineno="1928"><highlight class="normal"><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>==<sp/><ref refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" kindref="member">SSH_ERROR</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1929"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="libssh_8h_1a5b35a5038ad8eac4a4e4c00c6239e6e2a33d82f552d20734c17e770af637e3e17" kindref="member">SSH_AUTH_ERROR</ref>;</highlight></codeline>
<codeline lineno="1930"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1931"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="priv_8h_1aa21fd8a7a609329603b7b16da7939fca" kindref="member">SSH_LOG</ref>(<ref refid="group__libssh__log_1ggadf764cbdea00d65edcd07bb9953ad2b7a75fa79e63947b66462db977d9b5ae27c" kindref="member">SSH_LOG_PROTOCOL</ref>,<sp/></highlight><highlight class="stringliteral">&quot;Authenticating<sp/>with<sp/>gssapi-with-mic&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="1932"><highlight class="normal"></highlight></codeline>
<codeline lineno="1933"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a3d57e01582c0c9099f7f319513321fe8" kindref="member">auth</ref>.<ref refid="structssh__session__struct_1aa859857ac7a99808ffc537e08087e541" kindref="member">current_method</ref><sp/>=<sp/><ref refid="libssh_8h_1aa17667dad32ec77112a201b1b4b858e8" kindref="member">SSH_AUTH_METHOD_GSSAPI_MIC</ref>;</highlight></codeline>
<codeline lineno="1934"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a3d57e01582c0c9099f7f319513321fe8" kindref="member">auth</ref>.<ref refid="structssh__session__struct_1af0805877d21d43e81423ead52345c64b" kindref="member">state</ref><sp/>=<sp/><ref refid="auth_8h_1a0d3114986a741a14dc3ac03f7d8eafefa3ec3c08deba889e791cdca82edeb2ce6" kindref="member">SSH_AUTH_STATE_NONE</ref>;</highlight></codeline>
<codeline lineno="1935"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a5552665043089000065df39c5a5a7094" kindref="member">pending_call_state</ref><sp/>=<sp/><ref refid="session_8h_1abb7a4342b889601983497b3f094957e1ae2e9a86524484e605a8f6ed3a80d9dcd" kindref="member">SSH_PENDING_CALL_AUTH_GSSAPI_MIC</ref>;</highlight></codeline>
<codeline lineno="1936"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="gssapi_8h_1ae56cb90fad3c272362eee4c18531a65f" kindref="member">ssh_gssapi_auth_mic</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>);</highlight></codeline>
<codeline lineno="1937"><highlight class="normal"></highlight></codeline>
<codeline lineno="1938"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>==<sp/><ref refid="libssh_8h_1a5b35a5038ad8eac4a4e4c00c6239e6e2a33d82f552d20734c17e770af637e3e17" kindref="member">SSH_AUTH_ERROR</ref><sp/>||<sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>==<sp/><ref refid="libssh_8h_1a5b35a5038ad8eac4a4e4c00c6239e6e2ac3d2d6d092a7adc147b7f859a0b252d2" kindref="member">SSH_AUTH_DENIED</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1939"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a3d57e01582c0c9099f7f319513321fe8" kindref="member">auth</ref>.<ref refid="structssh__session__struct_1af0805877d21d43e81423ead52345c64b" kindref="member">state</ref><sp/>=<sp/><ref refid="auth_8h_1a0d3114986a741a14dc3ac03f7d8eafefa3ec3c08deba889e791cdca82edeb2ce6" kindref="member">SSH_AUTH_STATE_NONE</ref>;</highlight></codeline>
<codeline lineno="1940"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a5552665043089000065df39c5a5a7094" kindref="member">pending_call_state</ref><sp/>=<sp/><ref refid="session_8h_1abb7a4342b889601983497b3f094957e1a33be3f7cd03fe7fced1eeacd369cad94" kindref="member">SSH_PENDING_CALL_NONE</ref>;</highlight></codeline>
<codeline lineno="1941"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref>;</highlight></codeline>
<codeline lineno="1942"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1943"><highlight class="normal"></highlight></codeline>
<codeline lineno="1944"><highlight class="normal">pending:</highlight></codeline>
<codeline lineno="1945"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="group__libssh__auth_1gabff6b3898d3bf45b62cc3ed3774eaa83" kindref="member">ssh_userauth_get_response</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>);</highlight></codeline>
<codeline lineno="1946"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>!=<sp/><ref refid="libssh_8h_1a5b35a5038ad8eac4a4e4c00c6239e6e2a0f166cff4fa03faf4e4c11ad854a4996" kindref="member">SSH_AUTH_AGAIN</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1947"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a5552665043089000065df39c5a5a7094" kindref="member">pending_call_state</ref><sp/>=<sp/><ref refid="session_8h_1abb7a4342b889601983497b3f094957e1a33be3f7cd03fe7fced1eeacd369cad94" kindref="member">SSH_PENDING_CALL_NONE</ref>;</highlight></codeline>
<codeline lineno="1948"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1949"><highlight class="normal"></highlight><highlight class="preprocessor">#else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1950"><highlight class="normal"><sp/><sp/><sp/><sp/>(void)<sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>;<sp/></highlight><highlight class="comment">/*<sp/>unused<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1951"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1952"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref>;</highlight></codeline>
<codeline lineno="1953"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1954"><highlight class="normal"></highlight></codeline>
    </programlisting>
    <location file="libssh-mirror/src/auth.c"/>
  </compounddef>
</doxygen>
