<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<doxygen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="compound.xsd" version="1.9.1" xml:lang="en-US">
  <compounddef id="ssh__client_8c" kind="file" language="C++">
    <compoundname>ssh_client.c</compoundname>
    <includes refid="config_8h" local="yes">config.h</includes>
    <includes local="no">stdio.h</includes>
    <includes local="no">stdlib.h</includes>
    <includes refid="string_8h" local="no">string.h</includes>
    <includes local="no">sys/select.h</includes>
    <includes local="no">sys/time.h</includes>
    <includes local="no">sys/ioctl.h</includes>
    <includes local="no">signal.h</includes>
    <includes local="no">errno.h</includes>
    <includes local="no">fcntl.h</includes>
    <includes refid="callbacks_8h" local="no">libssh/callbacks.h</includes>
    <includes refid="libssh_8h" local="no">libssh/libssh.h</includes>
    <includes refid="sftp_8h" local="no">libssh/sftp.h</includes>
    <includes refid="examples__common_8h" local="yes">examples_common.h</includes>
    <incdepgraph>
      <node id="12">
        <label>sys/select.h</label>
      </node>
      <node id="6">
        <label>libssh/priv.h</label>
        <link refid="priv_8h"/>
        <childnode refid="7" relation="include">
        </childnode>
        <childnode refid="4" relation="include">
        </childnode>
        <childnode refid="5" relation="include">
        </childnode>
        <childnode refid="8" relation="include">
        </childnode>
        <childnode refid="9" relation="include">
        </childnode>
        <childnode refid="15" relation="include">
        </childnode>
      </node>
      <node id="14">
        <label>libssh/legacy.h</label>
        <link refid="legacy_8h"/>
      </node>
      <node id="5">
        <label>string.h</label>
        <link refid="string_8h"/>
        <childnode refid="6" relation="include">
        </childnode>
      </node>
      <node id="7">
        <label>stdint.h</label>
      </node>
      <node id="4">
        <label>stdlib.h</label>
      </node>
      <node id="19">
        <label>errno.h</label>
      </node>
      <node id="20">
        <label>fcntl.h</label>
      </node>
      <node id="17">
        <label>sys/ioctl.h</label>
      </node>
      <node id="21">
        <label>libssh/sftp.h</label>
        <link refid="sftp_8h"/>
        <childnode refid="11" relation="include">
        </childnode>
        <childnode refid="9" relation="include">
        </childnode>
      </node>
      <node id="15">
        <label>libssh/callbacks.h</label>
        <link refid="callbacks_8h"/>
        <childnode refid="9" relation="include">
        </childnode>
        <childnode refid="5" relation="include">
        </childnode>
      </node>
      <node id="13">
        <label>netdb.h</label>
      </node>
      <node id="11">
        <label>sys/types.h</label>
      </node>
      <node id="1">
        <label>libssh-mirror/examples/ssh_client.c</label>
        <link refid="ssh__client_8c"/>
        <childnode refid="2" relation="include">
        </childnode>
        <childnode refid="3" relation="include">
        </childnode>
        <childnode refid="4" relation="include">
        </childnode>
        <childnode refid="5" relation="include">
        </childnode>
        <childnode refid="12" relation="include">
        </childnode>
        <childnode refid="16" relation="include">
        </childnode>
        <childnode refid="17" relation="include">
        </childnode>
        <childnode refid="18" relation="include">
        </childnode>
        <childnode refid="19" relation="include">
        </childnode>
        <childnode refid="20" relation="include">
        </childnode>
        <childnode refid="15" relation="include">
        </childnode>
        <childnode refid="9" relation="include">
        </childnode>
        <childnode refid="21" relation="include">
        </childnode>
        <childnode refid="22" relation="include">
        </childnode>
      </node>
      <node id="8">
        <label>unistd.h</label>
      </node>
      <node id="18">
        <label>signal.h</label>
      </node>
      <node id="16">
        <label>sys/time.h</label>
      </node>
      <node id="9">
        <label>libssh/libssh.h</label>
        <link refid="libssh_8h"/>
        <childnode refid="8" relation="include">
        </childnode>
        <childnode refid="10" relation="include">
        </childnode>
        <childnode refid="11" relation="include">
        </childnode>
        <childnode refid="12" relation="include">
        </childnode>
        <childnode refid="13" relation="include">
        </childnode>
        <childnode refid="14" relation="include">
        </childnode>
      </node>
      <node id="2">
        <label>config.h</label>
        <link refid="config_8h"/>
      </node>
      <node id="22">
        <label>examples_common.h</label>
        <link refid="examples__common_8h"/>
        <childnode refid="9" relation="include">
        </childnode>
      </node>
      <node id="3">
        <label>stdio.h</label>
      </node>
      <node id="10">
        <label>inttypes.h</label>
      </node>
    </incdepgraph>
      <sectiondef kind="define">
      <memberdef kind="define" id="ssh__client_8c_1ac2c6acf3e0c14ce1210c05db36a10dba" prot="public" static="no">
        <name>MAXCMD</name>
        <initializer>10</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="libssh-mirror/examples/ssh_client.c" line="45" column="10" bodyfile="libssh-mirror/examples/ssh_client.c" bodystart="45" bodyend="-1"/>
      </memberdef>
      </sectiondef>
      <sectiondef kind="var">
      <memberdef kind="variable" id="ssh__client_8c_1a1c2046dcb30a629d6d9f45ff8f403f12" prot="public" static="yes" mutable="no">
        <type>char *</type>
        <definition>char* host</definition>
        <argsstring></argsstring>
        <name>host</name>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="libssh-mirror/examples/ssh_client.c" line="47" column="13" bodyfile="libssh-mirror/examples/ssh_client.c" bodystart="47" bodyend="-1"/>
        <referencedby refid="ssh__client_8c_1a0d3591711bd7d6cb03d42294115721bb" compoundref="ssh__client_8c" startline="318" endline="366">client</referencedby>
        <referencedby refid="ssh__client_8c_1a661b14d2cd5d6df5790276ddb9bcda0e" compoundref="ssh__client_8c" startline="109" endline="141">opts</referencedby>
      </memberdef>
      <memberdef kind="variable" id="ssh__client_8c_1a14871705f45ccdc5bb9f4549efd8e119" prot="public" static="yes" mutable="no">
        <type>char *</type>
        <definition>char* user</definition>
        <argsstring></argsstring>
        <name>user</name>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="libssh-mirror/examples/ssh_client.c" line="48" column="13" bodyfile="libssh-mirror/examples/ssh_client.c" bodystart="48" bodyend="-1"/>
        <referencedby refid="proxy_8c_1a6d949f92342daed25feaf5c85fc26566" compoundref="proxy_8c" startline="59" endline="71">auth_gssapi_mic</referencedby>
        <referencedby refid="proxy_8c_1a51822229a890049f75ce6980876e2dfc" compoundref="proxy_8c" startline="38" endline="57">auth_password</referencedby>
        <referencedby refid="torture__server__x11_8c_1ae0b607880f117f85738067b513956e7d" compoundref="torture__server__x11_8c" startline="98" endline="109">auth_password_accept</referencedby>
        <referencedby refid="default__cb_8c_1a990d510dff2020e18002d760c02c44d1" compoundref="default__cb_8c" startline="94" endline="137">auth_password_cb</referencedby>
        <referencedby refid="default__cb_8c_1a215d2b8fb88c836192e0eddae094c2f5" compoundref="default__cb_8c" startline="54" endline="91">auth_pubkey_cb</referencedby>
        <referencedby refid="ssh__server__fork_8c_1a3189cc40d6bcad5ea3c2c1edf9327672" compoundref="ssh__server__fork_8c" startline="452" endline="497">auth_publickey</referencedby>
        <referencedby refid="client_8c_1a4c4c9ace93a9791515090ebc197dd736" compoundref="client_8c" startline="96" endline="164">callback_receive_banner</referencedby>
        <referencedby refid="ssh__client_8c_1a0d3591711bd7d6cb03d42294115721bb" compoundref="ssh__client_8c" startline="318" endline="366">client</referencedby>
        <referencedby refid="connect__ssh_8c_1ada855ebf4aac69d9a59afb23a8e338f4" compoundref="connect__ssh_8c" startline="24" endline="67">connect_ssh</referencedby>
        <referencedby refid="pkd__daemon_8c_1a0ea051ed9df22544091f74435f55d685" compoundref="pkd__daemon_8c" startline="177" endline="194">pkd_auth_pubkey_cb</referencedby>
        <referencedby refid="client_8c_1a60373cf7aa31f7df6bee34eb6103af14" compoundref="client_8c" startline="63" endline="83">socket_callback_connected</referencedby>
        <referencedby refid="group__libssh__auth_1ga4eba018b5d45cc32999cb76b06440c55" compoundref="auth_8c" startline="81" endline="97">ssh_auth_response_termination</referencedby>
        <referencedby refid="group__libssh__server_1ga2b217c6cd3aa4eb3c81b9193bc3a2daa" compoundref="bind_8c" startline="325" endline="339">ssh_bind_poll_callback</referencedby>
        <referencedby refid="group__libssh__session_1gabca86e5dcb03e23c150b16f9655cd782" compoundref="client_8c" startline="483" endline="493">ssh_connect_termination</referencedby>
        <referencedby refid="group__libssh__session_1ga4b84e1ae757c0d4007a5eefdf4651694" compoundref="session_8c" startline="692" endline="740">ssh_handle_packets_termination</referencedby>
        <referencedby refid="group__libssh__session_1ga93f7f7159893f3ce62c9b178724eff75" compoundref="options_8c" startline="1193" endline="1357">ssh_options_getopt</referencedby>
        <referencedby refid="group__libssh__auth_1ga1fc1f11c7ba0469c866c42956450ebf7" compoundref="auth_8c" startline="195" endline="213">SSH_PACKET_CALLBACK</referencedby>
        <referencedby refid="packet_8h_1af53b16a51c1fb0b3cd7c15baba882ed8" compoundref="packet_8c" startline="1059" endline="1389">ssh_packet_socket_callback</referencedby>
        <referencedby refid="group__libssh__pki_1ga576cb3a5c7f40a0e20a88b14a023613d" compoundref="pki_8c" startline="2086" endline="2142">ssh_pki_export_pubkey_file</referencedby>
        <referencedby refid="legacy_8h_1aa4de432e122c76302e4190041fee6945" compoundref="legacy_8c" startline="575" endline="641">ssh_publickey_to_file</referencedby>
        <referencedby refid="group__libssh__session_1ga2635562d4c0bb8507e9a9f7274ff4729" compoundref="session_8c" startline="848" endline="860">ssh_socket_exception_callback</referencedby>
        <referencedby refid="group__libssh__auth_1ga6b3b1c2a045286d9476b0252791a07d2" compoundref="auth_8c" startline="1664" endline="1694">ssh_userauth_kbdint</referencedby>
        <referencedby refid="torture__misc_8c_1a922d7a84a8642e8858d92b0b68ec2599" compoundref="torture__misc_8c" startline="39" endline="54">torture_get_user_home_dir</referencedby>
        <referencedby refid="torture__options_8c_1aedae7c50929b9f2817764a36f1a927f1" compoundref="torture__options_8c" startline="329" endline="340">torture_options_get_user</referencedby>
        <referencedby refid="torture__misc_8c_1aacc65e8d5650800f39d8e4f497a42074" compoundref="torture__misc_8c" startline="124" endline="165">torture_path_expand_tilde_unix</referencedby>
        <referencedby refid="torture_8c_1aa1653e389922c4762e71dbd2ab2d7cda" compoundref="torture_8c" startline="262" endline="353">torture_ssh_session</referencedby>
      </memberdef>
      <memberdef kind="variable" id="ssh__client_8c_1af2ca9263602e29f4fdd69cd3e31bc641" prot="public" static="yes" mutable="no">
        <type>char *</type>
        <definition>char* cmds[MAXCMD]</definition>
        <argsstring>[MAXCMD]</argsstring>
        <name>cmds</name>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="libssh-mirror/examples/ssh_client.c" line="49" column="13" bodyfile="libssh-mirror/examples/ssh_client.c" bodystart="49" bodyend="-1"/>
        <referencedby refid="ssh__client_8c_1a45850c1cb10fa49cc185bc9f204f4ca1" compoundref="ssh__client_8c" startline="74" endline="85">add_cmd</referencedby>
        <referencedby refid="ssh__client_8c_1a8b8ff3289e057f1b391476c5c4b71178" compoundref="ssh__client_8c" startline="290" endline="316">batch_shell</referencedby>
        <referencedby refid="ssh__client_8c_1a0d3591711bd7d6cb03d42294115721bb" compoundref="ssh__client_8c" startline="318" endline="366">client</referencedby>
      </memberdef>
      <memberdef kind="variable" id="ssh__client_8c_1a029e0d76938d65623721b901853405a4" prot="public" static="yes" mutable="no">
        <type>struct termios</type>
        <definition>struct termios terminal</definition>
        <argsstring></argsstring>
        <name>terminal</name>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="libssh-mirror/examples/ssh_client.c" line="49" column="13" bodyfile="libssh-mirror/examples/ssh_client.c" bodystart="50" bodyend="-1"/>
        <referencedby refid="ssh__client_8c_1ada318c9f05c1dba93ef5ed73ed9a3e91" compoundref="ssh__client_8c" startline="155" endline="161">do_cleanup</referencedby>
        <referencedby refid="ssh__client_8c_1a9aee67bdbbcaaca080f23c622d7d38d9" compoundref="ssh__client_8c" startline="244" endline="288">shell</referencedby>
        <referencedby refid="group__libssh__channel_1gabb175414352256e1602286e0ab50886c" compoundref="channels_8c" startline="1798" endline="1847">ssh_channel_request_pty_size</referencedby>
      </memberdef>
      <memberdef kind="variable" id="ssh__client_8c_1a6c01d4272dd21e4cd0006557b836ec41" prot="public" static="yes" mutable="no">
        <type>char *</type>
        <definition>char* pcap_file</definition>
        <argsstring></argsstring>
        <name>pcap_file</name>
        <initializer>= NULL</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="libssh-mirror/examples/ssh_client.c" line="52" column="13" bodyfile="libssh-mirror/examples/ssh_client.c" bodystart="52" bodyend="-1"/>
        <referencedby refid="ssh__client_8c_1a661b14d2cd5d6df5790276ddb9bcda0e" compoundref="ssh__client_8c" startline="109" endline="141">opts</referencedby>
        <referencedby refid="ssh__client_8c_1a3ea85a9a747087d08426003509b49943" compoundref="ssh__client_8c" startline="369" endline="387">set_pcap</referencedby>
      </memberdef>
      <memberdef kind="variable" id="ssh__client_8c_1af18a40f45567d09a4f237ad82282588c" prot="public" static="yes" mutable="no">
        <type>char *</type>
        <definition>char* proxycommand</definition>
        <argsstring></argsstring>
        <name>proxycommand</name>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="libssh-mirror/examples/ssh_client.c" line="54" column="13" bodyfile="libssh-mirror/examples/ssh_client.c" bodystart="54" bodyend="-1"/>
        <referencedby refid="ssh__client_8c_1a0d3591711bd7d6cb03d42294115721bb" compoundref="ssh__client_8c" startline="318" endline="366">client</referencedby>
        <referencedby refid="ssh__client_8c_1a661b14d2cd5d6df5790276ddb9bcda0e" compoundref="ssh__client_8c" startline="109" endline="141">opts</referencedby>
      </memberdef>
      <memberdef kind="variable" id="ssh__client_8c_1ad7278e5a44ed2f8b6a472a1941a75b89" prot="public" static="no" mutable="no">
        <type>struct <ref refid="structssh__callbacks__struct" kindref="compound">ssh_callbacks_struct</ref></type>
        <definition>struct ssh_callbacks_struct cb</definition>
        <argsstring></argsstring>
        <name>cb</name>
        <initializer>= {
    .auth_function = <ref refid="ssh__client__fuzzer_8cpp_1a3bcf6ffc0c2c09238e1a7bc6f65aff7c" kindref="member">auth_callback</ref>,
    .userdata = NULL,
}</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="libssh-mirror/examples/ssh_client.c" line="56" column="12" bodyfile="libssh-mirror/examples/ssh_client.c" bodystart="69" bodyend="-1"/>
        <referencedby refid="threads_8h_1afd0bbff265662efc9c2d58696c1ab964" compoundref="threads_2libcrypto_8c" startline="69" endline="108">crypto_thread_init</referencedby>
        <referencedby refid="default__cb_8c_1a1815df9d04274463c40b5f3986bff6bb" compoundref="default__cb_8c" startline="760" endline="781">get_default_channel_cb</referencedby>
        <referencedby refid="default__cb_8c_1a970b01aa9312e9dea30e8da62cf9e666" compoundref="default__cb_8c" startline="733" endline="755">get_default_server_cb</referencedby>
        <referencedby refid="proxy_8c_1a3c04138a5bfe5d72780bb7e82a18e627" compoundref="proxy_8c" startline="215" endline="346">main</referencedby>
        <referencedby refid="torture__callbacks_8c_1ab3743688c369a6a63ebea4512080e9fe" compoundref="torture__callbacks_8c" startline="21" endline="36">setup</referencedby>
        <referencedby refid="group__libssh__callbacks_1ga2fd83df19998902f84f951fc47def83e" compoundref="callbacks_8c" startline="109" endline="112">ssh_add_channel_callbacks</referencedby>
        <referencedby refid="callbacks_8c_1ad2b3310e2c1a9718912b3928c5fb76ef" compoundref="callbacks_8c" startline="70" endline="102">ssh_add_set_channel_callbacks</referencedby>
        <referencedby refid="group__libssh__poll_1ga41d63ffe950a48e8b2c513877e0cd6b4" compoundref="poll_8c" startline="815" endline="845">ssh_event_add_fd</referencedby>
        <referencedby refid="packet_8h_1a2aab95b1998dbe9a6c525ba265768f52" compoundref="packet_8c" startline="1461" endline="1509">ssh_packet_process</referencedby>
        <referencedby refid="group__libssh__poll_1gac657ed07db9e5851ffb0aba45e071e99" compoundref="poll_8c" startline="351" endline="367">ssh_poll_new</referencedby>
        <referencedby refid="group__libssh__poll_1ga98ba36c2771b1e49d5c8e2f79be6d3ba" compoundref="poll_8c" startline="480" endline="485">ssh_poll_set_callback</referencedby>
        <referencedby refid="group__libssh__callbacks_1gae564352175e887c346a2e062f8124282" compoundref="callbacks_8c" startline="114" endline="130">ssh_remove_channel_callbacks</referencedby>
        <referencedby refid="group__libssh__callbacks_1ga2e4b0507c738748a3f10e43fe201fe09" compoundref="callbacks_8c" startline="48" endline="68">ssh_set_callbacks</referencedby>
        <referencedby refid="group__libssh__callbacks_1gacea52d1373970a4922bf60e6b1680919" compoundref="callbacks_8c" startline="104" endline="107">ssh_set_channel_callbacks</referencedby>
        <referencedby refid="group__libssh__log_1ga6accdc08b7d8c4234750ef30c4854b9e" compoundref="log_8c" startline="200" endline="208">ssh_set_log_callback</referencedby>
        <referencedby refid="group__libssh__callbacks_1gaa321f33172cfa54eb50baaa963457a17" compoundref="callbacks_8c" startline="133" endline="147">ssh_set_server_callbacks</referencedby>
        <referencedby refid="group__libssh__threads_1gaf473af3fbae6f1bb0e249fd1d079ff68" compoundref="threads_8c" startline="71" endline="85">ssh_threads_set_callbacks</referencedby>
        <referencedby refid="torture__callbacks_8c_1a29e3ea53f9e7164c1f11211f206a149a" compoundref="torture__callbacks_8c" startline="51" endline="67">torture_callbacks_exists</referencedby>
        <referencedby refid="torture__callbacks_8c_1af9cb59f14d72b1732463bb8a42619d4c" compoundref="torture__callbacks_8c" startline="45" endline="49">torture_callbacks_size</referencedby>
        <referencedby refid="torture__packet_8c_1ad28ea8febde081f05f3c6379e5397dd4" compoundref="torture__packet_8c" startline="45" endline="138">torture_packet</referencedby>
      </memberdef>
      <memberdef kind="variable" id="ssh__client_8c_1aadb4b99b6f71c3c49bd7b97096d033fa" prot="public" static="yes" mutable="no">
        <type><ref refid="libssh_8h_1aca32be8db7c865697a3de381dc7e9fc3" kindref="member">ssh_channel</ref></type>
        <definition>ssh_channel chan</definition>
        <argsstring></argsstring>
        <name>chan</name>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="libssh-mirror/examples/ssh_client.c" line="172" column="20" bodyfile="libssh-mirror/examples/ssh_client.c" bodystart="172" bodyend="-1"/>
        <referencedby refid="ssh__client_8c_1a9aee67bdbbcaaca080f23c622d7d38d9" compoundref="ssh__client_8c" startline="244" endline="288">shell</referencedby>
        <referencedby refid="ssh__client_8c_1ad1cebb7dc5f06fe1b835f9f90003c7da" compoundref="ssh__client_8c" startline="187" endline="196">sizechanged</referencedby>
      </memberdef>
      <memberdef kind="variable" id="ssh__client_8c_1a6d21331ac755fb13ced40bede585fa29" prot="public" static="yes" mutable="no">
        <type>int</type>
        <definition>int signal_delayed</definition>
        <argsstring></argsstring>
        <name>signal_delayed</name>
        <initializer>= 0</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="libssh-mirror/examples/ssh_client.c" line="173" column="12" bodyfile="libssh-mirror/examples/ssh_client.c" bodystart="173" bodyend="-1"/>
        <referencedby refid="ssh__client_8c_1a38ba4d370f756491ce0d55e0c320d08b" compoundref="ssh__client_8c" startline="198" endline="242">select_loop</referencedby>
        <referencedby refid="ssh__client_8c_1ab6cb6d395e08011c31ac65d1e6b00f35" compoundref="ssh__client_8c" startline="181" endline="185">setsignal</referencedby>
        <referencedby refid="ssh__client_8c_1a5e9c9bdaa340871740be04649f719f28" compoundref="ssh__client_8c" startline="175" endline="179">sigwindowchanged</referencedby>
      </memberdef>
      <memberdef kind="variable" id="ssh__client_8c_1ad52ca26e0f83f73a95659419669bd8bb" prot="public" static="yes" mutable="no">
        <type><ref refid="libssh_8h_1a476c4b8079f7b8ac30be4cc2c8f9d456" kindref="member">ssh_pcap_file</ref></type>
        <definition>ssh_pcap_file pcap</definition>
        <argsstring></argsstring>
        <name>pcap</name>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="libssh-mirror/examples/ssh_client.c" line="368" column="22" bodyfile="libssh-mirror/examples/ssh_client.c" bodystart="368" bodyend="-1"/>
        <referencedby refid="ssh__client_8c_1a640f3c55c8e63434a2ae0b67f72ab262" compoundref="ssh__client_8c" startline="389" endline="395">cleanup_pcap</referencedby>
        <referencedby refid="test__pcap_8c_1a3c04138a5bfe5d72780bb7e82a18e627" compoundref="test__pcap_8c" startline="32" endline="50">main</referencedby>
        <referencedby refid="ssh__client_8c_1a3ea85a9a747087d08426003509b49943" compoundref="ssh__client_8c" startline="369" endline="387">set_pcap</referencedby>
        <referencedby refid="libssh_8h_1a82344b7058b21d887c6aa9fd1b90f130" compoundref="pcap_8c" startline="534" endline="537">ssh_pcap_file_close</referencedby>
        <referencedby refid="libssh_8h_1a0e4cc21bf5453220b57612f278758f3c" compoundref="pcap_8c" startline="539" endline="541">ssh_pcap_file_free</referencedby>
        <referencedby refid="libssh_8h_1ace720476b72056b7faaec7bab504aaa0" compoundref="pcap_8c" startline="546" endline="550">ssh_pcap_file_open</referencedby>
      </memberdef>
      </sectiondef>
      <sectiondef kind="func">
      <memberdef kind="function" id="ssh__client_8c_1a3bcf6ffc0c2c09238e1a7bc6f65aff7c" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>static int auth_callback</definition>
        <argsstring>(const char *prompt, char *buf, size_t len, int echo, int verify, void *userdata)</argsstring>
        <name>auth_callback</name>
        <param>
          <type>const char *</type>
          <declname>prompt</declname>
        </param>
        <param>
          <type>char *</type>
          <declname>buf</declname>
        </param>
        <param>
          <type>size_t</type>
          <declname>len</declname>
        </param>
        <param>
          <type>int</type>
          <declname>echo</declname>
        </param>
        <param>
          <type>int</type>
          <declname>verify</declname>
        </param>
        <param>
          <type>void *</type>
          <declname>userdata</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="libssh-mirror/examples/ssh_client.c" line="56" column="12" bodyfile="libssh-mirror/examples/ssh_client.c" bodystart="56" bodyend="67"/>
        <references refid="samplesshd-kbdint_8c_1aed50069385b2de326e5bbed79b19affd" compoundref="samplesshd-kbdint_8c" startline="189">echo</references>
        <references refid="group__libssh__misc_1gad6effc9fcc3529ae5d7301fb096aa71c" compoundref="getpass_8c" startline="212" endline="282">ssh_getpass</references>
      </memberdef>
      <memberdef kind="function" id="ssh__client_8c_1a45850c1cb10fa49cc185bc9f204f4ca1" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>static void add_cmd</definition>
        <argsstring>(char *cmd)</argsstring>
        <name>add_cmd</name>
        <param>
          <type>char *</type>
          <declname>cmd</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="libssh-mirror/examples/ssh_client.c" line="74" column="13" bodyfile="libssh-mirror/examples/ssh_client.c" bodystart="74" bodyend="85"/>
        <references refid="ssh__client_8c_1af2ca9263602e29f4fdd69cd3e31bc641" compoundref="ssh__client_8c" startline="49">cmds</references>
        <references refid="ssh__client_8c_1ac2c6acf3e0c14ce1210c05db36a10dba" compoundref="ssh__client_8c" startline="45">MAXCMD</references>
        <referencedby refid="ssh__client_8c_1a661b14d2cd5d6df5790276ddb9bcda0e" compoundref="ssh__client_8c" startline="109" endline="141">opts</referencedby>
      </memberdef>
      <memberdef kind="function" id="ssh__client_8c_1ad96d407a911fbb914fa8e4cfbf2faf0f" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>static void usage</definition>
        <argsstring>(void)</argsstring>
        <name>usage</name>
        <param>
          <type>void</type>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="libssh-mirror/examples/ssh_client.c" line="87" column="13" bodyfile="libssh-mirror/examples/ssh_client.c" bodystart="87" bodyend="107"/>
        <references refid="CMakeLists_8txt_1afe4b652fdce40e32edbfd55e707a1ba0" compoundref="CMakeLists_8txt" startline="68" endline="113">endif</references>
        <references refid="group__libssh__misc_1gaeda71ed34a62fa332762f25b14dac6eb" compoundref="misc_8c" startline="652" endline="659">ssh_version</references>
        <referencedby refid="ssh__client_8c_1a3c04138a5bfe5d72780bb7e82a18e627" compoundref="ssh__client_8c" startline="397" endline="425">main</referencedby>
        <referencedby refid="ssh__client_8c_1a661b14d2cd5d6df5790276ddb9bcda0e" compoundref="ssh__client_8c" startline="109" endline="141">opts</referencedby>
      </memberdef>
      <memberdef kind="function" id="ssh__client_8c_1a661b14d2cd5d6df5790276ddb9bcda0e" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>static int opts</definition>
        <argsstring>(int argc, char **argv)</argsstring>
        <name>opts</name>
        <param>
          <type>int</type>
          <declname>argc</declname>
        </param>
        <param>
          <type>char **</type>
          <declname>argv</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="libssh-mirror/examples/ssh_client.c" line="109" column="12" bodyfile="libssh-mirror/examples/ssh_client.c" bodystart="109" bodyend="141"/>
        <references refid="ssh__client_8c_1a45850c1cb10fa49cc185bc9f204f4ca1" compoundref="ssh__client_8c" startline="74" endline="85">add_cmd</references>
        <references refid="ssh__client_8c_1a1c2046dcb30a629d6d9f45ff8f403f12" compoundref="ssh__client_8c" startline="47">host</references>
        <references refid="ssh__client_8c_1a6c01d4272dd21e4cd0006557b836ec41" compoundref="ssh__client_8c" startline="52">pcap_file</references>
        <references refid="ssh__client_8c_1af18a40f45567d09a4f237ad82282588c" compoundref="ssh__client_8c" startline="54">proxycommand</references>
        <references refid="ssh__client_8c_1ad96d407a911fbb914fa8e4cfbf2faf0f" compoundref="ssh__client_8c" startline="87" endline="107">usage</references>
        <referencedby refid="ssh__client_8c_1a3c04138a5bfe5d72780bb7e82a18e627" compoundref="ssh__client_8c" startline="397" endline="425">main</referencedby>
      </memberdef>
      <memberdef kind="function" id="ssh__client_8c_1a2edb85f17bd5713ff4cef46c6644e100" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>static void cfmakeraw</definition>
        <argsstring>(struct termios *termios_p)</argsstring>
        <name>cfmakeraw</name>
        <param>
          <type>struct termios *</type>
          <declname>termios_p</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="libssh-mirror/examples/ssh_client.c" line="144" column="13" bodyfile="libssh-mirror/examples/ssh_client.c" bodystart="144" bodyend="151"/>
        <referencedby refid="ssh__client_8c_1a9aee67bdbbcaaca080f23c622d7d38d9" compoundref="ssh__client_8c" startline="244" endline="288">shell</referencedby>
      </memberdef>
      <memberdef kind="function" id="ssh__client_8c_1ada318c9f05c1dba93ef5ed73ed9a3e91" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>static void do_cleanup</definition>
        <argsstring>(int i)</argsstring>
        <name>do_cleanup</name>
        <param>
          <type>int</type>
          <declname>i</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="libssh-mirror/examples/ssh_client.c" line="155" column="13" bodyfile="libssh-mirror/examples/ssh_client.c" bodystart="155" bodyend="161"/>
        <references refid="ssh__client_8c_1a029e0d76938d65623721b901853405a4" compoundref="ssh__client_8c" startline="50">terminal</references>
        <referencedby refid="ssh__client_8c_1a4a68c20f35351d4786eede1455b98199" compoundref="ssh__client_8c" startline="163" endline="170">do_exit</referencedby>
        <referencedby refid="ssh__client_8c_1a9aee67bdbbcaaca080f23c622d7d38d9" compoundref="ssh__client_8c" startline="244" endline="288">shell</referencedby>
      </memberdef>
      <memberdef kind="function" id="ssh__client_8c_1a4a68c20f35351d4786eede1455b98199" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>static void do_exit</definition>
        <argsstring>(int i)</argsstring>
        <name>do_exit</name>
        <param>
          <type>int</type>
          <declname>i</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="libssh-mirror/examples/ssh_client.c" line="163" column="13" bodyfile="libssh-mirror/examples/ssh_client.c" bodystart="163" bodyend="170"/>
        <references refid="ssh__client_8c_1ada318c9f05c1dba93ef5ed73ed9a3e91" compoundref="ssh__client_8c" startline="155" endline="161">do_cleanup</references>
        <referencedby refid="ssh__client_8c_1a3c04138a5bfe5d72780bb7e82a18e627" compoundref="ssh__client_8c" startline="397" endline="425">main</referencedby>
      </memberdef>
      <memberdef kind="function" id="ssh__client_8c_1a5e9c9bdaa340871740be04649f719f28" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>static void sigwindowchanged</definition>
        <argsstring>(int i)</argsstring>
        <name>sigwindowchanged</name>
        <param>
          <type>int</type>
          <declname>i</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="libssh-mirror/examples/ssh_client.c" line="175" column="13" bodyfile="libssh-mirror/examples/ssh_client.c" bodystart="175" bodyend="179"/>
        <references refid="ssh__client_8c_1a6d21331ac755fb13ced40bede585fa29" compoundref="ssh__client_8c" startline="173">signal_delayed</references>
        <referencedby refid="ssh__client_8c_1ab6cb6d395e08011c31ac65d1e6b00f35" compoundref="ssh__client_8c" startline="181" endline="185">setsignal</referencedby>
      </memberdef>
      <memberdef kind="function" id="ssh__client_8c_1ab6cb6d395e08011c31ac65d1e6b00f35" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>static void setsignal</definition>
        <argsstring>(void)</argsstring>
        <name>setsignal</name>
        <param>
          <type>void</type>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="libssh-mirror/examples/ssh_client.c" line="181" column="13" bodyfile="libssh-mirror/examples/ssh_client.c" bodystart="181" bodyend="185"/>
        <references refid="ssh__client_8c_1a6d21331ac755fb13ced40bede585fa29" compoundref="ssh__client_8c" startline="173">signal_delayed</references>
        <references refid="ssh__client_8c_1a5e9c9bdaa340871740be04649f719f28" compoundref="ssh__client_8c" startline="175" endline="179">sigwindowchanged</references>
        <referencedby refid="ssh__client_8c_1a9aee67bdbbcaaca080f23c622d7d38d9" compoundref="ssh__client_8c" startline="244" endline="288">shell</referencedby>
        <referencedby refid="ssh__client_8c_1ad1cebb7dc5f06fe1b835f9f90003c7da" compoundref="ssh__client_8c" startline="187" endline="196">sizechanged</referencedby>
      </memberdef>
      <memberdef kind="function" id="ssh__client_8c_1ad1cebb7dc5f06fe1b835f9f90003c7da" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>static void sizechanged</definition>
        <argsstring>(void)</argsstring>
        <name>sizechanged</name>
        <param>
          <type>void</type>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="libssh-mirror/examples/ssh_client.c" line="187" column="13" bodyfile="libssh-mirror/examples/ssh_client.c" bodystart="187" bodyend="196"/>
        <references refid="ssh__client_8c_1aadb4b99b6f71c3c49bd7b97096d033fa" compoundref="ssh__client_8c" startline="172">chan</references>
        <references refid="ssh__client_8c_1ab6cb6d395e08011c31ac65d1e6b00f35" compoundref="ssh__client_8c" startline="181" endline="185">setsignal</references>
        <references refid="group__libssh__channel_1gaf5d55c90f3d98c583df23d21905c1127" compoundref="channels_8c" startline="1880" endline="1907">ssh_channel_change_pty_size</references>
        <referencedby refid="ssh__client_8c_1a38ba4d370f756491ce0d55e0c320d08b" compoundref="ssh__client_8c" startline="198" endline="242">select_loop</referencedby>
        <referencedby refid="ssh__client_8c_1a9aee67bdbbcaaca080f23c622d7d38d9" compoundref="ssh__client_8c" startline="244" endline="288">shell</referencedby>
      </memberdef>
      <memberdef kind="function" id="ssh__client_8c_1a38ba4d370f756491ce0d55e0c320d08b" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>static void select_loop</definition>
        <argsstring>(ssh_session session, ssh_channel channel)</argsstring>
        <name>select_loop</name>
        <param>
          <type><ref refid="libssh_8h_1a02d3754de040612632cdd499c20f92f6" kindref="member">ssh_session</ref></type>
          <declname>session</declname>
        </param>
        <param>
          <type><ref refid="libssh_8h_1aca32be8db7c865697a3de381dc7e9fc3" kindref="member">ssh_channel</ref></type>
          <declname>channel</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="libssh-mirror/examples/ssh_client.c" line="198" column="13" bodyfile="libssh-mirror/examples/ssh_client.c" bodystart="198" bodyend="242"/>
        <references refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" compoundref="pkd__daemon_8c" startline="62">rc</references>
        <references refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" compoundref="torture__session__keys_8c" startline="61">session</references>
        <references refid="ssh__client_8c_1a6d21331ac755fb13ced40bede585fa29" compoundref="ssh__client_8c" startline="173">signal_delayed</references>
        <references refid="ssh__client_8c_1ad1cebb7dc5f06fe1b835f9f90003c7da" compoundref="ssh__client_8c" startline="187" endline="196">sizechanged</references>
        <references refid="group__libssh__channel_1gaaafcda943c96ddb91e5c28c0bdee7045" compoundref="channels_8c" startline="1566" endline="1571">ssh_channel_is_open</references>
        <references refid="libssh_8h_1ae082e4d35591a2f2f3074f28049ff993" compoundref="connector_8c" startline="125" endline="151">ssh_connector_free</references>
        <references refid="libssh_8h_1abe75f2d91dee85a3834ee50a69b64385" compoundref="connector_8c" startline="96" endline="123">ssh_connector_new</references>
        <references refid="libssh_8h_1a43ca9065044b48afdede3e9fd9f1f86a" compoundref="connector_8c" startline="153" endline="167">ssh_connector_set_in_channel</references>
        <references refid="libssh_8h_1ab5763a5e739e0fcf1857f5ca24b0716b" compoundref="connector_8c" startline="185" endline="190">ssh_connector_set_in_fd</references>
        <references refid="libssh_8h_1a9545174e1a2727b15a620f09b7e8b348" compoundref="connector_8c" startline="169" endline="183">ssh_connector_set_out_channel</references>
        <references refid="libssh_8h_1a83638a551468a2a6ef0ff38784bb6697" compoundref="connector_8c" startline="192" endline="197">ssh_connector_set_out_fd</references>
        <references refid="libssh_8h_1a1b16de6e3d7453108e91d9e3a6608536a8990d435585796e3aecf7426e6041408" compoundref="libssh_8h" startline="450">SSH_CONNECTOR_STDERR</references>
        <references refid="libssh_8h_1a1b16de6e3d7453108e91d9e3a6608536abc07fcb188c74661393d19b895ef8e5e" compoundref="libssh_8h" startline="448">SSH_CONNECTOR_STDINOUT</references>
        <references refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" compoundref="libssh_8h" startline="330">SSH_ERROR</references>
        <references refid="group__libssh__poll_1gae1f53a6ce420a41ae06ffb962f477f99" compoundref="poll_8c" startline="936" endline="938">ssh_event_add_connector</references>
        <references refid="group__libssh__poll_1gada90c0ca6919271708ba1ea0352632cb" compoundref="poll_8c" startline="957" endline="965">ssh_event_dopoll</references>
        <references refid="group__libssh__poll_1ga101388903c74d53ed550574b587449cd" compoundref="poll_8c" startline="1089" endline="1118">ssh_event_free</references>
        <references refid="group__libssh__poll_1ga406895f99b6b486c4b65536e5399ff96" compoundref="poll_8c" startline="760" endline="785">ssh_event_new</references>
        <references refid="group__libssh__poll_1gae120116df5a1da09ee9edd42e6a63397" compoundref="poll_8c" startline="1076" endline="1079">ssh_event_remove_connector</references>
        <referencedby refid="ssh__client_8c_1a8b8ff3289e057f1b391476c5c4b71178" compoundref="ssh__client_8c" startline="290" endline="316">batch_shell</referencedby>
        <referencedby refid="ssh__client_8c_1a9aee67bdbbcaaca080f23c622d7d38d9" compoundref="ssh__client_8c" startline="244" endline="288">shell</referencedby>
      </memberdef>
      <memberdef kind="function" id="ssh__client_8c_1a9aee67bdbbcaaca080f23c622d7d38d9" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>static void shell</definition>
        <argsstring>(ssh_session session)</argsstring>
        <name>shell</name>
        <param>
          <type><ref refid="libssh_8h_1a02d3754de040612632cdd499c20f92f6" kindref="member">ssh_session</ref></type>
          <declname>session</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="libssh-mirror/examples/ssh_client.c" line="244" column="13" bodyfile="libssh-mirror/examples/ssh_client.c" bodystart="244" bodyend="288"/>
        <references refid="ssh__client_8c_1a2edb85f17bd5713ff4cef46c6644e100" compoundref="ssh__client_8c" startline="144" endline="151">cfmakeraw</references>
        <references refid="ssh__client_8c_1aadb4b99b6f71c3c49bd7b97096d033fa" compoundref="ssh__client_8c" startline="172">chan</references>
        <references refid="ssh__client_8c_1ada318c9f05c1dba93ef5ed73ed9a3e91" compoundref="ssh__client_8c" startline="155" endline="161">do_cleanup</references>
        <references refid="ssh__client_8c_1a38ba4d370f756491ce0d55e0c320d08b" compoundref="ssh__client_8c" startline="198" endline="242">select_loop</references>
        <references refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" compoundref="torture__session__keys_8c" startline="61">session</references>
        <references refid="ssh__client_8c_1ab6cb6d395e08011c31ac65d1e6b00f35" compoundref="ssh__client_8c" startline="181" endline="185">setsignal</references>
        <references refid="ssh__client_8c_1ad1cebb7dc5f06fe1b835f9f90003c7da" compoundref="ssh__client_8c" startline="187" endline="196">sizechanged</references>
        <references refid="group__libssh__channel_1gad1417f9eae8928fed20faafe2d9dbfff" compoundref="channels_8c" startline="1123" endline="1167">ssh_channel_free</references>
        <references refid="group__libssh__channel_1gada8ccda7bf65165fe145d3096a252dcc" compoundref="channels_8c" startline="80" endline="129">ssh_channel_new</references>
        <references refid="group__libssh__channel_1gaf051dd30d75bf6dc45d1a5088cf970bd" compoundref="channels_8c" startline="920" endline="930">ssh_channel_open_session</references>
        <references refid="group__libssh__channel_1ga37c1cec33fe5a2f184768aba52e3a0db" compoundref="channels_8c" startline="1861" endline="1863">ssh_channel_request_pty</references>
        <references refid="group__libssh__channel_1gaed4c5fb30c9df2b2548421ccf4e81bf1" compoundref="channels_8c" startline="1919" endline="1925">ssh_channel_request_shell</references>
        <references refid="group__libssh__error_1ga9241586665bf21f823806473fc386258" compoundref="error_8c" startline="128" endline="132">ssh_get_error</references>
        <references refid="ssh__client_8c_1a029e0d76938d65623721b901853405a4" compoundref="ssh__client_8c" startline="50">terminal</references>
        <referencedby refid="ssh__client_8c_1a0d3591711bd7d6cb03d42294115721bb" compoundref="ssh__client_8c" startline="318" endline="366">client</referencedby>
        <referencedby refid="samplesshd-kbdint_8c_1a3c04138a5bfe5d72780bb7e82a18e627" compoundref="samplesshd-kbdint_8c" startline="291" endline="424">main</referencedby>
        <referencedby refid="config_8c_1a7c6e2a64504ae299e19670c0ef2665f2" compoundref="config_8c" startline="313" endline="393">ssh_exec_shell</referencedby>
        <referencedby refid="socket_8h_1a4b4cbdb96d450601a8ba7f2b0530a9c0" compoundref="socket_8c" startline="870" endline="901">ssh_execute_command</referencedby>
      </memberdef>
      <memberdef kind="function" id="ssh__client_8c_1a8b8ff3289e057f1b391476c5c4b71178" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>static void batch_shell</definition>
        <argsstring>(ssh_session session)</argsstring>
        <name>batch_shell</name>
        <param>
          <type><ref refid="libssh_8h_1a02d3754de040612632cdd499c20f92f6" kindref="member">ssh_session</ref></type>
          <declname>session</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="libssh-mirror/examples/ssh_client.c" line="290" column="13" bodyfile="libssh-mirror/examples/ssh_client.c" bodystart="290" bodyend="316"/>
        <references refid="benchmarks_8c_1aff2566f4c366b48d73479bef43ee4d2e" compoundref="benchmarks_8c" startline="347">buffer</references>
        <references refid="ssh__client_8c_1af2ca9263602e29f4fdd69cd3e31bc641" compoundref="ssh__client_8c" startline="49">cmds</references>
        <references refid="ssh__client_8c_1ac2c6acf3e0c14ce1210c05db36a10dba" compoundref="ssh__client_8c" startline="45">MAXCMD</references>
        <references refid="test__socket_8c_1a73991beba1accdcc64730cb00c146fe2" compoundref="test__socket_8c" startline="34">s</references>
        <references refid="ssh__client_8c_1a38ba4d370f756491ce0d55e0c320d08b" compoundref="ssh__client_8c" startline="198" endline="242">select_loop</references>
        <references refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" compoundref="torture__session__keys_8c" startline="61">session</references>
        <references refid="group__libssh__channel_1gad1417f9eae8928fed20faafe2d9dbfff" compoundref="channels_8c" startline="1123" endline="1167">ssh_channel_free</references>
        <references refid="group__libssh__channel_1gada8ccda7bf65165fe145d3096a252dcc" compoundref="channels_8c" startline="80" endline="129">ssh_channel_new</references>
        <references refid="group__libssh__channel_1gaf051dd30d75bf6dc45d1a5088cf970bd" compoundref="channels_8c" startline="920" endline="930">ssh_channel_open_session</references>
        <references refid="group__libssh__channel_1ga567d509183ade0a77190f390e2b5747d" compoundref="channels_8c" startline="2568" endline="2603">ssh_channel_request_exec</references>
        <references refid="group__libssh__error_1ga9241586665bf21f823806473fc386258" compoundref="error_8c" startline="128" endline="132">ssh_get_error</references>
        <referencedby refid="ssh__client_8c_1a0d3591711bd7d6cb03d42294115721bb" compoundref="ssh__client_8c" startline="318" endline="366">client</referencedby>
      </memberdef>
      <memberdef kind="function" id="ssh__client_8c_1a0d3591711bd7d6cb03d42294115721bb" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>static int client</definition>
        <argsstring>(ssh_session session)</argsstring>
        <name>client</name>
        <param>
          <type><ref refid="libssh_8h_1a02d3754de040612632cdd499c20f92f6" kindref="member">ssh_session</ref></type>
          <declname>session</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="libssh-mirror/examples/ssh_client.c" line="318" column="12" bodyfile="libssh-mirror/examples/ssh_client.c" bodystart="318" bodyend="366"/>
        <references refid="examples_2authentication_8c_1a442e0c31c0c57f60ec1f5eaaceebf436" compoundref="examples_2authentication_8c" startline="141" endline="241">authenticate_console</references>
        <references refid="ssh__client_8c_1a8b8ff3289e057f1b391476c5c4b71178" compoundref="ssh__client_8c" startline="290" endline="316">batch_shell</references>
        <references refid="ssh__client_8c_1af2ca9263602e29f4fdd69cd3e31bc641" compoundref="ssh__client_8c" startline="49">cmds</references>
        <references refid="ssh__client_8c_1a1c2046dcb30a629d6d9f45ff8f403f12" compoundref="ssh__client_8c" startline="47">host</references>
        <references refid="ssh__client_8c_1af18a40f45567d09a4f237ad82282588c" compoundref="ssh__client_8c" startline="54">proxycommand</references>
        <references refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" compoundref="torture__session__keys_8c" startline="61">session</references>
        <references refid="ssh__client_8c_1a9aee67bdbbcaaca080f23c622d7d38d9" compoundref="ssh__client_8c" startline="244" endline="288">shell</references>
        <references refid="libssh_8h_1a5b35a5038ad8eac4a4e4c00c6239e6e2ab145398ebf554c3cc5d6acfb241c5235" compoundref="libssh_8h" startline="162">SSH_AUTH_SUCCESS</references>
        <references refid="group__libssh__session_1ga032e07cbd8bc3f14cb2dd375db0b03d7" compoundref="client_8c" startline="507" endline="620">ssh_connect</references>
        <references refid="group__libssh__error_1ga9241586665bf21f823806473fc386258" compoundref="error_8c" startline="128" endline="132">ssh_get_error</references>
        <references refid="group__libssh__session_1ga89864d4d5cc6d3d6ef1c39652f2a688f" compoundref="client_8c" startline="632" endline="638">ssh_get_issue_banner</references>
        <references refid="libssh_8h_1af7093adacb08e7ee1e9b16e9c8b0f46ca6560e124c042153de507732d489e5564" compoundref="libssh_8h" startline="381">SSH_OPTIONS_HOST</references>
        <references refid="group__libssh__session_1ga82371e723260c7572ea061edecc2e9f1" compoundref="options_8c" startline="1375" endline="1418">ssh_options_parse_config</references>
        <references refid="libssh_8h_1af7093adacb08e7ee1e9b16e9c8b0f46ca32efaa3cf66ae2c42d9f979472086d3b" compoundref="libssh_8h" startline="400">SSH_OPTIONS_PROXYCOMMAND</references>
        <references refid="group__libssh__session_1ga7a801b85800baa3f4e16f5b47db0a73d" compoundref="options_8c" startline="474" endline="1039">ssh_options_set</references>
        <references refid="libssh_8h_1af7093adacb08e7ee1e9b16e9c8b0f46ca41a41401297578b6a88df70b50a3cd21" compoundref="libssh_8h" startline="385">SSH_OPTIONS_USER</references>
        <references refid="group__libssh__auth_1ga58e7c265236edbc97a2f117d3f23b4dd" compoundref="auth_8c" startline="406" endline="459">ssh_userauth_none</references>
        <references refid="ssh__client_8c_1a14871705f45ccdc5bb9f4549efd8e119" compoundref="ssh__client_8c" startline="48">user</references>
        <references refid="examples__common_8h_1ad5d8ab97d3635ecaf8fa78225cb960fb" compoundref="examples_2knownhosts_8c" startline="35" endline="117">verify_knownhost</references>
        <referencedby refid="ssh__client_8c_1a3c04138a5bfe5d72780bb7e82a18e627" compoundref="ssh__client_8c" startline="397" endline="425">main</referencedby>
        <referencedby refid="pkd__hello_8c_1a5e7c1318bf40ef5dbeda5e1d1b910398" compoundref="pkd__hello_8c" startline="760" endline="924">pkd_run_tests</referencedby>
        <referencedby refid="kex_8h_1a10fc6e5cb4678972e355e69bfe8e35e4" compoundref="kex_8c" startline="739" endline="801">ssh_kex_select_methods</referencedby>
        <referencedby refid="kex_8h_1ab792762bc96d5065d4db3ebfe5e3067a" compoundref="kex_8c" startline="663" endline="734">ssh_set_client_kex</referencedby>
      </memberdef>
      <memberdef kind="function" id="ssh__client_8c_1a3ea85a9a747087d08426003509b49943" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>static void set_pcap</definition>
        <argsstring>(ssh_session session)</argsstring>
        <name>set_pcap</name>
        <param>
          <type><ref refid="libssh_8h_1a02d3754de040612632cdd499c20f92f6" kindref="member">ssh_session</ref></type>
          <declname>session</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="libssh-mirror/examples/ssh_client.c" line="369" column="13" bodyfile="libssh-mirror/examples/ssh_client.c" bodystart="369" bodyend="387"/>
        <references refid="ssh__client_8c_1ad52ca26e0f83f73a95659419669bd8bb" compoundref="ssh__client_8c" startline="368">pcap</references>
        <references refid="ssh__client_8c_1a6c01d4272dd21e4cd0006557b836ec41" compoundref="ssh__client_8c" startline="52">pcap_file</references>
        <references refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" compoundref="torture__session__keys_8c" startline="61">session</references>
        <references refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" compoundref="libssh_8h" startline="330">SSH_ERROR</references>
        <references refid="libssh_8h_1a0e4cc21bf5453220b57612f278758f3c" compoundref="pcap_8c" startline="539" endline="541">ssh_pcap_file_free</references>
        <references refid="libssh_8h_1a91d9077fc6395d321e6490a6e5f1455c" compoundref="pcap_8c" startline="543" endline="545">ssh_pcap_file_new</references>
        <references refid="libssh_8h_1ace720476b72056b7faaec7bab504aaa0" compoundref="pcap_8c" startline="546" endline="550">ssh_pcap_file_open</references>
        <references refid="libssh_8h_1af5dd887de46c89e3c57d990bb37097cd" compoundref="pcap_8c" startline="552" endline="556">ssh_set_pcap_file</references>
        <referencedby refid="default__cb_8c_1a1c4ec691e0189bd2ff9c7acd3399895b" compoundref="default__cb_8c" startline="783" endline="995">default_handle_session_cb</referencedby>
        <referencedby refid="torture__server__auth__kbdint_8c_1a845bb2d262ac6cb3c7acfaeb394641ee" compoundref="torture__server__auth__kbdint_8c" startline="333" endline="515">handle_kbdint_session_cb</referencedby>
        <referencedby refid="samplesshd-kbdint_8c_1a3c04138a5bfe5d72780bb7e82a18e627" compoundref="samplesshd-kbdint_8c" startline="291" endline="424">main</referencedby>
      </memberdef>
      <memberdef kind="function" id="ssh__client_8c_1a640f3c55c8e63434a2ae0b67f72ab262" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>static void cleanup_pcap</definition>
        <argsstring>(void)</argsstring>
        <name>cleanup_pcap</name>
        <param>
          <type>void</type>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="libssh-mirror/examples/ssh_client.c" line="389" column="13" bodyfile="libssh-mirror/examples/ssh_client.c" bodystart="389" bodyend="395"/>
        <references refid="ssh__client_8c_1ad52ca26e0f83f73a95659419669bd8bb" compoundref="ssh__client_8c" startline="368">pcap</references>
        <references refid="libssh_8h_1a0e4cc21bf5453220b57612f278758f3c" compoundref="pcap_8c" startline="539" endline="541">ssh_pcap_file_free</references>
        <referencedby refid="default__cb_8c_1a1c4ec691e0189bd2ff9c7acd3399895b" compoundref="default__cb_8c" startline="783" endline="995">default_handle_session_cb</referencedby>
        <referencedby refid="torture__server__auth__kbdint_8c_1a845bb2d262ac6cb3c7acfaeb394641ee" compoundref="torture__server__auth__kbdint_8c" startline="333" endline="515">handle_kbdint_session_cb</referencedby>
        <referencedby refid="samplesshd-kbdint_8c_1a3c04138a5bfe5d72780bb7e82a18e627" compoundref="samplesshd-kbdint_8c" startline="291" endline="424">main</referencedby>
      </memberdef>
      <memberdef kind="function" id="ssh__client_8c_1a3c04138a5bfe5d72780bb7e82a18e627" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>int main</definition>
        <argsstring>(int argc, char **argv)</argsstring>
        <name>main</name>
        <param>
          <type>int</type>
          <declname>argc</declname>
        </param>
        <param>
          <type>char **</type>
          <declname>argv</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="libssh-mirror/examples/ssh_client.c" line="397" column="5" bodyfile="libssh-mirror/examples/ssh_client.c" bodystart="397" bodyend="425"/>
        <references refid="ssh__client_8c_1ad7278e5a44ed2f8b6a472a1941a75b89" compoundref="ssh__client_8c" startline="69">cb</references>
        <references refid="ssh__client_8c_1a640f3c55c8e63434a2ae0b67f72ab262" compoundref="ssh__client_8c" startline="389" endline="395">cleanup_pcap</references>
        <references refid="ssh__client_8c_1a0d3591711bd7d6cb03d42294115721bb" compoundref="ssh__client_8c" startline="318" endline="366">client</references>
        <references refid="ssh__client_8c_1a4a68c20f35351d4786eede1455b98199" compoundref="ssh__client_8c" startline="163" endline="170">do_exit</references>
        <references refid="ssh__client_8c_1a661b14d2cd5d6df5790276ddb9bcda0e" compoundref="ssh__client_8c" startline="109" endline="141">opts</references>
        <references refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" compoundref="torture__session__keys_8c" startline="61">session</references>
        <references refid="ssh__client_8c_1a3ea85a9a747087d08426003509b49943" compoundref="ssh__client_8c" startline="369" endline="387">set_pcap</references>
        <references refid="group__libssh__callbacks_1gafe09b81e5346f0babe288dc38113d289" compoundref="callbacks_8h" startline="423">ssh_callbacks_init</references>
        <references refid="group__libssh__session_1ga0f048a4c0dbe02cfb7e9c5b6d0db0f27" compoundref="client_8c" startline="672" endline="750">ssh_disconnect</references>
        <references refid="group__libssh_1ga94a851d00248acde9cd7da084b491242" compoundref="init_8c" startline="218" endline="220">ssh_finalize</references>
        <references refid="group__libssh__session_1gae5af27a98a7488e9f5ded6b37c274156" compoundref="session_8c" startline="191" endline="326">ssh_free</references>
        <references refid="group__libssh__error_1ga9241586665bf21f823806473fc386258" compoundref="error_8c" startline="128" endline="132">ssh_get_error</references>
        <references refid="group__libssh__session_1gaadadc0f9601547c30db7c4d62017d32c" compoundref="session_8c" startline="59" endline="181">ssh_new</references>
        <references refid="group__libssh__session_1ga93f7f7159893f3ce62c9b178724eff75" compoundref="options_8c" startline="1193" endline="1357">ssh_options_getopt</references>
        <references refid="group__libssh__callbacks_1ga2e4b0507c738748a3f10e43fe201fe09" compoundref="callbacks_8c" startline="48" endline="68">ssh_set_callbacks</references>
        <references refid="ssh__client_8c_1ad96d407a911fbb914fa8e4cfbf2faf0f" compoundref="ssh__client_8c" startline="87" endline="107">usage</references>
      </memberdef>
      </sectiondef>
    <briefdescription>
    </briefdescription>
    <detaileddescription>
    </detaileddescription>
    <programlisting>
<codeline lineno="1"><highlight class="comment">/*<sp/>ssh_client.c<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2"><highlight class="normal"></highlight></codeline>
<codeline lineno="3"><highlight class="normal"></highlight><highlight class="comment">/*</highlight></codeline>
<codeline lineno="4"><highlight class="comment"><sp/>*<sp/>Copyright<sp/>2003-2015<sp/>Aris<sp/>Adamantiadis</highlight></codeline>
<codeline lineno="5"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="6"><highlight class="comment"><sp/>*<sp/>This<sp/>file<sp/>is<sp/>part<sp/>of<sp/>the<sp/>SSH<sp/>Library</highlight></codeline>
<codeline lineno="7"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="8"><highlight class="comment"><sp/>*<sp/>You<sp/>are<sp/>free<sp/>to<sp/>copy<sp/>this<sp/>file,<sp/>modify<sp/>it<sp/>in<sp/>any<sp/>way,<sp/>consider<sp/>it<sp/>being<sp/>public</highlight></codeline>
<codeline lineno="9"><highlight class="comment"><sp/>*<sp/>domain.<sp/>This<sp/>does<sp/>not<sp/>apply<sp/>to<sp/>the<sp/>rest<sp/>of<sp/>the<sp/>library<sp/>though,<sp/>but<sp/>it<sp/>is</highlight></codeline>
<codeline lineno="10"><highlight class="comment"><sp/>*<sp/>allowed<sp/>to<sp/>cut-and-paste<sp/>working<sp/>code<sp/>from<sp/>this<sp/>file<sp/>to<sp/>any<sp/>license<sp/>of</highlight></codeline>
<codeline lineno="11"><highlight class="comment"><sp/>*<sp/>program.</highlight></codeline>
<codeline lineno="12"><highlight class="comment"><sp/>*<sp/>The<sp/>goal<sp/>is<sp/>to<sp/>show<sp/>the<sp/>API<sp/>in<sp/>action.<sp/>It&apos;s<sp/>not<sp/>a<sp/>reference<sp/>on<sp/>how<sp/>terminal</highlight></codeline>
<codeline lineno="13"><highlight class="comment"><sp/>*<sp/>clients<sp/>must<sp/>be<sp/>made<sp/>or<sp/>how<sp/>a<sp/>client<sp/>should<sp/>react.</highlight></codeline>
<codeline lineno="14"><highlight class="comment"><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="15"><highlight class="normal"></highlight></codeline>
<codeline lineno="16"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="config_8h" kindref="compound">config.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="17"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;stdio.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="18"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;stdlib.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="19"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;<ref refid="string_8h" kindref="compound">string.h</ref>&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="20"><highlight class="normal"></highlight></codeline>
<codeline lineno="21"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;sys/select.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="22"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;sys/time.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="23"><highlight class="normal"></highlight></codeline>
<codeline lineno="24"><highlight class="normal"></highlight><highlight class="preprocessor">#ifdef<sp/>HAVE_TERMIOS_H</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="25"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;termios.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="26"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="27"><highlight class="normal"></highlight><highlight class="preprocessor">#ifdef<sp/>HAVE_UNISTD_H</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="28"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;unistd.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="29"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="30"><highlight class="normal"></highlight><highlight class="preprocessor">#ifdef<sp/>HAVE_PTY_H</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="31"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;pty.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="32"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="33"><highlight class="normal"></highlight></codeline>
<codeline lineno="34"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;sys/ioctl.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="35"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;signal.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="36"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;errno.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="37"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;fcntl.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="38"><highlight class="normal"></highlight></codeline>
<codeline lineno="39"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;<ref refid="callbacks_8h" kindref="compound">libssh/callbacks.h</ref>&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="40"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;<ref refid="libssh_8h" kindref="compound">libssh/libssh.h</ref>&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="41"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;<ref refid="sftp_8h" kindref="compound">libssh/sftp.h</ref>&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="42"><highlight class="normal"></highlight></codeline>
<codeline lineno="43"><highlight class="normal"></highlight></codeline>
<codeline lineno="44"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="examples__common_8h" kindref="compound">examples_common.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="45" refid="ssh__client_8c_1ac2c6acf3e0c14ce1210c05db36a10dba" refkind="member"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>MAXCMD<sp/>10</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="46"><highlight class="normal"></highlight></codeline>
<codeline lineno="47" refid="ssh__client_8c_1a1c2046dcb30a629d6d9f45ff8f403f12" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*<ref refid="ssh__client_8c_1a1c2046dcb30a629d6d9f45ff8f403f12" kindref="member">host</ref>;</highlight></codeline>
<codeline lineno="48" refid="ssh__client_8c_1a14871705f45ccdc5bb9f4549efd8e119" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*<ref refid="ssh__client_8c_1a14871705f45ccdc5bb9f4549efd8e119" kindref="member">user</ref>;</highlight></codeline>
<codeline lineno="49" refid="ssh__client_8c_1af2ca9263602e29f4fdd69cd3e31bc641" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*<ref refid="ssh__client_8c_1af2ca9263602e29f4fdd69cd3e31bc641" kindref="member">cmds</ref>[<ref refid="ssh__client_8c_1ac2c6acf3e0c14ce1210c05db36a10dba" kindref="member">MAXCMD</ref>];</highlight></codeline>
<codeline lineno="50"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">struct<sp/></highlight><highlight class="normal">termios<sp/><ref refid="ssh__client_8c_1a029e0d76938d65623721b901853405a4" kindref="member">terminal</ref>;</highlight></codeline>
<codeline lineno="51"><highlight class="normal"></highlight></codeline>
<codeline lineno="52" refid="ssh__client_8c_1a6c01d4272dd21e4cd0006557b836ec41" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*<ref refid="ssh__client_8c_1a6c01d4272dd21e4cd0006557b836ec41" kindref="member">pcap_file</ref><sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="53"><highlight class="normal"></highlight></codeline>
<codeline lineno="54" refid="ssh__client_8c_1af18a40f45567d09a4f237ad82282588c" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*<ref refid="ssh__client_8c_1af18a40f45567d09a4f237ad82282588c" kindref="member">proxycommand</ref>;</highlight></codeline>
<codeline lineno="55"><highlight class="normal"></highlight></codeline>
<codeline lineno="56" refid="ssh__client_8c_1a3bcf6ffc0c2c09238e1a7bc6f65aff7c" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="ssh__client_8c_1a3bcf6ffc0c2c09238e1a7bc6f65aff7c" kindref="member">auth_callback</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*prompt,</highlight></codeline>
<codeline lineno="57"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*buf,</highlight></codeline>
<codeline lineno="58"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/>len,</highlight></codeline>
<codeline lineno="59"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="samplesshd-kbdint_8c_1aed50069385b2de326e5bbed79b19affd" kindref="member">echo</ref>,</highlight></codeline>
<codeline lineno="60"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>verify,</highlight></codeline>
<codeline lineno="61"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>*userdata)</highlight></codeline>
<codeline lineno="62"><highlight class="normal">{</highlight></codeline>
<codeline lineno="63"><highlight class="normal"><sp/><sp/><sp/><sp/>(void)<sp/>verify;</highlight></codeline>
<codeline lineno="64"><highlight class="normal"><sp/><sp/><sp/><sp/>(void)<sp/>userdata;</highlight></codeline>
<codeline lineno="65"><highlight class="normal"></highlight></codeline>
<codeline lineno="66"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="group__libssh__misc_1gad6effc9fcc3529ae5d7301fb096aa71c" kindref="member">ssh_getpass</ref>(prompt,<sp/>buf,<sp/>len,<sp/><ref refid="samplesshd-kbdint_8c_1aed50069385b2de326e5bbed79b19affd" kindref="member">echo</ref>,<sp/>verify);</highlight></codeline>
<codeline lineno="67"><highlight class="normal">}</highlight></codeline>
<codeline lineno="68"><highlight class="normal"></highlight></codeline>
<codeline lineno="69"><highlight class="normal"></highlight><highlight class="keyword">struct<sp/></highlight><highlight class="normal"><ref refid="structssh__callbacks__struct" kindref="compound">ssh_callbacks_struct</ref><sp/><ref refid="ssh__client_8c_1ad7278e5a44ed2f8b6a472a1941a75b89" kindref="member">cb</ref><sp/>=<sp/>{</highlight></codeline>
<codeline lineno="70"><highlight class="normal"><sp/><sp/><sp/><sp/>.<ref refid="structssh__callbacks__struct_1a5f79b2d36329d0ce6e9ac2cd3b77b046" kindref="member">auth_function</ref><sp/>=<sp/><ref refid="ssh__client_8c_1a3bcf6ffc0c2c09238e1a7bc6f65aff7c" kindref="member">auth_callback</ref>,</highlight></codeline>
<codeline lineno="71"><highlight class="normal"><sp/><sp/><sp/><sp/>.userdata<sp/>=<sp/>NULL,</highlight></codeline>
<codeline lineno="72"><highlight class="normal">};</highlight></codeline>
<codeline lineno="73"><highlight class="normal"></highlight></codeline>
<codeline lineno="74" refid="ssh__client_8c_1a45850c1cb10fa49cc185bc9f204f4ca1" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="ssh__client_8c_1a45850c1cb10fa49cc185bc9f204f4ca1" kindref="member">add_cmd</ref>(</highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*cmd)</highlight></codeline>
<codeline lineno="75"><highlight class="normal">{</highlight></codeline>
<codeline lineno="76"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>n;</highlight></codeline>
<codeline lineno="77"><highlight class="normal"></highlight></codeline>
<codeline lineno="78"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(n<sp/>=<sp/>0;<sp/>(n<sp/>&lt;<sp/><ref refid="ssh__client_8c_1ac2c6acf3e0c14ce1210c05db36a10dba" kindref="member">MAXCMD</ref>)<sp/>&amp;&amp;<sp/><ref refid="ssh__client_8c_1af2ca9263602e29f4fdd69cd3e31bc641" kindref="member">cmds</ref>[n]<sp/>!=<sp/>NULL;<sp/>n++);</highlight></codeline>
<codeline lineno="79"><highlight class="normal"></highlight></codeline>
<codeline lineno="80"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(n<sp/>==<sp/><ref refid="ssh__client_8c_1ac2c6acf3e0c14ce1210c05db36a10dba" kindref="member">MAXCMD</ref>)<sp/>{</highlight></codeline>
<codeline lineno="81"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="82"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="83"><highlight class="normal"></highlight></codeline>
<codeline lineno="84"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="ssh__client_8c_1af2ca9263602e29f4fdd69cd3e31bc641" kindref="member">cmds</ref>[n]<sp/>=<sp/>strdup(cmd);</highlight></codeline>
<codeline lineno="85"><highlight class="normal">}</highlight></codeline>
<codeline lineno="86"><highlight class="normal"></highlight></codeline>
<codeline lineno="87" refid="ssh__client_8c_1ad96d407a911fbb914fa8e4cfbf2faf0f" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="ssh__client_8c_1ad96d407a911fbb914fa8e4cfbf2faf0f" kindref="member">usage</ref>(</highlight><highlight class="keywordtype">void</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="88"><highlight class="normal">{</highlight></codeline>
<codeline lineno="89"><highlight class="normal"><sp/><sp/><sp/><sp/>fprintf(stderr,</highlight></codeline>
<codeline lineno="90"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Usage<sp/>:<sp/>ssh<sp/>[options]<sp/>[login@]hostname\n&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="91"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;sample<sp/>client<sp/>-<sp/>libssh-%s\n&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="92"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Options<sp/>:\n&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="93"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;<sp/><sp/>-l<sp/>user<sp/>:<sp/>log<sp/>in<sp/>as<sp/>user\n&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="94"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;<sp/><sp/>-p<sp/>port<sp/>:<sp/>connect<sp/>to<sp/>port\n&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="95"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;<sp/><sp/>-d<sp/>:<sp/>use<sp/>DSS<sp/>to<sp/>verify<sp/>host<sp/>public<sp/>key\n&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="96"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;<sp/><sp/>-r<sp/>:<sp/>use<sp/>RSA<sp/>to<sp/>verify<sp/>host<sp/>public<sp/>key\n&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="97"><highlight class="normal">#ifdef<sp/>WITH_PCAP</highlight></codeline>
<codeline lineno="98"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;<sp/><sp/>-P<sp/>file<sp/>:<sp/>create<sp/>a<sp/>pcap<sp/>debugging<sp/>file\n&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="99"><highlight class="normal">#<ref refid="CMakeLists_8txt_1afe4b652fdce40e32edbfd55e707a1ba0" kindref="member">endif</ref></highlight></codeline>
<codeline lineno="100"><highlight class="normal">#ifndef<sp/>_WIN32</highlight></codeline>
<codeline lineno="101"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;<sp/><sp/>-T<sp/>proxycommand<sp/>:<sp/>command<sp/>to<sp/>execute<sp/>as<sp/>a<sp/>socket<sp/>proxy\n&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="102"><highlight class="normal">#<ref refid="CMakeLists_8txt_1afe4b652fdce40e32edbfd55e707a1ba0" kindref="member">endif</ref></highlight></codeline>
<codeline lineno="103"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;\n&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="104"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="group__libssh__misc_1gaeda71ed34a62fa332762f25b14dac6eb" kindref="member">ssh_version</ref>(0));</highlight></codeline>
<codeline lineno="105"><highlight class="normal"></highlight></codeline>
<codeline lineno="106"><highlight class="normal"><sp/><sp/><sp/><sp/>exit(0);</highlight></codeline>
<codeline lineno="107"><highlight class="normal">}</highlight></codeline>
<codeline lineno="108"><highlight class="normal"></highlight></codeline>
<codeline lineno="109" refid="ssh__client_8c_1a661b14d2cd5d6df5790276ddb9bcda0e" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="ssh__client_8c_1a661b14d2cd5d6df5790276ddb9bcda0e" kindref="member">opts</ref>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>argc,<sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>**argv)</highlight></codeline>
<codeline lineno="110"><highlight class="normal">{</highlight></codeline>
<codeline lineno="111"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i;</highlight></codeline>
<codeline lineno="112"><highlight class="normal"></highlight></codeline>
<codeline lineno="113"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal">((i<sp/>=<sp/>getopt(argc,argv,</highlight><highlight class="stringliteral">&quot;T:P:&quot;</highlight><highlight class="normal">))<sp/>!=<sp/>-1)<sp/>{</highlight></codeline>
<codeline lineno="114"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">switch</highlight><highlight class="normal">(i){</highlight></codeline>
<codeline lineno="115"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/></highlight><highlight class="charliteral">&apos;P&apos;</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="116"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ssh__client_8c_1a6c01d4272dd21e4cd0006557b836ec41" kindref="member">pcap_file</ref><sp/>=<sp/>optarg;</highlight></codeline>
<codeline lineno="117"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="118"><highlight class="normal"></highlight><highlight class="preprocessor">#ifndef<sp/>_WIN32</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="119"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/></highlight><highlight class="charliteral">&apos;T&apos;</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="120"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ssh__client_8c_1af18a40f45567d09a4f237ad82282588c" kindref="member">proxycommand</ref><sp/>=<sp/>optarg;</highlight></codeline>
<codeline lineno="121"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="122"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="123"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">default</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="124"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fprintf(stderr,<sp/></highlight><highlight class="stringliteral">&quot;Unknown<sp/>option<sp/>%c\n&quot;</highlight><highlight class="normal">,<sp/>optopt);</highlight></codeline>
<codeline lineno="125"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ssh__client_8c_1ad96d407a911fbb914fa8e4cfbf2faf0f" kindref="member">usage</ref>();</highlight></codeline>
<codeline lineno="126"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="127"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="128"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(optind<sp/>&lt;<sp/>argc)<sp/>{</highlight></codeline>
<codeline lineno="129"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ssh__client_8c_1a1c2046dcb30a629d6d9f45ff8f403f12" kindref="member">host</ref><sp/>=<sp/>argv[optind++];</highlight></codeline>
<codeline lineno="130"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="131"><highlight class="normal"></highlight></codeline>
<codeline lineno="132"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal">(optind<sp/>&lt;<sp/>argc)<sp/>{</highlight></codeline>
<codeline lineno="133"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ssh__client_8c_1a45850c1cb10fa49cc185bc9f204f4ca1" kindref="member">add_cmd</ref>(argv[optind++]);</highlight></codeline>
<codeline lineno="134"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="135"><highlight class="normal"></highlight></codeline>
<codeline lineno="136"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="ssh__client_8c_1a1c2046dcb30a629d6d9f45ff8f403f12" kindref="member">host</ref><sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="137"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ssh__client_8c_1ad96d407a911fbb914fa8e4cfbf2faf0f" kindref="member">usage</ref>();</highlight></codeline>
<codeline lineno="138"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="139"><highlight class="normal"></highlight></codeline>
<codeline lineno="140"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>0;</highlight></codeline>
<codeline lineno="141"><highlight class="normal">}</highlight></codeline>
<codeline lineno="142"><highlight class="normal"></highlight></codeline>
<codeline lineno="143"><highlight class="normal"></highlight><highlight class="preprocessor">#ifndef<sp/>HAVE_CFMAKERAW</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="144" refid="ssh__client_8c_1a2edb85f17bd5713ff4cef46c6644e100" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="ssh__client_8c_1a2edb85f17bd5713ff4cef46c6644e100" kindref="member">cfmakeraw</ref>(</highlight><highlight class="keyword">struct</highlight><highlight class="normal"><sp/>termios<sp/>*termios_p)</highlight></codeline>
<codeline lineno="145"><highlight class="normal">{</highlight></codeline>
<codeline lineno="146"><highlight class="normal"><sp/><sp/><sp/><sp/>termios_p-&gt;c_iflag<sp/>&amp;=<sp/>~(IGNBRK|BRKINT|PARMRK|ISTRIP|INLCR|IGNCR|ICRNL|IXON);</highlight></codeline>
<codeline lineno="147"><highlight class="normal"><sp/><sp/><sp/><sp/>termios_p-&gt;c_oflag<sp/>&amp;=<sp/>~OPOST;</highlight></codeline>
<codeline lineno="148"><highlight class="normal"><sp/><sp/><sp/><sp/>termios_p-&gt;c_lflag<sp/>&amp;=<sp/>~(ECHO|ECHONL|ICANON|ISIG|IEXTEN);</highlight></codeline>
<codeline lineno="149"><highlight class="normal"><sp/><sp/><sp/><sp/>termios_p-&gt;c_cflag<sp/>&amp;=<sp/>~(CSIZE|PARENB);</highlight></codeline>
<codeline lineno="150"><highlight class="normal"><sp/><sp/><sp/><sp/>termios_p-&gt;c_cflag<sp/>|=<sp/>CS8;</highlight></codeline>
<codeline lineno="151"><highlight class="normal">}</highlight></codeline>
<codeline lineno="152"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="153"><highlight class="normal"></highlight></codeline>
<codeline lineno="154"><highlight class="normal"></highlight></codeline>
<codeline lineno="155" refid="ssh__client_8c_1ada318c9f05c1dba93ef5ed73ed9a3e91" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="ssh__client_8c_1ada318c9f05c1dba93ef5ed73ed9a3e91" kindref="member">do_cleanup</ref>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i)</highlight></codeline>
<codeline lineno="156"><highlight class="normal">{</highlight></codeline>
<codeline lineno="157"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">/*<sp/>unused<sp/>variable<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="158"><highlight class="normal"><sp/><sp/>(void)<sp/>i;</highlight></codeline>
<codeline lineno="159"><highlight class="normal"></highlight></codeline>
<codeline lineno="160"><highlight class="normal"><sp/><sp/>tcsetattr(0,<sp/>TCSANOW,<sp/>&amp;<ref refid="ssh__client_8c_1a029e0d76938d65623721b901853405a4" kindref="member">terminal</ref>);</highlight></codeline>
<codeline lineno="161"><highlight class="normal">}</highlight></codeline>
<codeline lineno="162"><highlight class="normal"></highlight></codeline>
<codeline lineno="163" refid="ssh__client_8c_1a4a68c20f35351d4786eede1455b98199" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="ssh__client_8c_1a4a68c20f35351d4786eede1455b98199" kindref="member">do_exit</ref>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i)</highlight></codeline>
<codeline lineno="164"><highlight class="normal">{</highlight></codeline>
<codeline lineno="165"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>unused<sp/>variable<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="166"><highlight class="normal"><sp/><sp/><sp/><sp/>(void)<sp/>i;</highlight></codeline>
<codeline lineno="167"><highlight class="normal"></highlight></codeline>
<codeline lineno="168"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="ssh__client_8c_1ada318c9f05c1dba93ef5ed73ed9a3e91" kindref="member">do_cleanup</ref>(0);</highlight></codeline>
<codeline lineno="169"><highlight class="normal"><sp/><sp/><sp/><sp/>exit(0);</highlight></codeline>
<codeline lineno="170"><highlight class="normal">}</highlight></codeline>
<codeline lineno="171"><highlight class="normal"></highlight></codeline>
<codeline lineno="172" refid="ssh__client_8c_1aadb4b99b6f71c3c49bd7b97096d033fa" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/><ref refid="structssh__channel__struct" kindref="compound">ssh_channel</ref><sp/><ref refid="ssh__client_8c_1aadb4b99b6f71c3c49bd7b97096d033fa" kindref="member">chan</ref>;</highlight></codeline>
<codeline lineno="173" refid="ssh__client_8c_1a6d21331ac755fb13ced40bede585fa29" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="ssh__client_8c_1a6d21331ac755fb13ced40bede585fa29" kindref="member">signal_delayed</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="174"><highlight class="normal"></highlight></codeline>
<codeline lineno="175" refid="ssh__client_8c_1a5e9c9bdaa340871740be04649f719f28" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="ssh__client_8c_1a5e9c9bdaa340871740be04649f719f28" kindref="member">sigwindowchanged</ref>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i)</highlight></codeline>
<codeline lineno="176"><highlight class="normal">{</highlight></codeline>
<codeline lineno="177"><highlight class="normal"><sp/><sp/><sp/><sp/>(void)<sp/>i;</highlight></codeline>
<codeline lineno="178"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="ssh__client_8c_1a6d21331ac755fb13ced40bede585fa29" kindref="member">signal_delayed</ref><sp/>=<sp/>1;</highlight></codeline>
<codeline lineno="179"><highlight class="normal">}</highlight></codeline>
<codeline lineno="180"><highlight class="normal"></highlight></codeline>
<codeline lineno="181" refid="ssh__client_8c_1ab6cb6d395e08011c31ac65d1e6b00f35" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="ssh__client_8c_1ab6cb6d395e08011c31ac65d1e6b00f35" kindref="member">setsignal</ref>(</highlight><highlight class="keywordtype">void</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="182"><highlight class="normal">{</highlight></codeline>
<codeline lineno="183"><highlight class="normal"><sp/><sp/><sp/><sp/>signal(SIGWINCH,<sp/><ref refid="ssh__client_8c_1a5e9c9bdaa340871740be04649f719f28" kindref="member">sigwindowchanged</ref>);</highlight></codeline>
<codeline lineno="184"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="ssh__client_8c_1a6d21331ac755fb13ced40bede585fa29" kindref="member">signal_delayed</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="185"><highlight class="normal">}</highlight></codeline>
<codeline lineno="186"><highlight class="normal"></highlight></codeline>
<codeline lineno="187" refid="ssh__client_8c_1ad1cebb7dc5f06fe1b835f9f90003c7da" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="ssh__client_8c_1ad1cebb7dc5f06fe1b835f9f90003c7da" kindref="member">sizechanged</ref>(</highlight><highlight class="keywordtype">void</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="188"><highlight class="normal">{</highlight></codeline>
<codeline lineno="189"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">struct<sp/></highlight><highlight class="normal">winsize<sp/>win<sp/>=<sp/>{</highlight></codeline>
<codeline lineno="190"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>.ws_row<sp/>=<sp/>0,</highlight></codeline>
<codeline lineno="191"><highlight class="normal"><sp/><sp/><sp/><sp/>};</highlight></codeline>
<codeline lineno="192"><highlight class="normal"></highlight></codeline>
<codeline lineno="193"><highlight class="normal"><sp/><sp/><sp/><sp/>ioctl(1,<sp/>TIOCGWINSZ,<sp/>&amp;win);</highlight></codeline>
<codeline lineno="194"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="group__libssh__channel_1gaf5d55c90f3d98c583df23d21905c1127" kindref="member">ssh_channel_change_pty_size</ref>(<ref refid="ssh__client_8c_1aadb4b99b6f71c3c49bd7b97096d033fa" kindref="member">chan</ref>,win.ws_col,<sp/>win.ws_row);</highlight></codeline>
<codeline lineno="195"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="ssh__client_8c_1ab6cb6d395e08011c31ac65d1e6b00f35" kindref="member">setsignal</ref>();</highlight></codeline>
<codeline lineno="196"><highlight class="normal">}</highlight></codeline>
<codeline lineno="197"><highlight class="normal"></highlight></codeline>
<codeline lineno="198" refid="ssh__client_8c_1a38ba4d370f756491ce0d55e0c320d08b" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="ssh__client_8c_1a38ba4d370f756491ce0d55e0c320d08b" kindref="member">select_loop</ref>(<ref refid="structssh__session__struct" kindref="compound">ssh_session</ref><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>,<ref refid="structssh__channel__struct" kindref="compound">ssh_channel</ref><sp/>channel)</highlight></codeline>
<codeline lineno="199"><highlight class="normal">{</highlight></codeline>
<codeline lineno="200"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="structssh__connector__struct" kindref="compound">ssh_connector</ref><sp/>connector_in,<sp/>connector_out,<sp/>connector_err;</highlight></codeline>
<codeline lineno="201"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref>;</highlight></codeline>
<codeline lineno="202"><highlight class="normal"></highlight></codeline>
<codeline lineno="203"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="structssh__event__struct" kindref="compound">ssh_event</ref><sp/></highlight><highlight class="keyword">event</highlight><highlight class="normal"><sp/>=<sp/><ref refid="group__libssh__poll_1ga406895f99b6b486c4b65536e5399ff96" kindref="member">ssh_event_new</ref>();</highlight></codeline>
<codeline lineno="204"><highlight class="normal"></highlight></codeline>
<codeline lineno="205"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>stdin<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="206"><highlight class="normal"><sp/><sp/><sp/><sp/>connector_in<sp/>=<sp/><ref refid="libssh_8h_1abe75f2d91dee85a3834ee50a69b64385" kindref="member">ssh_connector_new</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>);</highlight></codeline>
<codeline lineno="207"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="libssh_8h_1a9545174e1a2727b15a620f09b7e8b348" kindref="member">ssh_connector_set_out_channel</ref>(connector_in,<sp/>channel,<sp/><ref refid="libssh_8h_1a1b16de6e3d7453108e91d9e3a6608536abc07fcb188c74661393d19b895ef8e5e" kindref="member">SSH_CONNECTOR_STDINOUT</ref>);</highlight></codeline>
<codeline lineno="208"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="libssh_8h_1ab5763a5e739e0fcf1857f5ca24b0716b" kindref="member">ssh_connector_set_in_fd</ref>(connector_in,<sp/>0);</highlight></codeline>
<codeline lineno="209"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="group__libssh__poll_1gae1f53a6ce420a41ae06ffb962f477f99" kindref="member">ssh_event_add_connector</ref>(event,<sp/>connector_in);</highlight></codeline>
<codeline lineno="210"><highlight class="normal"></highlight></codeline>
<codeline lineno="211"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>stdout<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="212"><highlight class="normal"><sp/><sp/><sp/><sp/>connector_out<sp/>=<sp/><ref refid="libssh_8h_1abe75f2d91dee85a3834ee50a69b64385" kindref="member">ssh_connector_new</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>);</highlight></codeline>
<codeline lineno="213"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="libssh_8h_1a83638a551468a2a6ef0ff38784bb6697" kindref="member">ssh_connector_set_out_fd</ref>(connector_out,<sp/>1);</highlight></codeline>
<codeline lineno="214"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="libssh_8h_1a43ca9065044b48afdede3e9fd9f1f86a" kindref="member">ssh_connector_set_in_channel</ref>(connector_out,<sp/>channel,<sp/><ref refid="libssh_8h_1a1b16de6e3d7453108e91d9e3a6608536abc07fcb188c74661393d19b895ef8e5e" kindref="member">SSH_CONNECTOR_STDINOUT</ref>);</highlight></codeline>
<codeline lineno="215"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="group__libssh__poll_1gae1f53a6ce420a41ae06ffb962f477f99" kindref="member">ssh_event_add_connector</ref>(event,<sp/>connector_out);</highlight></codeline>
<codeline lineno="216"><highlight class="normal"></highlight></codeline>
<codeline lineno="217"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>stderr<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="218"><highlight class="normal"><sp/><sp/><sp/><sp/>connector_err<sp/>=<sp/><ref refid="libssh_8h_1abe75f2d91dee85a3834ee50a69b64385" kindref="member">ssh_connector_new</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>);</highlight></codeline>
<codeline lineno="219"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="libssh_8h_1a83638a551468a2a6ef0ff38784bb6697" kindref="member">ssh_connector_set_out_fd</ref>(connector_err,<sp/>2);</highlight></codeline>
<codeline lineno="220"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="libssh_8h_1a43ca9065044b48afdede3e9fd9f1f86a" kindref="member">ssh_connector_set_in_channel</ref>(connector_err,<sp/>channel,<sp/><ref refid="libssh_8h_1a1b16de6e3d7453108e91d9e3a6608536a8990d435585796e3aecf7426e6041408" kindref="member">SSH_CONNECTOR_STDERR</ref>);</highlight></codeline>
<codeline lineno="221"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="group__libssh__poll_1gae1f53a6ce420a41ae06ffb962f477f99" kindref="member">ssh_event_add_connector</ref>(event,<sp/>connector_err);</highlight></codeline>
<codeline lineno="222"><highlight class="normal"></highlight></codeline>
<codeline lineno="223"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>(<ref refid="group__libssh__channel_1gaaafcda943c96ddb91e5c28c0bdee7045" kindref="member">ssh_channel_is_open</ref>(channel))<sp/>{</highlight></codeline>
<codeline lineno="224"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="ssh__client_8c_1a6d21331ac755fb13ced40bede585fa29" kindref="member">signal_delayed</ref>)<sp/>{</highlight></codeline>
<codeline lineno="225"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ssh__client_8c_1ad1cebb7dc5f06fe1b835f9f90003c7da" kindref="member">sizechanged</ref>();</highlight></codeline>
<codeline lineno="226"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="227"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="group__libssh__poll_1gada90c0ca6919271708ba1ea0352632cb" kindref="member">ssh_event_dopoll</ref>(event,<sp/>60000);</highlight></codeline>
<codeline lineno="228"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>==<sp/><ref refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" kindref="member">SSH_ERROR</ref>)<sp/>{</highlight></codeline>
<codeline lineno="229"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fprintf(stderr,<sp/></highlight><highlight class="stringliteral">&quot;Error<sp/>in<sp/>ssh_event_dopoll()\n&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="230"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="231"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="232"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="233"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="group__libssh__poll_1gae120116df5a1da09ee9edd42e6a63397" kindref="member">ssh_event_remove_connector</ref>(event,<sp/>connector_in);</highlight></codeline>
<codeline lineno="234"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="group__libssh__poll_1gae120116df5a1da09ee9edd42e6a63397" kindref="member">ssh_event_remove_connector</ref>(event,<sp/>connector_out);</highlight></codeline>
<codeline lineno="235"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="group__libssh__poll_1gae120116df5a1da09ee9edd42e6a63397" kindref="member">ssh_event_remove_connector</ref>(event,<sp/>connector_err);</highlight></codeline>
<codeline lineno="236"><highlight class="normal"></highlight></codeline>
<codeline lineno="237"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="libssh_8h_1ae082e4d35591a2f2f3074f28049ff993" kindref="member">ssh_connector_free</ref>(connector_in);</highlight></codeline>
<codeline lineno="238"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="libssh_8h_1ae082e4d35591a2f2f3074f28049ff993" kindref="member">ssh_connector_free</ref>(connector_out);</highlight></codeline>
<codeline lineno="239"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="libssh_8h_1ae082e4d35591a2f2f3074f28049ff993" kindref="member">ssh_connector_free</ref>(connector_err);</highlight></codeline>
<codeline lineno="240"><highlight class="normal"></highlight></codeline>
<codeline lineno="241"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="group__libssh__poll_1ga101388903c74d53ed550574b587449cd" kindref="member">ssh_event_free</ref>(event);</highlight></codeline>
<codeline lineno="242"><highlight class="normal">}</highlight></codeline>
<codeline lineno="243"><highlight class="normal"></highlight></codeline>
<codeline lineno="244" refid="ssh__client_8c_1a9aee67bdbbcaaca080f23c622d7d38d9" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="ssh__client_8c_1a9aee67bdbbcaaca080f23c622d7d38d9" kindref="member">shell</ref>(<ref refid="structssh__session__struct" kindref="compound">ssh_session</ref><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>)</highlight></codeline>
<codeline lineno="245"><highlight class="normal">{</highlight></codeline>
<codeline lineno="246"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="structssh__channel__struct" kindref="compound">ssh_channel</ref><sp/>channel;</highlight></codeline>
<codeline lineno="247"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">struct<sp/></highlight><highlight class="normal">termios<sp/>terminal_local;</highlight></codeline>
<codeline lineno="248"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>interactive=isatty(0);</highlight></codeline>
<codeline lineno="249"><highlight class="normal"></highlight></codeline>
<codeline lineno="250"><highlight class="normal"><sp/><sp/><sp/><sp/>channel<sp/>=<sp/><ref refid="group__libssh__channel_1gada8ccda7bf65165fe145d3096a252dcc" kindref="member">ssh_channel_new</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>);</highlight></codeline>
<codeline lineno="251"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(channel<sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="252"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="253"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="254"><highlight class="normal"></highlight></codeline>
<codeline lineno="255"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(interactive)<sp/>{</highlight></codeline>
<codeline lineno="256"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>tcgetattr(0,<sp/>&amp;terminal_local);</highlight></codeline>
<codeline lineno="257"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>memcpy(&amp;<ref refid="ssh__client_8c_1a029e0d76938d65623721b901853405a4" kindref="member">terminal</ref>,<sp/>&amp;terminal_local,<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(</highlight><highlight class="keyword">struct</highlight><highlight class="normal"><sp/>termios));</highlight></codeline>
<codeline lineno="258"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="259"><highlight class="normal"></highlight></codeline>
<codeline lineno="260"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="group__libssh__channel_1gaf051dd30d75bf6dc45d1a5088cf970bd" kindref="member">ssh_channel_open_session</ref>(channel))<sp/>{</highlight></codeline>
<codeline lineno="261"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>printf(</highlight><highlight class="stringliteral">&quot;Error<sp/>opening<sp/>channel<sp/>:<sp/>%s\n&quot;</highlight><highlight class="normal">,<sp/><ref refid="group__libssh__error_1ga9241586665bf21f823806473fc386258" kindref="member">ssh_get_error</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>));</highlight></codeline>
<codeline lineno="262"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="group__libssh__channel_1gad1417f9eae8928fed20faafe2d9dbfff" kindref="member">ssh_channel_free</ref>(channel);</highlight></codeline>
<codeline lineno="263"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="264"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="265"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="ssh__client_8c_1aadb4b99b6f71c3c49bd7b97096d033fa" kindref="member">chan</ref><sp/>=<sp/>channel;</highlight></codeline>
<codeline lineno="266"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(interactive)<sp/>{</highlight></codeline>
<codeline lineno="267"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="group__libssh__channel_1ga37c1cec33fe5a2f184768aba52e3a0db" kindref="member">ssh_channel_request_pty</ref>(channel);</highlight></codeline>
<codeline lineno="268"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ssh__client_8c_1ad1cebb7dc5f06fe1b835f9f90003c7da" kindref="member">sizechanged</ref>();</highlight></codeline>
<codeline lineno="269"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="270"><highlight class="normal"></highlight></codeline>
<codeline lineno="271"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="group__libssh__channel_1gaed4c5fb30c9df2b2548421ccf4e81bf1" kindref="member">ssh_channel_request_shell</ref>(channel))<sp/>{</highlight></codeline>
<codeline lineno="272"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>printf(</highlight><highlight class="stringliteral">&quot;Requesting<sp/>shell<sp/>:<sp/>%s\n&quot;</highlight><highlight class="normal">,<sp/><ref refid="group__libssh__error_1ga9241586665bf21f823806473fc386258" kindref="member">ssh_get_error</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>));</highlight></codeline>
<codeline lineno="273"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="group__libssh__channel_1gad1417f9eae8928fed20faafe2d9dbfff" kindref="member">ssh_channel_free</ref>(channel);</highlight></codeline>
<codeline lineno="274"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="275"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="276"><highlight class="normal"></highlight></codeline>
<codeline lineno="277"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(interactive)<sp/>{</highlight></codeline>
<codeline lineno="278"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ssh__client_8c_1a2edb85f17bd5713ff4cef46c6644e100" kindref="member">cfmakeraw</ref>(&amp;terminal_local);</highlight></codeline>
<codeline lineno="279"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>tcsetattr(0,<sp/>TCSANOW,<sp/>&amp;terminal_local);</highlight></codeline>
<codeline lineno="280"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ssh__client_8c_1ab6cb6d395e08011c31ac65d1e6b00f35" kindref="member">setsignal</ref>();</highlight></codeline>
<codeline lineno="281"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="282"><highlight class="normal"><sp/><sp/><sp/><sp/>signal(SIGTERM,<sp/><ref refid="ssh__client_8c_1ada318c9f05c1dba93ef5ed73ed9a3e91" kindref="member">do_cleanup</ref>);</highlight></codeline>
<codeline lineno="283"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="ssh__client_8c_1a38ba4d370f756491ce0d55e0c320d08b" kindref="member">select_loop</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>,<sp/>channel);</highlight></codeline>
<codeline lineno="284"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(interactive)<sp/>{</highlight></codeline>
<codeline lineno="285"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ssh__client_8c_1ada318c9f05c1dba93ef5ed73ed9a3e91" kindref="member">do_cleanup</ref>(0);</highlight></codeline>
<codeline lineno="286"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="287"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="group__libssh__channel_1gad1417f9eae8928fed20faafe2d9dbfff" kindref="member">ssh_channel_free</ref>(channel);</highlight></codeline>
<codeline lineno="288"><highlight class="normal">}</highlight></codeline>
<codeline lineno="289"><highlight class="normal"></highlight></codeline>
<codeline lineno="290" refid="ssh__client_8c_1a8b8ff3289e057f1b391476c5c4b71178" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="ssh__client_8c_1a8b8ff3289e057f1b391476c5c4b71178" kindref="member">batch_shell</ref>(<ref refid="structssh__session__struct" kindref="compound">ssh_session</ref><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>)</highlight></codeline>
<codeline lineno="291"><highlight class="normal">{</highlight></codeline>
<codeline lineno="292"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="structssh__channel__struct" kindref="compound">ssh_channel</ref><sp/>channel;</highlight></codeline>
<codeline lineno="293"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/><ref refid="benchmarks_8c_1aff2566f4c366b48d73479bef43ee4d2e" kindref="member">buffer</ref>[1024];</highlight></codeline>
<codeline lineno="294"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/>i;</highlight></codeline>
<codeline lineno="295"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="test__socket_8c_1a73991beba1accdcc64730cb00c146fe2" kindref="member">s</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="296"><highlight class="normal"></highlight></codeline>
<codeline lineno="297"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/><ref refid="ssh__client_8c_1ac2c6acf3e0c14ce1210c05db36a10dba" kindref="member">MAXCMD</ref><sp/>&amp;&amp;<sp/><ref refid="ssh__client_8c_1af2ca9263602e29f4fdd69cd3e31bc641" kindref="member">cmds</ref>[i];<sp/>++i)<sp/>{</highlight></codeline>
<codeline lineno="298"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="test__socket_8c_1a73991beba1accdcc64730cb00c146fe2" kindref="member">s</ref><sp/>+=<sp/>snprintf(<ref refid="benchmarks_8c_1aff2566f4c366b48d73479bef43ee4d2e" kindref="member">buffer</ref><sp/>+<sp/><ref refid="test__socket_8c_1a73991beba1accdcc64730cb00c146fe2" kindref="member">s</ref>,<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(<ref refid="benchmarks_8c_1aff2566f4c366b48d73479bef43ee4d2e" kindref="member">buffer</ref>)<sp/>-<sp/><ref refid="test__socket_8c_1a73991beba1accdcc64730cb00c146fe2" kindref="member">s</ref>,<sp/></highlight><highlight class="stringliteral">&quot;%s<sp/>&quot;</highlight><highlight class="normal">,<sp/><ref refid="ssh__client_8c_1af2ca9263602e29f4fdd69cd3e31bc641" kindref="member">cmds</ref>[i]);</highlight></codeline>
<codeline lineno="299"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>free(<ref refid="ssh__client_8c_1af2ca9263602e29f4fdd69cd3e31bc641" kindref="member">cmds</ref>[i]);</highlight></codeline>
<codeline lineno="300"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ssh__client_8c_1af2ca9263602e29f4fdd69cd3e31bc641" kindref="member">cmds</ref>[i]<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="301"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="302"><highlight class="normal"></highlight></codeline>
<codeline lineno="303"><highlight class="normal"><sp/><sp/><sp/><sp/>channel<sp/>=<sp/><ref refid="group__libssh__channel_1gada8ccda7bf65165fe145d3096a252dcc" kindref="member">ssh_channel_new</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>);</highlight></codeline>
<codeline lineno="304"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(channel<sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="305"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="306"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="307"><highlight class="normal"></highlight></codeline>
<codeline lineno="308"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="group__libssh__channel_1gaf051dd30d75bf6dc45d1a5088cf970bd" kindref="member">ssh_channel_open_session</ref>(channel);</highlight></codeline>
<codeline lineno="309"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="group__libssh__channel_1ga567d509183ade0a77190f390e2b5747d" kindref="member">ssh_channel_request_exec</ref>(channel,<sp/><ref refid="benchmarks_8c_1aff2566f4c366b48d73479bef43ee4d2e" kindref="member">buffer</ref>))<sp/>{</highlight></codeline>
<codeline lineno="310"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>printf(</highlight><highlight class="stringliteral">&quot;Error<sp/>executing<sp/>&apos;%s&apos;<sp/>:<sp/>%s\n&quot;</highlight><highlight class="normal">,<sp/><ref refid="benchmarks_8c_1aff2566f4c366b48d73479bef43ee4d2e" kindref="member">buffer</ref>,<sp/><ref refid="group__libssh__error_1ga9241586665bf21f823806473fc386258" kindref="member">ssh_get_error</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>));</highlight></codeline>
<codeline lineno="311"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="group__libssh__channel_1gad1417f9eae8928fed20faafe2d9dbfff" kindref="member">ssh_channel_free</ref>(channel);</highlight></codeline>
<codeline lineno="312"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="313"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="314"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="ssh__client_8c_1a38ba4d370f756491ce0d55e0c320d08b" kindref="member">select_loop</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>,<sp/>channel);</highlight></codeline>
<codeline lineno="315"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="group__libssh__channel_1gad1417f9eae8928fed20faafe2d9dbfff" kindref="member">ssh_channel_free</ref>(channel);</highlight></codeline>
<codeline lineno="316"><highlight class="normal">}</highlight></codeline>
<codeline lineno="317"><highlight class="normal"></highlight></codeline>
<codeline lineno="318" refid="ssh__client_8c_1a0d3591711bd7d6cb03d42294115721bb" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="ssh__client_8c_1a0d3591711bd7d6cb03d42294115721bb" kindref="member">client</ref>(<ref refid="structssh__session__struct" kindref="compound">ssh_session</ref><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>)</highlight></codeline>
<codeline lineno="319"><highlight class="normal">{</highlight></codeline>
<codeline lineno="320"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>auth<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="321"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*banner;</highlight></codeline>
<codeline lineno="322"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>state;</highlight></codeline>
<codeline lineno="323"><highlight class="normal"></highlight></codeline>
<codeline lineno="324"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="ssh__client_8c_1a14871705f45ccdc5bb9f4549efd8e119" kindref="member">user</ref>)<sp/>{</highlight></codeline>
<codeline lineno="325"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="group__libssh__session_1ga7a801b85800baa3f4e16f5b47db0a73d" kindref="member">ssh_options_set</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>,<sp/><ref refid="libssh_8h_1af7093adacb08e7ee1e9b16e9c8b0f46ca41a41401297578b6a88df70b50a3cd21" kindref="member">SSH_OPTIONS_USER</ref>,<sp/><ref refid="ssh__client_8c_1a14871705f45ccdc5bb9f4549efd8e119" kindref="member">user</ref>)<sp/>&lt;<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="326"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>-1;</highlight></codeline>
<codeline lineno="327"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="328"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="329"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="group__libssh__session_1ga7a801b85800baa3f4e16f5b47db0a73d" kindref="member">ssh_options_set</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>,<sp/><ref refid="libssh_8h_1af7093adacb08e7ee1e9b16e9c8b0f46ca6560e124c042153de507732d489e5564" kindref="member">SSH_OPTIONS_HOST</ref><sp/>,<ref refid="ssh__client_8c_1a1c2046dcb30a629d6d9f45ff8f403f12" kindref="member">host</ref>)<sp/>&lt;<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="330"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>-1;</highlight></codeline>
<codeline lineno="331"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="332"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="ssh__client_8c_1af18a40f45567d09a4f237ad82282588c" kindref="member">proxycommand</ref><sp/>!=<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="333"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="group__libssh__session_1ga7a801b85800baa3f4e16f5b47db0a73d" kindref="member">ssh_options_set</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>,<sp/><ref refid="libssh_8h_1af7093adacb08e7ee1e9b16e9c8b0f46ca32efaa3cf66ae2c42d9f979472086d3b" kindref="member">SSH_OPTIONS_PROXYCOMMAND</ref>,<sp/><ref refid="ssh__client_8c_1af18a40f45567d09a4f237ad82282588c" kindref="member">proxycommand</ref>))<sp/>{</highlight></codeline>
<codeline lineno="334"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>-1;</highlight></codeline>
<codeline lineno="335"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="336"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="337"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="group__libssh__session_1ga82371e723260c7572ea061edecc2e9f1" kindref="member">ssh_options_parse_config</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>,<sp/>NULL);</highlight></codeline>
<codeline lineno="338"><highlight class="normal"></highlight></codeline>
<codeline lineno="339"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="group__libssh__session_1ga032e07cbd8bc3f14cb2dd375db0b03d7" kindref="member">ssh_connect</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>))<sp/>{</highlight></codeline>
<codeline lineno="340"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fprintf(stderr,<sp/></highlight><highlight class="stringliteral">&quot;Connection<sp/>failed<sp/>:<sp/>%s\n&quot;</highlight><highlight class="normal">,<sp/><ref refid="group__libssh__error_1ga9241586665bf21f823806473fc386258" kindref="member">ssh_get_error</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>));</highlight></codeline>
<codeline lineno="341"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>-1;</highlight></codeline>
<codeline lineno="342"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="343"><highlight class="normal"></highlight></codeline>
<codeline lineno="344"><highlight class="normal"><sp/><sp/><sp/><sp/>state<sp/>=<sp/><ref refid="examples__common_8h_1ad5d8ab97d3635ecaf8fa78225cb960fb" kindref="member">verify_knownhost</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>);</highlight></codeline>
<codeline lineno="345"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(state<sp/>!=<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="346"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>-1;</highlight></codeline>
<codeline lineno="347"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="348"><highlight class="normal"></highlight></codeline>
<codeline lineno="349"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="group__libssh__auth_1ga58e7c265236edbc97a2f117d3f23b4dd" kindref="member">ssh_userauth_none</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>,<sp/>NULL);</highlight></codeline>
<codeline lineno="350"><highlight class="normal"><sp/><sp/><sp/><sp/>banner<sp/>=<sp/><ref refid="group__libssh__session_1ga89864d4d5cc6d3d6ef1c39652f2a688f" kindref="member">ssh_get_issue_banner</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>);</highlight></codeline>
<codeline lineno="351"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(banner)<sp/>{</highlight></codeline>
<codeline lineno="352"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>printf(</highlight><highlight class="stringliteral">&quot;%s\n&quot;</highlight><highlight class="normal">,<sp/>banner);</highlight></codeline>
<codeline lineno="353"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>free(banner);</highlight></codeline>
<codeline lineno="354"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="355"><highlight class="normal"><sp/><sp/><sp/><sp/>auth<sp/>=<sp/><ref refid="examples_2authentication_8c_1a442e0c31c0c57f60ec1f5eaaceebf436" kindref="member">authenticate_console</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>);</highlight></codeline>
<codeline lineno="356"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(auth<sp/>!=<sp/><ref refid="libssh_8h_1a5b35a5038ad8eac4a4e4c00c6239e6e2ab145398ebf554c3cc5d6acfb241c5235" kindref="member">SSH_AUTH_SUCCESS</ref>)<sp/>{</highlight></codeline>
<codeline lineno="357"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>-1;</highlight></codeline>
<codeline lineno="358"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="359"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="ssh__client_8c_1af2ca9263602e29f4fdd69cd3e31bc641" kindref="member">cmds</ref>[0]<sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="360"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ssh__client_8c_1a9aee67bdbbcaaca080f23c622d7d38d9" kindref="member">shell</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>);</highlight></codeline>
<codeline lineno="361"><highlight class="normal"><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="362"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ssh__client_8c_1a8b8ff3289e057f1b391476c5c4b71178" kindref="member">batch_shell</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>);</highlight></codeline>
<codeline lineno="363"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="364"><highlight class="normal"></highlight></codeline>
<codeline lineno="365"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>0;</highlight></codeline>
<codeline lineno="366"><highlight class="normal">}</highlight></codeline>
<codeline lineno="367"><highlight class="normal"></highlight></codeline>
<codeline lineno="368" refid="ssh__client_8c_1ad52ca26e0f83f73a95659419669bd8bb" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/><ref refid="libssh_8h_1a476c4b8079f7b8ac30be4cc2c8f9d456" kindref="member">ssh_pcap_file</ref><sp/><ref refid="ssh__client_8c_1ad52ca26e0f83f73a95659419669bd8bb" kindref="member">pcap</ref>;</highlight></codeline>
<codeline lineno="369" refid="ssh__client_8c_1a3ea85a9a747087d08426003509b49943" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="ssh__client_8c_1a3ea85a9a747087d08426003509b49943" kindref="member">set_pcap</ref>(<ref refid="structssh__session__struct" kindref="compound">ssh_session</ref><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>)</highlight></codeline>
<codeline lineno="370"><highlight class="normal">{</highlight></codeline>
<codeline lineno="371"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="ssh__client_8c_1a6c01d4272dd21e4cd0006557b836ec41" kindref="member">pcap_file</ref><sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="372"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="373"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="374"><highlight class="normal"></highlight></codeline>
<codeline lineno="375"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="ssh__client_8c_1ad52ca26e0f83f73a95659419669bd8bb" kindref="member">pcap</ref><sp/>=<sp/><ref refid="libssh_8h_1a91d9077fc6395d321e6490a6e5f1455c" kindref="member">ssh_pcap_file_new</ref>();</highlight></codeline>
<codeline lineno="376"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="ssh__client_8c_1ad52ca26e0f83f73a95659419669bd8bb" kindref="member">pcap</ref><sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="377"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="378"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="379"><highlight class="normal"></highlight></codeline>
<codeline lineno="380"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="libssh_8h_1ace720476b72056b7faaec7bab504aaa0" kindref="member">ssh_pcap_file_open</ref>(<ref refid="ssh__client_8c_1ad52ca26e0f83f73a95659419669bd8bb" kindref="member">pcap</ref>,<sp/><ref refid="ssh__client_8c_1a6c01d4272dd21e4cd0006557b836ec41" kindref="member">pcap_file</ref>)<sp/>==<sp/><ref refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" kindref="member">SSH_ERROR</ref>)<sp/>{</highlight></codeline>
<codeline lineno="381"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>printf(</highlight><highlight class="stringliteral">&quot;Error<sp/>opening<sp/>pcap<sp/>file\n&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="382"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="libssh_8h_1a0e4cc21bf5453220b57612f278758f3c" kindref="member">ssh_pcap_file_free</ref>(<ref refid="ssh__client_8c_1ad52ca26e0f83f73a95659419669bd8bb" kindref="member">pcap</ref>);</highlight></codeline>
<codeline lineno="383"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ssh__client_8c_1ad52ca26e0f83f73a95659419669bd8bb" kindref="member">pcap</ref><sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="384"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="385"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="386"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="libssh_8h_1af5dd887de46c89e3c57d990bb37097cd" kindref="member">ssh_set_pcap_file</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>,<sp/><ref refid="ssh__client_8c_1ad52ca26e0f83f73a95659419669bd8bb" kindref="member">pcap</ref>);</highlight></codeline>
<codeline lineno="387"><highlight class="normal">}</highlight></codeline>
<codeline lineno="388"><highlight class="normal"></highlight></codeline>
<codeline lineno="389" refid="ssh__client_8c_1a640f3c55c8e63434a2ae0b67f72ab262" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="ssh__client_8c_1a640f3c55c8e63434a2ae0b67f72ab262" kindref="member">cleanup_pcap</ref>(</highlight><highlight class="keywordtype">void</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="390"><highlight class="normal">{</highlight></codeline>
<codeline lineno="391"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="ssh__client_8c_1ad52ca26e0f83f73a95659419669bd8bb" kindref="member">pcap</ref><sp/>!=<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="392"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="libssh_8h_1a0e4cc21bf5453220b57612f278758f3c" kindref="member">ssh_pcap_file_free</ref>(<ref refid="ssh__client_8c_1ad52ca26e0f83f73a95659419669bd8bb" kindref="member">pcap</ref>);</highlight></codeline>
<codeline lineno="393"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="394"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="ssh__client_8c_1ad52ca26e0f83f73a95659419669bd8bb" kindref="member">pcap</ref><sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="395"><highlight class="normal">}</highlight></codeline>
<codeline lineno="396"><highlight class="normal"></highlight></codeline>
<codeline lineno="397" refid="ssh__client_8c_1a3c04138a5bfe5d72780bb7e82a18e627" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="ssh__client_8c_1a3c04138a5bfe5d72780bb7e82a18e627" kindref="member">main</ref>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>argc,<sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>**argv)</highlight></codeline>
<codeline lineno="398"><highlight class="normal">{</highlight></codeline>
<codeline lineno="399"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="structssh__session__struct" kindref="compound">ssh_session</ref><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>;</highlight></codeline>
<codeline lineno="400"><highlight class="normal"></highlight></codeline>
<codeline lineno="401"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref><sp/>=<sp/><ref refid="group__libssh__session_1gaadadc0f9601547c30db7c4d62017d32c" kindref="member">ssh_new</ref>();</highlight></codeline>
<codeline lineno="402"><highlight class="normal"></highlight></codeline>
<codeline lineno="403"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="group__libssh__callbacks_1gafe09b81e5346f0babe288dc38113d289" kindref="member">ssh_callbacks_init</ref>(&amp;<ref refid="ssh__client_8c_1ad7278e5a44ed2f8b6a472a1941a75b89" kindref="member">cb</ref>);</highlight></codeline>
<codeline lineno="404"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="group__libssh__callbacks_1ga2e4b0507c738748a3f10e43fe201fe09" kindref="member">ssh_set_callbacks</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>,&amp;<ref refid="ssh__client_8c_1ad7278e5a44ed2f8b6a472a1941a75b89" kindref="member">cb</ref>);</highlight></codeline>
<codeline lineno="405"><highlight class="normal"></highlight></codeline>
<codeline lineno="406"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="group__libssh__session_1ga93f7f7159893f3ce62c9b178724eff75" kindref="member">ssh_options_getopt</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>,<sp/>&amp;argc,<sp/>argv))<sp/>{</highlight></codeline>
<codeline lineno="407"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fprintf(stderr,</highlight></codeline>
<codeline lineno="408"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Error<sp/>parsing<sp/>command<sp/>line:<sp/>%s\n&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="409"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="group__libssh__error_1ga9241586665bf21f823806473fc386258" kindref="member">ssh_get_error</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>));</highlight></codeline>
<codeline lineno="410"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ssh__client_8c_1ad96d407a911fbb914fa8e4cfbf2faf0f" kindref="member">usage</ref>();</highlight></codeline>
<codeline lineno="411"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="412"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="ssh__client_8c_1a661b14d2cd5d6df5790276ddb9bcda0e" kindref="member">opts</ref>(argc,<sp/>argv);</highlight></codeline>
<codeline lineno="413"><highlight class="normal"><sp/><sp/><sp/><sp/>signal(SIGTERM,<sp/><ref refid="ssh__client_8c_1a4a68c20f35351d4786eede1455b98199" kindref="member">do_exit</ref>);</highlight></codeline>
<codeline lineno="414"><highlight class="normal"></highlight></codeline>
<codeline lineno="415"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="ssh__client_8c_1a3ea85a9a747087d08426003509b49943" kindref="member">set_pcap</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>);</highlight></codeline>
<codeline lineno="416"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="ssh__client_8c_1a0d3591711bd7d6cb03d42294115721bb" kindref="member">client</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>);</highlight></codeline>
<codeline lineno="417"><highlight class="normal"></highlight></codeline>
<codeline lineno="418"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="group__libssh__session_1ga0f048a4c0dbe02cfb7e9c5b6d0db0f27" kindref="member">ssh_disconnect</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>);</highlight></codeline>
<codeline lineno="419"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="group__libssh__session_1gae5af27a98a7488e9f5ded6b37c274156" kindref="member">ssh_free</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>);</highlight></codeline>
<codeline lineno="420"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="ssh__client_8c_1a640f3c55c8e63434a2ae0b67f72ab262" kindref="member">cleanup_pcap</ref>();</highlight></codeline>
<codeline lineno="421"><highlight class="normal"></highlight></codeline>
<codeline lineno="422"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="group__libssh_1ga94a851d00248acde9cd7da084b491242" kindref="member">ssh_finalize</ref>();</highlight></codeline>
<codeline lineno="423"><highlight class="normal"></highlight></codeline>
<codeline lineno="424"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>0;</highlight></codeline>
<codeline lineno="425"><highlight class="normal">}</highlight></codeline>
    </programlisting>
    <location file="libssh-mirror/examples/ssh_client.c"/>
  </compounddef>
</doxygen>
