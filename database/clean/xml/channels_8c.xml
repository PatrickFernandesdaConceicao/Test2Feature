<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<doxygen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="compound.xsd" version="1.9.1" xml:lang="en-US">
  <compounddef id="channels_8c" kind="file" language="C++">
    <compoundname>channels.c</compoundname>
    <includes refid="config_8h" local="yes">config.h</includes>
    <includes local="no">limits.h</includes>
    <includes local="no">stdio.h</includes>
    <includes local="no">errno.h</includes>
    <includes local="no">time.h</includes>
    <includes local="no">stdbool.h</includes>
    <includes local="no">netinet/in.h</includes>
    <includes local="no">arpa/inet.h</includes>
    <includes refid="priv_8h" local="yes">libssh/priv.h</includes>
    <includes refid="ssh2_8h" local="yes">libssh/ssh2.h</includes>
    <includes refid="buffer_8h" local="yes">libssh/buffer.h</includes>
    <includes refid="packet_8h" local="yes">libssh/packet.h</includes>
    <includes refid="socket_8h" local="yes">libssh/socket.h</includes>
    <includes refid="channels_8h" local="yes">libssh/channels.h</includes>
    <includes refid="session_8h" local="yes">libssh/session.h</includes>
    <includes refid="misc_8h" local="yes">libssh/misc.h</includes>
    <includes refid="messages_8h" local="yes">libssh/messages.h</includes>
    <includedby refid="torture__channel_8c" local="yes">tests/unittests/torture_channel.c</includedby>
    <incdepgraph>
      <node id="25">
        <label>libssh/packet.h</label>
        <link refid="packet_8h"/>
        <childnode refid="26" relation="include">
        </childnode>
      </node>
      <node id="7">
        <label>stdbool.h</label>
      </node>
      <node id="1">
        <label>src/channels.c</label>
        <link refid="channels_8c"/>
        <childnode refid="2" relation="include">
        </childnode>
        <childnode refid="3" relation="include">
        </childnode>
        <childnode refid="4" relation="include">
        </childnode>
        <childnode refid="5" relation="include">
        </childnode>
        <childnode refid="6" relation="include">
        </childnode>
        <childnode refid="7" relation="include">
        </childnode>
        <childnode refid="8" relation="include">
        </childnode>
        <childnode refid="9" relation="include">
        </childnode>
        <childnode refid="10" relation="include">
        </childnode>
        <childnode refid="22" relation="include">
        </childnode>
        <childnode refid="23" relation="include">
        </childnode>
        <childnode refid="25" relation="include">
        </childnode>
        <childnode refid="30" relation="include">
        </childnode>
        <childnode refid="31" relation="include">
        </childnode>
        <childnode refid="32" relation="include">
        </childnode>
        <childnode refid="37" relation="include">
        </childnode>
        <childnode refid="38" relation="include">
        </childnode>
      </node>
      <node id="24">
        <label>stdarg.h</label>
      </node>
      <node id="18">
        <label>sys/select.h</label>
      </node>
      <node id="8">
        <label>netinet/in.h</label>
      </node>
      <node id="9">
        <label>arpa/inet.h</label>
      </node>
      <node id="10">
        <label>libssh/priv.h</label>
        <link refid="priv_8h"/>
        <childnode refid="11" relation="include">
        </childnode>
        <childnode refid="12" relation="include">
        </childnode>
        <childnode refid="13" relation="include">
        </childnode>
        <childnode refid="14" relation="include">
        </childnode>
        <childnode refid="15" relation="include">
        </childnode>
        <childnode refid="21" relation="include">
        </childnode>
      </node>
      <node id="20">
        <label>libssh/legacy.h</label>
        <link refid="legacy_8h"/>
      </node>
      <node id="13">
        <label>string.h</label>
        <link refid="string_8h"/>
        <childnode refid="10" relation="include">
        </childnode>
      </node>
      <node id="11">
        <label>stdint.h</label>
      </node>
      <node id="12">
        <label>stdlib.h</label>
      </node>
      <node id="37">
        <label>libssh/misc.h</label>
        <link refid="misc_8h"/>
      </node>
      <node id="5">
        <label>errno.h</label>
      </node>
      <node id="30">
        <label>libssh/socket.h</label>
        <link refid="socket_8h"/>
        <childnode refid="21" relation="include">
        </childnode>
      </node>
      <node id="23">
        <label>libssh/buffer.h</label>
        <link refid="buffer_8h"/>
        <childnode refid="24" relation="include">
        </childnode>
        <childnode refid="15" relation="include">
        </childnode>
      </node>
      <node id="27">
        <label>libssh/libcrypto.h</label>
        <link refid="libcrypto_8h"/>
        <childnode refid="2" relation="include">
        </childnode>
      </node>
      <node id="21">
        <label>libssh/callbacks.h</label>
        <link refid="callbacks_8h"/>
        <childnode refid="15" relation="include">
        </childnode>
        <childnode refid="13" relation="include">
        </childnode>
      </node>
      <node id="19">
        <label>netdb.h</label>
      </node>
      <node id="3">
        <label>limits.h</label>
      </node>
      <node id="33">
        <label>libssh/kex.h</label>
        <link refid="kex_8h"/>
        <childnode refid="10" relation="include">
        </childnode>
        <childnode refid="21" relation="include">
        </childnode>
      </node>
      <node id="34">
        <label>libssh/pcap.h</label>
        <link refid="pcap_8h"/>
        <childnode refid="2" relation="include">
        </childnode>
        <childnode refid="15" relation="include">
        </childnode>
      </node>
      <node id="29">
        <label>libssh/libmbedcrypto.h</label>
        <link refid="libmbedcrypto_8h"/>
        <childnode refid="2" relation="include">
        </childnode>
      </node>
      <node id="31">
        <label>libssh/channels.h</label>
        <link refid="channels_8h"/>
        <childnode refid="10" relation="include">
        </childnode>
      </node>
      <node id="17">
        <label>sys/types.h</label>
      </node>
      <node id="28">
        <label>libssh/libgcrypt.h</label>
        <link refid="libgcrypt_8h"/>
        <childnode refid="2" relation="include">
        </childnode>
      </node>
      <node id="14">
        <label>unistd.h</label>
      </node>
      <node id="36">
        <label>libssh/poll.h</label>
        <link refid="poll_8h"/>
        <childnode refid="2" relation="include">
        </childnode>
      </node>
      <node id="6">
        <label>time.h</label>
      </node>
      <node id="15">
        <label>libssh/libssh.h</label>
        <link refid="libssh_8h"/>
        <childnode refid="14" relation="include">
        </childnode>
        <childnode refid="16" relation="include">
        </childnode>
        <childnode refid="17" relation="include">
        </childnode>
        <childnode refid="18" relation="include">
        </childnode>
        <childnode refid="19" relation="include">
        </childnode>
        <childnode refid="20" relation="include">
        </childnode>
      </node>
      <node id="26">
        <label>libssh/wrapper.h</label>
        <link refid="wrapper_8h"/>
        <childnode refid="7" relation="include">
        </childnode>
        <childnode refid="2" relation="include">
        </childnode>
        <childnode refid="15" relation="include">
        </childnode>
        <childnode refid="27" relation="include">
        </childnode>
        <childnode refid="28" relation="include">
        </childnode>
        <childnode refid="29" relation="include">
        </childnode>
      </node>
      <node id="2">
        <label>config.h</label>
        <link refid="config_8h"/>
      </node>
      <node id="22">
        <label>libssh/ssh2.h</label>
        <link refid="ssh2_8h"/>
      </node>
      <node id="35">
        <label>libssh/auth.h</label>
        <link refid="auth_8h"/>
        <childnode refid="2" relation="include">
        </childnode>
        <childnode refid="21" relation="include">
        </childnode>
      </node>
      <node id="38">
        <label>libssh/messages.h</label>
        <link refid="messages_8h"/>
        <childnode refid="2" relation="include">
        </childnode>
      </node>
      <node id="4">
        <label>stdio.h</label>
      </node>
      <node id="32">
        <label>libssh/session.h</label>
        <link refid="session_8h"/>
        <childnode refid="7" relation="include">
        </childnode>
        <childnode refid="10" relation="include">
        </childnode>
        <childnode refid="33" relation="include">
        </childnode>
        <childnode refid="25" relation="include">
        </childnode>
        <childnode refid="34" relation="include">
        </childnode>
        <childnode refid="35" relation="include">
        </childnode>
        <childnode refid="31" relation="include">
        </childnode>
        <childnode refid="36" relation="include">
        </childnode>
        <childnode refid="2" relation="include">
        </childnode>
        <childnode refid="37" relation="include">
        </childnode>
      </node>
      <node id="16">
        <label>inttypes.h</label>
      </node>
    </incdepgraph>
    <invincdepgraph>
      <node id="1">
        <label>src/channels.c</label>
        <link refid="channels_8c"/>
        <childnode refid="2" relation="include">
        </childnode>
      </node>
      <node id="2">
        <label>tests/unittests/torture_channel.c</label>
        <link refid="torture__channel_8c"/>
      </node>
    </invincdepgraph>
    <innerclass refid="structssh__channel__read__termination__struct" prot="public">ssh_channel_read_termination_struct</innerclass>
      <sectiondef kind="define">
      <memberdef kind="define" id="channels_8c_1ab291488cbad12a5e02777a6d16c7fc1c" prot="public" static="no">
        <name>WINDOWBASE</name>
        <initializer>1280000</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/channels.c" line="51" column="9" bodyfile="src/channels.c" bodystart="51" bodyend="-1"/>
      </memberdef>
      <memberdef kind="define" id="channels_8c_1aebda54a24a840f266fcc864e4940f749" prot="public" static="no">
        <name>WINDOWLIMIT</name>
        <initializer>(<ref refid="channels_8c_1ab291488cbad12a5e02777a6d16c7fc1c" kindref="member">WINDOWBASE</ref>/2)</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/channels.c" line="52" column="9" bodyfile="src/channels.c" bodystart="52" bodyend="-1"/>
      </memberdef>
      <memberdef kind="define" id="channels_8c_1a2ab57c8b0eeaa7b8ef3733493a00bf55" prot="public" static="no">
        <name>CHANNEL_MAX_PACKET</name>
        <initializer>32768</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/channels.c" line="59" column="9" bodyfile="src/channels.c" bodystart="59" bodyend="-1"/>
      </memberdef>
      <memberdef kind="define" id="channels_8c_1a6d5398350fc6c52561ed2674154161dc" prot="public" static="no">
        <name>CHANNEL_INITIAL_WINDOW</name>
        <initializer>64000</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/channels.c" line="60" column="9" bodyfile="src/channels.c" bodystart="60" bodyend="-1"/>
      </memberdef>
      </sectiondef>
      <sectiondef kind="func">
      <memberdef kind="function" id="group__libssh__channel_1ga41254c9dd24ac1ae9ad9c0edd3825dee" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="libssh_8h_1aca32be8db7c865697a3de381dc7e9fc3" kindref="member">ssh_channel</ref></type>
        <definition>static ssh_channel channel_from_msg</definition>
        <argsstring>(ssh_session session, ssh_buffer packet)</argsstring>
        <name>channel_from_msg</name>
        <param>
          <type><ref refid="libssh_8h_1a02d3754de040612632cdd499c20f92f6" kindref="member">ssh_session</ref></type>
          <declname>session</declname>
        </param>
        <param>
          <type><ref refid="libssh_8h_1ac91852b0afd5138f36e09ef59af8e52b" kindref="member">ssh_buffer</ref></type>
          <declname>packet</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/channels.c" line="455" column="20" bodyfile="src/channels.c" bodystart="455" bodyend="475" declfile="src/channels.c" declline="71" declcolumn="20"/>
        <references refid="proxy_8c_1aadb4b99b6f71c3c49bd7b97096d033fa" compoundref="proxy_8c" startline="34">chan</references>
        <references refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" compoundref="pkd__daemon_8c" startline="62">rc</references>
        <references refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" compoundref="torture__session__keys_8c" startline="61">session</references>
        <references refid="buffer_8h_1ab51014ef9a47e7cdbd235af3e62b81ee" compoundref="buffer_8h" startline="59">ssh_buffer_unpack</references>
        <references refid="group__libssh__channel_1ga4c25383c95b09d1b583ef0a9db4b08e2" compoundref="channels_8c" startline="370" endline="385">ssh_channel_from_local</references>
        <references refid="libssh_8h_1a036b2b00fb04337a4d06d719d1b62be1a86ff0b2e8da6ad8628efc556b6ce1887" compoundref="libssh_8h" startline="286">SSH_FATAL</references>
        <references refid="libssh_8h_1ac1ee1d1e917456d4760a94a18015377d" compoundref="libssh_8h" startline="329">SSH_OK</references>
        <references refid="priv_8h_1a55177b3e8db90ca9adb435c44281963c" compoundref="priv_8h" startline="258">ssh_set_error</references>
        <referencedby refid="group__libssh__channel_1ga18df7b076dd041ef43e8f174eecdc02a" compoundref="channels_8c" startline="212" endline="253">SSH_PACKET_CALLBACK</referencedby>
      </memberdef>
      <memberdef kind="function" id="group__libssh__channel_1gada8ccda7bf65165fe145d3096a252dcc" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="libssh_8h_1aca32be8db7c865697a3de381dc7e9fc3" kindref="member">ssh_channel</ref></type>
        <definition>ssh_channel ssh_channel_new</definition>
        <argsstring>(ssh_session session)</argsstring>
        <name>ssh_channel_new</name>
        <param>
          <type><ref refid="libssh_8h_1a02d3754de040612632cdd499c20f92f6" kindref="member">ssh_session</ref></type>
          <declname>session</declname>
        </param>
        <briefdescription>
<para>Allocate a new channel. </para>
        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername direction="in">session</parametername>
</parameternamelist>
<parameterdescription>
<para>The ssh session to use.</para>
</parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>A pointer to a newly allocated channel, NULL on error. </para>
</simplesect>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/channels.c" line="80" column="13" bodyfile="src/channels.c" bodystart="80" bodyend="129"/>
        <references refid="structssh__session__struct_1a9445164beb02a1979171bef9b1a63182" compoundref="session_8h" startline="175">ssh_session_struct::channels</references>
        <references refid="structssh__channel__struct_1a3e9106e477bee737abed43d8c57a7bd6" compoundref="channels_8h" startline="79">ssh_channel_struct::exit_status</references>
        <references refid="structssh__channel__struct_1a400dc0c0dc7cd02daaea731825c1a7c4" compoundref="channels_8h" startline="75">ssh_channel_struct::flags</references>
        <references refid="structssh__session__struct_1a997060832a3419d8fe884d3da855ef4c" compoundref="session_8h" startline="129">ssh_session_struct::flags</references>
        <references refid="structssh__channel__struct_1a25a8d874fbdccd50ecfff837ef69bad2" compoundref="channels_8h" startline="80">ssh_channel_struct::request_state</references>
        <references refid="sshd__direct-tcpip_8c_1aed3129b7674034c979192bcca6b0ad8c" compoundref="sshd__direct-tcpip_8c" startline="36">SAFE_FREE</references>
        <references refid="structssh__channel__struct_1a0832dc830d09accd2f3a8f8349c3faf2" compoundref="channels_8h" startline="63">ssh_channel_struct::session</references>
        <references refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" compoundref="torture__session__keys_8c" startline="61">session</references>
        <references refid="libssh_8h_1a8b09f7d6f7066de7ef8dab4ed7494a52" compoundref="libssh_8h" startline="828">SSH_BUFFER_FREE</references>
        <references refid="group__libssh__buffer_1ga7ecc914104a5bf0da485d3e42f6a7d3b" compoundref="buffer_8c" startline="119" endline="142">ssh_buffer_new</references>
        <references refid="channels_8h_1a040c2d863bb3de2036d3b2fcde37450c" compoundref="channels_8h" startline="60">SSH_CHANNEL_FLAG_NOT_BOUND</references>
        <references refid="channels_8h_1a774597eb1605e8b48cd065965fdc2325a98c7a3dcf02759118261e2bac4d6e421" compoundref="channels_8h" startline="31">SSH_CHANNEL_REQ_STATE_NONE</references>
        <references refid="channels_8h_1a5a002159e5db31d156bb2a8ce8a10cd1a1c7ade5ea201bca92177fa99becb3a0c" compoundref="channels_8h" startline="43">SSH_CHANNEL_STATE_NOT_OPEN</references>
        <references refid="group__libssh__misc_1ga4c696e6fd38257737962971fa0362435" compoundref="misc_8c" startline="661" endline="667">ssh_list_new</references>
        <references refid="group__libssh__misc_1ga7f1c23a518f3ca0b63189763b64141c4" compoundref="misc_8c" startline="747" endline="769">ssh_list_prepend</references>
        <references refid="session_8h_1ae54e87f0565e24b25aed1372b3493a2b" compoundref="session_8h" startline="76">SSH_SESSION_FLAG_AUTHENTICATED</references>
        <references refid="priv_8h_1ae280c413c792e04237f000841ac8ce44" compoundref="priv_8h" startline="265">ssh_set_error_oom</references>
        <references refid="structssh__channel__struct_1a272b198e279fa672afeaf9f2e610eb04" compoundref="channels_8h" startline="73">ssh_channel_struct::state</references>
        <references refid="structssh__channel__struct_1a6806319dfa8f417bbad93f6481ad99d4" compoundref="channels_8h" startline="77">ssh_channel_struct::stderr_buffer</references>
        <references refid="structssh__channel__struct_1a8ae1473aafd716256ce762d0115b2321" compoundref="channels_8h" startline="76">ssh_channel_struct::stdout_buffer</references>
        <referencedby refid="ssh__client_8c_1a8b8ff3289e057f1b391476c5c4b71178" compoundref="ssh__client_8c" startline="290" endline="316">batch_shell</referencedby>
        <referencedby refid="bench__raw_8c_1afd64b09e9ae3ce2136328be2cd0bac89" compoundref="bench__raw_8c" startline="227" endline="285">benchmarks_raw_down</referencedby>
        <referencedby refid="bench__raw_8c_1a070a579a7a62c222e5f28c9e074c0df7" compoundref="bench__raw_8c" startline="107" endline="182">benchmarks_raw_up</referencedby>
        <referencedby refid="benchmarks_8h_1a166dab0266f920174e138f1039ca1773" compoundref="latency_8c" startline="119" endline="148">benchmarks_ssh_latency</referencedby>
        <referencedby refid="classssh_1_1Channel_1a7f3db6b167f4cf9844b494ca32a74432" compoundref="libsshpp_8hpp" startline="459" endline="462">ssh::Channel::Channel</referencedby>
        <referencedby refid="legacy_8h_1a28c66bfe76bb7be138f8285210098631" compoundref="legacy_8c" startline="207" endline="209">channel_new</referencedby>
        <referencedby refid="default__cb_8c_1a71685186673740becb46b3f47566fc0c" compoundref="default__cb_8c" startline="628" endline="651">channel_new_session_cb</referencedby>
        <referencedby refid="ssh__server__fork_8c_1abe10df22f22204a031b0ee56aa0b81bf" compoundref="ssh__server__fork_8c" startline="499" endline="504">channel_open</referencedby>
        <referencedby refid="torture__server__x11_8c_1abb575a0d8644debf193b257c748c0ce1" compoundref="torture__server__x11_8c" startline="69" endline="96">client_thread</referencedby>
        <referencedby refid="scp__download_8c_1abf8ad844320270e1c0b49e510c9bb4a0" compoundref="scp__download_8c" startline="61" endline="100">create_files</referencedby>
        <referencedby refid="test__exec_8c_1acbd4f6c4ecc68d1c4cc45223741be81c" compoundref="test__exec_8c" startline="10" endline="49">do_connect</referencedby>
        <referencedby refid="sshnetcat_8c_1ad08dcc6e9fab1b29fbaabbc4db908350" compoundref="sshnetcat_8c" startline="177" endline="187">forwarding</referencedby>
        <referencedby refid="ssh__client__fuzzer_8cpp_1a91ce7c16e9840492202299da2b451e60" compoundref="ssh__client__fuzzer_8cpp" startline="85" endline="158">LLVMFuzzerTestOneInput</referencedby>
        <referencedby refid="exec_8c_1a840291bc02cba5474a4cb46a9b9566fe" compoundref="exec_8c" startline="7" endline="66">main</referencedby>
        <referencedby refid="proxy_8c_1a68b21024dfd044e4f41dcd2c03fd1c0f" compoundref="proxy_8c" startline="99" endline="109">new_session_channel</referencedby>
        <referencedby refid="pkd__daemon_8c_1a072176a3f00730d8fefe327d7110426b" compoundref="pkd__daemon_8c" startline="205" endline="230">pkd_channel_openreq_cb</referencedby>
        <referencedby refid="ssh__client_8c_1a9aee67bdbbcaaca080f23c622d7d38d9" compoundref="ssh__client_8c" startline="244" endline="288">shell</referencedby>
        <referencedby refid="group__libssh__messages_1gaf9afe350861a5085901b37c5ff9b7702" compoundref="messages_8c" startline="1289" endline="1308">ssh_message_channel_request_open_reply_accept</referencedby>
        <referencedby refid="group__libssh__scp_1ga1db56dcb9dee01dd0b679b3b11151110" compoundref="scp_8c" startline="119" endline="230">ssh_scp_init</referencedby>
        <referencedby refid="torture__session_8c_1a99c33d74eaa8af7ac88d2b2ffe1299ca" compoundref="torture__session_8c" startline="83" endline="119">torture_channel_read_error</referencedby>
        <referencedby refid="torture__request__env_8c_1af673d397cb089d358c279e3e6e082388" compoundref="torture__request__env_8c" startline="78" endline="118">torture_request_env</referencedby>
        <referencedby refid="torture__server_8c_1a65c15130edce6143731c7bff27153650" compoundref="torture__server_8c" startline="476" endline="518">torture_server_unknown_global_request</referencedby>
        <referencedby refid="torture__client__global__requests_8c_1a32462a357527b0302ce677bab88c3cf2" compoundref="torture__client__global__requests_8c" startline="109" endline="135">torture_unknown_request</referencedby>
        <referencedby refid="bench__raw_8c_1ab14322fd9f96904e565cabfbe2b42a5e" compoundref="bench__raw_8c" startline="71" endline="97">upload_script</referencedby>
      </memberdef>
      <memberdef kind="function" id="group__libssh__channel_1gabb9c8cd95c0aab1a293e91d7b05f8fc4" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>uint32_t</type>
        <definition>uint32_t ssh_channel_new_id</definition>
        <argsstring>(ssh_session session)</argsstring>
        <name>ssh_channel_new_id</name>
        <param>
          <type><ref refid="libssh_8h_1a02d3754de040612632cdd499c20f92f6" kindref="member">ssh_session</ref></type>
          <declname>session</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/channels.c" line="140" column="10" bodyfile="src/channels.c" bodystart="140" bodyend="142"/>
        <references refid="structssh__session__struct_1a8fd8ef167e1236e76208827f50808a91" compoundref="session_8h" startline="176">ssh_session_struct::maxchannel</references>
        <references refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" compoundref="torture__session__keys_8c" startline="61">session</references>
        <referencedby refid="group__libssh__channel_1gaa3d6d7d4ab8191f8b8eb14464b0f0e1e" compoundref="channels_8c" startline="285" endline="367">channel_open</referencedby>
        <referencedby refid="group__libssh__messages_1gabf37c510c2ba4f05bfc201b652af896c" compoundref="messages_8c" startline="1238" endline="1276">ssh_message_channel_request_open_reply_accept_channel</referencedby>
      </memberdef>
      <memberdef kind="function" id="group__libssh__channel_1ga1f817e943f01e76843f60f9f9ca970f9" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type></type>
        <definition>SSH_PACKET_CALLBACK</definition>
        <argsstring>(ssh_packet_channel_open_conf)</argsstring>
        <name>SSH_PACKET_CALLBACK</name>
        <param>
          <type>ssh_packet_channel_open_conf</type>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/channels.c" line="151" column="1" bodyfile="src/channels.c" bodystart="151" bodyend="205"/>
        <references refid="proxy_8c_1a11614f44ef4d939bdd984953346a7572" compoundref="proxy_8c" startline="33">error</references>
        <references refid="structssh__channel__struct_1a400dc0c0dc7cd02daaea731825c1a7c4" compoundref="channels_8h" startline="75">ssh_channel_struct::flags</references>
        <references refid="structssh__channel__struct_1a39cdc105ee0bbd1b7faea169db30f0a1" compoundref="channels_8h" startline="64">ssh_channel_struct::local_channel</references>
        <references refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" compoundref="pkd__daemon_8c" startline="62">rc</references>
        <references refid="structssh__channel__struct_1aa553acf6d12fffb1ae18b11196c2c0e9" compoundref="channels_8h" startline="69">ssh_channel_struct::remote_channel</references>
        <references refid="structssh__channel__struct_1a748cbf4c5d3af22bd8e8fea69144128d" compoundref="channels_8h" startline="72">ssh_channel_struct::remote_maxpacket</references>
        <references refid="structssh__channel__struct_1a1b5936420da03e6b64aa8f900eb8ad0c" compoundref="channels_8h" startline="70">ssh_channel_struct::remote_window</references>
        <references refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" compoundref="torture__session__keys_8c" startline="61">session</references>
        <references refid="buffer_8h_1ab51014ef9a47e7cdbd235af3e62b81ee" compoundref="buffer_8h" startline="59">ssh_buffer_unpack</references>
        <references refid="channels_8h_1a040c2d863bb3de2036d3b2fcde37450c" compoundref="channels_8h" startline="60">SSH_CHANNEL_FLAG_NOT_BOUND</references>
        <references refid="group__libssh__channel_1ga4c25383c95b09d1b583ef0a9db4b08e2" compoundref="channels_8c" startline="370" endline="385">ssh_channel_from_local</references>
        <references refid="channels_8h_1a5a002159e5db31d156bb2a8ce8a10cd1a488a78707192c35250392423b5058e2b" compoundref="channels_8h" startline="46">SSH_CHANNEL_STATE_OPEN</references>
        <references refid="channels_8h_1a5a002159e5db31d156bb2a8ce8a10cd1a5a7cc3348940d3df41d2fd293cdb2e4c" compoundref="channels_8h" startline="44">SSH_CHANNEL_STATE_OPENING</references>
        <references refid="libssh_8h_1a036b2b00fb04337a4d06d719d1b62be1a86ff0b2e8da6ad8628efc556b6ce1887" compoundref="libssh_8h" startline="286">SSH_FATAL</references>
        <references refid="priv_8h_1aa21fd8a7a609329603b7b16da7939fca" compoundref="priv_8h" startline="240">SSH_LOG</references>
        <references refid="group__libssh__log_1ggadf764cbdea00d65edcd07bb9953ad2b7a6445dfe21592d69d9741d319538b6673" compoundref="libssh_8h" startline="352">SSH_LOG_PACKET</references>
        <references refid="group__libssh__log_1ggadf764cbdea00d65edcd07bb9953ad2b7a75fa79e63947b66462db977d9b5ae27c" compoundref="libssh_8h" startline="349">SSH_LOG_PROTOCOL</references>
        <references refid="libssh_8h_1a1c08cc9177a5598e0675abfb833d2993" compoundref="libssh_8h" startline="358">SSH_LOG_RARE</references>
        <references refid="libssh_8h_1ac1ee1d1e917456d4760a94a18015377d" compoundref="libssh_8h" startline="329">SSH_OK</references>
        <references refid="group__libssh__callbacks_1gac29df803aa1295d6a498c1b081f3b494" compoundref="callbacks_8h" startline="517">SSH_PACKET_USED</references>
        <references refid="priv_8h_1a55177b3e8db90ca9adb435c44281963c" compoundref="priv_8h" startline="258">ssh_set_error</references>
        <references refid="structssh__channel__struct_1a272b198e279fa672afeaf9f2e610eb04" compoundref="channels_8h" startline="73">ssh_channel_struct::state</references>
        <references refid="ssh__client_8c_1a14871705f45ccdc5bb9f4549efd8e119" compoundref="ssh__client_8c" startline="48">user</references>
      </memberdef>
      <memberdef kind="function" id="group__libssh__channel_1ga18df7b076dd041ef43e8f174eecdc02a" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type></type>
        <definition>SSH_PACKET_CALLBACK</definition>
        <argsstring>(ssh_packet_channel_open_fail)</argsstring>
        <name>SSH_PACKET_CALLBACK</name>
        <param>
          <type>ssh_packet_channel_open_fail</type>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/channels.c" line="212" column="1" bodyfile="src/channels.c" bodystart="212" bodyend="253"/>
        <references refid="group__libssh__channel_1ga41254c9dd24ac1ae9ad9c0edd3825dee" compoundref="channels_8c" startline="455" endline="475">channel_from_msg</references>
        <references refid="proxy_8c_1a11614f44ef4d939bdd984953346a7572" compoundref="proxy_8c" startline="33">error</references>
        <references refid="structssh__channel__struct_1a39cdc105ee0bbd1b7faea169db30f0a1" compoundref="channels_8h" startline="64">ssh_channel_struct::local_channel</references>
        <references refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" compoundref="pkd__daemon_8c" startline="62">rc</references>
        <references refid="sshd__direct-tcpip_8c_1aed3129b7674034c979192bcca6b0ad8c" compoundref="sshd__direct-tcpip_8c" startline="36">SAFE_FREE</references>
        <references refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" compoundref="torture__session__keys_8c" startline="61">session</references>
        <references refid="buffer_8h_1ab51014ef9a47e7cdbd235af3e62b81ee" compoundref="buffer_8h" startline="59">ssh_buffer_unpack</references>
        <references refid="channels_8h_1a5a002159e5db31d156bb2a8ce8a10cd1ac55b9c695524684a57a3a817ca06b444" compoundref="channels_8h" startline="45">SSH_CHANNEL_STATE_OPEN_DENIED</references>
        <references refid="channels_8h_1a5a002159e5db31d156bb2a8ce8a10cd1a5a7cc3348940d3df41d2fd293cdb2e4c" compoundref="channels_8h" startline="44">SSH_CHANNEL_STATE_OPENING</references>
        <references refid="libssh_8h_1a036b2b00fb04337a4d06d719d1b62be1a86ff0b2e8da6ad8628efc556b6ce1887" compoundref="libssh_8h" startline="286">SSH_FATAL</references>
        <references refid="priv_8h_1aa21fd8a7a609329603b7b16da7939fca" compoundref="priv_8h" startline="240">SSH_LOG</references>
        <references refid="libssh_8h_1a1c08cc9177a5598e0675abfb833d2993" compoundref="libssh_8h" startline="358">SSH_LOG_RARE</references>
        <references refid="libssh_8h_1ac1ee1d1e917456d4760a94a18015377d" compoundref="libssh_8h" startline="329">SSH_OK</references>
        <references refid="group__libssh__callbacks_1gac29df803aa1295d6a498c1b081f3b494" compoundref="callbacks_8h" startline="517">SSH_PACKET_USED</references>
        <references refid="libssh_8h_1a036b2b00fb04337a4d06d719d1b62be1ad1339fb4b92a9d25bdb99df5de5c4f88" compoundref="libssh_8h" startline="285">SSH_REQUEST_DENIED</references>
        <references refid="priv_8h_1a55177b3e8db90ca9adb435c44281963c" compoundref="priv_8h" startline="258">ssh_set_error</references>
        <references refid="structssh__channel__struct_1a272b198e279fa672afeaf9f2e610eb04" compoundref="channels_8h" startline="73">ssh_channel_struct::state</references>
        <references refid="ssh__client_8c_1a14871705f45ccdc5bb9f4549efd8e119" compoundref="ssh__client_8c" startline="48">user</references>
      </memberdef>
      <memberdef kind="function" id="group__libssh__channel_1ga3c2fe7cf69c947046bbfae132afa7ff4" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>static int ssh_channel_open_termination</definition>
        <argsstring>(void *c)</argsstring>
        <name>ssh_channel_open_termination</name>
        <param>
          <type>void *</type>
          <declname>c</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/channels.c" line="255" column="12" bodyfile="src/channels.c" bodystart="255" bodyend="262"/>
        <references refid="structssh__channel__struct_1a0832dc830d09accd2f3a8f8349c3faf2" compoundref="channels_8h" startline="63">ssh_channel_struct::session</references>
        <references refid="structssh__session__struct_1a6f74d1a1eb6ed715b1073b67caa18460" compoundref="session_8h" startline="147">ssh_session_struct::session_state</references>
        <references refid="channels_8h_1a5a002159e5db31d156bb2a8ce8a10cd1a5a7cc3348940d3df41d2fd293cdb2e4c" compoundref="channels_8h" startline="44">SSH_CHANNEL_STATE_OPENING</references>
        <references refid="session_8h_1a9bbd1d5ae11485e27279be6ad461992ca855474fc84a2fb170fcb72546af8eeb8" compoundref="session_8h" startline="46">SSH_SESSION_STATE_ERROR</references>
        <references refid="structssh__channel__struct_1a272b198e279fa672afeaf9f2e610eb04" compoundref="channels_8h" startline="73">ssh_channel_struct::state</references>
        <referencedby refid="group__libssh__channel_1gaa3d6d7d4ab8191f8b8eb14464b0f0e1e" compoundref="channels_8c" startline="285" endline="367">channel_open</referencedby>
      </memberdef>
      <memberdef kind="function" id="group__libssh__channel_1gaa3d6d7d4ab8191f8b8eb14464b0f0e1e" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>static int channel_open</definition>
        <argsstring>(ssh_channel channel, const char *type, uint32_t window, uint32_t maxpacket, ssh_buffer payload)</argsstring>
        <name>channel_open</name>
        <param>
          <type><ref refid="libssh_8h_1aca32be8db7c865697a3de381dc7e9fc3" kindref="member">ssh_channel</ref></type>
          <declname>channel</declname>
        </param>
        <param>
          <type>const char *</type>
          <declname>type</declname>
        </param>
        <param>
          <type>uint32_t</type>
          <declname>window</declname>
        </param>
        <param>
          <type>uint32_t</type>
          <declname>maxpacket</declname>
        </param>
        <param>
          <type><ref refid="libssh_8h_1ac91852b0afd5138f36e09ef59af8e52b" kindref="member">ssh_buffer</ref></type>
          <declname>payload</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/channels.c" line="285" column="1" bodyfile="src/channels.c" bodystart="285" bodyend="367"/>
        <references refid="structssh__channel__struct_1a39cdc105ee0bbd1b7faea169db30f0a1" compoundref="channels_8h" startline="64">ssh_channel_struct::local_channel</references>
        <references refid="structssh__channel__struct_1a0a0b3f3813c49edf2540e35853d2f791" compoundref="channels_8h" startline="67">ssh_channel_struct::local_maxpacket</references>
        <references refid="structssh__channel__struct_1a7067e2963e961729416849785c1d1bd3" compoundref="channels_8h" startline="65">ssh_channel_struct::local_window</references>
        <references refid="structssh__session__struct_1af0aed60c1e529bbfdcb483fd80bf98a0" compoundref="session_8h" startline="140">ssh_session_struct::out_buffer</references>
        <references refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" compoundref="pkd__daemon_8c" startline="62">rc</references>
        <references refid="structssh__channel__struct_1a0832dc830d09accd2f3a8f8349c3faf2" compoundref="channels_8h" startline="63">ssh_channel_struct::session</references>
        <references refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" compoundref="torture__session__keys_8c" startline="61">session</references>
        <references refid="structssh__session__struct_1a6f74d1a1eb6ed715b1073b67caa18460" compoundref="session_8h" startline="147">ssh_session_struct::session_state</references>
        <references refid="ssh2_8h_1ad24b399bd1fe32588984e09d35dfd14d" compoundref="ssh2_8h" startline="45">SSH2_MSG_CHANNEL_OPEN</references>
        <references refid="libssh_8h_1a9c57e4f6482106336045a4d25a55f28e" compoundref="libssh_8h" startline="331">SSH_AGAIN</references>
        <references refid="buffer_8h_1af2ca5e302f5395c48657a1bad52f3a12">ssh_buffer_add_buffer</references>
        <references refid="buffer_8h_1ae17848a86043f0abfc60c1c4f6126ccd" compoundref="buffer_8h" startline="49">ssh_buffer_pack</references>
        <references refid="group__libssh__channel_1gabb9c8cd95c0aab1a293e91d7b05f8fc4" compoundref="channels_8c" startline="140" endline="142">ssh_channel_new_id</references>
        <references refid="group__libssh__channel_1ga3c2fe7cf69c947046bbfae132afa7ff4" compoundref="channels_8c" startline="255" endline="262">ssh_channel_open_termination</references>
        <references refid="channels_8h_1a5a002159e5db31d156bb2a8ce8a10cd1a96872cd3f6e98f6f040097e3ee6cb900" compoundref="channels_8h" startline="47">SSH_CHANNEL_STATE_CLOSED</references>
        <references refid="channels_8h_1a5a002159e5db31d156bb2a8ce8a10cd1a1c7ade5ea201bca92177fa99becb3a0c" compoundref="channels_8h" startline="43">SSH_CHANNEL_STATE_NOT_OPEN</references>
        <references refid="channels_8h_1a5a002159e5db31d156bb2a8ce8a10cd1a488a78707192c35250392423b5058e2b" compoundref="channels_8h" startline="46">SSH_CHANNEL_STATE_OPEN</references>
        <references refid="channels_8h_1a5a002159e5db31d156bb2a8ce8a10cd1ac55b9c695524684a57a3a817ca06b444" compoundref="channels_8h" startline="45">SSH_CHANNEL_STATE_OPEN_DENIED</references>
        <references refid="channels_8h_1a5a002159e5db31d156bb2a8ce8a10cd1a5a7cc3348940d3df41d2fd293cdb2e4c" compoundref="channels_8h" startline="44">SSH_CHANNEL_STATE_OPENING</references>
        <references refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" compoundref="libssh_8h" startline="330">SSH_ERROR</references>
        <references refid="libssh_8h_1a036b2b00fb04337a4d06d719d1b62be1a86ff0b2e8da6ad8628efc556b6ce1887" compoundref="libssh_8h" startline="286">SSH_FATAL</references>
        <references refid="group__libssh__session_1ga4b84e1ae757c0d4007a5eefdf4651694" compoundref="session_8c" startline="692" endline="740">ssh_handle_packets_termination</references>
        <references refid="priv_8h_1aa21fd8a7a609329603b7b16da7939fca" compoundref="priv_8h" startline="240">SSH_LOG</references>
        <references refid="group__libssh__log_1ggadf764cbdea00d65edcd07bb9953ad2b7a6445dfe21592d69d9741d319538b6673" compoundref="libssh_8h" startline="352">SSH_LOG_PACKET</references>
        <references refid="group__libssh__log_1ggadf764cbdea00d65edcd07bb9953ad2b7a75fa79e63947b66462db977d9b5ae27c" compoundref="libssh_8h" startline="349">SSH_LOG_PROTOCOL</references>
        <references refid="libssh_8h_1ac1ee1d1e917456d4760a94a18015377d" compoundref="libssh_8h" startline="329">SSH_OK</references>
        <references refid="packet_8h_1a7e6c7ed74c23ace432476aa8a6841140" compoundref="packet_8c" startline="1761" endline="1843">ssh_packet_send</references>
        <references refid="session_8h_1a9bbd1d5ae11485e27279be6ad461992ca855474fc84a2fb170fcb72546af8eeb8" compoundref="session_8h" startline="46">SSH_SESSION_STATE_ERROR</references>
        <references refid="priv_8h_1a55177b3e8db90ca9adb435c44281963c" compoundref="priv_8h" startline="258">ssh_set_error</references>
        <references refid="priv_8h_1ae280c413c792e04237f000841ac8ce44" compoundref="priv_8h" startline="265">ssh_set_error_oom</references>
        <references refid="session_8h_1aa8c8d35c7f83d7b00218ebadfac2254b" compoundref="session_8h" startline="84">SSH_TIMEOUT_DEFAULT</references>
        <references refid="structssh__channel__struct_1a272b198e279fa672afeaf9f2e610eb04" compoundref="channels_8h" startline="73">ssh_channel_struct::state</references>
        <referencedby refid="group__libssh__channel_1ga6c4d4f5436dd5be58973606c6bcd8bb4" compoundref="channels_8c" startline="947" endline="957">ssh_channel_open_auth_agent</referencedby>
        <referencedby refid="group__libssh__channel_1gae86b0704a1f2bdebb268b55567f7f47b" compoundref="channels_8c" startline="985" endline="1031">ssh_channel_open_forward</referencedby>
        <referencedby refid="group__libssh__channel_1ga93ddd5055eb3322d38c70986aa63c673" compoundref="channels_8c" startline="1057" endline="1114">ssh_channel_open_forward_unix</referencedby>
        <referencedby refid="group__libssh__channel_1gaf051dd30d75bf6dc45d1a5088cf970bd" compoundref="channels_8c" startline="920" endline="930">ssh_channel_open_session</referencedby>
      </memberdef>
      <memberdef kind="function" id="group__libssh__channel_1ga4c25383c95b09d1b583ef0a9db4b08e2" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="libssh_8h_1aca32be8db7c865697a3de381dc7e9fc3" kindref="member">ssh_channel</ref></type>
        <definition>ssh_channel ssh_channel_from_local</definition>
        <argsstring>(ssh_session session, uint32_t id)</argsstring>
        <name>ssh_channel_from_local</name>
        <param>
          <type><ref refid="libssh_8h_1a02d3754de040612632cdd499c20f92f6" kindref="member">ssh_session</ref></type>
          <declname>session</declname>
        </param>
        <param>
          <type>uint32_t</type>
          <declname>id</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/channels.c" line="370" column="13" bodyfile="src/channels.c" bodystart="370" bodyend="385"/>
        <references refid="structssh__session__struct_1a9445164beb02a1979171bef9b1a63182" compoundref="session_8h" startline="175">ssh_session_struct::channels</references>
        <references refid="structssh__channel__struct_1a39cdc105ee0bbd1b7faea169db30f0a1" compoundref="channels_8h" startline="64">ssh_channel_struct::local_channel</references>
        <references refid="structssh__iterator_1a7fd7219325e56f365796ad59c8443ee5" compoundref="misc_8h" startline="45">ssh_iterator::next</references>
        <references refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" compoundref="torture__session__keys_8c" startline="61">session</references>
        <references refid="misc_8h_1a1f44c71b6f7ba10a4a543f73a07a85aa" compoundref="misc_8h" startline="73">ssh_iterator_value</references>
        <references refid="group__libssh__misc_1gad36d247bfcae7965d6aca8245d061e0d" compoundref="misc_8c" startline="682" endline="686">ssh_list_get_iterator</references>
        <referencedby refid="group__libssh__channel_1ga41254c9dd24ac1ae9ad9c0edd3825dee" compoundref="channels_8c" startline="455" endline="475">channel_from_msg</referencedby>
        <referencedby refid="group__libssh__channel_1ga1f817e943f01e76843f60f9f9ca970f9" compoundref="channels_8c" startline="151" endline="205">SSH_PACKET_CALLBACK</referencedby>
      </memberdef>
      <memberdef kind="function" id="group__libssh__channel_1gac4fc789667578e8f0e2614f5274c9b5f" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>static int grow_window</definition>
        <argsstring>(ssh_session session, ssh_channel channel, uint32_t minimumsize)</argsstring>
        <name>grow_window</name>
        <param>
          <type><ref refid="libssh_8h_1a02d3754de040612632cdd499c20f92f6" kindref="member">ssh_session</ref></type>
          <declname>session</declname>
        </param>
        <param>
          <type><ref refid="libssh_8h_1aca32be8db7c865697a3de381dc7e9fc3" kindref="member">ssh_channel</ref></type>
          <declname>channel</declname>
        </param>
        <param>
          <type>uint32_t</type>
          <declname>minimumsize</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/channels.c" line="395" column="12" bodyfile="src/channels.c" bodystart="395" bodyend="440"/>
        <references refid="proxy_8c_1a11614f44ef4d939bdd984953346a7572" compoundref="proxy_8c" startline="33">error</references>
        <references refid="structssh__channel__struct_1a39cdc105ee0bbd1b7faea169db30f0a1" compoundref="channels_8h" startline="64">ssh_channel_struct::local_channel</references>
        <references refid="structssh__channel__struct_1a7067e2963e961729416849785c1d1bd3" compoundref="channels_8h" startline="65">ssh_channel_struct::local_window</references>
        <references refid="structssh__session__struct_1af0aed60c1e529bbfdcb483fd80bf98a0" compoundref="session_8h" startline="140">ssh_session_struct::out_buffer</references>
        <references refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" compoundref="pkd__daemon_8c" startline="62">rc</references>
        <references refid="structssh__channel__struct_1aa553acf6d12fffb1ae18b11196c2c0e9" compoundref="channels_8h" startline="69">ssh_channel_struct::remote_channel</references>
        <references refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" compoundref="torture__session__keys_8c" startline="61">session</references>
        <references refid="ssh2_8h_1a3ff2e2a8f3b31a90985291f0c0eff418" compoundref="ssh2_8h" startline="48">SSH2_MSG_CHANNEL_WINDOW_ADJUST</references>
        <references refid="buffer_8h_1ae17848a86043f0abfc60c1c4f6126ccd" compoundref="buffer_8h" startline="49">ssh_buffer_pack</references>
        <references refid="libssh_8h_1ac8802ff7f5348d0145dab5242623f740">ssh_buffer_reinit</references>
        <references refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" compoundref="libssh_8h" startline="330">SSH_ERROR</references>
        <references refid="priv_8h_1aa21fd8a7a609329603b7b16da7939fca" compoundref="priv_8h" startline="240">SSH_LOG</references>
        <references refid="group__libssh__log_1ggadf764cbdea00d65edcd07bb9953ad2b7a75fa79e63947b66462db977d9b5ae27c" compoundref="libssh_8h" startline="349">SSH_LOG_PROTOCOL</references>
        <references refid="libssh_8h_1ac1ee1d1e917456d4760a94a18015377d" compoundref="libssh_8h" startline="329">SSH_OK</references>
        <references refid="packet_8h_1a7e6c7ed74c23ace432476aa8a6841140" compoundref="packet_8c" startline="1761" endline="1843">ssh_packet_send</references>
        <references refid="priv_8h_1ae280c413c792e04237f000841ac8ce44" compoundref="priv_8h" startline="265">ssh_set_error_oom</references>
        <references refid="channels_8c_1ab291488cbad12a5e02777a6d16c7fc1c" compoundref="channels_8c" startline="51">WINDOWBASE</references>
        <referencedby refid="group__libssh__channel_1ga2f4e02cb3b3adbc30a534623164068fd" compoundref="channels_8c" startline="2863" endline="2960">ssh_channel_read_timeout</referencedby>
        <referencedby refid="group__libssh__channel_1ga2a1924f01a292478aaf2f140a8a107e3" compoundref="channels_8c" startline="510" endline="614">SSH_PACKET_CALLBACK</referencedby>
      </memberdef>
      <memberdef kind="function" id="group__libssh__channel_1ga9ddc86ac082a2b8992426c70c0b9e2ef" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type></type>
        <definition>SSH_PACKET_CALLBACK</definition>
        <argsstring>(channel_rcv_change_window)</argsstring>
        <name>SSH_PACKET_CALLBACK</name>
        <param>
          <type>channel_rcv_change_window</type>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/channels.c" line="477" column="1" bodyfile="src/channels.c" bodystart="477" bodyend="507"/>
        <references refid="group__libssh__channel_1ga41254c9dd24ac1ae9ad9c0edd3825dee" compoundref="channels_8c" startline="455" endline="475">channel_from_msg</references>
        <references refid="structssh__channel__struct_1a39cdc105ee0bbd1b7faea169db30f0a1" compoundref="channels_8h" startline="64">ssh_channel_struct::local_channel</references>
        <references refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" compoundref="pkd__daemon_8c" startline="62">rc</references>
        <references refid="structssh__channel__struct_1aa553acf6d12fffb1ae18b11196c2c0e9" compoundref="channels_8h" startline="69">ssh_channel_struct::remote_channel</references>
        <references refid="structssh__channel__struct_1a1b5936420da03e6b64aa8f900eb8ad0c" compoundref="channels_8h" startline="70">ssh_channel_struct::remote_window</references>
        <references refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" compoundref="torture__session__keys_8c" startline="61">session</references>
        <references refid="buffer_8h_1ab51014ef9a47e7cdbd235af3e62b81ee" compoundref="buffer_8h" startline="59">ssh_buffer_unpack</references>
        <references refid="group__libssh__error_1ga9241586665bf21f823806473fc386258" compoundref="error_8c" startline="128" endline="132">ssh_get_error</references>
        <references refid="priv_8h_1aa21fd8a7a609329603b7b16da7939fca" compoundref="priv_8h" startline="240">SSH_LOG</references>
        <references refid="group__libssh__log_1ggadf764cbdea00d65edcd07bb9953ad2b7a926c933f61d1afa64003c1cc66f6a01c" compoundref="libssh_8h" startline="355">SSH_LOG_FUNCTIONS</references>
        <references refid="group__libssh__log_1ggadf764cbdea00d65edcd07bb9953ad2b7a6445dfe21592d69d9741d319538b6673" compoundref="libssh_8h" startline="352">SSH_LOG_PACKET</references>
        <references refid="group__libssh__log_1ggadf764cbdea00d65edcd07bb9953ad2b7a75fa79e63947b66462db977d9b5ae27c" compoundref="libssh_8h" startline="349">SSH_LOG_PROTOCOL</references>
        <references refid="libssh_8h_1ac1ee1d1e917456d4760a94a18015377d" compoundref="libssh_8h" startline="329">SSH_OK</references>
        <references refid="group__libssh__callbacks_1gac29df803aa1295d6a498c1b081f3b494" compoundref="callbacks_8h" startline="517">SSH_PACKET_USED</references>
        <references refid="ssh__client_8c_1a14871705f45ccdc5bb9f4549efd8e119" compoundref="ssh__client_8c" startline="48">user</references>
      </memberdef>
      <memberdef kind="function" id="group__libssh__channel_1ga2a1924f01a292478aaf2f140a8a107e3" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type></type>
        <definition>SSH_PACKET_CALLBACK</definition>
        <argsstring>(channel_rcv_data)</argsstring>
        <name>SSH_PACKET_CALLBACK</name>
        <param>
          <type>channel_rcv_data</type>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/channels.c" line="510" column="1" bodyfile="src/channels.c" bodystart="510" bodyend="614"/>
        <references refid="structssh__channel__struct_1ad526c0401837d1636e3f9075226f7cd9" compoundref="channels_8h" startline="81">ssh_channel_struct::callbacks</references>
        <references refid="group__libssh__channel_1ga3f6b844e236802c6780e7bcf0c0f3fce" compoundref="channels_8c" startline="847" endline="903">channel_default_bufferize</references>
        <references refid="group__libssh__channel_1ga41254c9dd24ac1ae9ad9c0edd3825dee" compoundref="channels_8c" startline="455" endline="475">channel_from_msg</references>
        <references refid="structssh__channel__struct_1ab1beeacd4aff735258cb7488c079c6dc" compoundref="channels_8h" startline="84">ssh_channel_struct::counter</references>
        <references refid="group__libssh__channel_1gac4fc789667578e8f0e2614f5274c9b5f" compoundref="channels_8c" startline="395" endline="440">grow_window</references>
        <references refid="structssh__counter__struct_1a4fb86ab2536688750c960f58ac414c79" compoundref="libssh_8h" startline="109">ssh_counter_struct::in_bytes</references>
        <references refid="structssh__channel__struct_1a7067e2963e961729416849785c1d1bd3" compoundref="channels_8h" startline="65">ssh_channel_struct::local_window</references>
        <references refid="priv_8h_1a9a1a185142f0e05d19758ac524f862e2" compoundref="priv_8h" startline="165">PRIdS</references>
        <references refid="structssh__channel__struct_1a1b5936420da03e6b64aa8f900eb8ad0c" compoundref="channels_8h" startline="70">ssh_channel_struct::remote_window</references>
        <references refid="structssh__channel__struct_1a0832dc830d09accd2f3a8f8349c3faf2" compoundref="channels_8h" startline="63">ssh_channel_struct::session</references>
        <references refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" compoundref="torture__session__keys_8c" startline="61">session</references>
        <references refid="ssh2_8h_1ab4dc0d7b8a45a0f902a5332c6a7c2b35" compoundref="ssh2_8h" startline="49">SSH2_MSG_CHANNEL_DATA</references>
        <references refid="libssh_8h_1a240b02fb7c0475fbb5996d1f759221ee">ssh_buffer_get</references>
        <references refid="libssh_8h_1a61400c7267feb254046cd606a3fdfdbc">ssh_buffer_get_len</references>
        <references refid="buffer_8h_1ae9ba83ddeaf673b2d15be5312495ed7e">ssh_buffer_get_ssh_string</references>
        <references refid="buffer_8h_1a71d2508b2ed54654c2fae5f0e4422a8f">ssh_buffer_get_u32</references>
        <references refid="buffer_8h_1a226d198c4274fac7c354b6a340049d47">ssh_buffer_pass_bytes</references>
        <references refid="group__libssh__callbacks_1gaaba68eea7a3cfbe8ea8038841861a412" compoundref="callbacks_8h" startline="489">ssh_callbacks_iterate</references>
        <references refid="group__libssh__callbacks_1gab814c9f6d54a92a304577d67b8db726b" compoundref="callbacks_8h" startline="500">ssh_callbacks_iterate_end</references>
        <references refid="group__libssh__callbacks_1ga805c03a07f2d9e1f1f6daaaf9aaccf07" compoundref="callbacks_8h" startline="497">ssh_callbacks_iterate_exec</references>
        <references refid="group__libssh__error_1ga9241586665bf21f823806473fc386258" compoundref="error_8c" startline="128" endline="132">ssh_get_error</references>
        <references refid="priv_8h_1aa21fd8a7a609329603b7b16da7939fca" compoundref="priv_8h" startline="240">SSH_LOG</references>
        <references refid="group__libssh__log_1ggadf764cbdea00d65edcd07bb9953ad2b7a926c933f61d1afa64003c1cc66f6a01c" compoundref="libssh_8h" startline="355">SSH_LOG_FUNCTIONS</references>
        <references refid="group__libssh__log_1ggadf764cbdea00d65edcd07bb9953ad2b7a6445dfe21592d69d9741d319538b6673" compoundref="libssh_8h" startline="352">SSH_LOG_PACKET</references>
        <references refid="libssh_8h_1a1c08cc9177a5598e0675abfb833d2993" compoundref="libssh_8h" startline="358">SSH_LOG_RARE</references>
        <references refid="group__libssh__callbacks_1gac29df803aa1295d6a498c1b081f3b494" compoundref="callbacks_8h" startline="517">SSH_PACKET_USED</references>
        <references refid="libssh_8h_1aca901aa97257413ddf60ef74ff2bf7a6">ssh_string_data</references>
        <references refid="libssh_8h_1a5bc8710c8633117ff449d15489fca051" compoundref="libssh_8h" startline="790">SSH_STRING_FREE</references>
        <references refid="libssh_8h_1aad7b2fc092973a478df54a40af69abf2">ssh_string_len</references>
        <references refid="structssh__channel__struct_1a6806319dfa8f417bbad93f6481ad99d4" compoundref="channels_8h" startline="77">ssh_channel_struct::stderr_buffer</references>
        <references refid="structssh__channel__struct_1a8ae1473aafd716256ce762d0115b2321" compoundref="channels_8h" startline="76">ssh_channel_struct::stdout_buffer</references>
        <references refid="ssh__client_8c_1a14871705f45ccdc5bb9f4549efd8e119" compoundref="ssh__client_8c" startline="48">user</references>
        <references refid="channels_8c_1aebda54a24a840f266fcc864e4940f749" compoundref="channels_8c" startline="52">WINDOWLIMIT</references>
      </memberdef>
      <memberdef kind="function" id="group__libssh__channel_1ga21f963dbe5ac591cc181244f00a6a396" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type></type>
        <definition>SSH_PACKET_CALLBACK</definition>
        <argsstring>(channel_rcv_eof)</argsstring>
        <name>SSH_PACKET_CALLBACK</name>
        <param>
          <type>channel_rcv_eof</type>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/channels.c" line="616" column="1" bodyfile="src/channels.c" bodystart="616" bodyend="642"/>
        <references refid="structssh__channel__struct_1ad526c0401837d1636e3f9075226f7cd9" compoundref="channels_8h" startline="81">ssh_channel_struct::callbacks</references>
        <references refid="group__libssh__channel_1ga41254c9dd24ac1ae9ad9c0edd3825dee" compoundref="channels_8c" startline="455" endline="475">channel_from_msg</references>
        <references refid="structssh__channel__struct_1a39cdc105ee0bbd1b7faea169db30f0a1" compoundref="channels_8h" startline="64">ssh_channel_struct::local_channel</references>
        <references refid="structssh__channel__struct_1aa553acf6d12fffb1ae18b11196c2c0e9" compoundref="channels_8h" startline="69">ssh_channel_struct::remote_channel</references>
        <references refid="structssh__channel__struct_1a01fee161bb195c61e434e9bc7b330187" compoundref="channels_8h" startline="71">ssh_channel_struct::remote_eof</references>
        <references refid="structssh__channel__struct_1a0832dc830d09accd2f3a8f8349c3faf2" compoundref="channels_8h" startline="63">ssh_channel_struct::session</references>
        <references refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" compoundref="torture__session__keys_8c" startline="61">session</references>
        <references refid="group__libssh__callbacks_1ga4dc546e7406ce5642a2278aaad3b1e35" compoundref="callbacks_8h" startline="457">ssh_callbacks_execute_list</references>
        <references refid="group__libssh__error_1ga9241586665bf21f823806473fc386258" compoundref="error_8c" startline="128" endline="132">ssh_get_error</references>
        <references refid="priv_8h_1aa21fd8a7a609329603b7b16da7939fca" compoundref="priv_8h" startline="240">SSH_LOG</references>
        <references refid="group__libssh__log_1ggadf764cbdea00d65edcd07bb9953ad2b7a926c933f61d1afa64003c1cc66f6a01c" compoundref="libssh_8h" startline="355">SSH_LOG_FUNCTIONS</references>
        <references refid="group__libssh__log_1ggadf764cbdea00d65edcd07bb9953ad2b7a6445dfe21592d69d9741d319538b6673" compoundref="libssh_8h" startline="352">SSH_LOG_PACKET</references>
        <references refid="group__libssh__callbacks_1gac29df803aa1295d6a498c1b081f3b494" compoundref="callbacks_8h" startline="517">SSH_PACKET_USED</references>
        <references refid="ssh__client_8c_1a14871705f45ccdc5bb9f4549efd8e119" compoundref="ssh__client_8c" startline="48">user</references>
      </memberdef>
      <memberdef kind="function" id="group__libssh__channel_1ga174d7f6268abeab5bc5d427d3ba0fc90" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type></type>
        <definition>SSH_PACKET_CALLBACK</definition>
        <argsstring>(channel_rcv_close)</argsstring>
        <name>SSH_PACKET_CALLBACK</name>
        <param>
          <type>channel_rcv_close</type>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/channels.c" line="644" column="1" bodyfile="src/channels.c" bodystart="644" bodyend="690"/>
        <references refid="structssh__channel__struct_1ad526c0401837d1636e3f9075226f7cd9" compoundref="channels_8h" startline="81">ssh_channel_struct::callbacks</references>
        <references refid="group__libssh__channel_1ga41254c9dd24ac1ae9ad9c0edd3825dee" compoundref="channels_8c" startline="455" endline="475">channel_from_msg</references>
        <references refid="structssh__channel__struct_1a23f4022c397cfd2cfc05a1358f8082f6" compoundref="channels_8h" startline="74">ssh_channel_struct::delayed_close</references>
        <references refid="structssh__channel__struct_1a400dc0c0dc7cd02daaea731825c1a7c4" compoundref="channels_8h" startline="75">ssh_channel_struct::flags</references>
        <references refid="structssh__channel__struct_1a39cdc105ee0bbd1b7faea169db30f0a1" compoundref="channels_8h" startline="64">ssh_channel_struct::local_channel</references>
        <references refid="structssh__channel__struct_1aa553acf6d12fffb1ae18b11196c2c0e9" compoundref="channels_8h" startline="69">ssh_channel_struct::remote_channel</references>
        <references refid="structssh__channel__struct_1a01fee161bb195c61e434e9bc7b330187" compoundref="channels_8h" startline="71">ssh_channel_struct::remote_eof</references>
        <references refid="structssh__channel__struct_1a0832dc830d09accd2f3a8f8349c3faf2" compoundref="channels_8h" startline="63">ssh_channel_struct::session</references>
        <references refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" compoundref="torture__session__keys_8c" startline="61">session</references>
        <references refid="libssh_8h_1a61400c7267feb254046cd606a3fdfdbc">ssh_buffer_get_len</references>
        <references refid="group__libssh__callbacks_1ga4dc546e7406ce5642a2278aaad3b1e35" compoundref="callbacks_8h" startline="457">ssh_callbacks_execute_list</references>
        <references refid="group__libssh__channel_1ga1e7211251562c5e1ec64647236caa745" compoundref="channels_8c" startline="1174" endline="1194">ssh_channel_do_free</references>
        <references refid="channels_8h_1ade088105d65a071041027d9215213071" compoundref="channels_8h" startline="51">SSH_CHANNEL_FLAG_CLOSED_REMOTE</references>
        <references refid="channels_8h_1af83f3c2360379b70925e90d9c0a8f0dd" compoundref="channels_8h" startline="57">SSH_CHANNEL_FLAG_FREED_LOCAL</references>
        <references refid="channels_8h_1a5a002159e5db31d156bb2a8ce8a10cd1a96872cd3f6e98f6f040097e3ee6cb900" compoundref="channels_8h" startline="47">SSH_CHANNEL_STATE_CLOSED</references>
        <references refid="group__libssh__error_1ga9241586665bf21f823806473fc386258" compoundref="error_8c" startline="128" endline="132">ssh_get_error</references>
        <references refid="priv_8h_1aa21fd8a7a609329603b7b16da7939fca" compoundref="priv_8h" startline="240">SSH_LOG</references>
        <references refid="group__libssh__log_1ggadf764cbdea00d65edcd07bb9953ad2b7a926c933f61d1afa64003c1cc66f6a01c" compoundref="libssh_8h" startline="355">SSH_LOG_FUNCTIONS</references>
        <references refid="group__libssh__log_1ggadf764cbdea00d65edcd07bb9953ad2b7a6445dfe21592d69d9741d319538b6673" compoundref="libssh_8h" startline="352">SSH_LOG_PACKET</references>
        <references refid="group__libssh__callbacks_1gac29df803aa1295d6a498c1b081f3b494" compoundref="callbacks_8h" startline="517">SSH_PACKET_USED</references>
        <references refid="structssh__channel__struct_1a272b198e279fa672afeaf9f2e610eb04" compoundref="channels_8h" startline="73">ssh_channel_struct::state</references>
        <references refid="structssh__channel__struct_1a6806319dfa8f417bbad93f6481ad99d4" compoundref="channels_8h" startline="77">ssh_channel_struct::stderr_buffer</references>
        <references refid="structssh__channel__struct_1a8ae1473aafd716256ce762d0115b2321" compoundref="channels_8h" startline="76">ssh_channel_struct::stdout_buffer</references>
        <references refid="ssh__client_8c_1a14871705f45ccdc5bb9f4549efd8e119" compoundref="ssh__client_8c" startline="48">user</references>
      </memberdef>
      <memberdef kind="function" id="group__libssh__channel_1ga04a182f13550058a18b9ba97d8d63ded" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type></type>
        <definition>SSH_PACKET_CALLBACK</definition>
        <argsstring>(channel_rcv_request)</argsstring>
        <name>SSH_PACKET_CALLBACK</name>
        <param>
          <type>channel_rcv_request</type>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/channels.c" line="692" column="1" bodyfile="src/channels.c" bodystart="692" bodyend="839"/>
        <references refid="structssh__channel__struct_1ad526c0401837d1636e3f9075226f7cd9" compoundref="channels_8h" startline="81">ssh_channel_struct::callbacks</references>
        <references refid="group__libssh__channel_1ga41254c9dd24ac1ae9ad9c0edd3825dee" compoundref="channels_8c" startline="455" endline="475">channel_from_msg</references>
        <references refid="structssh__channel__struct_1a3e9106e477bee737abed43d8c57a7bd6" compoundref="channels_8h" startline="79">ssh_channel_struct::exit_status</references>
        <references refid="structssh__session__struct_1af0aed60c1e529bbfdcb483fd80bf98a0" compoundref="session_8h" startline="140">ssh_session_struct::out_buffer</references>
        <references refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" compoundref="pkd__daemon_8c" startline="62">rc</references>
        <references refid="structssh__channel__struct_1aa553acf6d12fffb1ae18b11196c2c0e9" compoundref="channels_8h" startline="69">ssh_channel_struct::remote_channel</references>
        <references refid="sshd__direct-tcpip_8c_1aed3129b7674034c979192bcca6b0ad8c" compoundref="sshd__direct-tcpip_8c" startline="36">SAFE_FREE</references>
        <references refid="structssh__channel__struct_1a0832dc830d09accd2f3a8f8349c3faf2" compoundref="channels_8h" startline="63">ssh_channel_struct::session</references>
        <references refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" compoundref="torture__session__keys_8c" startline="61">session</references>
        <references refid="ssh2_8h_1a2b23fd7211615f33319a267d1728c785" compoundref="ssh2_8h" startline="55">SSH2_MSG_CHANNEL_FAILURE</references>
        <references refid="buffer_8h_1ae17848a86043f0abfc60c1c4f6126ccd" compoundref="buffer_8h" startline="49">ssh_buffer_pack</references>
        <references refid="buffer_8h_1ab51014ef9a47e7cdbd235af3e62b81ee" compoundref="buffer_8h" startline="59">ssh_buffer_unpack</references>
        <references refid="group__libssh__callbacks_1ga4dc546e7406ce5642a2278aaad3b1e35" compoundref="callbacks_8h" startline="457">ssh_callbacks_execute_list</references>
        <references refid="group__libssh__error_1ga9241586665bf21f823806473fc386258" compoundref="error_8c" startline="128" endline="132">ssh_get_error</references>
        <references refid="priv_8h_1aa21fd8a7a609329603b7b16da7939fca" compoundref="priv_8h" startline="240">SSH_LOG</references>
        <references refid="group__libssh__log_1ggadf764cbdea00d65edcd07bb9953ad2b7a926c933f61d1afa64003c1cc66f6a01c" compoundref="libssh_8h" startline="355">SSH_LOG_FUNCTIONS</references>
        <references refid="group__libssh__log_1ggadf764cbdea00d65edcd07bb9953ad2b7a6445dfe21592d69d9741d319538b6673" compoundref="libssh_8h" startline="352">SSH_LOG_PACKET</references>
        <references refid="group__libssh__log_1ggadf764cbdea00d65edcd07bb9953ad2b7a75fa79e63947b66462db977d9b5ae27c" compoundref="libssh_8h" startline="349">SSH_LOG_PROTOCOL</references>
        <references refid="group__libssh__log_1ggadf764cbdea00d65edcd07bb9953ad2b7a12e6bbab0c5a667e259e2f9599a72550" compoundref="libssh_8h" startline="346">SSH_LOG_WARNING</references>
        <references refid="group__libssh__messages_1gad4f7f7dc02ac8dd0f07492b104a0dd7e" compoundref="messages_8c" startline="1329" endline="1439">ssh_message_handle_channel_request</references>
        <references refid="libssh_8h_1ac1ee1d1e917456d4760a94a18015377d" compoundref="libssh_8h" startline="329">SSH_OK</references>
        <references refid="packet_8h_1a7e6c7ed74c23ace432476aa8a6841140" compoundref="packet_8c" startline="1761" endline="1843">ssh_packet_send</references>
        <references refid="group__libssh__callbacks_1gac29df803aa1295d6a498c1b081f3b494" compoundref="callbacks_8h" startline="517">SSH_PACKET_USED</references>
        <references refid="ssh__client_8c_1a14871705f45ccdc5bb9f4549efd8e119" compoundref="ssh__client_8c" startline="48">user</references>
      </memberdef>
      <memberdef kind="function" id="group__libssh__channel_1ga3f6b844e236802c6780e7bcf0c0f3fce" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>int channel_default_bufferize</definition>
        <argsstring>(ssh_channel channel, void *data, size_t len, bool is_stderr)</argsstring>
        <name>channel_default_bufferize</name>
        <param>
          <type><ref refid="libssh_8h_1aca32be8db7c865697a3de381dc7e9fc3" kindref="member">ssh_channel</ref></type>
          <declname>channel</declname>
        </param>
        <param>
          <type>void *</type>
          <declname>data</declname>
        </param>
        <param>
          <type>size_t</type>
          <declname>len</declname>
        </param>
        <param>
          <type>bool</type>
          <declname>is_stderr</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/channels.c" line="847" column="5" bodyfile="src/channels.c" bodystart="847" bodyend="903"/>
        <references refid="structssh__iterator_1a4cc4eb8c8599a487e7e3321d32a9e9cd" compoundref="misc_8h" startline="46">ssh_iterator::data</references>
        <references refid="structssh__channel__struct_1a0832dc830d09accd2f3a8f8349c3faf2" compoundref="channels_8h" startline="63">ssh_channel_struct::session</references>
        <references refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" compoundref="torture__session__keys_8c" startline="61">session</references>
        <references refid="libssh_8h_1a92d37237bf129961367accd4a9e0dcfc">ssh_buffer_add_data</references>
        <references refid="libssh_8h_1a8b09f7d6f7066de7ef8dab4ed7494a52" compoundref="libssh_8h" startline="828">SSH_BUFFER_FREE</references>
        <references refid="group__libssh__buffer_1ga7ecc914104a5bf0da485d3e42f6a7d3b" compoundref="buffer_8c" startline="119" endline="142">ssh_buffer_new</references>
        <references refid="priv_8h_1aa21fd8a7a609329603b7b16da7939fca" compoundref="priv_8h" startline="240">SSH_LOG</references>
        <references refid="group__libssh__log_1ggadf764cbdea00d65edcd07bb9953ad2b7a6445dfe21592d69d9741d319538b6673" compoundref="libssh_8h" startline="352">SSH_LOG_PACKET</references>
        <references refid="priv_8h_1a351ea86857d33b3ba80b396e05c4517c" compoundref="priv_8h" startline="269">ssh_set_error_invalid</references>
        <references refid="priv_8h_1ae280c413c792e04237f000841ac8ce44" compoundref="priv_8h" startline="265">ssh_set_error_oom</references>
        <references refid="structssh__channel__struct_1a6806319dfa8f417bbad93f6481ad99d4" compoundref="channels_8h" startline="77">ssh_channel_struct::stderr_buffer</references>
        <references refid="structssh__channel__struct_1a8ae1473aafd716256ce762d0115b2321" compoundref="channels_8h" startline="76">ssh_channel_struct::stdout_buffer</references>
        <referencedby refid="group__libssh__channel_1ga2a1924f01a292478aaf2f140a8a107e3" compoundref="channels_8c" startline="510" endline="614">SSH_PACKET_CALLBACK</referencedby>
      </memberdef>
      <memberdef kind="function" id="group__libssh__channel_1gaf051dd30d75bf6dc45d1a5088cf970bd" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>int ssh_channel_open_session</definition>
        <argsstring>(ssh_channel channel)</argsstring>
        <name>ssh_channel_open_session</name>
        <param>
          <type><ref refid="libssh_8h_1aca32be8db7c865697a3de381dc7e9fc3" kindref="member">ssh_channel</ref></type>
          <declname>channel</declname>
        </param>
        <briefdescription>
<para>Open a session channel (suited for a shell, not TCP forwarding). </para>
        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername direction="in">channel</parametername>
</parameternamelist>
<parameterdescription>
<para>An allocated channel.</para>
</parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>SSH_OK on success, SSH_ERROR if an error occurred, SSH_AGAIN if in nonblocking mode and call has to be done again.</para>
</simplesect>
<simplesect kind="see"><para><ref refid="group__libssh__channel_1gae86b0704a1f2bdebb268b55567f7f47b" kindref="member">ssh_channel_open_forward()</ref> </para>
</simplesect>
<simplesect kind="see"><para><ref refid="group__libssh__channel_1ga7aede2f9af4c494ff9e41fc08a4572f1" kindref="member">ssh_channel_request_env()</ref> </para>
</simplesect>
<simplesect kind="see"><para><ref refid="group__libssh__channel_1gaed4c5fb30c9df2b2548421ccf4e81bf1" kindref="member">ssh_channel_request_shell()</ref> </para>
</simplesect>
<simplesect kind="see"><para><ref refid="group__libssh__channel_1ga567d509183ade0a77190f390e2b5747d" kindref="member">ssh_channel_request_exec()</ref> </para>
</simplesect>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/channels.c" line="920" column="5" bodyfile="src/channels.c" bodystart="920" bodyend="930"/>
        <references refid="channels_8c_1a6d5398350fc6c52561ed2674154161dc" compoundref="channels_8c" startline="60">CHANNEL_INITIAL_WINDOW</references>
        <references refid="channels_8c_1a2ab57c8b0eeaa7b8ef3733493a00bf55" compoundref="channels_8c" startline="59">CHANNEL_MAX_PACKET</references>
        <references refid="group__libssh__channel_1gaa3d6d7d4ab8191f8b8eb14464b0f0e1e" compoundref="channels_8c" startline="285" endline="367">channel_open</references>
        <references refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" compoundref="libssh_8h" startline="330">SSH_ERROR</references>
        <referencedby refid="ssh__client_8c_1a8b8ff3289e057f1b391476c5c4b71178" compoundref="ssh__client_8c" startline="290" endline="316">batch_shell</referencedby>
        <referencedby refid="bench__raw_8c_1afd64b09e9ae3ce2136328be2cd0bac89" compoundref="bench__raw_8c" startline="227" endline="285">benchmarks_raw_down</referencedby>
        <referencedby refid="bench__raw_8c_1a070a579a7a62c222e5f28c9e074c0df7" compoundref="bench__raw_8c" startline="107" endline="182">benchmarks_raw_up</referencedby>
        <referencedby refid="benchmarks_8h_1a166dab0266f920174e138f1039ca1773" compoundref="latency_8c" startline="119" endline="148">benchmarks_ssh_latency</referencedby>
        <referencedby refid="legacy_8h_1af388977b9bfaec3ed77aaa6826e930a9" compoundref="legacy_8c" startline="217" endline="219">channel_open_session</referencedby>
        <referencedby refid="torture__server__x11_8c_1abb575a0d8644debf193b257c748c0ce1" compoundref="torture__server__x11_8c" startline="69" endline="96">client_thread</referencedby>
        <referencedby refid="scp__download_8c_1abf8ad844320270e1c0b49e510c9bb4a0" compoundref="scp__download_8c" startline="61" endline="100">create_files</referencedby>
        <referencedby refid="test__exec_8c_1acbd4f6c4ecc68d1c4cc45223741be81c" compoundref="test__exec_8c" startline="10" endline="49">do_connect</referencedby>
        <referencedby refid="ssh__client__fuzzer_8cpp_1a91ce7c16e9840492202299da2b451e60" compoundref="ssh__client__fuzzer_8cpp" startline="85" endline="158">LLVMFuzzerTestOneInput</referencedby>
        <referencedby refid="exec_8c_1a840291bc02cba5474a4cb46a9b9566fe" compoundref="exec_8c" startline="7" endline="66">main</referencedby>
        <referencedby refid="classssh_1_1Channel_1ab2764dbcf8b9c3168963536ba8b0ea1b" compoundref="libsshpp_8hpp" startline="535" endline="539">ssh::Channel::openSession</referencedby>
        <referencedby refid="ssh__client_8c_1a9aee67bdbbcaaca080f23c622d7d38d9" compoundref="ssh__client_8c" startline="244" endline="288">shell</referencedby>
        <referencedby refid="group__libssh__scp_1ga1db56dcb9dee01dd0b679b3b11151110" compoundref="scp_8c" startline="119" endline="230">ssh_scp_init</referencedby>
        <referencedby refid="torture__session_8c_1a99c33d74eaa8af7ac88d2b2ffe1299ca" compoundref="torture__session_8c" startline="83" endline="119">torture_channel_read_error</referencedby>
        <referencedby refid="torture__request__env_8c_1af673d397cb089d358c279e3e6e082388" compoundref="torture__request__env_8c" startline="78" endline="118">torture_request_env</referencedby>
        <referencedby refid="torture__server_8c_1a65c15130edce6143731c7bff27153650" compoundref="torture__server_8c" startline="476" endline="518">torture_server_unknown_global_request</referencedby>
        <referencedby refid="torture__client__global__requests_8c_1a32462a357527b0302ce677bab88c3cf2" compoundref="torture__client__global__requests_8c" startline="109" endline="135">torture_unknown_request</referencedby>
        <referencedby refid="bench__raw_8c_1ab14322fd9f96904e565cabfbe2b42a5e" compoundref="bench__raw_8c" startline="71" endline="97">upload_script</referencedby>
      </memberdef>
      <memberdef kind="function" id="group__libssh__channel_1ga6c4d4f5436dd5be58973606c6bcd8bb4" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>int ssh_channel_open_auth_agent</definition>
        <argsstring>(ssh_channel channel)</argsstring>
        <name>ssh_channel_open_auth_agent</name>
        <param>
          <type><ref refid="libssh_8h_1aca32be8db7c865697a3de381dc7e9fc3" kindref="member">ssh_channel</ref></type>
          <declname>channel</declname>
        </param>
        <briefdescription>
<para>Open an agent authentication forwarding channel. This type of channel can be opened by a server towards a client in order to provide SSH-Agent services to the server-side process. This channel can only be opened if the client claimed support by sending a channel request beforehand. </para>
        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername direction="in">channel</parametername>
</parameternamelist>
<parameterdescription>
<para>An allocated channel.</para>
</parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>SSH_OK on success, SSH_ERROR if an error occurred, SSH_AGAIN if in nonblocking mode and call has to be done again.</para>
</simplesect>
<simplesect kind="see"><para><ref refid="group__libssh__channel_1gae86b0704a1f2bdebb268b55567f7f47b" kindref="member">ssh_channel_open_forward()</ref> </para>
</simplesect>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/channels.c" line="947" column="5" bodyfile="src/channels.c" bodystart="947" bodyend="957"/>
        <references refid="channels_8c_1a6d5398350fc6c52561ed2674154161dc" compoundref="channels_8c" startline="60">CHANNEL_INITIAL_WINDOW</references>
        <references refid="channels_8c_1a2ab57c8b0eeaa7b8ef3733493a00bf55" compoundref="channels_8c" startline="59">CHANNEL_MAX_PACKET</references>
        <references refid="group__libssh__channel_1gaa3d6d7d4ab8191f8b8eb14464b0f0e1e" compoundref="channels_8c" startline="285" endline="367">channel_open</references>
        <references refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" compoundref="libssh_8h" startline="330">SSH_ERROR</references>
      </memberdef>
      <memberdef kind="function" id="group__libssh__channel_1gae86b0704a1f2bdebb268b55567f7f47b" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>int ssh_channel_open_forward</definition>
        <argsstring>(ssh_channel channel, const char *remotehost, int remoteport, const char *sourcehost, int localport)</argsstring>
        <name>ssh_channel_open_forward</name>
        <param>
          <type><ref refid="libssh_8h_1aca32be8db7c865697a3de381dc7e9fc3" kindref="member">ssh_channel</ref></type>
          <declname>channel</declname>
        </param>
        <param>
          <type>const char *</type>
          <declname>remotehost</declname>
        </param>
        <param>
          <type>int</type>
          <declname>remoteport</declname>
        </param>
        <param>
          <type>const char *</type>
          <declname>sourcehost</declname>
        </param>
        <param>
          <type>int</type>
          <declname>localport</declname>
        </param>
        <briefdescription>
<para>Open a TCP/IP forwarding channel. </para>
        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername direction="in">channel</parametername>
</parameternamelist>
<parameterdescription>
<para>An allocated channel.</para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">remotehost</parametername>
</parameternamelist>
<parameterdescription>
<para>The remote host to connected (host name or IP).</para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">remoteport</parametername>
</parameternamelist>
<parameterdescription>
<para>The remote port.</para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">sourcehost</parametername>
</parameternamelist>
<parameterdescription>
<para>The numeric IP address of the machine from where the connection request originates. This is mostly for logging purposes.</para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">localport</parametername>
</parameternamelist>
<parameterdescription>
<para>The port on the host from where the connection originated. This is mostly for logging purposes.</para>
</parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>SSH_OK on success, SSH_ERROR if an error occurred, SSH_AGAIN if in nonblocking mode and call has to be done again.</para>
</simplesect>
<simplesect kind="warning"><para>This function does not bind the local port and does not automatically forward the content of a socket to the channel. You still have to use channel_read and channel_write for this. </para>
</simplesect>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/channels.c" line="985" column="5" bodyfile="src/channels.c" bodystart="985" bodyend="1031"/>
        <references refid="channels_8c_1a6d5398350fc6c52561ed2674154161dc" compoundref="channels_8c" startline="60">CHANNEL_INITIAL_WINDOW</references>
        <references refid="channels_8c_1a2ab57c8b0eeaa7b8ef3733493a00bf55" compoundref="channels_8c" startline="59">CHANNEL_MAX_PACKET</references>
        <references refid="group__libssh__channel_1gaa3d6d7d4ab8191f8b8eb14464b0f0e1e" compoundref="channels_8c" startline="285" endline="367">channel_open</references>
        <references refid="proxy_8c_1a11614f44ef4d939bdd984953346a7572" compoundref="proxy_8c" startline="33">error</references>
        <references refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" compoundref="pkd__daemon_8c" startline="62">rc</references>
        <references refid="structssh__channel__struct_1a0832dc830d09accd2f3a8f8349c3faf2" compoundref="channels_8h" startline="63">ssh_channel_struct::session</references>
        <references refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" compoundref="torture__session__keys_8c" startline="61">session</references>
        <references refid="libssh_8h_1a8b09f7d6f7066de7ef8dab4ed7494a52" compoundref="libssh_8h" startline="828">SSH_BUFFER_FREE</references>
        <references refid="group__libssh__buffer_1ga7ecc914104a5bf0da485d3e42f6a7d3b" compoundref="buffer_8c" startline="119" endline="142">ssh_buffer_new</references>
        <references refid="buffer_8h_1ae17848a86043f0abfc60c1c4f6126ccd" compoundref="buffer_8h" startline="49">ssh_buffer_pack</references>
        <references refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" compoundref="libssh_8h" startline="330">SSH_ERROR</references>
        <references refid="libssh_8h_1ac1ee1d1e917456d4760a94a18015377d" compoundref="libssh_8h" startline="329">SSH_OK</references>
        <references refid="priv_8h_1a351ea86857d33b3ba80b396e05c4517c" compoundref="priv_8h" startline="269">ssh_set_error_invalid</references>
        <references refid="priv_8h_1ae280c413c792e04237f000841ac8ce44" compoundref="priv_8h" startline="265">ssh_set_error_oom</references>
        <references refid="libssh_8h_1a5bc8710c8633117ff449d15489fca051" compoundref="libssh_8h" startline="790">SSH_STRING_FREE</references>
        <referencedby refid="legacy_8h_1a038d66c15cfae8730cf09d7ea71c92cb" compoundref="legacy_8c" startline="211" endline="215">channel_open_forward</referencedby>
        <referencedby refid="test__tunnel_8c_1acbd4f6c4ecc68d1c4cc45223741be81c" compoundref="test__tunnel_8c" startline="10" endline="63">do_connect</referencedby>
        <referencedby refid="sshnetcat_8c_1ad08dcc6e9fab1b29fbaabbc4db908350" compoundref="sshnetcat_8c" startline="177" endline="187">forwarding</referencedby>
        <referencedby refid="classssh_1_1Channel_1ac5408b11bfb79ec58456660b8c8d98d8" compoundref="libsshpp_8hpp" startline="527" endline="533">ssh::Channel::openForward</referencedby>
      </memberdef>
      <memberdef kind="function" id="group__libssh__channel_1ga93ddd5055eb3322d38c70986aa63c673" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>int ssh_channel_open_forward_unix</definition>
        <argsstring>(ssh_channel channel, const char *remotepath, const char *sourcehost, int localport)</argsstring>
        <name>ssh_channel_open_forward_unix</name>
        <param>
          <type><ref refid="libssh_8h_1aca32be8db7c865697a3de381dc7e9fc3" kindref="member">ssh_channel</ref></type>
          <declname>channel</declname>
        </param>
        <param>
          <type>const char *</type>
          <declname>remotepath</declname>
        </param>
        <param>
          <type>const char *</type>
          <declname>sourcehost</declname>
        </param>
        <param>
          <type>int</type>
          <declname>localport</declname>
        </param>
        <briefdescription>
<para>Open a TCP/IP - UNIX domain socket forwarding channel. </para>
        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername direction="in">channel</parametername>
</parameternamelist>
<parameterdescription>
<para>An allocated channel.</para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">remotepath</parametername>
</parameternamelist>
<parameterdescription>
<para>The UNIX socket path on the remote machine</para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">sourcehost</parametername>
</parameternamelist>
<parameterdescription>
<para>The numeric IP address of the machine from where the connection request originates. This is mostly for logging purposes.</para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">localport</parametername>
</parameternamelist>
<parameterdescription>
<para>The port on the host from where the connection originated. This is mostly for logging purposes.</para>
</parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>SSH_OK on success, SSH_ERROR if an error occurred, SSH_AGAIN if in nonblocking mode and call has to be done again.</para>
</simplesect>
<simplesect kind="warning"><para>This function does not bind the local port and does not automatically forward the content of a socket to the channel. You still have to use channel_read and channel_write for this. </para>
</simplesect>
<simplesect kind="warning"><para>Requires support of OpenSSH for UNIX domain socket forwarding. </para>
</simplesect>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/channels.c" line="1057" column="5" bodyfile="src/channels.c" bodystart="1057" bodyend="1114"/>
        <references refid="channels_8c_1a6d5398350fc6c52561ed2674154161dc" compoundref="channels_8c" startline="60">CHANNEL_INITIAL_WINDOW</references>
        <references refid="channels_8c_1a2ab57c8b0eeaa7b8ef3733493a00bf55" compoundref="channels_8c" startline="59">CHANNEL_MAX_PACKET</references>
        <references refid="group__libssh__channel_1gaa3d6d7d4ab8191f8b8eb14464b0f0e1e" compoundref="channels_8c" startline="285" endline="367">channel_open</references>
        <references refid="proxy_8c_1a11614f44ef4d939bdd984953346a7572" compoundref="proxy_8c" startline="33">error</references>
        <references refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" compoundref="pkd__daemon_8c" startline="62">rc</references>
        <references refid="structssh__channel__struct_1a0832dc830d09accd2f3a8f8349c3faf2" compoundref="channels_8h" startline="63">ssh_channel_struct::session</references>
        <references refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" compoundref="torture__session__keys_8c" startline="61">session</references>
        <references refid="libssh_8h_1a8b09f7d6f7066de7ef8dab4ed7494a52" compoundref="libssh_8h" startline="828">SSH_BUFFER_FREE</references>
        <references refid="group__libssh__buffer_1ga7ecc914104a5bf0da485d3e42f6a7d3b" compoundref="buffer_8c" startline="119" endline="142">ssh_buffer_new</references>
        <references refid="buffer_8h_1ae17848a86043f0abfc60c1c4f6126ccd" compoundref="buffer_8h" startline="49">ssh_buffer_pack</references>
        <references refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" compoundref="libssh_8h" startline="330">SSH_ERROR</references>
        <references refid="group__libssh__session_1gac55d2895467a1e898ee75b4710d836a5" compoundref="client_8c" startline="658" endline="664">ssh_get_openssh_version</references>
        <references refid="libssh_8h_1ac1ee1d1e917456d4760a94a18015377d" compoundref="libssh_8h" startline="329">SSH_OK</references>
        <references refid="libssh_8h_1a036b2b00fb04337a4d06d719d1b62be1ad1339fb4b92a9d25bdb99df5de5c4f88" compoundref="libssh_8h" startline="285">SSH_REQUEST_DENIED</references>
        <references refid="priv_8h_1a55177b3e8db90ca9adb435c44281963c" compoundref="priv_8h" startline="258">ssh_set_error</references>
        <references refid="priv_8h_1a351ea86857d33b3ba80b396e05c4517c" compoundref="priv_8h" startline="269">ssh_set_error_invalid</references>
        <references refid="priv_8h_1ae280c413c792e04237f000841ac8ce44" compoundref="priv_8h" startline="265">ssh_set_error_oom</references>
        <references refid="libssh_8h_1a5bc8710c8633117ff449d15489fca051" compoundref="libssh_8h" startline="790">SSH_STRING_FREE</references>
      </memberdef>
      <memberdef kind="function" id="group__libssh__channel_1gad1417f9eae8928fed20faafe2d9dbfff" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void ssh_channel_free</definition>
        <argsstring>(ssh_channel channel)</argsstring>
        <name>ssh_channel_free</name>
        <param>
          <type><ref refid="libssh_8h_1aca32be8db7c865697a3de381dc7e9fc3" kindref="member">ssh_channel</ref></type>
          <declname>channel</declname>
        </param>
        <briefdescription>
<para>Close and free a channel. </para>
        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername direction="in">channel</parametername>
</parameternamelist>
<parameterdescription>
<para>The channel to free.</para>
</parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="warning"><para>Any data unread on this channel will be lost. </para>
</simplesect>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/channels.c" line="1123" column="6" bodyfile="src/channels.c" bodystart="1123" bodyend="1167"/>
        <references refid="structssh__session__struct_1a729d3c7f6ae20cb5a00ac7cd28a630f7" compoundref="session_8h" startline="124">ssh_session_struct::alive</references>
        <references refid="structssh__channel__struct_1a400dc0c0dc7cd02daaea731825c1a7c4" compoundref="channels_8h" startline="75">ssh_channel_struct::flags</references>
        <references refid="structssh__channel__struct_1a0832dc830d09accd2f3a8f8349c3faf2" compoundref="channels_8h" startline="63">ssh_channel_struct::session</references>
        <references refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" compoundref="torture__session__keys_8c" startline="61">session</references>
        <references refid="group__libssh__channel_1ga238f07e0455456a5bfd8a49ead917732" compoundref="channels_8c" startline="1285" endline="1336">ssh_channel_close</references>
        <references refid="group__libssh__channel_1ga1e7211251562c5e1ec64647236caa745" compoundref="channels_8c" startline="1174" endline="1194">ssh_channel_do_free</references>
        <references refid="channels_8h_1ad2f890619dac7055258ce90e9944b65f" compoundref="channels_8h" startline="54">SSH_CHANNEL_FLAG_CLOSED_LOCAL</references>
        <references refid="channels_8h_1ade088105d65a071041027d9215213071" compoundref="channels_8h" startline="51">SSH_CHANNEL_FLAG_CLOSED_REMOTE</references>
        <references refid="channels_8h_1af83f3c2360379b70925e90d9c0a8f0dd" compoundref="channels_8h" startline="57">SSH_CHANNEL_FLAG_FREED_LOCAL</references>
        <references refid="channels_8h_1a040c2d863bb3de2036d3b2fcde37450c" compoundref="channels_8h" startline="60">SSH_CHANNEL_FLAG_NOT_BOUND</references>
        <references refid="channels_8h_1a5a002159e5db31d156bb2a8ce8a10cd1a96872cd3f6e98f6f040097e3ee6cb900" compoundref="channels_8h" startline="47">SSH_CHANNEL_STATE_CLOSED</references>
        <references refid="channels_8h_1a5a002159e5db31d156bb2a8ce8a10cd1a488a78707192c35250392423b5058e2b" compoundref="channels_8h" startline="46">SSH_CHANNEL_STATE_OPEN</references>
        <references refid="structssh__channel__struct_1a272b198e279fa672afeaf9f2e610eb04" compoundref="channels_8h" startline="73">ssh_channel_struct::state</references>
        <referencedby refid="ssh__client_8c_1a8b8ff3289e057f1b391476c5c4b71178" compoundref="ssh__client_8c" startline="290" endline="316">batch_shell</referencedby>
        <referencedby refid="bench__raw_8c_1afd64b09e9ae3ce2136328be2cd0bac89" compoundref="bench__raw_8c" startline="227" endline="285">benchmarks_raw_down</referencedby>
        <referencedby refid="bench__raw_8c_1a070a579a7a62c222e5f28c9e074c0df7" compoundref="bench__raw_8c" startline="107" endline="182">benchmarks_raw_up</referencedby>
        <referencedby refid="benchmarks_8h_1a166dab0266f920174e138f1039ca1773" compoundref="latency_8c" startline="119" endline="148">benchmarks_ssh_latency</referencedby>
        <referencedby refid="legacy_8h_1afd23734c693ecf2b967c34cdf5640aac" compoundref="legacy_8c" startline="183" endline="185">channel_free</referencedby>
        <referencedby refid="scp__download_8c_1abf8ad844320270e1c0b49e510c9bb4a0" compoundref="scp__download_8c" startline="61" endline="100">create_files</referencedby>
        <referencedby refid="sshd__direct-tcpip_8c_1a1d108777de8e248073f748300f01226c" compoundref="sshd__direct-tcpip_8c" startline="95" endline="132">do_cleanup</referencedby>
        <referencedby refid="test__exec_8c_1acbd4f6c4ecc68d1c4cc45223741be81c" compoundref="test__exec_8c" startline="10" endline="49">do_connect</referencedby>
        <referencedby refid="ssh__client__fuzzer_8cpp_1a91ce7c16e9840492202299da2b451e60" compoundref="ssh__client__fuzzer_8cpp" startline="85" endline="158">LLVMFuzzerTestOneInput</referencedby>
        <referencedby refid="exec_8c_1a840291bc02cba5474a4cb46a9b9566fe" compoundref="exec_8c" startline="7" endline="66">main</referencedby>
        <referencedby refid="pkd__daemon_8c_1a072176a3f00730d8fefe327d7110426b" compoundref="pkd__daemon_8c" startline="205" endline="230">pkd_channel_openreq_cb</referencedby>
        <referencedby refid="pkd__daemon_8c_1abe87875a523cecd013d848c7c9c5ba22" compoundref="pkd__daemon_8c" startline="238" endline="475">pkd_exec_hello</referencedby>
        <referencedby refid="sshnetcat_8c_1a38ba4d370f756491ce0d55e0c320d08b" compoundref="sshnetcat_8c" startline="77" endline="175">select_loop</referencedby>
        <referencedby refid="ssh__client_8c_1a9aee67bdbbcaaca080f23c622d7d38d9" compoundref="ssh__client_8c" startline="244" endline="288">shell</referencedby>
        <referencedby refid="group__libssh__messages_1gaf9afe350861a5085901b37c5ff9b7702" compoundref="messages_8c" startline="1289" endline="1308">ssh_message_channel_request_open_reply_accept</referencedby>
        <referencedby refid="group__libssh__scp_1ga14d31059dcf6fb2325fb960da8e4474e" compoundref="scp_8c" startline="241" endline="277">ssh_scp_close</referencedby>
        <referencedby refid="group__libssh__scp_1gac29000cdb07c74d54251fbd838c0c661" compoundref="scp_8c" startline="286" endline="304">ssh_scp_free</referencedby>
        <referencedby refid="torture__session_8c_1a99c33d74eaa8af7ac88d2b2ffe1299ca" compoundref="torture__session_8c" startline="83" endline="119">torture_channel_read_error</referencedby>
        <referencedby refid="bench__raw_8c_1ab14322fd9f96904e565cabfbe2b42a5e" compoundref="bench__raw_8c" startline="71" endline="97">upload_script</referencedby>
        <referencedby refid="classssh_1_1Channel_1a10dc8f6c498117bfb4be5f3cdafd0a02" compoundref="libsshpp_8hpp" startline="463" endline="466">ssh::Channel::~Channel</referencedby>
      </memberdef>
      <memberdef kind="function" id="group__libssh__channel_1ga1e7211251562c5e1ec64647236caa745" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void ssh_channel_do_free</definition>
        <argsstring>(ssh_channel channel)</argsstring>
        <name>ssh_channel_do_free</name>
        <param>
          <type><ref refid="libssh_8h_1aca32be8db7c865697a3de381dc7e9fc3" kindref="member">ssh_channel</ref></type>
          <declname>channel</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/channels.c" line="1174" column="6" bodyfile="src/channels.c" bodystart="1174" bodyend="1194"/>
        <references refid="structssh__channel__struct_1ad526c0401837d1636e3f9075226f7cd9" compoundref="channels_8h" startline="81">ssh_channel_struct::callbacks</references>
        <references refid="structssh__session__struct_1a9445164beb02a1979171bef9b1a63182" compoundref="session_8h" startline="175">ssh_session_struct::channels</references>
        <references refid="sshd__direct-tcpip_8c_1aed3129b7674034c979192bcca6b0ad8c" compoundref="sshd__direct-tcpip_8c" startline="36">SAFE_FREE</references>
        <references refid="structssh__channel__struct_1a0832dc830d09accd2f3a8f8349c3faf2" compoundref="channels_8h" startline="63">ssh_channel_struct::session</references>
        <references refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" compoundref="torture__session__keys_8c" startline="61">session</references>
        <references refid="libssh_8h_1a8b09f7d6f7066de7ef8dab4ed7494a52" compoundref="libssh_8h" startline="828">SSH_BUFFER_FREE</references>
        <references refid="group__libssh__misc_1ga7a929a68f02650d474604a10252afd68" compoundref="misc_8c" startline="688" endline="694">ssh_list_find</references>
        <references refid="group__libssh__misc_1ga069155e0b5924eb930022b8d566f6d28" compoundref="misc_8c" startline="669" endline="680">ssh_list_free</references>
        <references refid="group__libssh__misc_1gac862429660a1f93dcf625d08f407b85e" compoundref="misc_8c" startline="771" endline="798">ssh_list_remove</references>
        <references refid="structssh__channel__struct_1a6806319dfa8f417bbad93f6481ad99d4" compoundref="channels_8h" startline="77">ssh_channel_struct::stderr_buffer</references>
        <references refid="structssh__channel__struct_1a8ae1473aafd716256ce762d0115b2321" compoundref="channels_8h" startline="76">ssh_channel_struct::stdout_buffer</references>
        <referencedby refid="group__libssh__channel_1gad1417f9eae8928fed20faafe2d9dbfff" compoundref="channels_8c" startline="1123" endline="1167">ssh_channel_free</referencedby>
        <referencedby refid="group__libssh__session_1ga0f048a4c0dbe02cfb7e9c5b6d0db0f27" compoundref="client_8c" startline="672" endline="750">ssh_disconnect</referencedby>
        <referencedby refid="group__libssh__session_1gae5af27a98a7488e9f5ded6b37c274156" compoundref="session_8c" startline="191" endline="326">ssh_free</referencedby>
        <referencedby refid="group__libssh__channel_1ga174d7f6268abeab5bc5d427d3ba0fc90" compoundref="channels_8c" startline="644" endline="690">SSH_PACKET_CALLBACK</referencedby>
      </memberdef>
      <memberdef kind="function" id="group__libssh__channel_1ga072f82fdf3e50514f747653af2c99004" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>int ssh_channel_send_eof</definition>
        <argsstring>(ssh_channel channel)</argsstring>
        <name>ssh_channel_send_eof</name>
        <param>
          <type><ref refid="libssh_8h_1aca32be8db7c865697a3de381dc7e9fc3" kindref="member">ssh_channel</ref></type>
          <declname>channel</declname>
        </param>
        <briefdescription>
<para>Send an end of file on the channel. </para>
        </briefdescription>
        <detaileddescription>
<para>This doesn&apos;t close the channel. You may still read from it but not write.</para>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername direction="in">channel</parametername>
</parameternamelist>
<parameterdescription>
<para>The channel to send the eof to.</para>
</parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>SSH_OK on success, SSH_ERROR if an error occurred.</para>
</simplesect>
Example: <programlisting><codeline><highlight class="normal">rc<sp/>=<sp/>ssh_channel_send_eof(channel);</highlight></codeline>
<codeline><highlight class="normal">if<sp/>(rc<sp/>==<sp/>SSH_ERROR)<sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>return<sp/>-1;</highlight></codeline>
<codeline><highlight class="normal">}</highlight></codeline>
<codeline><highlight class="normal">while(!ssh_channel_is_eof(channel))<sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>rc<sp/>=<sp/>ssh_channel_read(channel,<sp/>buf,<sp/>sizeof(buf),<sp/>0);</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>if<sp/>(rc<sp/>==<sp/>SSH_ERROR)<sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>-1;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline><highlight class="normal">}</highlight></codeline>
<codeline><highlight class="normal">ssh_channel_close(channel);</highlight></codeline>
</programlisting></para>
<para><simplesect kind="see"><para><ref refid="group__libssh__channel_1ga238f07e0455456a5bfd8a49ead917732" kindref="member">ssh_channel_close()</ref> </para>
</simplesect>
<simplesect kind="see"><para><ref refid="group__libssh__channel_1gad1417f9eae8928fed20faafe2d9dbfff" kindref="member">ssh_channel_free()</ref> </para>
</simplesect>
<simplesect kind="see"><para><ref refid="group__libssh__channel_1gab535264029443d77214c0615a0788b0a" kindref="member">ssh_channel_is_eof()</ref> </para>
</simplesect>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/channels.c" line="1224" column="5" bodyfile="src/channels.c" bodystart="1224" bodyend="1270"/>
        <references refid="proxy_8c_1a11614f44ef4d939bdd984953346a7572" compoundref="proxy_8c" startline="33">error</references>
        <references refid="structssh__channel__struct_1a39cdc105ee0bbd1b7faea169db30f0a1" compoundref="channels_8h" startline="64">ssh_channel_struct::local_channel</references>
        <references refid="structssh__channel__struct_1a84b4de0420fa99e2b0673d4b5eeb4875" compoundref="channels_8h" startline="66">ssh_channel_struct::local_eof</references>
        <references refid="structssh__session__struct_1af0aed60c1e529bbfdcb483fd80bf98a0" compoundref="session_8h" startline="140">ssh_session_struct::out_buffer</references>
        <references refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" compoundref="pkd__daemon_8c" startline="62">rc</references>
        <references refid="structssh__channel__struct_1aa553acf6d12fffb1ae18b11196c2c0e9" compoundref="channels_8h" startline="69">ssh_channel_struct::remote_channel</references>
        <references refid="structssh__channel__struct_1a0832dc830d09accd2f3a8f8349c3faf2" compoundref="channels_8h" startline="63">ssh_channel_struct::session</references>
        <references refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" compoundref="torture__session__keys_8c" startline="61">session</references>
        <references refid="ssh2_8h_1a71f0974db7fd436bb5c29d4761d2f176" compoundref="ssh2_8h" startline="51">SSH2_MSG_CHANNEL_EOF</references>
        <references refid="buffer_8h_1ae17848a86043f0abfc60c1c4f6126ccd" compoundref="buffer_8h" startline="49">ssh_buffer_pack</references>
        <references refid="libssh_8h_1ac8802ff7f5348d0145dab5242623f740">ssh_buffer_reinit</references>
        <references refid="group__libssh__channel_1gae61fe034965d58e1fb6da1bee98de191" compoundref="channels_8c" startline="1372" endline="1374">ssh_channel_flush</references>
        <references refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" compoundref="libssh_8h" startline="330">SSH_ERROR</references>
        <references refid="priv_8h_1aa21fd8a7a609329603b7b16da7939fca" compoundref="priv_8h" startline="240">SSH_LOG</references>
        <references refid="group__libssh__log_1ggadf764cbdea00d65edcd07bb9953ad2b7a6445dfe21592d69d9741d319538b6673" compoundref="libssh_8h" startline="352">SSH_LOG_PACKET</references>
        <references refid="libssh_8h_1ac1ee1d1e917456d4760a94a18015377d" compoundref="libssh_8h" startline="329">SSH_OK</references>
        <references refid="packet_8h_1a7e6c7ed74c23ace432476aa8a6841140" compoundref="packet_8c" startline="1761" endline="1843">ssh_packet_send</references>
        <references refid="priv_8h_1ae280c413c792e04237f000841ac8ce44" compoundref="priv_8h" startline="265">ssh_set_error_oom</references>
        <referencedby refid="legacy_8h_1a585680861c10be67d85437e6a04e662f" compoundref="legacy_8c" startline="280" endline="282">channel_send_eof</referencedby>
        <referencedby refid="default__cb_8c_1a1c4ec691e0189bd2ff9c7acd3399895b" compoundref="default__cb_8c" startline="783" endline="995">default_handle_session_cb</referencedby>
        <referencedby refid="test__exec_8c_1acbd4f6c4ecc68d1c4cc45223741be81c" compoundref="test__exec_8c" startline="10" endline="49">do_connect</referencedby>
        <referencedby refid="torture__server__auth__kbdint_8c_1a845bb2d262ac6cb3c7acfaeb394641ee" compoundref="torture__server__auth__kbdint_8c" startline="333" endline="515">handle_kbdint_session_cb</referencedby>
        <referencedby refid="ssh__server__fork_8c_1a2094e558ae17a16e444d40f575063102" compoundref="ssh__server__fork_8c" startline="536" endline="679">handle_session</referencedby>
        <referencedby refid="exec_8c_1a840291bc02cba5474a4cb46a9b9566fe" compoundref="exec_8c" startline="7" endline="66">main</referencedby>
        <referencedby refid="sshd__direct-tcpip_8c_1acb2eaf207c01cc503bec863448734a4f" compoundref="sshd__direct-tcpip_8c" startline="295" endline="388">my_fd_data_function</referencedby>
        <referencedby refid="pkd__daemon_8c_1abe87875a523cecd013d848c7c9c5ba22" compoundref="pkd__daemon_8c" startline="238" endline="475">pkd_exec_hello</referencedby>
        <referencedby refid="sshnetcat_8c_1a38ba4d370f756491ce0d55e0c320d08b" compoundref="sshnetcat_8c" startline="77" endline="175">select_loop</referencedby>
        <referencedby refid="classssh_1_1Channel_1aba2abb07a061bb1c8509f159c284bc55" compoundref="libsshpp_8hpp" startline="624" endline="628">ssh::Channel::sendEof</referencedby>
        <referencedby refid="group__libssh__channel_1ga238f07e0455456a5bfd8a49ead917732" compoundref="channels_8c" startline="1285" endline="1336">ssh_channel_close</referencedby>
        <referencedby refid="connector_8c_1a4cc7de304441a1cdb59c3656ad1a1678" compoundref="connector_8c" startline="513" endline="563">ssh_connector_channel_write_wontblock_cb</referencedby>
        <referencedby refid="connector_8c_1a83806fe46fe887adb695eeca7f35682a" compoundref="connector_8c" startline="243" endline="322">ssh_connector_fd_in_cb</referencedby>
        <referencedby refid="group__libssh__scp_1ga14d31059dcf6fb2325fb960da8e4474e" compoundref="scp_8c" startline="241" endline="277">ssh_scp_close</referencedby>
        <referencedby refid="torture__forward_8c_1a8f1d1bddae7902259b1b169d0439fe2f" compoundref="torture__forward_8c" startline="78" endline="99">torture_ssh_forward</referencedby>
        <referencedby refid="bench__raw_8c_1ab14322fd9f96904e565cabfbe2b42a5e" compoundref="bench__raw_8c" startline="71" endline="97">upload_script</referencedby>
      </memberdef>
      <memberdef kind="function" id="group__libssh__channel_1ga238f07e0455456a5bfd8a49ead917732" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>int ssh_channel_close</definition>
        <argsstring>(ssh_channel channel)</argsstring>
        <name>ssh_channel_close</name>
        <param>
          <type><ref refid="libssh_8h_1aca32be8db7c865697a3de381dc7e9fc3" kindref="member">ssh_channel</ref></type>
          <declname>channel</declname>
        </param>
        <briefdescription>
<para>Close a channel. </para>
        </briefdescription>
        <detaileddescription>
<para>This sends an end of file and then closes the channel. You won&apos;t be able to recover any data the server was going to send or was in buffers.</para>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername direction="in">channel</parametername>
</parameternamelist>
<parameterdescription>
<para>The channel to close.</para>
</parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>SSH_OK on success, SSH_ERROR if an error occurred.</para>
</simplesect>
<simplesect kind="see"><para><ref refid="group__libssh__channel_1gad1417f9eae8928fed20faafe2d9dbfff" kindref="member">ssh_channel_free()</ref> </para>
</simplesect>
<simplesect kind="see"><para><ref refid="group__libssh__channel_1gab535264029443d77214c0615a0788b0a" kindref="member">ssh_channel_is_eof()</ref> </para>
</simplesect>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/channels.c" line="1285" column="5" bodyfile="src/channels.c" bodystart="1285" bodyend="1336"/>
        <references refid="proxy_8c_1a11614f44ef4d939bdd984953346a7572" compoundref="proxy_8c" startline="33">error</references>
        <references refid="structssh__channel__struct_1a400dc0c0dc7cd02daaea731825c1a7c4" compoundref="channels_8h" startline="75">ssh_channel_struct::flags</references>
        <references refid="structssh__channel__struct_1a39cdc105ee0bbd1b7faea169db30f0a1" compoundref="channels_8h" startline="64">ssh_channel_struct::local_channel</references>
        <references refid="structssh__session__struct_1af0aed60c1e529bbfdcb483fd80bf98a0" compoundref="session_8h" startline="140">ssh_session_struct::out_buffer</references>
        <references refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" compoundref="pkd__daemon_8c" startline="62">rc</references>
        <references refid="structssh__channel__struct_1aa553acf6d12fffb1ae18b11196c2c0e9" compoundref="channels_8h" startline="69">ssh_channel_struct::remote_channel</references>
        <references refid="structssh__channel__struct_1a0832dc830d09accd2f3a8f8349c3faf2" compoundref="channels_8h" startline="63">ssh_channel_struct::session</references>
        <references refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" compoundref="torture__session__keys_8c" startline="61">session</references>
        <references refid="ssh2_8h_1a8397a7ba3abc36c7866340f3c3fa80ee" compoundref="ssh2_8h" startline="52">SSH2_MSG_CHANNEL_CLOSE</references>
        <references refid="buffer_8h_1ae17848a86043f0abfc60c1c4f6126ccd" compoundref="buffer_8h" startline="49">ssh_buffer_pack</references>
        <references refid="libssh_8h_1ac8802ff7f5348d0145dab5242623f740">ssh_buffer_reinit</references>
        <references refid="channels_8h_1ad2f890619dac7055258ce90e9944b65f" compoundref="channels_8h" startline="54">SSH_CHANNEL_FLAG_CLOSED_LOCAL</references>
        <references refid="group__libssh__channel_1gae61fe034965d58e1fb6da1bee98de191" compoundref="channels_8c" startline="1372" endline="1374">ssh_channel_flush</references>
        <references refid="group__libssh__channel_1ga072f82fdf3e50514f747653af2c99004" compoundref="channels_8c" startline="1224" endline="1270">ssh_channel_send_eof</references>
        <references refid="channels_8h_1a5a002159e5db31d156bb2a8ce8a10cd1a96872cd3f6e98f6f040097e3ee6cb900" compoundref="channels_8h" startline="47">SSH_CHANNEL_STATE_CLOSED</references>
        <references refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" compoundref="libssh_8h" startline="330">SSH_ERROR</references>
        <references refid="priv_8h_1aa21fd8a7a609329603b7b16da7939fca" compoundref="priv_8h" startline="240">SSH_LOG</references>
        <references refid="group__libssh__log_1ggadf764cbdea00d65edcd07bb9953ad2b7a6445dfe21592d69d9741d319538b6673" compoundref="libssh_8h" startline="352">SSH_LOG_PACKET</references>
        <references refid="libssh_8h_1ac1ee1d1e917456d4760a94a18015377d" compoundref="libssh_8h" startline="329">SSH_OK</references>
        <references refid="packet_8h_1a7e6c7ed74c23ace432476aa8a6841140" compoundref="packet_8c" startline="1761" endline="1843">ssh_packet_send</references>
        <references refid="priv_8h_1ae280c413c792e04237f000841ac8ce44" compoundref="priv_8h" startline="265">ssh_set_error_oom</references>
        <references refid="structssh__channel__struct_1a272b198e279fa672afeaf9f2e610eb04" compoundref="channels_8h" startline="73">ssh_channel_struct::state</references>
        <referencedby refid="bench__raw_8c_1afd64b09e9ae3ce2136328be2cd0bac89" compoundref="bench__raw_8c" startline="227" endline="285">benchmarks_raw_down</referencedby>
        <referencedby refid="bench__raw_8c_1a070a579a7a62c222e5f28c9e074c0df7" compoundref="bench__raw_8c" startline="107" endline="182">benchmarks_raw_up</referencedby>
        <referencedby refid="benchmarks_8h_1a166dab0266f920174e138f1039ca1773" compoundref="latency_8c" startline="119" endline="148">benchmarks_ssh_latency</referencedby>
        <referencedby refid="legacy_8h_1a387f3a48de0524965c72137c6336b15d" compoundref="legacy_8c" startline="170" endline="172">channel_close</referencedby>
        <referencedby refid="classssh_1_1Channel_1a383618db99c0ccd5c33b5e7bcd992e80" compoundref="libsshpp_8hpp" startline="498" endline="501">ssh::Channel::close</referencedby>
        <referencedby refid="scp__download_8c_1abf8ad844320270e1c0b49e510c9bb4a0" compoundref="scp__download_8c" startline="61" endline="100">create_files</referencedby>
        <referencedby refid="default__cb_8c_1a1c4ec691e0189bd2ff9c7acd3399895b" compoundref="default__cb_8c" startline="783" endline="995">default_handle_session_cb</referencedby>
        <referencedby refid="sshd__direct-tcpip_8c_1a1d108777de8e248073f748300f01226c" compoundref="sshd__direct-tcpip_8c" startline="95" endline="132">do_cleanup</referencedby>
        <referencedby refid="test__exec_8c_1acbd4f6c4ecc68d1c4cc45223741be81c" compoundref="test__exec_8c" startline="10" endline="49">do_connect</referencedby>
        <referencedby refid="torture__server__auth__kbdint_8c_1a845bb2d262ac6cb3c7acfaeb394641ee" compoundref="torture__server__auth__kbdint_8c" startline="333" endline="515">handle_kbdint_session_cb</referencedby>
        <referencedby refid="ssh__server__fork_8c_1a2094e558ae17a16e444d40f575063102" compoundref="ssh__server__fork_8c" startline="536" endline="679">handle_session</referencedby>
        <referencedby refid="exec_8c_1a840291bc02cba5474a4cb46a9b9566fe" compoundref="exec_8c" startline="7" endline="66">main</referencedby>
        <referencedby refid="sshd__direct-tcpip_8c_1acb2eaf207c01cc503bec863448734a4f" compoundref="sshd__direct-tcpip_8c" startline="295" endline="388">my_fd_data_function</referencedby>
        <referencedby refid="pkd__daemon_8c_1abe87875a523cecd013d848c7c9c5ba22" compoundref="pkd__daemon_8c" startline="238" endline="475">pkd_exec_hello</referencedby>
        <referencedby refid="group__libssh__channel_1gad1417f9eae8928fed20faafe2d9dbfff" compoundref="channels_8c" startline="1123" endline="1167">ssh_channel_free</referencedby>
        <referencedby refid="group__libssh__scp_1ga14d31059dcf6fb2325fb960da8e4474e" compoundref="scp_8c" startline="241" endline="277">ssh_scp_close</referencedby>
        <referencedby refid="torture__request__env_8c_1af673d397cb089d358c279e3e6e082388" compoundref="torture__request__env_8c" startline="78" endline="118">torture_request_env</referencedby>
        <referencedby refid="torture__server_8c_1a65c15130edce6143731c7bff27153650" compoundref="torture__server_8c" startline="476" endline="518">torture_server_unknown_global_request</referencedby>
        <referencedby refid="torture__forward_8c_1a8f1d1bddae7902259b1b169d0439fe2f" compoundref="torture__forward_8c" startline="78" endline="99">torture_ssh_forward</referencedby>
        <referencedby refid="torture__client__global__requests_8c_1a32462a357527b0302ce677bab88c3cf2" compoundref="torture__client__global__requests_8c" startline="109" endline="135">torture_unknown_request</referencedby>
        <referencedby refid="bench__raw_8c_1ab14322fd9f96904e565cabfbe2b42a5e" compoundref="bench__raw_8c" startline="71" endline="97">upload_script</referencedby>
      </memberdef>
      <memberdef kind="function" id="group__libssh__channel_1gac85f6c47b96159e7e912f25c7ba5f2a1" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>static int ssh_channel_waitwindow_termination</definition>
        <argsstring>(void *c)</argsstring>
        <name>ssh_channel_waitwindow_termination</name>
        <param>
          <type>void *</type>
          <declname>c</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/channels.c" line="1339" column="12" bodyfile="src/channels.c" bodystart="1339" bodyend="1347"/>
        <references refid="structssh__channel__struct_1a1b5936420da03e6b64aa8f900eb8ad0c" compoundref="channels_8h" startline="70">ssh_channel_struct::remote_window</references>
        <references refid="structssh__channel__struct_1a0832dc830d09accd2f3a8f8349c3faf2" compoundref="channels_8h" startline="63">ssh_channel_struct::session</references>
        <references refid="structssh__session__struct_1a6f74d1a1eb6ed715b1073b67caa18460" compoundref="session_8h" startline="147">ssh_session_struct::session_state</references>
        <references refid="channels_8h_1a5a002159e5db31d156bb2a8ce8a10cd1a96872cd3f6e98f6f040097e3ee6cb900" compoundref="channels_8h" startline="47">SSH_CHANNEL_STATE_CLOSED</references>
        <references refid="session_8h_1a9bbd1d5ae11485e27279be6ad461992ca855474fc84a2fb170fcb72546af8eeb8" compoundref="session_8h" startline="46">SSH_SESSION_STATE_ERROR</references>
        <references refid="structssh__channel__struct_1a272b198e279fa672afeaf9f2e610eb04" compoundref="channels_8h" startline="73">ssh_channel_struct::state</references>
        <referencedby refid="group__libssh__channel_1ga918e9bde297309e977a872bc62c0d260" compoundref="channels_8c" startline="1376" endline="1517">channel_write_common</referencedby>
      </memberdef>
      <memberdef kind="function" id="group__libssh__channel_1gae8a61c46f07fc2b242a8b8cee0c50596" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>static int ssh_waitsession_unblocked</definition>
        <argsstring>(void *s)</argsstring>
        <name>ssh_waitsession_unblocked</name>
        <param>
          <type>void *</type>
          <declname>s</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/channels.c" line="1352" column="12" bodyfile="src/channels.c" bodystart="1352" bodyend="1362"/>
        <references refid="test__socket_8c_1a73991beba1accdcc64730cb00c146fe2" compoundref="test__socket_8c" startline="34">s</references>
        <references refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" compoundref="torture__session__keys_8c" startline="61">session</references>
        <references refid="structssh__session__struct_1a6f74d1a1eb6ed715b1073b67caa18460" compoundref="session_8h" startline="147">ssh_session_struct::session_state</references>
        <references refid="session_8h_1a9bbd1d5ae11485e27279be6ad461992ca1dcace0fedd97312d6829ecc526d3606" compoundref="session_8h" startline="43">SSH_SESSION_STATE_DH</references>
        <references refid="session_8h_1a9bbd1d5ae11485e27279be6ad461992ca64f98e48c54ec9ae09070b92c1f47659" compoundref="session_8h" startline="41">SSH_SESSION_STATE_INITIAL_KEX</references>
        <references refid="session_8h_1a9bbd1d5ae11485e27279be6ad461992ca336024640ab057d21d87ded010687dc7" compoundref="session_8h" startline="42">SSH_SESSION_STATE_KEXINIT_RECEIVED</references>
        <referencedby refid="group__libssh__channel_1ga918e9bde297309e977a872bc62c0d260" compoundref="channels_8c" startline="1376" endline="1517">channel_write_common</referencedby>
      </memberdef>
      <memberdef kind="function" id="group__libssh__channel_1gae61fe034965d58e1fb6da1bee98de191" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>int ssh_channel_flush</definition>
        <argsstring>(ssh_channel channel)</argsstring>
        <name>ssh_channel_flush</name>
        <param>
          <type><ref refid="libssh_8h_1aca32be8db7c865697a3de381dc7e9fc3" kindref="member">ssh_channel</ref></type>
          <declname>channel</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/channels.c" line="1372" column="5" bodyfile="src/channels.c" bodystart="1372" bodyend="1374"/>
        <references refid="structssh__channel__struct_1a0832dc830d09accd2f3a8f8349c3faf2" compoundref="channels_8h" startline="63">ssh_channel_struct::session</references>
        <references refid="group__libssh__session_1ga60da8e2c47897a209a455923c35d52d8" compoundref="session_8c" startline="523" endline="539">ssh_blocking_flush</references>
        <references refid="session_8h_1aa8c8d35c7f83d7b00218ebadfac2254b" compoundref="session_8h" startline="84">SSH_TIMEOUT_DEFAULT</references>
        <referencedby refid="group__libssh__channel_1ga918e9bde297309e977a872bc62c0d260" compoundref="channels_8c" startline="1376" endline="1517">channel_write_common</referencedby>
        <referencedby refid="group__libssh__channel_1ga238f07e0455456a5bfd8a49ead917732" compoundref="channels_8c" startline="1285" endline="1336">ssh_channel_close</referencedby>
        <referencedby refid="group__libssh__channel_1ga072f82fdf3e50514f747653af2c99004" compoundref="channels_8c" startline="1224" endline="1270">ssh_channel_send_eof</referencedby>
      </memberdef>
      <memberdef kind="function" id="group__libssh__channel_1ga918e9bde297309e977a872bc62c0d260" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>static int channel_write_common</definition>
        <argsstring>(ssh_channel channel, const void *data, uint32_t len, int is_stderr)</argsstring>
        <name>channel_write_common</name>
        <param>
          <type><ref refid="libssh_8h_1aca32be8db7c865697a3de381dc7e9fc3" kindref="member">ssh_channel</ref></type>
          <declname>channel</declname>
        </param>
        <param>
          <type>const void *</type>
          <declname>data</declname>
        </param>
        <param>
          <type>uint32_t</type>
          <declname>len</declname>
        </param>
        <param>
          <type>int</type>
          <declname>is_stderr</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/channels.c" line="1376" column="12" bodyfile="src/channels.c" bodystart="1376" bodyend="1517"/>
        <references refid="structssh__channel__struct_1ab1beeacd4aff735258cb7488c079c6dc" compoundref="channels_8h" startline="84">ssh_channel_struct::counter</references>
        <references refid="structssh__iterator_1a4cc4eb8c8599a487e7e3321d32a9e9cd" compoundref="misc_8h" startline="46">ssh_iterator::data</references>
        <references refid="structssh__channel__struct_1a23f4022c397cfd2cfc05a1358f8082f6" compoundref="channels_8h" startline="74">ssh_channel_struct::delayed_close</references>
        <references refid="proxy_8c_1a11614f44ef4d939bdd984953346a7572" compoundref="proxy_8c" startline="33">error</references>
        <references refid="structssh__channel__struct_1a39cdc105ee0bbd1b7faea169db30f0a1" compoundref="channels_8h" startline="64">ssh_channel_struct::local_channel</references>
        <references refid="structssh__channel__struct_1a84b4de0420fa99e2b0673d4b5eeb4875" compoundref="channels_8h" startline="66">ssh_channel_struct::local_eof</references>
        <references refid="priv_8h_1a3acffbd305ee72dcd4593c0d8af64a4f" compoundref="priv_8h" startline="306">MIN</references>
        <references refid="structssh__session__struct_1af0aed60c1e529bbfdcb483fd80bf98a0" compoundref="session_8h" startline="140">ssh_session_struct::out_buffer</references>
        <references refid="structssh__counter__struct_1a0fc155fa51fb41bc8011da0df017e182" compoundref="libssh_8h" startline="110">ssh_counter_struct::out_bytes</references>
        <references refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" compoundref="pkd__daemon_8c" startline="62">rc</references>
        <references refid="structssh__channel__struct_1aa553acf6d12fffb1ae18b11196c2c0e9" compoundref="channels_8h" startline="69">ssh_channel_struct::remote_channel</references>
        <references refid="structssh__channel__struct_1a748cbf4c5d3af22bd8e8fea69144128d" compoundref="channels_8h" startline="72">ssh_channel_struct::remote_maxpacket</references>
        <references refid="structssh__channel__struct_1a1b5936420da03e6b64aa8f900eb8ad0c" compoundref="channels_8h" startline="70">ssh_channel_struct::remote_window</references>
        <references refid="structssh__channel__struct_1a0832dc830d09accd2f3a8f8349c3faf2" compoundref="channels_8h" startline="63">ssh_channel_struct::session</references>
        <references refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" compoundref="torture__session__keys_8c" startline="61">session</references>
        <references refid="structssh__session__struct_1a6f74d1a1eb6ed715b1073b67caa18460" compoundref="session_8h" startline="147">ssh_session_struct::session_state</references>
        <references refid="ssh2_8h_1aa185eb435ac3cb25552c6c82112c979c" compoundref="ssh2_8h" startline="79">SSH2_EXTENDED_DATA_STDERR</references>
        <references refid="ssh2_8h_1ab4dc0d7b8a45a0f902a5332c6a7c2b35" compoundref="ssh2_8h" startline="49">SSH2_MSG_CHANNEL_DATA</references>
        <references refid="ssh2_8h_1a29768987bed67fbe3e7d537c5ee05f29" compoundref="ssh2_8h" startline="50">SSH2_MSG_CHANNEL_EXTENDED_DATA</references>
        <references refid="buffer_8h_1ae17848a86043f0abfc60c1c4f6126ccd" compoundref="buffer_8h" startline="49">ssh_buffer_pack</references>
        <references refid="libssh_8h_1ac8802ff7f5348d0145dab5242623f740">ssh_buffer_reinit</references>
        <references refid="group__libssh__channel_1gae61fe034965d58e1fb6da1bee98de191" compoundref="channels_8c" startline="1372" endline="1374">ssh_channel_flush</references>
        <references refid="channels_8h_1a5a002159e5db31d156bb2a8ce8a10cd1a96872cd3f6e98f6f040097e3ee6cb900" compoundref="channels_8h" startline="47">SSH_CHANNEL_STATE_CLOSED</references>
        <references refid="channels_8h_1a5a002159e5db31d156bb2a8ce8a10cd1a488a78707192c35250392423b5058e2b" compoundref="channels_8h" startline="46">SSH_CHANNEL_STATE_OPEN</references>
        <references refid="group__libssh__channel_1gac85f6c47b96159e7e912f25c7ba5f2a1" compoundref="channels_8c" startline="1339" endline="1347">ssh_channel_waitwindow_termination</references>
        <references refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" compoundref="libssh_8h" startline="330">SSH_ERROR</references>
        <references refid="group__libssh__session_1ga4b84e1ae757c0d4007a5eefdf4651694" compoundref="session_8c" startline="692" endline="740">ssh_handle_packets_termination</references>
        <references refid="priv_8h_1aa21fd8a7a609329603b7b16da7939fca" compoundref="priv_8h" startline="240">SSH_LOG</references>
        <references refid="group__libssh__log_1ggadf764cbdea00d65edcd07bb9953ad2b7a6445dfe21592d69d9741d319538b6673" compoundref="libssh_8h" startline="352">SSH_LOG_PACKET</references>
        <references refid="group__libssh__log_1ggadf764cbdea00d65edcd07bb9953ad2b7a75fa79e63947b66462db977d9b5ae27c" compoundref="libssh_8h" startline="349">SSH_LOG_PROTOCOL</references>
        <references refid="libssh_8h_1ac1ee1d1e917456d4760a94a18015377d" compoundref="libssh_8h" startline="329">SSH_OK</references>
        <references refid="packet_8h_1a7e6c7ed74c23ace432476aa8a6841140" compoundref="packet_8c" startline="1761" endline="1843">ssh_packet_send</references>
        <references refid="libssh_8h_1a036b2b00fb04337a4d06d719d1b62be1ad1339fb4b92a9d25bdb99df5de5c4f88" compoundref="libssh_8h" startline="285">SSH_REQUEST_DENIED</references>
        <references refid="session_8h_1a9bbd1d5ae11485e27279be6ad461992ca855474fc84a2fb170fcb72546af8eeb8" compoundref="session_8h" startline="46">SSH_SESSION_STATE_ERROR</references>
        <references refid="priv_8h_1a55177b3e8db90ca9adb435c44281963c" compoundref="priv_8h" startline="258">ssh_set_error</references>
        <references refid="priv_8h_1a351ea86857d33b3ba80b396e05c4517c" compoundref="priv_8h" startline="269">ssh_set_error_invalid</references>
        <references refid="priv_8h_1ae280c413c792e04237f000841ac8ce44" compoundref="priv_8h" startline="265">ssh_set_error_oom</references>
        <references refid="session_8h_1aa8c8d35c7f83d7b00218ebadfac2254b" compoundref="session_8h" startline="84">SSH_TIMEOUT_DEFAULT</references>
        <references refid="group__libssh__channel_1gae8a61c46f07fc2b242a8b8cee0c50596" compoundref="channels_8c" startline="1352" endline="1362">ssh_waitsession_unblocked</references>
        <references refid="structssh__channel__struct_1a272b198e279fa672afeaf9f2e610eb04" compoundref="channels_8h" startline="73">ssh_channel_struct::state</references>
        <referencedby refid="group__libssh__channel_1ga5d658df773ba854b35ff9f905341e2fb" compoundref="channels_8c" startline="1553" endline="1555">ssh_channel_write</referencedby>
        <referencedby refid="group__libssh__channel_1ga7ebd0ed490ee4485c6d5feb7d22bc162" compoundref="channels_8c" startline="3438" endline="3440">ssh_channel_write_stderr</referencedby>
      </memberdef>
      <memberdef kind="function" id="group__libssh__channel_1gadf53c5a5b501086af26d06cba3f1491f" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>uint32_t</type>
        <definition>uint32_t ssh_channel_window_size</definition>
        <argsstring>(ssh_channel channel)</argsstring>
        <name>ssh_channel_window_size</name>
        <param>
          <type><ref refid="libssh_8h_1aca32be8db7c865697a3de381dc7e9fc3" kindref="member">ssh_channel</ref></type>
          <declname>channel</declname>
        </param>
        <briefdescription>
<para>Get the remote window size. </para>
        </briefdescription>
        <detaileddescription>
<para>This is the maximum amounts of bytes the remote side expects us to send before growing the window again.</para>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername direction="in">channel</parametername>
</parameternamelist>
<parameterdescription>
<para>The channel to query.</para>
</parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>The remote window size</para>
</simplesect>
<simplesect kind="warning"><para>A nonzero return value does not guarantee the socket is ready to send that much data. Buffering may happen in the local SSH packet buffer, so beware of really big window sizes.</para>
</simplesect>
<simplesect kind="warning"><para>A zero return value means ssh_channel_write (default settings) will block until the window grows back. </para>
</simplesect>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/channels.c" line="1536" column="10" bodyfile="src/channels.c" bodystart="1536" bodyend="1538"/>
        <references refid="structssh__channel__struct_1a1b5936420da03e6b64aa8f900eb8ad0c" compoundref="channels_8h" startline="70">ssh_channel_struct::remote_window</references>
        <referencedby refid="connector_8c_1ad994e6c0acb9b1f2eab185da25fd46b8" compoundref="connector_8c" startline="424" endline="500">ssh_connector_channel_data_cb</referencedby>
        <referencedby refid="connector_8c_1a83806fe46fe887adb695eeca7f35682a" compoundref="connector_8c" startline="243" endline="322">ssh_connector_fd_in_cb</referencedby>
        <referencedby refid="priv_8h_1a84015bb99d7ac6fe60fe6e61dbd0e1cf" compoundref="connector_8c" startline="565" endline="628">ssh_connector_set_event</referencedby>
      </memberdef>
      <memberdef kind="function" id="group__libssh__channel_1ga5d658df773ba854b35ff9f905341e2fb" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>int ssh_channel_write</definition>
        <argsstring>(ssh_channel channel, const void *data, uint32_t len)</argsstring>
        <name>ssh_channel_write</name>
        <param>
          <type><ref refid="libssh_8h_1aca32be8db7c865697a3de381dc7e9fc3" kindref="member">ssh_channel</ref></type>
          <declname>channel</declname>
        </param>
        <param>
          <type>const void *</type>
          <declname>data</declname>
        </param>
        <param>
          <type>uint32_t</type>
          <declname>len</declname>
        </param>
        <briefdescription>
<para>Blocking write on a channel. </para>
        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername direction="in">channel</parametername>
</parameternamelist>
<parameterdescription>
<para>The channel to write to.</para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">data</parametername>
</parameternamelist>
<parameterdescription>
<para>A pointer to the data to write.</para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">len</parametername>
</parameternamelist>
<parameterdescription>
<para>The length of the buffer to write to.</para>
</parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>The number of bytes written, SSH_ERROR on error.</para>
</simplesect>
<simplesect kind="see"><para><ref refid="group__libssh__channel_1gac92381c4c5d4a7eab35f6e84686f033d" kindref="member">ssh_channel_read()</ref> </para>
</simplesect>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/channels.c" line="1553" column="5" bodyfile="src/channels.c" bodystart="1553" bodyend="1555"/>
        <references refid="group__libssh__channel_1ga918e9bde297309e977a872bc62c0d260" compoundref="channels_8c" startline="1376" endline="1517">channel_write_common</references>
        <references refid="structssh__iterator_1a4cc4eb8c8599a487e7e3321d32a9e9cd" compoundref="misc_8h" startline="46">ssh_iterator::data</references>
        <referencedby refid="agent_8c_1a5de461e227daa4f58be39d898ad861fb" compoundref="agent_8c" startline="66" endline="124">atomicio</referencedby>
        <referencedby refid="bench__raw_8c_1afd64b09e9ae3ce2136328be2cd0bac89" compoundref="bench__raw_8c" startline="227" endline="285">benchmarks_raw_down</referencedby>
        <referencedby refid="bench__raw_8c_1a070a579a7a62c222e5f28c9e074c0df7" compoundref="bench__raw_8c" startline="107" endline="182">benchmarks_raw_up</referencedby>
        <referencedby refid="legacy_8h_1aa63551016c6320da15686231171b04dc" compoundref="legacy_8c" startline="293" endline="295">channel_write</referencedby>
        <referencedby refid="test__tunnel_8c_1acbd4f6c4ecc68d1c4cc45223741be81c" compoundref="test__tunnel_8c" startline="10" endline="63">do_connect</referencedby>
        <referencedby refid="proxy_8c_1a3c04138a5bfe5d72780bb7e82a18e627" compoundref="proxy_8c" startline="215" endline="346">main</referencedby>
        <referencedby refid="sshd__direct-tcpip_8c_1acb2eaf207c01cc503bec863448734a4f" compoundref="sshd__direct-tcpip_8c" startline="295" endline="388">my_fd_data_function</referencedby>
        <referencedby refid="pkd__daemon_8c_1abe87875a523cecd013d848c7c9c5ba22" compoundref="pkd__daemon_8c" startline="238" endline="475">pkd_exec_hello</referencedby>
        <referencedby refid="ssh__server__fork_8c_1a23b914ec9abba5d8d17b30e5cee99174" compoundref="ssh__server__fork_8c" startline="506" endline="519">process_stdout</referencedby>
        <referencedby refid="sshnetcat_8c_1a38ba4d370f756491ce0d55e0c320d08b" compoundref="sshnetcat_8c" startline="77" endline="175">select_loop</referencedby>
        <referencedby refid="connector_8c_1ad994e6c0acb9b1f2eab185da25fd46b8" compoundref="connector_8c" startline="424" endline="500">ssh_connector_channel_data_cb</referencedby>
        <referencedby refid="connector_8c_1a4cc7de304441a1cdb59c3656ad1a1678" compoundref="connector_8c" startline="513" endline="563">ssh_connector_channel_write_wontblock_cb</referencedby>
        <referencedby refid="connector_8c_1a83806fe46fe887adb695eeca7f35682a" compoundref="connector_8c" startline="243" endline="322">ssh_connector_fd_in_cb</referencedby>
        <referencedby refid="group__libssh__scp_1gad3bb38b15f02597cc1e155c526a51e51" compoundref="scp_8c" startline="918" endline="944">ssh_scp_accept_request</referencedby>
        <referencedby refid="group__libssh__scp_1gad36438c6b1e235d96cec43ca350e9b4f" compoundref="scp_8c" startline="882" endline="907">ssh_scp_deny_request</referencedby>
        <referencedby refid="group__libssh__scp_1ga1db56dcb9dee01dd0b679b3b11151110" compoundref="scp_8c" startline="119" endline="230">ssh_scp_init</referencedby>
        <referencedby refid="group__libssh__scp_1ga2ca698c1e49612c083d9f8a72df52188" compoundref="scp_8c" startline="409" endline="436">ssh_scp_leave_directory</referencedby>
        <referencedby refid="group__libssh__scp_1gaba59cd8cc77d219cac93f865445c6e47" compoundref="scp_8c" startline="770" endline="869">ssh_scp_pull_request</referencedby>
        <referencedby refid="group__libssh__scp_1gaa584f03d4e3d582ac10a3a19818ec56d" compoundref="scp_8c" startline="320" endline="399">ssh_scp_push_directory</referencedby>
        <referencedby refid="group__libssh__scp_1ga50b701b9c8923011d4fc6489c9c7eaae" compoundref="scp_8c" startline="456" endline="540">ssh_scp_push_file64</referencedby>
        <referencedby refid="group__libssh__scp_1ga10bf627407959b51a7c39b37e8d46460" compoundref="scp_8c" startline="956" endline="1014">ssh_scp_read</referencedby>
        <referencedby refid="group__libssh__scp_1ga11f48e2cf62bcec20d9232ed3ca41752" compoundref="scp_8c" startline="642" endline="702">ssh_scp_write</referencedby>
        <referencedby refid="bench__raw_8c_1ab14322fd9f96904e565cabfbe2b42a5e" compoundref="bench__raw_8c" startline="71" endline="97">upload_script</referencedby>
        <referencedby refid="classssh_1_1Channel_1a06cf7ffd971eff87783a169444fa09a2" compoundref="libsshpp_8hpp" startline="638" endline="647">ssh::Channel::write</referencedby>
      </memberdef>
      <memberdef kind="function" id="group__libssh__channel_1gaaafcda943c96ddb91e5c28c0bdee7045" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>int ssh_channel_is_open</definition>
        <argsstring>(ssh_channel channel)</argsstring>
        <name>ssh_channel_is_open</name>
        <param>
          <type><ref refid="libssh_8h_1aca32be8db7c865697a3de381dc7e9fc3" kindref="member">ssh_channel</ref></type>
          <declname>channel</declname>
        </param>
        <briefdescription>
<para>Check if the channel is open or not. </para>
        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername direction="in">channel</parametername>
</parameternamelist>
<parameterdescription>
<para>The channel to check.</para>
</parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>0 if channel is closed, nonzero otherwise.</para>
</simplesect>
<simplesect kind="see"><para><ref refid="group__libssh__channel_1gab2720b44cb7f1dfe2b38ffe07c2f45c7" kindref="member">ssh_channel_is_closed()</ref> </para>
</simplesect>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/channels.c" line="1566" column="5" bodyfile="src/channels.c" bodystart="1566" bodyend="1571"/>
        <references refid="structssh__session__struct_1a729d3c7f6ae20cb5a00ac7cd28a630f7" compoundref="session_8h" startline="124">ssh_session_struct::alive</references>
        <references refid="structssh__channel__struct_1a0832dc830d09accd2f3a8f8349c3faf2" compoundref="channels_8h" startline="63">ssh_channel_struct::session</references>
        <references refid="channels_8h_1a5a002159e5db31d156bb2a8ce8a10cd1a488a78707192c35250392423b5058e2b" compoundref="channels_8h" startline="46">SSH_CHANNEL_STATE_OPEN</references>
        <references refid="structssh__channel__struct_1a272b198e279fa672afeaf9f2e610eb04" compoundref="channels_8h" startline="73">ssh_channel_struct::state</references>
        <referencedby refid="legacy_8h_1a830009e0bcdfe3c5bd59bfb790691bb2" compoundref="legacy_8c" startline="203" endline="205">channel_is_open</referencedby>
        <referencedby refid="group__libssh__channel_1ga3a106d0c860b8ada098b4ed317c3cce4" compoundref="channels_8c" startline="3204" endline="3250">channel_protocol_select</referencedby>
        <referencedby refid="default__cb_8c_1a1c4ec691e0189bd2ff9c7acd3399895b" compoundref="default__cb_8c" startline="783" endline="995">default_handle_session_cb</referencedby>
        <referencedby refid="torture__server__auth__kbdint_8c_1a845bb2d262ac6cb3c7acfaeb394641ee" compoundref="torture__server__auth__kbdint_8c" startline="333" endline="515">handle_kbdint_session_cb</referencedby>
        <referencedby refid="ssh__server__fork_8c_1a2094e558ae17a16e444d40f575063102" compoundref="ssh__server__fork_8c" startline="536" endline="679">handle_session</referencedby>
        <referencedby refid="classssh_1_1Channel_1aa2794c09f819f3132b241aa6b72b0664" compoundref="libsshpp_8hpp" startline="524" endline="526">ssh::Channel::isOpen</referencedby>
        <referencedby refid="sshd__direct-tcpip_8c_1acb2eaf207c01cc503bec863448734a4f" compoundref="sshd__direct-tcpip_8c" startline="295" endline="388">my_fd_data_function</referencedby>
        <referencedby refid="ssh__client_8c_1a38ba4d370f756491ce0d55e0c320d08b" compoundref="ssh__client_8c" startline="198" endline="242">select_loop</referencedby>
      </memberdef>
      <memberdef kind="function" id="group__libssh__channel_1gab2720b44cb7f1dfe2b38ffe07c2f45c7" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>int ssh_channel_is_closed</definition>
        <argsstring>(ssh_channel channel)</argsstring>
        <name>ssh_channel_is_closed</name>
        <param>
          <type><ref refid="libssh_8h_1aca32be8db7c865697a3de381dc7e9fc3" kindref="member">ssh_channel</ref></type>
          <declname>channel</declname>
        </param>
        <briefdescription>
<para>Check if the channel is closed or not. </para>
        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername direction="in">channel</parametername>
</parameternamelist>
<parameterdescription>
<para>The channel to check.</para>
</parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>0 if channel is opened, nonzero otherwise.</para>
</simplesect>
<simplesect kind="see"><para><ref refid="group__libssh__channel_1gaaafcda943c96ddb91e5c28c0bdee7045" kindref="member">ssh_channel_is_open()</ref> </para>
</simplesect>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/channels.c" line="1582" column="5" bodyfile="src/channels.c" bodystart="1582" bodyend="1587"/>
        <references refid="structssh__session__struct_1a729d3c7f6ae20cb5a00ac7cd28a630f7" compoundref="session_8h" startline="124">ssh_session_struct::alive</references>
        <references refid="structssh__channel__struct_1a0832dc830d09accd2f3a8f8349c3faf2" compoundref="channels_8h" startline="63">ssh_channel_struct::session</references>
        <references refid="channels_8h_1a5a002159e5db31d156bb2a8ce8a10cd1a488a78707192c35250392423b5058e2b" compoundref="channels_8h" startline="46">SSH_CHANNEL_STATE_OPEN</references>
        <references refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" compoundref="libssh_8h" startline="330">SSH_ERROR</references>
        <references refid="structssh__channel__struct_1a272b198e279fa672afeaf9f2e610eb04" compoundref="channels_8h" startline="73">ssh_channel_struct::state</references>
        <referencedby refid="legacy_8h_1a2300f6de96227361aadbf48303aca375" compoundref="legacy_8c" startline="195" endline="197">channel_is_closed</referencedby>
        <referencedby refid="group__libssh__channel_1ga3a106d0c860b8ada098b4ed317c3cce4" compoundref="channels_8c" startline="3204" endline="3250">channel_protocol_select</referencedby>
        <referencedby refid="sshd__direct-tcpip_8c_1a1d108777de8e248073f748300f01226c" compoundref="sshd__direct-tcpip_8c" startline="95" endline="132">do_cleanup</referencedby>
        <referencedby refid="classssh_1_1Channel_1a38880d18d0fc357be0f4f8b8ef1c92ef" compoundref="libsshpp_8hpp" startline="512" endline="514">ssh::Channel::isClosed</referencedby>
        <referencedby refid="sshd__direct-tcpip_8c_1acb2eaf207c01cc503bec863448734a4f" compoundref="sshd__direct-tcpip_8c" startline="295" endline="388">my_fd_data_function</referencedby>
        <referencedby refid="sshnetcat_8c_1a38ba4d370f756491ce0d55e0c320d08b" compoundref="sshnetcat_8c" startline="77" endline="175">select_loop</referencedby>
      </memberdef>
      <memberdef kind="function" id="group__libssh__channel_1gab535264029443d77214c0615a0788b0a" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>int ssh_channel_is_eof</definition>
        <argsstring>(ssh_channel channel)</argsstring>
        <name>ssh_channel_is_eof</name>
        <param>
          <type><ref refid="libssh_8h_1aca32be8db7c865697a3de381dc7e9fc3" kindref="member">ssh_channel</ref></type>
          <declname>channel</declname>
        </param>
        <briefdescription>
<para>Check if remote has sent an EOF. </para>
        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername direction="in">channel</parametername>
</parameternamelist>
<parameterdescription>
<para>The channel to check.</para>
</parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>0 if there is no EOF, nonzero otherwise. </para>
</simplesect>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/channels.c" line="1596" column="5" bodyfile="src/channels.c" bodystart="1596" bodyend="1608"/>
        <references refid="structssh__channel__struct_1a01fee161bb195c61e434e9bc7b330187" compoundref="channels_8h" startline="71">ssh_channel_struct::remote_eof</references>
        <references refid="libssh_8h_1a61400c7267feb254046cd606a3fdfdbc">ssh_buffer_get_len</references>
        <references refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" compoundref="libssh_8h" startline="330">SSH_ERROR</references>
        <references refid="structssh__channel__struct_1a6806319dfa8f417bbad93f6481ad99d4" compoundref="channels_8h" startline="77">ssh_channel_struct::stderr_buffer</references>
        <references refid="structssh__channel__struct_1a8ae1473aafd716256ce762d0115b2321" compoundref="channels_8h" startline="76">ssh_channel_struct::stdout_buffer</references>
        <referencedby refid="legacy_8h_1aa7e0fa823cdee290c27a42d138f367a1" compoundref="legacy_8c" startline="199" endline="201">channel_is_eof</referencedby>
        <referencedby refid="group__libssh__channel_1gab391f5c978cb1bc8df3ebd061f38e8c5" compoundref="channels_8c" startline="2731" endline="2790">channel_read_buffer</referencedby>
        <referencedby refid="scp__download_8c_1abf8ad844320270e1c0b49e510c9bb4a0" compoundref="scp__download_8c" startline="61" endline="100">create_files</referencedby>
        <referencedby refid="classssh_1_1Channel_1a3bb4131d82cc033d75f65a5137053532" compoundref="libsshpp_8hpp" startline="518" endline="520">ssh::Channel::isEof</referencedby>
        <referencedby refid="connector_8c_1a4cc7de304441a1cdb59c3656ad1a1678" compoundref="connector_8c" startline="513" endline="563">ssh_connector_channel_write_wontblock_cb</referencedby>
        <referencedby refid="connector_8c_1ad13c8d29eb297a425c51a53379450dd1" compoundref="connector_8c" startline="327" endline="370">ssh_connector_fd_out_cb</referencedby>
        <referencedby refid="group__libssh__scp_1ga14d31059dcf6fb2325fb960da8e4474e" compoundref="scp_8c" startline="241" endline="277">ssh_scp_close</referencedby>
        <referencedby refid="group__libssh__scp_1gaba59cd8cc77d219cac93f865445c6e47" compoundref="scp_8c" startline="770" endline="869">ssh_scp_pull_request</referencedby>
      </memberdef>
      <memberdef kind="function" id="group__libssh__channel_1ga1c00ed18679d9a8c5b971260b5df13a2" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void ssh_channel_set_blocking</definition>
        <argsstring>(ssh_channel channel, int blocking)</argsstring>
        <name>ssh_channel_set_blocking</name>
        <param>
          <type><ref refid="libssh_8h_1aca32be8db7c865697a3de381dc7e9fc3" kindref="member">ssh_channel</ref></type>
          <declname>channel</declname>
        </param>
        <param>
          <type>int</type>
          <declname>blocking</declname>
        </param>
        <briefdescription>
<para>Put the channel into blocking or nonblocking mode. </para>
        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername direction="in">channel</parametername>
</parameternamelist>
<parameterdescription>
<para>The channel to use.</para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">blocking</parametername>
</parameternamelist>
<parameterdescription>
<para>A boolean for blocking or nonblocking.</para>
</parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="warning"><para>A side-effect of this is to put the whole session in non-blocking mode. </para>
</simplesect>
<simplesect kind="see"><para><ref refid="group__libssh__session_1ga2a29cff08855611be84d050e5bec73bc" kindref="member">ssh_set_blocking()</ref> </para>
</simplesect>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/channels.c" line="1621" column="6" bodyfile="src/channels.c" bodystart="1621" bodyend="1626"/>
        <references refid="structssh__channel__struct_1a0832dc830d09accd2f3a8f8349c3faf2" compoundref="channels_8h" startline="63">ssh_channel_struct::session</references>
        <references refid="group__libssh__session_1ga2a29cff08855611be84d050e5bec73bc" compoundref="session_8c" startline="482" endline="489">ssh_set_blocking</references>
        <referencedby refid="legacy_8h_1a1295f8fc2862c6f7af3c95075ce8e0f8" compoundref="legacy_8c" startline="289" endline="291">channel_set_blocking</referencedby>
      </memberdef>
      <memberdef kind="function" id="group__libssh__channel_1ga198e96d111ee3dd2a0551fe10bd3ce16" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type></type>
        <definition>SSH_PACKET_CALLBACK</definition>
        <argsstring>(ssh_packet_channel_success)</argsstring>
        <name>SSH_PACKET_CALLBACK</name>
        <param>
          <type>ssh_packet_channel_success</type>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/channels.c" line="1633" column="1" bodyfile="src/channels.c" bodystart="1633" bodyend="1656"/>
        <references refid="group__libssh__channel_1ga41254c9dd24ac1ae9ad9c0edd3825dee" compoundref="channels_8c" startline="455" endline="475">channel_from_msg</references>
        <references refid="structssh__channel__struct_1a39cdc105ee0bbd1b7faea169db30f0a1" compoundref="channels_8h" startline="64">ssh_channel_struct::local_channel</references>
        <references refid="structssh__channel__struct_1aa553acf6d12fffb1ae18b11196c2c0e9" compoundref="channels_8h" startline="69">ssh_channel_struct::remote_channel</references>
        <references refid="structssh__channel__struct_1a25a8d874fbdccd50ecfff837ef69bad2" compoundref="channels_8h" startline="80">ssh_channel_struct::request_state</references>
        <references refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" compoundref="torture__session__keys_8c" startline="61">session</references>
        <references refid="channels_8h_1a774597eb1605e8b48cd065965fdc2325a4054be6a6327c97579cb9dce89c90590" compoundref="channels_8h" startline="35">SSH_CHANNEL_REQ_STATE_ACCEPTED</references>
        <references refid="channels_8h_1a774597eb1605e8b48cd065965fdc2325a1229a4614fb5d58a7bcd4d6b0bd4816e" compoundref="channels_8h" startline="33">SSH_CHANNEL_REQ_STATE_PENDING</references>
        <references refid="group__libssh__error_1ga9241586665bf21f823806473fc386258" compoundref="error_8c" startline="128" endline="132">ssh_get_error</references>
        <references refid="priv_8h_1aa21fd8a7a609329603b7b16da7939fca" compoundref="priv_8h" startline="240">SSH_LOG</references>
        <references refid="group__libssh__log_1ggadf764cbdea00d65edcd07bb9953ad2b7a926c933f61d1afa64003c1cc66f6a01c" compoundref="libssh_8h" startline="355">SSH_LOG_FUNCTIONS</references>
        <references refid="group__libssh__log_1ggadf764cbdea00d65edcd07bb9953ad2b7a6445dfe21592d69d9741d319538b6673" compoundref="libssh_8h" startline="352">SSH_LOG_PACKET</references>
        <references refid="libssh_8h_1a1c08cc9177a5598e0675abfb833d2993" compoundref="libssh_8h" startline="358">SSH_LOG_RARE</references>
        <references refid="group__libssh__callbacks_1gac29df803aa1295d6a498c1b081f3b494" compoundref="callbacks_8h" startline="517">SSH_PACKET_USED</references>
        <references refid="ssh__client_8c_1a14871705f45ccdc5bb9f4549efd8e119" compoundref="ssh__client_8c" startline="48">user</references>
      </memberdef>
      <memberdef kind="function" id="group__libssh__channel_1gad05566d70f79b960a8ffdddbd65600cb" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type></type>
        <definition>SSH_PACKET_CALLBACK</definition>
        <argsstring>(ssh_packet_channel_failure)</argsstring>
        <name>SSH_PACKET_CALLBACK</name>
        <param>
          <type>ssh_packet_channel_failure</type>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/channels.c" line="1663" column="1" bodyfile="src/channels.c" bodystart="1663" bodyend="1687"/>
        <references refid="group__libssh__channel_1ga41254c9dd24ac1ae9ad9c0edd3825dee" compoundref="channels_8c" startline="455" endline="475">channel_from_msg</references>
        <references refid="structssh__channel__struct_1a39cdc105ee0bbd1b7faea169db30f0a1" compoundref="channels_8h" startline="64">ssh_channel_struct::local_channel</references>
        <references refid="structssh__channel__struct_1aa553acf6d12fffb1ae18b11196c2c0e9" compoundref="channels_8h" startline="69">ssh_channel_struct::remote_channel</references>
        <references refid="structssh__channel__struct_1a25a8d874fbdccd50ecfff837ef69bad2" compoundref="channels_8h" startline="80">ssh_channel_struct::request_state</references>
        <references refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" compoundref="torture__session__keys_8c" startline="61">session</references>
        <references refid="channels_8h_1a774597eb1605e8b48cd065965fdc2325a4947de111ac917be11de88f4e9147d14" compoundref="channels_8h" startline="37">SSH_CHANNEL_REQ_STATE_DENIED</references>
        <references refid="channels_8h_1a774597eb1605e8b48cd065965fdc2325a1229a4614fb5d58a7bcd4d6b0bd4816e" compoundref="channels_8h" startline="33">SSH_CHANNEL_REQ_STATE_PENDING</references>
        <references refid="group__libssh__error_1ga9241586665bf21f823806473fc386258" compoundref="error_8c" startline="128" endline="132">ssh_get_error</references>
        <references refid="priv_8h_1aa21fd8a7a609329603b7b16da7939fca" compoundref="priv_8h" startline="240">SSH_LOG</references>
        <references refid="group__libssh__log_1ggadf764cbdea00d65edcd07bb9953ad2b7a926c933f61d1afa64003c1cc66f6a01c" compoundref="libssh_8h" startline="355">SSH_LOG_FUNCTIONS</references>
        <references refid="group__libssh__log_1ggadf764cbdea00d65edcd07bb9953ad2b7a6445dfe21592d69d9741d319538b6673" compoundref="libssh_8h" startline="352">SSH_LOG_PACKET</references>
        <references refid="libssh_8h_1a1c08cc9177a5598e0675abfb833d2993" compoundref="libssh_8h" startline="358">SSH_LOG_RARE</references>
        <references refid="group__libssh__callbacks_1gac29df803aa1295d6a498c1b081f3b494" compoundref="callbacks_8h" startline="517">SSH_PACKET_USED</references>
        <references refid="ssh__client_8c_1a14871705f45ccdc5bb9f4549efd8e119" compoundref="ssh__client_8c" startline="48">user</references>
      </memberdef>
      <memberdef kind="function" id="group__libssh__channel_1gae3eefab282bb408e096fdeeeba676618" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>static int ssh_channel_request_termination</definition>
        <argsstring>(void *c)</argsstring>
        <name>ssh_channel_request_termination</name>
        <param>
          <type>void *</type>
          <declname>c</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/channels.c" line="1689" column="12" bodyfile="src/channels.c" bodystart="1689" bodyend="1696"/>
        <references refid="structssh__channel__struct_1a25a8d874fbdccd50ecfff837ef69bad2" compoundref="channels_8h" startline="80">ssh_channel_struct::request_state</references>
        <references refid="structssh__channel__struct_1a0832dc830d09accd2f3a8f8349c3faf2" compoundref="channels_8h" startline="63">ssh_channel_struct::session</references>
        <references refid="structssh__session__struct_1a6f74d1a1eb6ed715b1073b67caa18460" compoundref="session_8h" startline="147">ssh_session_struct::session_state</references>
        <references refid="channels_8h_1a774597eb1605e8b48cd065965fdc2325a1229a4614fb5d58a7bcd4d6b0bd4816e" compoundref="channels_8h" startline="33">SSH_CHANNEL_REQ_STATE_PENDING</references>
        <references refid="session_8h_1a9bbd1d5ae11485e27279be6ad461992ca855474fc84a2fb170fcb72546af8eeb8" compoundref="session_8h" startline="46">SSH_SESSION_STATE_ERROR</references>
        <referencedby refid="group__libssh__channel_1gaee35ccabe6998568d138d35f538765d9" compoundref="channels_8c" startline="1698" endline="1780">channel_request</referencedby>
      </memberdef>
      <memberdef kind="function" id="group__libssh__channel_1gaee35ccabe6998568d138d35f538765d9" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>static int channel_request</definition>
        <argsstring>(ssh_channel channel, const char *request, ssh_buffer buffer, int reply)</argsstring>
        <name>channel_request</name>
        <param>
          <type><ref refid="libssh_8h_1aca32be8db7c865697a3de381dc7e9fc3" kindref="member">ssh_channel</ref></type>
          <declname>channel</declname>
        </param>
        <param>
          <type>const char *</type>
          <declname>request</declname>
        </param>
        <param>
          <type><ref refid="libssh_8h_1ac91852b0afd5138f36e09ef59af8e52b" kindref="member">ssh_buffer</ref></type>
          <declname>buffer</declname>
        </param>
        <param>
          <type>int</type>
          <declname>reply</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/channels.c" line="1698" column="12" bodyfile="src/channels.c" bodystart="1698" bodyend="1780"/>
        <references refid="benchmarks_8c_1aff2566f4c366b48d73479bef43ee4d2e" compoundref="benchmarks_8c" startline="347">buffer</references>
        <references refid="proxy_8c_1a11614f44ef4d939bdd984953346a7572" compoundref="proxy_8c" startline="33">error</references>
        <references refid="structssh__session__struct_1af0aed60c1e529bbfdcb483fd80bf98a0" compoundref="session_8h" startline="140">ssh_session_struct::out_buffer</references>
        <references refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" compoundref="pkd__daemon_8c" startline="62">rc</references>
        <references refid="structssh__channel__struct_1aa553acf6d12fffb1ae18b11196c2c0e9" compoundref="channels_8h" startline="69">ssh_channel_struct::remote_channel</references>
        <references refid="structssh__channel__struct_1a25a8d874fbdccd50ecfff837ef69bad2" compoundref="channels_8h" startline="80">ssh_channel_struct::request_state</references>
        <references refid="structssh__channel__struct_1a0832dc830d09accd2f3a8f8349c3faf2" compoundref="channels_8h" startline="63">ssh_channel_struct::session</references>
        <references refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" compoundref="torture__session__keys_8c" startline="61">session</references>
        <references refid="structssh__session__struct_1a6f74d1a1eb6ed715b1073b67caa18460" compoundref="session_8h" startline="147">ssh_session_struct::session_state</references>
        <references refid="ssh2_8h_1a553c9488e17f091fa39dd01f7abc48d8" compoundref="ssh2_8h" startline="53">SSH2_MSG_CHANNEL_REQUEST</references>
        <references refid="libssh_8h_1a9c57e4f6482106336045a4d25a55f28e" compoundref="libssh_8h" startline="331">SSH_AGAIN</references>
        <references refid="libssh_8h_1a92d37237bf129961367accd4a9e0dcfc">ssh_buffer_add_data</references>
        <references refid="libssh_8h_1a240b02fb7c0475fbb5996d1f759221ee">ssh_buffer_get</references>
        <references refid="libssh_8h_1a61400c7267feb254046cd606a3fdfdbc">ssh_buffer_get_len</references>
        <references refid="buffer_8h_1ae17848a86043f0abfc60c1c4f6126ccd" compoundref="buffer_8h" startline="49">ssh_buffer_pack</references>
        <references refid="libssh_8h_1ac8802ff7f5348d0145dab5242623f740">ssh_buffer_reinit</references>
        <references refid="channels_8h_1a774597eb1605e8b48cd065965fdc2325a4054be6a6327c97579cb9dce89c90590" compoundref="channels_8h" startline="35">SSH_CHANNEL_REQ_STATE_ACCEPTED</references>
        <references refid="channels_8h_1a774597eb1605e8b48cd065965fdc2325a4947de111ac917be11de88f4e9147d14" compoundref="channels_8h" startline="37">SSH_CHANNEL_REQ_STATE_DENIED</references>
        <references refid="channels_8h_1a774597eb1605e8b48cd065965fdc2325a7d2c1ea4f49536c9bea8c1187d950378" compoundref="channels_8h" startline="39">SSH_CHANNEL_REQ_STATE_ERROR</references>
        <references refid="channels_8h_1a774597eb1605e8b48cd065965fdc2325a98c7a3dcf02759118261e2bac4d6e421" compoundref="channels_8h" startline="31">SSH_CHANNEL_REQ_STATE_NONE</references>
        <references refid="channels_8h_1a774597eb1605e8b48cd065965fdc2325a1229a4614fb5d58a7bcd4d6b0bd4816e" compoundref="channels_8h" startline="33">SSH_CHANNEL_REQ_STATE_PENDING</references>
        <references refid="group__libssh__channel_1gae3eefab282bb408e096fdeeeba676618" compoundref="channels_8c" startline="1689" endline="1696">ssh_channel_request_termination</references>
        <references refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" compoundref="libssh_8h" startline="330">SSH_ERROR</references>
        <references refid="libssh_8h_1a036b2b00fb04337a4d06d719d1b62be1a86ff0b2e8da6ad8628efc556b6ce1887" compoundref="libssh_8h" startline="286">SSH_FATAL</references>
        <references refid="group__libssh__session_1ga4b84e1ae757c0d4007a5eefdf4651694" compoundref="session_8c" startline="692" endline="740">ssh_handle_packets_termination</references>
        <references refid="priv_8h_1aa21fd8a7a609329603b7b16da7939fca" compoundref="priv_8h" startline="240">SSH_LOG</references>
        <references refid="group__libssh__log_1ggadf764cbdea00d65edcd07bb9953ad2b7a6445dfe21592d69d9741d319538b6673" compoundref="libssh_8h" startline="352">SSH_LOG_PACKET</references>
        <references refid="group__libssh__log_1ggadf764cbdea00d65edcd07bb9953ad2b7a75fa79e63947b66462db977d9b5ae27c" compoundref="libssh_8h" startline="349">SSH_LOG_PROTOCOL</references>
        <references refid="libssh_8h_1ac1ee1d1e917456d4760a94a18015377d" compoundref="libssh_8h" startline="329">SSH_OK</references>
        <references refid="packet_8h_1a7e6c7ed74c23ace432476aa8a6841140" compoundref="packet_8c" startline="1761" endline="1843">ssh_packet_send</references>
        <references refid="libssh_8h_1a036b2b00fb04337a4d06d719d1b62be1ad1339fb4b92a9d25bdb99df5de5c4f88" compoundref="libssh_8h" startline="285">SSH_REQUEST_DENIED</references>
        <references refid="session_8h_1a9bbd1d5ae11485e27279be6ad461992ca855474fc84a2fb170fcb72546af8eeb8" compoundref="session_8h" startline="46">SSH_SESSION_STATE_ERROR</references>
        <references refid="priv_8h_1a55177b3e8db90ca9adb435c44281963c" compoundref="priv_8h" startline="258">ssh_set_error</references>
        <references refid="priv_8h_1ae280c413c792e04237f000841ac8ce44" compoundref="priv_8h" startline="265">ssh_set_error_oom</references>
        <references refid="session_8h_1aa8c8d35c7f83d7b00218ebadfac2254b" compoundref="session_8h" startline="84">SSH_TIMEOUT_DEFAULT</references>
        <referencedby refid="group__libssh__channel_1gaf5d55c90f3d98c583df23d21905c1127" compoundref="channels_8c" startline="1880" endline="1907">ssh_channel_change_pty_size</referencedby>
        <referencedby refid="group__libssh__channel_1gab2e28b520b8f8fe5ff5626de2a4113d9" compoundref="channels_8c" startline="2173" endline="2179">ssh_channel_request_auth_agent</referencedby>
        <referencedby refid="group__libssh__channel_1ga7aede2f9af4c494ff9e41fc08a4572f1" compoundref="channels_8c" startline="2498" endline="2535">ssh_channel_request_env</referencedby>
        <referencedby refid="group__libssh__channel_1ga567d509183ade0a77190f390e2b5747d" compoundref="channels_8c" startline="2568" endline="2603">ssh_channel_request_exec</referencedby>
        <referencedby refid="group__libssh__channel_1gabb175414352256e1602286e0ab50886c" compoundref="channels_8c" startline="1798" endline="1847">ssh_channel_request_pty_size</referencedby>
        <referencedby refid="group__libssh__channel_1gaef198ad0dcf0968aa2a449c8898d985e" compoundref="channels_8c" startline="2684" endline="2709">ssh_channel_request_send_break</referencedby>
        <referencedby refid="group__libssh__channel_1gaa98315fca818b561970a6950683f4053" compoundref="channels_8c" startline="2638" endline="2666">ssh_channel_request_send_signal</referencedby>
        <referencedby refid="group__libssh__channel_1gaed4c5fb30c9df2b2548421ccf4e81bf1" compoundref="channels_8c" startline="1919" endline="1925">ssh_channel_request_shell</referencedby>
        <referencedby refid="group__libssh__channel_1ga06024b070f9b2a3d6964b79ae36695b7" compoundref="channels_8c" startline="1941" endline="1976">ssh_channel_request_subsystem</referencedby>
        <referencedby refid="group__libssh__channel_1gadfa34624c28164bd73453cd04aa64c1f" compoundref="channels_8c" startline="2042" endline="2091">ssh_channel_request_x11</referencedby>
      </memberdef>
      <memberdef kind="function" id="group__libssh__channel_1gabb175414352256e1602286e0ab50886c" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>int ssh_channel_request_pty_size</definition>
        <argsstring>(ssh_channel channel, const char *terminal, int col, int row)</argsstring>
        <name>ssh_channel_request_pty_size</name>
        <param>
          <type><ref refid="libssh_8h_1aca32be8db7c865697a3de381dc7e9fc3" kindref="member">ssh_channel</ref></type>
          <declname>channel</declname>
        </param>
        <param>
          <type>const char *</type>
          <declname>terminal</declname>
        </param>
        <param>
          <type>int</type>
          <declname>col</declname>
        </param>
        <param>
          <type>int</type>
          <declname>row</declname>
        </param>
        <briefdescription>
<para>Request a pty with a specific type and size. </para>
        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername direction="in">channel</parametername>
</parameternamelist>
<parameterdescription>
<para>The channel to sent the request.</para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">terminal</parametername>
</parameternamelist>
<parameterdescription>
<para>The terminal type (&quot;vt100, xterm,...&quot;).</para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">col</parametername>
</parameternamelist>
<parameterdescription>
<para>The number of columns.</para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">row</parametername>
</parameternamelist>
<parameterdescription>
<para>The number of rows.</para>
</parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>SSH_OK on success, SSH_ERROR if an error occurred, SSH_AGAIN if in nonblocking mode and call has to be done again. </para>
</simplesect>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/channels.c" line="1798" column="5" bodyfile="src/channels.c" bodystart="1798" bodyend="1847"/>
        <references refid="benchmarks_8c_1aff2566f4c366b48d73479bef43ee4d2e" compoundref="benchmarks_8c" startline="347">buffer</references>
        <references refid="group__libssh__channel_1gaee35ccabe6998568d138d35f538765d9" compoundref="channels_8c" startline="1698" endline="1780">channel_request</references>
        <references refid="proxy_8c_1a11614f44ef4d939bdd984953346a7572" compoundref="proxy_8c" startline="33">error</references>
        <references refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" compoundref="pkd__daemon_8c" startline="62">rc</references>
        <references refid="structssh__channel__struct_1a25a8d874fbdccd50ecfff837ef69bad2" compoundref="channels_8h" startline="80">ssh_channel_struct::request_state</references>
        <references refid="structssh__channel__struct_1a0832dc830d09accd2f3a8f8349c3faf2" compoundref="channels_8h" startline="63">ssh_channel_struct::session</references>
        <references refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" compoundref="torture__session__keys_8c" startline="61">session</references>
        <references refid="libssh_8h_1a8b09f7d6f7066de7ef8dab4ed7494a52" compoundref="libssh_8h" startline="828">SSH_BUFFER_FREE</references>
        <references refid="group__libssh__buffer_1ga7ecc914104a5bf0da485d3e42f6a7d3b" compoundref="buffer_8c" startline="119" endline="142">ssh_buffer_new</references>
        <references refid="buffer_8h_1ae17848a86043f0abfc60c1c4f6126ccd" compoundref="buffer_8h" startline="49">ssh_buffer_pack</references>
        <references refid="channels_8h_1a774597eb1605e8b48cd065965fdc2325a98c7a3dcf02759118261e2bac4d6e421" compoundref="channels_8h" startline="31">SSH_CHANNEL_REQ_STATE_NONE</references>
        <references refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" compoundref="libssh_8h" startline="330">SSH_ERROR</references>
        <references refid="libssh_8h_1ac1ee1d1e917456d4760a94a18015377d" compoundref="libssh_8h" startline="329">SSH_OK</references>
        <references refid="priv_8h_1a351ea86857d33b3ba80b396e05c4517c" compoundref="priv_8h" startline="269">ssh_set_error_invalid</references>
        <references refid="priv_8h_1ae280c413c792e04237f000841ac8ce44" compoundref="priv_8h" startline="265">ssh_set_error_oom</references>
        <references refid="ssh__client_8c_1a029e0d76938d65623721b901853405a4" compoundref="ssh__client_8c" startline="50">terminal</references>
        <referencedby refid="legacy_8h_1a35980d2509e83eb98a63bee2a7da31fd" compoundref="legacy_8c" startline="253" endline="256">channel_request_pty_size</referencedby>
        <referencedby refid="classssh_1_1Channel_1aa0598bb62bba61428d2785a4e92b0b70" compoundref="libsshpp_8hpp" startline="592" endline="600">ssh::Channel::requestPty</referencedby>
        <referencedby refid="group__libssh__channel_1ga37c1cec33fe5a2f184768aba52e3a0db" compoundref="channels_8c" startline="1861" endline="1863">ssh_channel_request_pty</referencedby>
      </memberdef>
      <memberdef kind="function" id="group__libssh__channel_1ga37c1cec33fe5a2f184768aba52e3a0db" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>int ssh_channel_request_pty</definition>
        <argsstring>(ssh_channel channel)</argsstring>
        <name>ssh_channel_request_pty</name>
        <param>
          <type><ref refid="libssh_8h_1aca32be8db7c865697a3de381dc7e9fc3" kindref="member">ssh_channel</ref></type>
          <declname>channel</declname>
        </param>
        <briefdescription>
<para>Request a PTY. </para>
        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername direction="in">channel</parametername>
</parameternamelist>
<parameterdescription>
<para>The channel to send the request.</para>
</parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>SSH_OK on success, SSH_ERROR if an error occurred, SSH_AGAIN if in nonblocking mode and call has to be done again.</para>
</simplesect>
<simplesect kind="see"><para><ref refid="group__libssh__channel_1gabb175414352256e1602286e0ab50886c" kindref="member">ssh_channel_request_pty_size()</ref> </para>
</simplesect>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/channels.c" line="1861" column="5" bodyfile="src/channels.c" bodystart="1861" bodyend="1863"/>
        <references refid="group__libssh__channel_1gabb175414352256e1602286e0ab50886c" compoundref="channels_8c" startline="1798" endline="1847">ssh_channel_request_pty_size</references>
        <referencedby refid="legacy_8h_1a33f40b7f8a1d8805458dea3c0e552686" compoundref="legacy_8c" startline="249" endline="251">channel_request_pty</referencedby>
        <referencedby refid="classssh_1_1Channel_1aa0598bb62bba61428d2785a4e92b0b70" compoundref="libsshpp_8hpp" startline="592" endline="600">ssh::Channel::requestPty</referencedby>
        <referencedby refid="ssh__client_8c_1a9aee67bdbbcaaca080f23c622d7d38d9" compoundref="ssh__client_8c" startline="244" endline="288">shell</referencedby>
      </memberdef>
      <memberdef kind="function" id="group__libssh__channel_1gaf5d55c90f3d98c583df23d21905c1127" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>int ssh_channel_change_pty_size</definition>
        <argsstring>(ssh_channel channel, int cols, int rows)</argsstring>
        <name>ssh_channel_change_pty_size</name>
        <param>
          <type><ref refid="libssh_8h_1aca32be8db7c865697a3de381dc7e9fc3" kindref="member">ssh_channel</ref></type>
          <declname>channel</declname>
        </param>
        <param>
          <type>int</type>
          <declname>cols</declname>
        </param>
        <param>
          <type>int</type>
          <declname>rows</declname>
        </param>
        <briefdescription>
<para>Change the size of the terminal associated to a channel. </para>
        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername direction="in">channel</parametername>
</parameternamelist>
<parameterdescription>
<para>The channel to change the size.</para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">cols</parametername>
</parameternamelist>
<parameterdescription>
<para>The new number of columns.</para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">rows</parametername>
</parameternamelist>
<parameterdescription>
<para>The new number of rows.</para>
</parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>SSH_OK on success, SSH_ERROR if an error occurred.</para>
</simplesect>
<simplesect kind="warning"><para>Do not call it from a signal handler if you are not sure any other libssh function using the same channel/session is running at same time (not 100% threadsafe). </para>
</simplesect>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/channels.c" line="1880" column="5" bodyfile="src/channels.c" bodystart="1880" bodyend="1907"/>
        <references refid="benchmarks_8c_1aff2566f4c366b48d73479bef43ee4d2e" compoundref="benchmarks_8c" startline="347">buffer</references>
        <references refid="group__libssh__channel_1gaee35ccabe6998568d138d35f538765d9" compoundref="channels_8c" startline="1698" endline="1780">channel_request</references>
        <references refid="proxy_8c_1a11614f44ef4d939bdd984953346a7572" compoundref="proxy_8c" startline="33">error</references>
        <references refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" compoundref="pkd__daemon_8c" startline="62">rc</references>
        <references refid="structssh__channel__struct_1a0832dc830d09accd2f3a8f8349c3faf2" compoundref="channels_8h" startline="63">ssh_channel_struct::session</references>
        <references refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" compoundref="torture__session__keys_8c" startline="61">session</references>
        <references refid="libssh_8h_1a8b09f7d6f7066de7ef8dab4ed7494a52" compoundref="libssh_8h" startline="828">SSH_BUFFER_FREE</references>
        <references refid="group__libssh__buffer_1ga7ecc914104a5bf0da485d3e42f6a7d3b" compoundref="buffer_8c" startline="119" endline="142">ssh_buffer_new</references>
        <references refid="buffer_8h_1ae17848a86043f0abfc60c1c4f6126ccd" compoundref="buffer_8h" startline="49">ssh_buffer_pack</references>
        <references refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" compoundref="libssh_8h" startline="330">SSH_ERROR</references>
        <references refid="libssh_8h_1ac1ee1d1e917456d4760a94a18015377d" compoundref="libssh_8h" startline="329">SSH_OK</references>
        <references refid="priv_8h_1ae280c413c792e04237f000841ac8ce44" compoundref="priv_8h" startline="265">ssh_set_error_oom</references>
        <referencedby refid="classssh_1_1Channel_1a3adc48275cf34d211fb18514288f7c6f" compoundref="libsshpp_8hpp" startline="488" endline="492">ssh::Channel::changePtySize</referencedby>
        <referencedby refid="legacy_8h_1a9f4f8bf6d4530c665f51b6123adbc768" compoundref="legacy_8c" startline="162" endline="164">channel_change_pty_size</referencedby>
        <referencedby refid="ssh__client_8c_1ad1cebb7dc5f06fe1b835f9f90003c7da" compoundref="ssh__client_8c" startline="187" endline="196">sizechanged</referencedby>
      </memberdef>
      <memberdef kind="function" id="group__libssh__channel_1gaed4c5fb30c9df2b2548421ccf4e81bf1" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>int ssh_channel_request_shell</definition>
        <argsstring>(ssh_channel channel)</argsstring>
        <name>ssh_channel_request_shell</name>
        <param>
          <type><ref refid="libssh_8h_1aca32be8db7c865697a3de381dc7e9fc3" kindref="member">ssh_channel</ref></type>
          <declname>channel</declname>
        </param>
        <briefdescription>
<para>Request a shell. </para>
        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername direction="in">channel</parametername>
</parameternamelist>
<parameterdescription>
<para>The channel to send the request.</para>
</parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>SSH_OK on success, SSH_ERROR if an error occurred, SSH_AGAIN if in nonblocking mode and call has to be done again. </para>
</simplesect>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/channels.c" line="1919" column="5" bodyfile="src/channels.c" bodystart="1919" bodyend="1925"/>
        <references refid="group__libssh__channel_1gaee35ccabe6998568d138d35f538765d9" compoundref="channels_8c" startline="1698" endline="1780">channel_request</references>
        <references refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" compoundref="libssh_8h" startline="330">SSH_ERROR</references>
        <referencedby refid="legacy_8h_1aa719eb08ef28098f5375e0856846e47c" compoundref="legacy_8c" startline="258" endline="260">channel_request_shell</referencedby>
        <referencedby refid="classssh_1_1Channel_1a72bc638030fc1ffce0319fb037d8bfcb" compoundref="libsshpp_8hpp" startline="602" endline="606">ssh::Channel::requestShell</referencedby>
        <referencedby refid="ssh__client_8c_1a9aee67bdbbcaaca080f23c622d7d38d9" compoundref="ssh__client_8c" startline="244" endline="288">shell</referencedby>
      </memberdef>
      <memberdef kind="function" id="group__libssh__channel_1ga06024b070f9b2a3d6964b79ae36695b7" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>int ssh_channel_request_subsystem</definition>
        <argsstring>(ssh_channel channel, const char *subsys)</argsstring>
        <name>ssh_channel_request_subsystem</name>
        <param>
          <type><ref refid="libssh_8h_1aca32be8db7c865697a3de381dc7e9fc3" kindref="member">ssh_channel</ref></type>
          <declname>channel</declname>
        </param>
        <param>
          <type>const char *</type>
          <declname>subsys</declname>
        </param>
        <briefdescription>
<para>Request a subsystem (for example &quot;sftp&quot;). </para>
        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername direction="in">channel</parametername>
</parameternamelist>
<parameterdescription>
<para>The channel to send the request.</para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">subsys</parametername>
</parameternamelist>
<parameterdescription>
<para>The subsystem to request (for example &quot;sftp&quot;).</para>
</parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>SSH_OK on success, SSH_ERROR if an error occurred, SSH_AGAIN if in nonblocking mode and call has to be done again.</para>
</simplesect>
<simplesect kind="warning"><para>You normally don&apos;t have to call it for sftp, see <ref refid="group__libssh__sftp_1gae84eeb5a1af9d49db10f17a060151e97" kindref="member">sftp_new()</ref>. </para>
</simplesect>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/channels.c" line="1941" column="5" bodyfile="src/channels.c" bodystart="1941" bodyend="1976"/>
        <references refid="benchmarks_8c_1aff2566f4c366b48d73479bef43ee4d2e" compoundref="benchmarks_8c" startline="347">buffer</references>
        <references refid="group__libssh__channel_1gaee35ccabe6998568d138d35f538765d9" compoundref="channels_8c" startline="1698" endline="1780">channel_request</references>
        <references refid="proxy_8c_1a11614f44ef4d939bdd984953346a7572" compoundref="proxy_8c" startline="33">error</references>
        <references refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" compoundref="pkd__daemon_8c" startline="62">rc</references>
        <references refid="structssh__channel__struct_1a25a8d874fbdccd50ecfff837ef69bad2" compoundref="channels_8h" startline="80">ssh_channel_struct::request_state</references>
        <references refid="structssh__channel__struct_1a0832dc830d09accd2f3a8f8349c3faf2" compoundref="channels_8h" startline="63">ssh_channel_struct::session</references>
        <references refid="libssh_8h_1a8b09f7d6f7066de7ef8dab4ed7494a52" compoundref="libssh_8h" startline="828">SSH_BUFFER_FREE</references>
        <references refid="group__libssh__buffer_1ga7ecc914104a5bf0da485d3e42f6a7d3b" compoundref="buffer_8c" startline="119" endline="142">ssh_buffer_new</references>
        <references refid="buffer_8h_1ae17848a86043f0abfc60c1c4f6126ccd" compoundref="buffer_8h" startline="49">ssh_buffer_pack</references>
        <references refid="channels_8h_1a774597eb1605e8b48cd065965fdc2325a98c7a3dcf02759118261e2bac4d6e421" compoundref="channels_8h" startline="31">SSH_CHANNEL_REQ_STATE_NONE</references>
        <references refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" compoundref="libssh_8h" startline="330">SSH_ERROR</references>
        <references refid="libssh_8h_1ac1ee1d1e917456d4760a94a18015377d" compoundref="libssh_8h" startline="329">SSH_OK</references>
        <references refid="priv_8h_1a351ea86857d33b3ba80b396e05c4517c" compoundref="priv_8h" startline="269">ssh_set_error_invalid</references>
        <references refid="priv_8h_1ae280c413c792e04237f000841ac8ce44" compoundref="priv_8h" startline="265">ssh_set_error_oom</references>
        <referencedby refid="legacy_8h_1ad2ebb0a2fc0c97b9aea146bfcdbb9d59" compoundref="legacy_8c" startline="270" endline="272">channel_request_subsystem</referencedby>
        <referencedby refid="classssh_1_1Channel_1afb6dc7a15ec6e68c8cfd12b66273260f" compoundref="libsshpp_8hpp" startline="612" endline="616">ssh::Channel::requestSubsystem</referencedby>
        <referencedby refid="group__libssh__channel_1ga3d2a402cddd799036006294eb61649fe" compoundref="channels_8c" startline="1990" endline="1995">ssh_channel_request_sftp</referencedby>
      </memberdef>
      <memberdef kind="function" id="group__libssh__channel_1ga3d2a402cddd799036006294eb61649fe" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>int ssh_channel_request_sftp</definition>
        <argsstring>(ssh_channel channel)</argsstring>
        <name>ssh_channel_request_sftp</name>
        <param>
          <type><ref refid="libssh_8h_1aca32be8db7c865697a3de381dc7e9fc3" kindref="member">ssh_channel</ref></type>
          <declname>channel</declname>
        </param>
        <briefdescription>
<para>Request sftp subsystem on the channel. </para>
        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername direction="in">channel</parametername>
</parameternamelist>
<parameterdescription>
<para>The channel to request the sftp subsystem.</para>
</parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>SSH_OK on success, SSH_ERROR if an error occurred, SSH_AGAIN if in nonblocking mode and call has to be done again.</para>
</simplesect>
<simplesect kind="note"><para>You should use <ref refid="group__libssh__sftp_1gae84eeb5a1af9d49db10f17a060151e97" kindref="member">sftp_new()</ref> which does this for you. </para>
</simplesect>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/channels.c" line="1990" column="5" bodyfile="src/channels.c" bodystart="1990" bodyend="1995"/>
        <references refid="group__libssh__channel_1ga06024b070f9b2a3d6964b79ae36695b7" compoundref="channels_8c" startline="1941" endline="1976">ssh_channel_request_subsystem</references>
        <references refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" compoundref="libssh_8h" startline="330">SSH_ERROR</references>
        <referencedby refid="legacy_8h_1a23fbf7f07b79fe685282b513d8e6a6f0" compoundref="legacy_8c" startline="266" endline="268">channel_request_sftp</referencedby>
      </memberdef>
      <memberdef kind="function" id="group__libssh__channel_1gad14fc6d15d825654af4312764a970d04" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>char *</type>
        <definition>static char* generate_cookie</definition>
        <argsstring>(void)</argsstring>
        <name>generate_cookie</name>
        <param>
          <type>void</type>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/channels.c" line="1997" column="13" bodyfile="src/channels.c" bodystart="1997" bodyend="2015"/>
        <references refid="test__socket_8c_1a73991beba1accdcc64730cb00c146fe2" compoundref="test__socket_8c" startline="34">s</references>
        <references refid="libssh_8h_1aa04e01bdb1b607b705233a5d3587ae11">ssh_get_random</references>
        <referencedby refid="group__libssh__channel_1gadfa34624c28164bd73453cd04aa64c1f" compoundref="channels_8c" startline="2042" endline="2091">ssh_channel_request_x11</referencedby>
      </memberdef>
      <memberdef kind="function" id="group__libssh__channel_1gadfa34624c28164bd73453cd04aa64c1f" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>int ssh_channel_request_x11</definition>
        <argsstring>(ssh_channel channel, int single_connection, const char *protocol, const char *cookie, int screen_number)</argsstring>
        <name>ssh_channel_request_x11</name>
        <param>
          <type><ref refid="libssh_8h_1aca32be8db7c865697a3de381dc7e9fc3" kindref="member">ssh_channel</ref></type>
          <declname>channel</declname>
        </param>
        <param>
          <type>int</type>
          <declname>single_connection</declname>
        </param>
        <param>
          <type>const char *</type>
          <declname>protocol</declname>
        </param>
        <param>
          <type>const char *</type>
          <declname>cookie</declname>
        </param>
        <param>
          <type>int</type>
          <declname>screen_number</declname>
        </param>
        <briefdescription>
<para>Sends the &quot;x11-req&quot; channel request over an existing session channel. </para>
        </briefdescription>
        <detaileddescription>
<para>This will enable redirecting the display of the remote X11 applications to local X server over an secure tunnel.</para>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername direction="in">channel</parametername>
</parameternamelist>
<parameterdescription>
<para>An existing session channel where the remote X11 applications are going to be executed.</para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">single_connection</parametername>
</parameternamelist>
<parameterdescription>
<para>A boolean to mark only one X11 app will be redirected.</para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">protocol</parametername>
</parameternamelist>
<parameterdescription>
<para>A x11 authentication protocol. Pass NULL to use the default value MIT-MAGIC-COOKIE-1.</para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">cookie</parametername>
</parameternamelist>
<parameterdescription>
<para>A x11 authentication cookie. Pass NULL to generate a random cookie.</para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">screen_number</parametername>
</parameternamelist>
<parameterdescription>
<para>The screen number.</para>
</parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>SSH_OK on success, SSH_ERROR if an error occurred, SSH_AGAIN if in nonblocking mode and call has to be done again. </para>
</simplesect>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/channels.c" line="2042" column="5" bodyfile="src/channels.c" bodystart="2042" bodyend="2091"/>
        <references refid="benchmarks_8c_1aff2566f4c366b48d73479bef43ee4d2e" compoundref="benchmarks_8c" startline="347">buffer</references>
        <references refid="group__libssh__channel_1gaee35ccabe6998568d138d35f538765d9" compoundref="channels_8c" startline="1698" endline="1780">channel_request</references>
        <references refid="proxy_8c_1a11614f44ef4d939bdd984953346a7572" compoundref="proxy_8c" startline="33">error</references>
        <references refid="group__libssh__channel_1gad14fc6d15d825654af4312764a970d04" compoundref="channels_8c" startline="1997" endline="2015">generate_cookie</references>
        <references refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" compoundref="pkd__daemon_8c" startline="62">rc</references>
        <references refid="structssh__channel__struct_1a25a8d874fbdccd50ecfff837ef69bad2" compoundref="channels_8h" startline="80">ssh_channel_struct::request_state</references>
        <references refid="sshd__direct-tcpip_8c_1aed3129b7674034c979192bcca6b0ad8c" compoundref="sshd__direct-tcpip_8c" startline="36">SAFE_FREE</references>
        <references refid="structssh__channel__struct_1a0832dc830d09accd2f3a8f8349c3faf2" compoundref="channels_8h" startline="63">ssh_channel_struct::session</references>
        <references refid="libssh_8h_1a8b09f7d6f7066de7ef8dab4ed7494a52" compoundref="libssh_8h" startline="828">SSH_BUFFER_FREE</references>
        <references refid="group__libssh__buffer_1ga7ecc914104a5bf0da485d3e42f6a7d3b" compoundref="buffer_8c" startline="119" endline="142">ssh_buffer_new</references>
        <references refid="buffer_8h_1ae17848a86043f0abfc60c1c4f6126ccd" compoundref="buffer_8h" startline="49">ssh_buffer_pack</references>
        <references refid="channels_8h_1a774597eb1605e8b48cd065965fdc2325a98c7a3dcf02759118261e2bac4d6e421" compoundref="channels_8h" startline="31">SSH_CHANNEL_REQ_STATE_NONE</references>
        <references refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" compoundref="libssh_8h" startline="330">SSH_ERROR</references>
        <references refid="libssh_8h_1ac1ee1d1e917456d4760a94a18015377d" compoundref="libssh_8h" startline="329">SSH_OK</references>
        <references refid="priv_8h_1ae280c413c792e04237f000841ac8ce44" compoundref="priv_8h" startline="265">ssh_set_error_oom</references>
        <referencedby refid="legacy_8h_1a23133ef471db542be0b37c4782f4921e" compoundref="legacy_8c" startline="274" endline="278">channel_request_x11</referencedby>
        <referencedby refid="torture__server__x11_8c_1abb575a0d8644debf193b257c748c0ce1" compoundref="torture__server__x11_8c" startline="69" endline="96">client_thread</referencedby>
        <referencedby refid="classssh_1_1Channel_1a7421cfbdc01d05f999a55e05af9a593c" compoundref="libsshpp_8hpp" startline="617" endline="623">ssh::Channel::requestX11</referencedby>
      </memberdef>
      <memberdef kind="function" id="group__libssh__channel_1gac43bae56048b912205d102249b436eec" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="libssh_8h_1aca32be8db7c865697a3de381dc7e9fc3" kindref="member">ssh_channel</ref></type>
        <definition>static ssh_channel ssh_channel_accept</definition>
        <argsstring>(ssh_session session, int channeltype, int timeout_ms, int *destination_port)</argsstring>
        <name>ssh_channel_accept</name>
        <param>
          <type><ref refid="libssh_8h_1a02d3754de040612632cdd499c20f92f6" kindref="member">ssh_session</ref></type>
          <declname>session</declname>
        </param>
        <param>
          <type>int</type>
          <declname>channeltype</declname>
        </param>
        <param>
          <type>int</type>
          <declname>timeout_ms</declname>
        </param>
        <param>
          <type>int *</type>
          <declname>destination_port</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/channels.c" line="2093" column="20" bodyfile="src/channels.c" bodystart="2093" bodyend="2146"/>
        <references refid="structssh__message__struct_1a7579d1e2cd4136f2e152985d0018777f" compoundref="messages_8h" startline="88">ssh_message_struct::channel_request_open</references>
        <references refid="structssh__iterator_1a4cc4eb8c8599a487e7e3321d32a9e9cd" compoundref="misc_8h" startline="46">ssh_iterator::data</references>
        <references refid="structssh__channel__request__open_1a855a0ab9192961301638a007eed1a2ba" compoundref="messages_8h" startline="43">ssh_channel_request_open::destination_port</references>
        <references refid="doc_2CMakeLists_8txt_1a8ac464f14522528c145064f01020e23e" compoundref="doc_2CMakeLists_8txt" startline="4" endline="9">if</references>
        <references refid="structssh__iterator_1a7fd7219325e56f365796ad59c8443ee5" compoundref="misc_8h" startline="45">ssh_iterator::next</references>
        <references refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" compoundref="torture__session__keys_8c" startline="61">session</references>
        <references refid="group__libssh__session_1gaa0e04dc9e24d5112a5ca2b7bd68031d0" compoundref="session_8c" startline="633" endline="665">ssh_handle_packets</references>
        <references refid="group__libssh__misc_1gad36d247bfcae7965d6aca8245d061e0d" compoundref="misc_8c" startline="682" endline="686">ssh_list_get_iterator</references>
        <references refid="group__libssh__misc_1gac862429660a1f93dcf625d08f407b85e" compoundref="misc_8c" startline="771" endline="798">ssh_list_remove</references>
        <references refid="group__libssh__messages_1gaf9afe350861a5085901b37c5ff9b7702" compoundref="messages_8c" startline="1289" endline="1308">ssh_message_channel_request_open_reply_accept</references>
        <references refid="group__libssh__messages_1ga9d1b1d2279c6be3539f2b630960759c3" compoundref="messages_8c" startline="582" endline="637">ssh_message_free</references>
        <references refid="structssh__session__struct_1ac18fe9d39a3b73274e03ca0e2ae55db2" compoundref="session_8h" startline="195">ssh_session_struct::ssh_message_list</references>
        <references refid="group__libssh__messages_1ga7aa19d51c443b779fe454f0be3c666d4" compoundref="messages_8c" startline="558" endline="575">ssh_message_subtype</references>
        <references refid="group__libssh__messages_1ga20fc6e536f170b98c7d62ce3675d8cdb" compoundref="messages_8c" startline="543" endline="549">ssh_message_type</references>
        <references refid="libssh_8h_1a036b2b00fb04337a4d06d719d1b62be1ac3aceef794ead7991dc7a2d0cf93f5c5" compoundref="libssh_8h" startline="284">SSH_NO_ERROR</references>
        <references refid="libssh_8h_1a9484ca6b9fd0460e31a80fb8d0e81da6a55349816be9b38f7187447782dcd8d06" compoundref="libssh_8h" startline="182">SSH_REQUEST_CHANNEL_OPEN</references>
        <references refid="priv_8h_1a55177b3e8db90ca9adb435c44281963c" compoundref="priv_8h" startline="258">ssh_set_error</references>
        <referencedby refid="group__libssh__channel_1ga490e4b0a7adc022507b7f165b336afe4" compoundref="channels_8c" startline="2428" endline="2430">ssh_channel_accept_forward</referencedby>
        <referencedby refid="group__libssh__channel_1ga548bd0f77a50b7c8180942544b375866" compoundref="channels_8c" startline="2158" endline="2160">ssh_channel_accept_x11</referencedby>
        <referencedby refid="group__libssh__channel_1ga205d5ea76fb140075ebb1c20b8f193d3" compoundref="channels_8c" startline="2412" endline="2414">ssh_forward_accept</referencedby>
      </memberdef>
      <memberdef kind="function" id="group__libssh__channel_1ga548bd0f77a50b7c8180942544b375866" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="libssh_8h_1aca32be8db7c865697a3de381dc7e9fc3" kindref="member">ssh_channel</ref></type>
        <definition>ssh_channel ssh_channel_accept_x11</definition>
        <argsstring>(ssh_channel channel, int timeout_ms)</argsstring>
        <name>ssh_channel_accept_x11</name>
        <param>
          <type><ref refid="libssh_8h_1aca32be8db7c865697a3de381dc7e9fc3" kindref="member">ssh_channel</ref></type>
          <declname>channel</declname>
        </param>
        <param>
          <type>int</type>
          <declname>timeout_ms</declname>
        </param>
        <briefdescription>
<para>Accept an X11 forwarding channel. </para>
        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername direction="in">channel</parametername>
</parameternamelist>
<parameterdescription>
<para>An x11-enabled session channel.</para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">timeout_ms</parametername>
</parameternamelist>
<parameterdescription>
<para>Timeout in milliseconds.</para>
</parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>A newly created channel, or NULL if no X11 request from the server. </para>
</simplesect>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/channels.c" line="2158" column="13" bodyfile="src/channels.c" bodystart="2158" bodyend="2160"/>
        <references refid="structssh__channel__struct_1a0832dc830d09accd2f3a8f8349c3faf2" compoundref="channels_8h" startline="63">ssh_channel_struct::session</references>
        <references refid="group__libssh__channel_1gac43bae56048b912205d102249b436eec" compoundref="channels_8c" startline="2093" endline="2146">ssh_channel_accept</references>
        <references refid="libssh_8h_1acc2732b8c54002b0031fa1e40ee60b24aeae4049d38c91066926580f9cbefb3b5" compoundref="libssh_8h" startline="193">SSH_CHANNEL_X11</references>
        <referencedby refid="classssh_1_1Channel_1a62000c16999e74525d296f0a1cb19c95" compoundref="libsshpp_8hpp" startline="476" endline="481">ssh::Channel::acceptX11</referencedby>
        <referencedby refid="legacy_8h_1a0272d0fd1b1de952cd74a95bfc0773a2" compoundref="legacy_8c" startline="158" endline="160">channel_accept_x11</referencedby>
      </memberdef>
      <memberdef kind="function" id="group__libssh__channel_1gab2e28b520b8f8fe5ff5626de2a4113d9" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>int ssh_channel_request_auth_agent</definition>
        <argsstring>(ssh_channel channel)</argsstring>
        <name>ssh_channel_request_auth_agent</name>
        <param>
          <type><ref refid="libssh_8h_1aca32be8db7c865697a3de381dc7e9fc3" kindref="member">ssh_channel</ref></type>
          <declname>channel</declname>
        </param>
        <briefdescription>
<para>Send an &quot;auth-agent-req&quot; channel request over an existing session channel. </para>
        </briefdescription>
        <detaileddescription>
<para>This client-side request will enable forwarding the agent over an secure tunnel. When the server is ready to open one authentication agent channel, an ssh_channel_open_request_auth_agent_callback event will be generated.</para>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername direction="in">channel</parametername>
</parameternamelist>
<parameterdescription>
<para>The channel to send signal.</para>
</parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>SSH_OK on success, SSH_ERROR if an error occurred </para>
</simplesect>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/channels.c" line="2173" column="5" bodyfile="src/channels.c" bodystart="2173" bodyend="2179"/>
        <references refid="group__libssh__channel_1gaee35ccabe6998568d138d35f538765d9" compoundref="channels_8c" startline="1698" endline="1780">channel_request</references>
        <references refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" compoundref="libssh_8h" startline="330">SSH_ERROR</references>
      </memberdef>
      <memberdef kind="function" id="group__libssh__channel_1gadf43d7b10268fb16127d1dc441bbd226" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type></type>
        <definition>SSH_PACKET_CALLBACK</definition>
        <argsstring>(ssh_request_success)</argsstring>
        <name>SSH_PACKET_CALLBACK</name>
        <param>
          <type>ssh_request_success</type>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/channels.c" line="2187" column="1" bodyfile="src/channels.c" bodystart="2187" bodyend="2202"/>
        <references refid="structssh__session__struct_1a70a72ecdca89309b5a19e8c887f2ca2c" compoundref="session_8h" startline="150">ssh_session_struct::global_req_state</references>
        <references refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" compoundref="torture__session__keys_8c" startline="61">session</references>
        <references refid="channels_8h_1a774597eb1605e8b48cd065965fdc2325a4054be6a6327c97579cb9dce89c90590" compoundref="channels_8h" startline="35">SSH_CHANNEL_REQ_STATE_ACCEPTED</references>
        <references refid="channels_8h_1a774597eb1605e8b48cd065965fdc2325a1229a4614fb5d58a7bcd4d6b0bd4816e" compoundref="channels_8h" startline="33">SSH_CHANNEL_REQ_STATE_PENDING</references>
        <references refid="priv_8h_1aa21fd8a7a609329603b7b16da7939fca" compoundref="priv_8h" startline="240">SSH_LOG</references>
        <references refid="group__libssh__log_1ggadf764cbdea00d65edcd07bb9953ad2b7a6445dfe21592d69d9741d319538b6673" compoundref="libssh_8h" startline="352">SSH_LOG_PACKET</references>
        <references refid="libssh_8h_1a1c08cc9177a5598e0675abfb833d2993" compoundref="libssh_8h" startline="358">SSH_LOG_RARE</references>
        <references refid="group__libssh__callbacks_1gac29df803aa1295d6a498c1b081f3b494" compoundref="callbacks_8h" startline="517">SSH_PACKET_USED</references>
        <references refid="ssh__client_8c_1a14871705f45ccdc5bb9f4549efd8e119" compoundref="ssh__client_8c" startline="48">user</references>
      </memberdef>
      <memberdef kind="function" id="group__libssh__channel_1ga8518f0b33a413a4b6d55d78816fb092d" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type></type>
        <definition>SSH_PACKET_CALLBACK</definition>
        <argsstring>(ssh_request_denied)</argsstring>
        <name>SSH_PACKET_CALLBACK</name>
        <param>
          <type>ssh_request_denied</type>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/channels.c" line="2210" column="1" bodyfile="src/channels.c" bodystart="2210" bodyend="2226"/>
        <references refid="structssh__session__struct_1a70a72ecdca89309b5a19e8c887f2ca2c" compoundref="session_8h" startline="150">ssh_session_struct::global_req_state</references>
        <references refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" compoundref="torture__session__keys_8c" startline="61">session</references>
        <references refid="channels_8h_1a774597eb1605e8b48cd065965fdc2325a4947de111ac917be11de88f4e9147d14" compoundref="channels_8h" startline="37">SSH_CHANNEL_REQ_STATE_DENIED</references>
        <references refid="channels_8h_1a774597eb1605e8b48cd065965fdc2325a1229a4614fb5d58a7bcd4d6b0bd4816e" compoundref="channels_8h" startline="33">SSH_CHANNEL_REQ_STATE_PENDING</references>
        <references refid="priv_8h_1aa21fd8a7a609329603b7b16da7939fca" compoundref="priv_8h" startline="240">SSH_LOG</references>
        <references refid="group__libssh__log_1ggadf764cbdea00d65edcd07bb9953ad2b7a6445dfe21592d69d9741d319538b6673" compoundref="libssh_8h" startline="352">SSH_LOG_PACKET</references>
        <references refid="libssh_8h_1a1c08cc9177a5598e0675abfb833d2993" compoundref="libssh_8h" startline="358">SSH_LOG_RARE</references>
        <references refid="group__libssh__callbacks_1gac29df803aa1295d6a498c1b081f3b494" compoundref="callbacks_8h" startline="517">SSH_PACKET_USED</references>
        <references refid="ssh__client_8c_1a14871705f45ccdc5bb9f4549efd8e119" compoundref="ssh__client_8c" startline="48">user</references>
      </memberdef>
      <memberdef kind="function" id="group__libssh__channel_1gad181aa43648dc1a380051d55f53855ad" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>static int ssh_global_request_termination</definition>
        <argsstring>(void *s)</argsstring>
        <name>ssh_global_request_termination</name>
        <param>
          <type>void *</type>
          <declname>s</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/channels.c" line="2228" column="12" bodyfile="src/channels.c" bodystart="2228" bodyend="2235"/>
        <references refid="structssh__session__struct_1a70a72ecdca89309b5a19e8c887f2ca2c" compoundref="session_8h" startline="150">ssh_session_struct::global_req_state</references>
        <references refid="test__socket_8c_1a73991beba1accdcc64730cb00c146fe2" compoundref="test__socket_8c" startline="34">s</references>
        <references refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" compoundref="torture__session__keys_8c" startline="61">session</references>
        <references refid="structssh__session__struct_1a6f74d1a1eb6ed715b1073b67caa18460" compoundref="session_8h" startline="147">ssh_session_struct::session_state</references>
        <references refid="channels_8h_1a774597eb1605e8b48cd065965fdc2325a1229a4614fb5d58a7bcd4d6b0bd4816e" compoundref="channels_8h" startline="33">SSH_CHANNEL_REQ_STATE_PENDING</references>
        <references refid="session_8h_1a9bbd1d5ae11485e27279be6ad461992ca855474fc84a2fb170fcb72546af8eeb8" compoundref="session_8h" startline="46">SSH_SESSION_STATE_ERROR</references>
        <referencedby refid="group__libssh__channel_1ga814cf8a82b4098b8994f9029fed572c0" compoundref="channels_8c" startline="2256" endline="2341">ssh_global_request</referencedby>
      </memberdef>
      <memberdef kind="function" id="group__libssh__channel_1ga814cf8a82b4098b8994f9029fed572c0" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>int ssh_global_request</definition>
        <argsstring>(ssh_session session, const char *request, ssh_buffer buffer, int reply)</argsstring>
        <name>ssh_global_request</name>
        <param>
          <type><ref refid="libssh_8h_1a02d3754de040612632cdd499c20f92f6" kindref="member">ssh_session</ref></type>
          <declname>session</declname>
        </param>
        <param>
          <type>const char *</type>
          <declname>request</declname>
        </param>
        <param>
          <type><ref refid="libssh_8h_1ac91852b0afd5138f36e09ef59af8e52b" kindref="member">ssh_buffer</ref></type>
          <declname>buffer</declname>
        </param>
        <param>
          <type>int</type>
          <declname>reply</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/channels.c" line="2256" column="5" bodyfile="src/channels.c" bodystart="2256" bodyend="2341"/>
        <references refid="benchmarks_8c_1aff2566f4c366b48d73479bef43ee4d2e" compoundref="benchmarks_8c" startline="347">buffer</references>
        <references refid="proxy_8c_1a11614f44ef4d939bdd984953346a7572" compoundref="proxy_8c" startline="33">error</references>
        <references refid="structssh__session__struct_1a70a72ecdca89309b5a19e8c887f2ca2c" compoundref="session_8h" startline="150">ssh_session_struct::global_req_state</references>
        <references refid="structssh__session__struct_1af0aed60c1e529bbfdcb483fd80bf98a0" compoundref="session_8h" startline="140">ssh_session_struct::out_buffer</references>
        <references refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" compoundref="pkd__daemon_8c" startline="62">rc</references>
        <references refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" compoundref="torture__session__keys_8c" startline="61">session</references>
        <references refid="structssh__session__struct_1a6f74d1a1eb6ed715b1073b67caa18460" compoundref="session_8h" startline="147">ssh_session_struct::session_state</references>
        <references refid="ssh2_8h_1a4eadfca7fb359cdaa08b9c3cec05c54d" compoundref="ssh2_8h" startline="42">SSH2_MSG_GLOBAL_REQUEST</references>
        <references refid="libssh_8h_1a9c57e4f6482106336045a4d25a55f28e" compoundref="libssh_8h" startline="331">SSH_AGAIN</references>
        <references refid="libssh_8h_1a92d37237bf129961367accd4a9e0dcfc">ssh_buffer_add_data</references>
        <references refid="libssh_8h_1a240b02fb7c0475fbb5996d1f759221ee">ssh_buffer_get</references>
        <references refid="libssh_8h_1a61400c7267feb254046cd606a3fdfdbc">ssh_buffer_get_len</references>
        <references refid="buffer_8h_1ae17848a86043f0abfc60c1c4f6126ccd" compoundref="buffer_8h" startline="49">ssh_buffer_pack</references>
        <references refid="libssh_8h_1ac8802ff7f5348d0145dab5242623f740">ssh_buffer_reinit</references>
        <references refid="channels_8h_1a774597eb1605e8b48cd065965fdc2325a4054be6a6327c97579cb9dce89c90590" compoundref="channels_8h" startline="35">SSH_CHANNEL_REQ_STATE_ACCEPTED</references>
        <references refid="channels_8h_1a774597eb1605e8b48cd065965fdc2325a4947de111ac917be11de88f4e9147d14" compoundref="channels_8h" startline="37">SSH_CHANNEL_REQ_STATE_DENIED</references>
        <references refid="channels_8h_1a774597eb1605e8b48cd065965fdc2325a7d2c1ea4f49536c9bea8c1187d950378" compoundref="channels_8h" startline="39">SSH_CHANNEL_REQ_STATE_ERROR</references>
        <references refid="channels_8h_1a774597eb1605e8b48cd065965fdc2325a98c7a3dcf02759118261e2bac4d6e421" compoundref="channels_8h" startline="31">SSH_CHANNEL_REQ_STATE_NONE</references>
        <references refid="channels_8h_1a774597eb1605e8b48cd065965fdc2325a1229a4614fb5d58a7bcd4d6b0bd4816e" compoundref="channels_8h" startline="33">SSH_CHANNEL_REQ_STATE_PENDING</references>
        <references refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" compoundref="libssh_8h" startline="330">SSH_ERROR</references>
        <references refid="group__libssh__channel_1gad181aa43648dc1a380051d55f53855ad" compoundref="channels_8c" startline="2228" endline="2235">ssh_global_request_termination</references>
        <references refid="group__libssh__session_1ga4b84e1ae757c0d4007a5eefdf4651694" compoundref="session_8c" startline="692" endline="740">ssh_handle_packets_termination</references>
        <references refid="priv_8h_1aa21fd8a7a609329603b7b16da7939fca" compoundref="priv_8h" startline="240">SSH_LOG</references>
        <references refid="group__libssh__log_1ggadf764cbdea00d65edcd07bb9953ad2b7a6445dfe21592d69d9741d319538b6673" compoundref="libssh_8h" startline="352">SSH_LOG_PACKET</references>
        <references refid="group__libssh__log_1ggadf764cbdea00d65edcd07bb9953ad2b7a75fa79e63947b66462db977d9b5ae27c" compoundref="libssh_8h" startline="349">SSH_LOG_PROTOCOL</references>
        <references refid="libssh_8h_1ac1ee1d1e917456d4760a94a18015377d" compoundref="libssh_8h" startline="329">SSH_OK</references>
        <references refid="packet_8h_1a7e6c7ed74c23ace432476aa8a6841140" compoundref="packet_8c" startline="1761" endline="1843">ssh_packet_send</references>
        <references refid="libssh_8h_1a036b2b00fb04337a4d06d719d1b62be1ad1339fb4b92a9d25bdb99df5de5c4f88" compoundref="libssh_8h" startline="285">SSH_REQUEST_DENIED</references>
        <references refid="session_8h_1a9bbd1d5ae11485e27279be6ad461992ca855474fc84a2fb170fcb72546af8eeb8" compoundref="session_8h" startline="46">SSH_SESSION_STATE_ERROR</references>
        <references refid="priv_8h_1a55177b3e8db90ca9adb435c44281963c" compoundref="priv_8h" startline="258">ssh_set_error</references>
        <references refid="priv_8h_1ae280c413c792e04237f000841ac8ce44" compoundref="priv_8h" startline="265">ssh_set_error_oom</references>
        <references refid="session_8h_1aa8c8d35c7f83d7b00218ebadfac2254b" compoundref="session_8h" startline="84">SSH_TIMEOUT_DEFAULT</references>
        <referencedby refid="group__libssh__channel_1ga3bff751afc5ecb5bbf9d6447e4e5370f" compoundref="channels_8c" startline="2447" endline="2476">ssh_channel_cancel_forward</referencedby>
        <referencedby refid="group__libssh__channel_1ga758cda957227751870c8772df46e5b39" compoundref="channels_8c" startline="2365" endline="2404">ssh_channel_listen_forward</referencedby>
        <referencedby refid="group__libssh__server_1gaa1ac2e1b7fdc23fd7e253aa9f0a47e7a" compoundref="server_8c" startline="1173" endline="1179">ssh_send_keepalive</referencedby>
        <referencedby refid="torture__server_8c_1a65c15130edce6143731c7bff27153650" compoundref="torture__server_8c" startline="476" endline="518">torture_server_unknown_global_request</referencedby>
        <referencedby refid="torture__client__global__requests_8c_1a32462a357527b0302ce677bab88c3cf2" compoundref="torture__client__global__requests_8c" startline="109" endline="135">torture_unknown_request</referencedby>
      </memberdef>
      <memberdef kind="function" id="group__libssh__channel_1ga758cda957227751870c8772df46e5b39" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>int ssh_channel_listen_forward</definition>
        <argsstring>(ssh_session session, const char *address, int port, int *bound_port)</argsstring>
        <name>ssh_channel_listen_forward</name>
        <param>
          <type><ref refid="libssh_8h_1a02d3754de040612632cdd499c20f92f6" kindref="member">ssh_session</ref></type>
          <declname>session</declname>
        </param>
        <param>
          <type>const char *</type>
          <declname>address</declname>
        </param>
        <param>
          <type>int</type>
          <declname>port</declname>
        </param>
        <param>
          <type>int *</type>
          <declname>bound_port</declname>
        </param>
        <briefdescription>
<para>Sends the &quot;tcpip-forward&quot; global request to ask the server to begin listening for inbound connections. </para>
        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername direction="in">session</parametername>
</parameternamelist>
<parameterdescription>
<para>The ssh session to send the request.</para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">address</parametername>
</parameternamelist>
<parameterdescription>
<para>The address to bind to on the server. Pass NULL to bind to all available addresses on all protocol families supported by the server.</para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">port</parametername>
</parameternamelist>
<parameterdescription>
<para>The port to bind to on the server. Pass 0 to ask the server to allocate the next available unprivileged port number</para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">bound_port</parametername>
</parameternamelist>
<parameterdescription>
<para>The pointer to get actual bound port. Pass NULL to ignore.</para>
</parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>SSH_OK on success, SSH_ERROR if an error occurred, SSH_AGAIN if in nonblocking mode and call has to be done again. </para>
</simplesect>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/channels.c" line="2365" column="5" bodyfile="src/channels.c" bodystart="2365" bodyend="2404"/>
        <references refid="benchmarks_8c_1aff2566f4c366b48d73479bef43ee4d2e" compoundref="benchmarks_8c" startline="347">buffer</references>
        <references refid="proxy_8c_1a11614f44ef4d939bdd984953346a7572" compoundref="proxy_8c" startline="33">error</references>
        <references refid="structssh__session__struct_1a70a72ecdca89309b5a19e8c887f2ca2c" compoundref="session_8h" startline="150">ssh_session_struct::global_req_state</references>
        <references refid="structssh__session__struct_1a0fdb53c794a3173557463030583b2079" compoundref="session_8h" startline="138">ssh_session_struct::in_buffer</references>
        <references refid="sshnetcat_8c_1ad723da1801ae1586eb330380e2d9a912" compoundref="sshnetcat_8c" startline="39">port</references>
        <references refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" compoundref="pkd__daemon_8c" startline="62">rc</references>
        <references refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" compoundref="torture__session__keys_8c" startline="61">session</references>
        <references refid="libssh_8h_1a8b09f7d6f7066de7ef8dab4ed7494a52" compoundref="libssh_8h" startline="828">SSH_BUFFER_FREE</references>
        <references refid="group__libssh__buffer_1ga7ecc914104a5bf0da485d3e42f6a7d3b" compoundref="buffer_8c" startline="119" endline="142">ssh_buffer_new</references>
        <references refid="buffer_8h_1ae17848a86043f0abfc60c1c4f6126ccd" compoundref="buffer_8h" startline="49">ssh_buffer_pack</references>
        <references refid="buffer_8h_1ab51014ef9a47e7cdbd235af3e62b81ee" compoundref="buffer_8h" startline="59">ssh_buffer_unpack</references>
        <references refid="channels_8h_1a774597eb1605e8b48cd065965fdc2325a98c7a3dcf02759118261e2bac4d6e421" compoundref="channels_8h" startline="31">SSH_CHANNEL_REQ_STATE_NONE</references>
        <references refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" compoundref="libssh_8h" startline="330">SSH_ERROR</references>
        <references refid="group__libssh__channel_1ga814cf8a82b4098b8994f9029fed572c0" compoundref="channels_8c" startline="2256" endline="2341">ssh_global_request</references>
        <references refid="libssh_8h_1ac1ee1d1e917456d4760a94a18015377d" compoundref="libssh_8h" startline="329">SSH_OK</references>
        <references refid="priv_8h_1ae280c413c792e04237f000841ac8ce44" compoundref="priv_8h" startline="265">ssh_set_error_oom</references>
        <referencedby refid="legacy_8h_1a0ef44f268f77a091d52f39d3b02b1ad1" compoundref="legacy_8c" startline="178" endline="181">channel_forward_listen</referencedby>
        <referencedby refid="classssh_1_1Session_1aa4ab8dfd40f13bb72ef8ef65a48be861" compoundref="libsshpp_8hpp" startline="432" endline="437">ssh::Session::listenForward</referencedby>
        <referencedby refid="group__libssh__channel_1ga041a495f0230bb017cdf7459e6773664" compoundref="channels_8c" startline="2407" endline="2409">ssh_forward_listen</referencedby>
        <referencedby refid="torture__forward_8c_1a8f1d1bddae7902259b1b169d0439fe2f" compoundref="torture__forward_8c" startline="78" endline="99">torture_ssh_forward</referencedby>
      </memberdef>
      <memberdef kind="function" id="group__libssh__channel_1ga041a495f0230bb017cdf7459e6773664" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>int ssh_forward_listen</definition>
        <argsstring>(ssh_session session, const char *address, int port, int *bound_port)</argsstring>
        <name>ssh_forward_listen</name>
        <param>
          <type><ref refid="libssh_8h_1a02d3754de040612632cdd499c20f92f6" kindref="member">ssh_session</ref></type>
          <declname>session</declname>
        </param>
        <param>
          <type>const char *</type>
          <declname>address</declname>
        </param>
        <param>
          <type>int</type>
          <declname>port</declname>
        </param>
        <param>
          <type>int *</type>
          <declname>bound_port</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/channels.c" line="2407" column="5" bodyfile="src/channels.c" bodystart="2407" bodyend="2409"/>
        <references refid="sshnetcat_8c_1ad723da1801ae1586eb330380e2d9a912" compoundref="sshnetcat_8c" startline="39">port</references>
        <references refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" compoundref="torture__session__keys_8c" startline="61">session</references>
        <references refid="group__libssh__channel_1ga758cda957227751870c8772df46e5b39" compoundref="channels_8c" startline="2365" endline="2404">ssh_channel_listen_forward</references>
      </memberdef>
      <memberdef kind="function" id="group__libssh__channel_1ga205d5ea76fb140075ebb1c20b8f193d3" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="libssh_8h_1aca32be8db7c865697a3de381dc7e9fc3" kindref="member">ssh_channel</ref></type>
        <definition>ssh_channel ssh_forward_accept</definition>
        <argsstring>(ssh_session session, int timeout_ms)</argsstring>
        <name>ssh_forward_accept</name>
        <param>
          <type><ref refid="libssh_8h_1a02d3754de040612632cdd499c20f92f6" kindref="member">ssh_session</ref></type>
          <declname>session</declname>
        </param>
        <param>
          <type>int</type>
          <declname>timeout_ms</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/channels.c" line="2412" column="13" bodyfile="src/channels.c" bodystart="2412" bodyend="2414"/>
        <references refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" compoundref="torture__session__keys_8c" startline="61">session</references>
        <references refid="group__libssh__channel_1gac43bae56048b912205d102249b436eec" compoundref="channels_8c" startline="2093" endline="2146">ssh_channel_accept</references>
        <references refid="libssh_8h_1acc2732b8c54002b0031fa1e40ee60b24a218aac5de2f3a87265e3bcc8542057ed" compoundref="libssh_8h" startline="192">SSH_CHANNEL_FORWARDED_TCPIP</references>
      </memberdef>
      <memberdef kind="function" id="group__libssh__channel_1ga490e4b0a7adc022507b7f165b336afe4" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="libssh_8h_1aca32be8db7c865697a3de381dc7e9fc3" kindref="member">ssh_channel</ref></type>
        <definition>ssh_channel ssh_channel_accept_forward</definition>
        <argsstring>(ssh_session session, int timeout_ms, int *destination_port)</argsstring>
        <name>ssh_channel_accept_forward</name>
        <param>
          <type><ref refid="libssh_8h_1a02d3754de040612632cdd499c20f92f6" kindref="member">ssh_session</ref></type>
          <declname>session</declname>
        </param>
        <param>
          <type>int</type>
          <declname>timeout_ms</declname>
        </param>
        <param>
          <type>int *</type>
          <declname>destination_port</declname>
        </param>
        <briefdescription>
<para>Accept an incoming TCP/IP forwarding channel and get information about incomming connection. </para>
        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername direction="in">session</parametername>
</parameternamelist>
<parameterdescription>
<para>The ssh session to use.</para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">timeout_ms</parametername>
</parameternamelist>
<parameterdescription>
<para>A timeout in milliseconds.</para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">destination_port</parametername>
</parameternamelist>
<parameterdescription>
<para>A pointer to destination port or NULL.</para>
</parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>Newly created channel, or NULL if no incoming channel request from the server </para>
</simplesect>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/channels.c" line="2428" column="13" bodyfile="src/channels.c" bodystart="2428" bodyend="2430"/>
        <references refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" compoundref="torture__session__keys_8c" startline="61">session</references>
        <references refid="group__libssh__channel_1gac43bae56048b912205d102249b436eec" compoundref="channels_8c" startline="2093" endline="2146">ssh_channel_accept</references>
        <references refid="libssh_8h_1acc2732b8c54002b0031fa1e40ee60b24a218aac5de2f3a87265e3bcc8542057ed" compoundref="libssh_8h" startline="192">SSH_CHANNEL_FORWARDED_TCPIP</references>
        <referencedby refid="classssh_1_1Session_1a6cd5318d71a3850a87b87bdfd89a5983" compoundref="libsshpp_8hpp" startline="672" endline="678">ssh::Session::acceptForward</referencedby>
        <referencedby refid="legacy_8h_1a695e125386b9088c70e36c53f7187d64" compoundref="legacy_8c" startline="166" endline="168">channel_forward_accept</referencedby>
        <referencedby refid="torture__forward_8c_1a8f1d1bddae7902259b1b169d0439fe2f" compoundref="torture__forward_8c" startline="78" endline="99">torture_ssh_forward</referencedby>
      </memberdef>
      <memberdef kind="function" id="group__libssh__channel_1ga3bff751afc5ecb5bbf9d6447e4e5370f" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>int ssh_channel_cancel_forward</definition>
        <argsstring>(ssh_session session, const char *address, int port)</argsstring>
        <name>ssh_channel_cancel_forward</name>
        <param>
          <type><ref refid="libssh_8h_1a02d3754de040612632cdd499c20f92f6" kindref="member">ssh_session</ref></type>
          <declname>session</declname>
        </param>
        <param>
          <type>const char *</type>
          <declname>address</declname>
        </param>
        <param>
          <type>int</type>
          <declname>port</declname>
        </param>
        <briefdescription>
<para>Sends the &quot;cancel-tcpip-forward&quot; global request to ask the server to cancel the tcpip-forward request. </para>
        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername direction="in">session</parametername>
</parameternamelist>
<parameterdescription>
<para>The ssh session to send the request.</para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">address</parametername>
</parameternamelist>
<parameterdescription>
<para>The bound address on the server.</para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">port</parametername>
</parameternamelist>
<parameterdescription>
<para>The bound port on the server.</para>
</parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>SSH_OK on success, SSH_ERROR if an error occurred, SSH_AGAIN if in nonblocking mode and call has to be done again. </para>
</simplesect>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/channels.c" line="2447" column="5" bodyfile="src/channels.c" bodystart="2447" bodyend="2476"/>
        <references refid="benchmarks_8c_1aff2566f4c366b48d73479bef43ee4d2e" compoundref="benchmarks_8c" startline="347">buffer</references>
        <references refid="proxy_8c_1a11614f44ef4d939bdd984953346a7572" compoundref="proxy_8c" startline="33">error</references>
        <references refid="structssh__session__struct_1a70a72ecdca89309b5a19e8c887f2ca2c" compoundref="session_8h" startline="150">ssh_session_struct::global_req_state</references>
        <references refid="sshnetcat_8c_1ad723da1801ae1586eb330380e2d9a912" compoundref="sshnetcat_8c" startline="39">port</references>
        <references refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" compoundref="pkd__daemon_8c" startline="62">rc</references>
        <references refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" compoundref="torture__session__keys_8c" startline="61">session</references>
        <references refid="libssh_8h_1a8b09f7d6f7066de7ef8dab4ed7494a52" compoundref="libssh_8h" startline="828">SSH_BUFFER_FREE</references>
        <references refid="group__libssh__buffer_1ga7ecc914104a5bf0da485d3e42f6a7d3b" compoundref="buffer_8c" startline="119" endline="142">ssh_buffer_new</references>
        <references refid="buffer_8h_1ae17848a86043f0abfc60c1c4f6126ccd" compoundref="buffer_8h" startline="49">ssh_buffer_pack</references>
        <references refid="channels_8h_1a774597eb1605e8b48cd065965fdc2325a98c7a3dcf02759118261e2bac4d6e421" compoundref="channels_8h" startline="31">SSH_CHANNEL_REQ_STATE_NONE</references>
        <references refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" compoundref="libssh_8h" startline="330">SSH_ERROR</references>
        <references refid="group__libssh__channel_1ga814cf8a82b4098b8994f9029fed572c0" compoundref="channels_8c" startline="2256" endline="2341">ssh_global_request</references>
        <references refid="libssh_8h_1ac1ee1d1e917456d4760a94a18015377d" compoundref="libssh_8h" startline="329">SSH_OK</references>
        <references refid="priv_8h_1ae280c413c792e04237f000841ac8ce44" compoundref="priv_8h" startline="265">ssh_set_error_oom</references>
        <referencedby refid="classssh_1_1Session_1a70f29e5f12fea442dfd0bff3ec51d3a8" compoundref="libsshpp_8hpp" startline="426" endline="430">ssh::Session::cancelForward</referencedby>
        <referencedby refid="legacy_8h_1a061861c2fd7ab1ae018c006c4d29a3e4" compoundref="legacy_8c" startline="174" endline="176">channel_forward_cancel</referencedby>
        <referencedby refid="group__libssh__channel_1gac474d071d80e725c8b5633cb1d35c010" compoundref="channels_8c" startline="2479" endline="2481">ssh_forward_cancel</referencedby>
      </memberdef>
      <memberdef kind="function" id="group__libssh__channel_1gac474d071d80e725c8b5633cb1d35c010" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>int ssh_forward_cancel</definition>
        <argsstring>(ssh_session session, const char *address, int port)</argsstring>
        <name>ssh_forward_cancel</name>
        <param>
          <type><ref refid="libssh_8h_1a02d3754de040612632cdd499c20f92f6" kindref="member">ssh_session</ref></type>
          <declname>session</declname>
        </param>
        <param>
          <type>const char *</type>
          <declname>address</declname>
        </param>
        <param>
          <type>int</type>
          <declname>port</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/channels.c" line="2479" column="5" bodyfile="src/channels.c" bodystart="2479" bodyend="2481"/>
        <references refid="sshnetcat_8c_1ad723da1801ae1586eb330380e2d9a912" compoundref="sshnetcat_8c" startline="39">port</references>
        <references refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" compoundref="torture__session__keys_8c" startline="61">session</references>
        <references refid="group__libssh__channel_1ga3bff751afc5ecb5bbf9d6447e4e5370f" compoundref="channels_8c" startline="2447" endline="2476">ssh_channel_cancel_forward</references>
      </memberdef>
      <memberdef kind="function" id="group__libssh__channel_1ga7aede2f9af4c494ff9e41fc08a4572f1" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>int ssh_channel_request_env</definition>
        <argsstring>(ssh_channel channel, const char *name, const char *value)</argsstring>
        <name>ssh_channel_request_env</name>
        <param>
          <type><ref refid="libssh_8h_1aca32be8db7c865697a3de381dc7e9fc3" kindref="member">ssh_channel</ref></type>
          <declname>channel</declname>
        </param>
        <param>
          <type>const char *</type>
          <declname>name</declname>
        </param>
        <param>
          <type>const char *</type>
          <declname>value</declname>
        </param>
        <briefdescription>
<para>Set environment variables. </para>
        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername direction="in">channel</parametername>
</parameternamelist>
<parameterdescription>
<para>The channel to set the environment variables.</para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">name</parametername>
</parameternamelist>
<parameterdescription>
<para>The name of the variable.</para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">value</parametername>
</parameternamelist>
<parameterdescription>
<para>The value to set.</para>
</parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>SSH_OK on success, SSH_ERROR if an error occurred, SSH_AGAIN if in nonblocking mode and call has to be done again. </para>
</simplesect>
<simplesect kind="warning"><para>Some environment variables may be refused by security reasons. </para>
</simplesect>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/channels.c" line="2498" column="5" bodyfile="src/channels.c" bodystart="2498" bodyend="2535"/>
        <references refid="benchmarks_8c_1aff2566f4c366b48d73479bef43ee4d2e" compoundref="benchmarks_8c" startline="347">buffer</references>
        <references refid="group__libssh__channel_1gaee35ccabe6998568d138d35f538765d9" compoundref="channels_8c" startline="1698" endline="1780">channel_request</references>
        <references refid="proxy_8c_1a11614f44ef4d939bdd984953346a7572" compoundref="proxy_8c" startline="33">error</references>
        <references refid="samplesshd-kbdint_8c_1a8f8f80d37794cde9472343e4487ba3eb" compoundref="samplesshd-kbdint_8c" startline="186">name</references>
        <references refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" compoundref="pkd__daemon_8c" startline="62">rc</references>
        <references refid="structssh__channel__struct_1a25a8d874fbdccd50ecfff837ef69bad2" compoundref="channels_8h" startline="80">ssh_channel_struct::request_state</references>
        <references refid="structssh__channel__struct_1a0832dc830d09accd2f3a8f8349c3faf2" compoundref="channels_8h" startline="63">ssh_channel_struct::session</references>
        <references refid="libssh_8h_1a8b09f7d6f7066de7ef8dab4ed7494a52" compoundref="libssh_8h" startline="828">SSH_BUFFER_FREE</references>
        <references refid="group__libssh__buffer_1ga7ecc914104a5bf0da485d3e42f6a7d3b" compoundref="buffer_8c" startline="119" endline="142">ssh_buffer_new</references>
        <references refid="buffer_8h_1ae17848a86043f0abfc60c1c4f6126ccd" compoundref="buffer_8h" startline="49">ssh_buffer_pack</references>
        <references refid="channels_8h_1a774597eb1605e8b48cd065965fdc2325a98c7a3dcf02759118261e2bac4d6e421" compoundref="channels_8h" startline="31">SSH_CHANNEL_REQ_STATE_NONE</references>
        <references refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" compoundref="libssh_8h" startline="330">SSH_ERROR</references>
        <references refid="libssh_8h_1ac1ee1d1e917456d4760a94a18015377d" compoundref="libssh_8h" startline="329">SSH_OK</references>
        <references refid="priv_8h_1a351ea86857d33b3ba80b396e05c4517c" compoundref="priv_8h" startline="269">ssh_set_error_invalid</references>
        <references refid="priv_8h_1ae280c413c792e04237f000841ac8ce44" compoundref="priv_8h" startline="265">ssh_set_error_oom</references>
        <referencedby refid="benchmarks_8h_1a166dab0266f920174e138f1039ca1773" compoundref="latency_8c" startline="119" endline="148">benchmarks_ssh_latency</referencedby>
        <referencedby refid="legacy_8h_1a5a8d0782011d4d57da5613fa0e18c5bd" compoundref="legacy_8c" startline="241" endline="243">channel_request_env</referencedby>
        <referencedby refid="classssh_1_1Channel_1a1493e5c618e62d41a0213e7d8ef1223b" compoundref="libsshpp_8hpp" startline="581" endline="585">ssh::Channel::requestEnv</referencedby>
        <referencedby refid="torture__request__env_8c_1af673d397cb089d358c279e3e6e082388" compoundref="torture__request__env_8c" startline="78" endline="118">torture_request_env</referencedby>
      </memberdef>
      <memberdef kind="function" id="group__libssh__channel_1ga567d509183ade0a77190f390e2b5747d" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>int ssh_channel_request_exec</definition>
        <argsstring>(ssh_channel channel, const char *cmd)</argsstring>
        <name>ssh_channel_request_exec</name>
        <param>
          <type><ref refid="libssh_8h_1aca32be8db7c865697a3de381dc7e9fc3" kindref="member">ssh_channel</ref></type>
          <declname>channel</declname>
        </param>
        <param>
          <type>const char *</type>
          <declname>cmd</declname>
        </param>
        <briefdescription>
<para>Run a shell command without an interactive shell. </para>
        </briefdescription>
        <detaileddescription>
<para>This is similar to &apos;sh -c command&apos;.</para>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername direction="in">channel</parametername>
</parameternamelist>
<parameterdescription>
<para>The channel to execute the command.</para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">cmd</parametername>
</parameternamelist>
<parameterdescription>
<para>The command to execute (e.g. &quot;ls ~/ -al | grep -i reports&quot;).</para>
</parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>SSH_OK on success, SSH_ERROR if an error occurred, SSH_AGAIN if in nonblocking mode and call has to be done again.</para>
</simplesect>
Example: <programlisting><codeline><highlight class="normal">rc<sp/>=<sp/>ssh_channel_request_exec(channel,<sp/>&quot;ps<sp/>aux&quot;);</highlight></codeline>
<codeline><highlight class="normal">if<sp/>(rc<sp/>&gt;<sp/>0)<sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>return<sp/>-1;</highlight></codeline>
<codeline><highlight class="normal">}</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">while<sp/>((rc<sp/>=<sp/>ssh_channel_read(channel,<sp/>buffer,<sp/>sizeof(buffer),<sp/>0))<sp/>&gt;<sp/>0)<sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>if<sp/>(fwrite(buffer,<sp/>1,<sp/>rc,<sp/>stdout)<sp/>!=<sp/>(unsigned<sp/>int)<sp/>rc)<sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>-1;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline><highlight class="normal">}</highlight></codeline>
</programlisting></para>
<para><simplesect kind="see"><para><ref refid="group__libssh__channel_1gaed4c5fb30c9df2b2548421ccf4e81bf1" kindref="member">ssh_channel_request_shell()</ref> </para>
</simplesect>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/channels.c" line="2568" column="5" bodyfile="src/channels.c" bodystart="2568" bodyend="2603"/>
        <references refid="benchmarks_8c_1aff2566f4c366b48d73479bef43ee4d2e" compoundref="benchmarks_8c" startline="347">buffer</references>
        <references refid="group__libssh__channel_1gaee35ccabe6998568d138d35f538765d9" compoundref="channels_8c" startline="1698" endline="1780">channel_request</references>
        <references refid="proxy_8c_1a11614f44ef4d939bdd984953346a7572" compoundref="proxy_8c" startline="33">error</references>
        <references refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" compoundref="pkd__daemon_8c" startline="62">rc</references>
        <references refid="structssh__channel__struct_1a25a8d874fbdccd50ecfff837ef69bad2" compoundref="channels_8h" startline="80">ssh_channel_struct::request_state</references>
        <references refid="structssh__channel__struct_1a0832dc830d09accd2f3a8f8349c3faf2" compoundref="channels_8h" startline="63">ssh_channel_struct::session</references>
        <references refid="libssh_8h_1a8b09f7d6f7066de7ef8dab4ed7494a52" compoundref="libssh_8h" startline="828">SSH_BUFFER_FREE</references>
        <references refid="group__libssh__buffer_1ga7ecc914104a5bf0da485d3e42f6a7d3b" compoundref="buffer_8c" startline="119" endline="142">ssh_buffer_new</references>
        <references refid="buffer_8h_1ae17848a86043f0abfc60c1c4f6126ccd" compoundref="buffer_8h" startline="49">ssh_buffer_pack</references>
        <references refid="channels_8h_1a774597eb1605e8b48cd065965fdc2325a98c7a3dcf02759118261e2bac4d6e421" compoundref="channels_8h" startline="31">SSH_CHANNEL_REQ_STATE_NONE</references>
        <references refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" compoundref="libssh_8h" startline="330">SSH_ERROR</references>
        <references refid="libssh_8h_1ac1ee1d1e917456d4760a94a18015377d" compoundref="libssh_8h" startline="329">SSH_OK</references>
        <references refid="priv_8h_1a351ea86857d33b3ba80b396e05c4517c" compoundref="priv_8h" startline="269">ssh_set_error_invalid</references>
        <references refid="priv_8h_1ae280c413c792e04237f000841ac8ce44" compoundref="priv_8h" startline="265">ssh_set_error_oom</references>
        <referencedby refid="ssh__client_8c_1a8b8ff3289e057f1b391476c5c4b71178" compoundref="ssh__client_8c" startline="290" endline="316">batch_shell</referencedby>
        <referencedby refid="bench__raw_8c_1afd64b09e9ae3ce2136328be2cd0bac89" compoundref="bench__raw_8c" startline="227" endline="285">benchmarks_raw_down</referencedby>
        <referencedby refid="bench__raw_8c_1a070a579a7a62c222e5f28c9e074c0df7" compoundref="bench__raw_8c" startline="107" endline="182">benchmarks_raw_up</referencedby>
        <referencedby refid="legacy_8h_1a8e5c501b6a9ab6893ae1946fe5b12bbf" compoundref="legacy_8c" startline="245" endline="247">channel_request_exec</referencedby>
        <referencedby refid="scp__download_8c_1abf8ad844320270e1c0b49e510c9bb4a0" compoundref="scp__download_8c" startline="61" endline="100">create_files</referencedby>
        <referencedby refid="test__exec_8c_1acbd4f6c4ecc68d1c4cc45223741be81c" compoundref="test__exec_8c" startline="10" endline="49">do_connect</referencedby>
        <referencedby refid="ssh__client__fuzzer_8cpp_1a91ce7c16e9840492202299da2b451e60" compoundref="ssh__client__fuzzer_8cpp" startline="85" endline="158">LLVMFuzzerTestOneInput</referencedby>
        <referencedby refid="exec_8c_1a840291bc02cba5474a4cb46a9b9566fe" compoundref="exec_8c" startline="7" endline="66">main</referencedby>
        <referencedby refid="classssh_1_1Channel_1a4fd026ccfef501034741a206ec207329" compoundref="libsshpp_8hpp" startline="587" endline="591">ssh::Channel::requestExec</referencedby>
        <referencedby refid="group__libssh__scp_1ga1db56dcb9dee01dd0b679b3b11151110" compoundref="scp_8c" startline="119" endline="230">ssh_scp_init</referencedby>
        <referencedby refid="torture__session_8c_1a99c33d74eaa8af7ac88d2b2ffe1299ca" compoundref="torture__session_8c" startline="83" endline="119">torture_channel_read_error</referencedby>
        <referencedby refid="torture__request__env_8c_1af673d397cb089d358c279e3e6e082388" compoundref="torture__request__env_8c" startline="78" endline="118">torture_request_env</referencedby>
        <referencedby refid="bench__raw_8c_1ab14322fd9f96904e565cabfbe2b42a5e" compoundref="bench__raw_8c" startline="71" endline="97">upload_script</referencedby>
      </memberdef>
      <memberdef kind="function" id="group__libssh__channel_1gaa98315fca818b561970a6950683f4053" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>int ssh_channel_request_send_signal</definition>
        <argsstring>(ssh_channel channel, const char *sig)</argsstring>
        <name>ssh_channel_request_send_signal</name>
        <param>
          <type><ref refid="libssh_8h_1aca32be8db7c865697a3de381dc7e9fc3" kindref="member">ssh_channel</ref></type>
          <declname>channel</declname>
        </param>
        <param>
          <type>const char *</type>
          <declname>sig</declname>
        </param>
        <briefdescription>
<para>Send a signal to remote process (as described in RFC 4254, section 6.9). </para>
        </briefdescription>
        <detaileddescription>
<para>Sends a signal &apos;sig&apos; to the remote process. Note, that remote system may not support signals concept. In such a case this request will be silently ignored. Only SSH-v2 is supported (I&apos;m not sure about SSH-v1).</para>
<para>OpenSSH doesn&apos;t support signals yet, see: <ulink url="https://bugzilla.mindrot.org/show_bug.cgi?id=1424">https://bugzilla.mindrot.org/show_bug.cgi?id=1424</ulink></para>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername direction="in">channel</parametername>
</parameternamelist>
<parameterdescription>
<para>The channel to send signal.</para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">sig</parametername>
</parameternamelist>
<parameterdescription>
<para>The signal to send (without SIG prefix) <linebreak/>
<linebreak/>
 SIGABRT -&gt; ABRT <linebreak/>
 SIGALRM -&gt; ALRM <linebreak/>
 SIGFPE -&gt; FPE <linebreak/>
 SIGHUP -&gt; HUP <linebreak/>
 SIGILL -&gt; ILL <linebreak/>
 SIGINT -&gt; INT <linebreak/>
 SIGKILL -&gt; KILL <linebreak/>
 SIGPIPE -&gt; PIPE <linebreak/>
 SIGQUIT -&gt; QUIT <linebreak/>
 SIGSEGV -&gt; SEGV <linebreak/>
 SIGTERM -&gt; TERM <linebreak/>
 SIGUSR1 -&gt; USR1 <linebreak/>
 SIGUSR2 -&gt; USR2 <linebreak/>
 </para>
</parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>SSH_OK on success, SSH_ERROR if an error occurred (including attempts to send signal via SSH-v1 session). </para>
</simplesect>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/channels.c" line="2638" column="5" bodyfile="src/channels.c" bodystart="2638" bodyend="2666"/>
        <references refid="benchmarks_8c_1aff2566f4c366b48d73479bef43ee4d2e" compoundref="benchmarks_8c" startline="347">buffer</references>
        <references refid="group__libssh__channel_1gaee35ccabe6998568d138d35f538765d9" compoundref="channels_8c" startline="1698" endline="1780">channel_request</references>
        <references refid="proxy_8c_1a11614f44ef4d939bdd984953346a7572" compoundref="proxy_8c" startline="33">error</references>
        <references refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" compoundref="pkd__daemon_8c" startline="62">rc</references>
        <references refid="structssh__channel__struct_1a0832dc830d09accd2f3a8f8349c3faf2" compoundref="channels_8h" startline="63">ssh_channel_struct::session</references>
        <references refid="libssh_8h_1a8b09f7d6f7066de7ef8dab4ed7494a52" compoundref="libssh_8h" startline="828">SSH_BUFFER_FREE</references>
        <references refid="group__libssh__buffer_1ga7ecc914104a5bf0da485d3e42f6a7d3b" compoundref="buffer_8c" startline="119" endline="142">ssh_buffer_new</references>
        <references refid="buffer_8h_1ae17848a86043f0abfc60c1c4f6126ccd" compoundref="buffer_8h" startline="49">ssh_buffer_pack</references>
        <references refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" compoundref="libssh_8h" startline="330">SSH_ERROR</references>
        <references refid="libssh_8h_1ac1ee1d1e917456d4760a94a18015377d" compoundref="libssh_8h" startline="329">SSH_OK</references>
        <references refid="priv_8h_1a351ea86857d33b3ba80b396e05c4517c" compoundref="priv_8h" startline="269">ssh_set_error_invalid</references>
        <references refid="priv_8h_1ae280c413c792e04237f000841ac8ce44" compoundref="priv_8h" startline="265">ssh_set_error_oom</references>
        <referencedby refid="legacy_8h_1a2a23a14275788dec03c86e6532f443b2" compoundref="legacy_8c" startline="262" endline="264">channel_request_send_signal</referencedby>
        <referencedby refid="classssh_1_1Channel_1a9124161a6c69d544593b4f505c71813e" compoundref="libsshpp_8hpp" startline="607" endline="611">ssh::Channel::requestSendSignal</referencedby>
      </memberdef>
      <memberdef kind="function" id="group__libssh__channel_1gaef198ad0dcf0968aa2a449c8898d985e" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>int ssh_channel_request_send_break</definition>
        <argsstring>(ssh_channel channel, uint32_t length)</argsstring>
        <name>ssh_channel_request_send_break</name>
        <param>
          <type><ref refid="libssh_8h_1aca32be8db7c865697a3de381dc7e9fc3" kindref="member">ssh_channel</ref></type>
          <declname>channel</declname>
        </param>
        <param>
          <type>uint32_t</type>
          <declname>length</declname>
        </param>
        <briefdescription>
<para>Send a break signal to the server (as described in RFC 4335). </para>
        </briefdescription>
        <detaileddescription>
<para>Sends a break signal to the remote process. Note, that remote system may not support breaks. In such a case this request will be silently ignored. Only SSH-v2 is supported.</para>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername direction="in">channel</parametername>
</parameternamelist>
<parameterdescription>
<para>The channel to send the break to.</para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">length</parametername>
</parameternamelist>
<parameterdescription>
<para>The break-length in milliseconds to send.</para>
</parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>SSH_OK on success, SSH_ERROR if an error occurred (including attempts to send signal via SSH-v1 session). </para>
</simplesect>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/channels.c" line="2684" column="5" bodyfile="src/channels.c" bodystart="2684" bodyend="2709"/>
        <references refid="benchmarks_8c_1aff2566f4c366b48d73479bef43ee4d2e" compoundref="benchmarks_8c" startline="347">buffer</references>
        <references refid="group__libssh__channel_1gaee35ccabe6998568d138d35f538765d9" compoundref="channels_8c" startline="1698" endline="1780">channel_request</references>
        <references refid="proxy_8c_1a11614f44ef4d939bdd984953346a7572" compoundref="proxy_8c" startline="33">error</references>
        <references refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" compoundref="pkd__daemon_8c" startline="62">rc</references>
        <references refid="structssh__channel__struct_1a0832dc830d09accd2f3a8f8349c3faf2" compoundref="channels_8h" startline="63">ssh_channel_struct::session</references>
        <references refid="libssh_8h_1a8b09f7d6f7066de7ef8dab4ed7494a52" compoundref="libssh_8h" startline="828">SSH_BUFFER_FREE</references>
        <references refid="group__libssh__buffer_1ga7ecc914104a5bf0da485d3e42f6a7d3b" compoundref="buffer_8c" startline="119" endline="142">ssh_buffer_new</references>
        <references refid="buffer_8h_1ae17848a86043f0abfc60c1c4f6126ccd" compoundref="buffer_8h" startline="49">ssh_buffer_pack</references>
        <references refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" compoundref="libssh_8h" startline="330">SSH_ERROR</references>
        <references refid="libssh_8h_1ac1ee1d1e917456d4760a94a18015377d" compoundref="libssh_8h" startline="329">SSH_OK</references>
        <references refid="priv_8h_1ae280c413c792e04237f000841ac8ce44" compoundref="priv_8h" startline="265">ssh_set_error_oom</references>
      </memberdef>
      <memberdef kind="function" id="group__libssh__channel_1gab391f5c978cb1bc8df3ebd061f38e8c5" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>int channel_read_buffer</definition>
        <argsstring>(ssh_channel channel, ssh_buffer buffer, uint32_t count, int is_stderr)</argsstring>
        <name>channel_read_buffer</name>
        <param>
          <type><ref refid="libssh_8h_1aca32be8db7c865697a3de381dc7e9fc3" kindref="member">ssh_channel</ref></type>
          <declname>channel</declname>
        </param>
        <param>
          <type><ref refid="libssh_8h_1ac91852b0afd5138f36e09ef59af8e52b" kindref="member">ssh_buffer</ref></type>
          <declname>buffer</declname>
        </param>
        <param>
          <type>uint32_t</type>
          <declname>count</declname>
        </param>
        <param>
          <type>int</type>
          <declname>is_stderr</declname>
        </param>
        <briefdescription>
<para>Read data from a channel into a buffer. </para>
        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername direction="in">channel</parametername>
</parameternamelist>
<parameterdescription>
<para>The channel to read from.</para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">buffer</parametername>
</parameternamelist>
<parameterdescription>
<para>The buffer which will get the data.</para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">count</parametername>
</parameternamelist>
<parameterdescription>
<para>The count of bytes to be read. If it is bigger than 0, the exact size will be read, else (bytes=0) it will return once anything is available.</para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>is_stderr</parametername>
</parameternamelist>
<parameterdescription>
<para>A boolean value to mark reading from the stderr stream.</para>
</parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>The number of bytes read, 0 on end of file or SSH_ERROR on error. </para>
</simplesect>
<xrefsect id="deprecated_1_deprecated000001"><xreftitle>Deprecated</xreftitle><xrefdescription><para>Please use ssh_channel_read instead </para>
</xrefdescription></xrefsect><simplesect kind="warning"><para>This function doesn&apos;t work in nonblocking/timeout mode </para>
</simplesect>
<simplesect kind="see"><para><ref refid="group__libssh__channel_1gac92381c4c5d4a7eab35f6e84686f033d" kindref="member">ssh_channel_read</ref> </para>
</simplesect>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/channels.c" line="2731" column="5" bodyfile="src/channels.c" bodystart="2731" bodyend="2790"/>
        <references refid="benchmarks_8c_1aff2566f4c366b48d73479bef43ee4d2e" compoundref="benchmarks_8c" startline="347">buffer</references>
        <references refid="structssh__channel__struct_1a0832dc830d09accd2f3a8f8349c3faf2" compoundref="channels_8h" startline="63">ssh_channel_struct::session</references>
        <references refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" compoundref="torture__session__keys_8c" startline="61">session</references>
        <references refid="libssh_8h_1a92d37237bf129961367accd4a9e0dcfc">ssh_buffer_add_data</references>
        <references refid="libssh_8h_1ac8802ff7f5348d0145dab5242623f740">ssh_buffer_reinit</references>
        <references refid="group__libssh__channel_1gab535264029443d77214c0615a0788b0a" compoundref="channels_8c" startline="1596" endline="1608">ssh_channel_is_eof</references>
        <references refid="group__libssh__channel_1ga157f7d1df5de07ec6c6976e2034ba6e2" compoundref="channels_8c" startline="3038" endline="3069">ssh_channel_poll</references>
        <references refid="group__libssh__channel_1gac92381c4c5d4a7eab35f6e84686f033d" compoundref="channels_8c" startline="2831" endline="2838">ssh_channel_read</references>
        <references refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" compoundref="libssh_8h" startline="330">SSH_ERROR</references>
        <references refid="group__libssh__session_1gaa0e04dc9e24d5112a5ca2b7bd68031d0" compoundref="session_8c" startline="633" endline="665">ssh_handle_packets</references>
        <references refid="priv_8h_1a351ea86857d33b3ba80b396e05c4517c" compoundref="priv_8h" startline="269">ssh_set_error_invalid</references>
        <references refid="priv_8h_1ae280c413c792e04237f000841ac8ce44" compoundref="priv_8h" startline="265">ssh_set_error_oom</references>
        <references refid="session_8h_1ae931fa7865b3e4d87c18b5bd5e44e74e" compoundref="session_8h" startline="80">SSH_TIMEOUT_INFINITE</references>
      </memberdef>
      <memberdef kind="function" id="group__libssh__channel_1ga7e90618e682963ae420321a16102d213" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>static int ssh_channel_read_termination</definition>
        <argsstring>(void *s)</argsstring>
        <name>ssh_channel_read_termination</name>
        <param>
          <type>void *</type>
          <declname>s</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/channels.c" line="2798" column="12" bodyfile="src/channels.c" bodystart="2798" bodyend="2806"/>
        <references refid="pkd__daemon_8c_1a369ae25f82baa025322b03deb70aa5f3">ctx</references>
        <references refid="test__socket_8c_1a73991beba1accdcc64730cb00c146fe2" compoundref="test__socket_8c" startline="34">s</references>
        <references refid="libssh_8h_1a61400c7267feb254046cd606a3fdfdbc">ssh_buffer_get_len</references>
        <references refid="session_8h_1a9bbd1d5ae11485e27279be6ad461992ca855474fc84a2fb170fcb72546af8eeb8" compoundref="session_8h" startline="46">SSH_SESSION_STATE_ERROR</references>
        <referencedby refid="group__libssh__channel_1gab56c7b7959e4c23959f2989468811661" compoundref="channels_8c" startline="3090" endline="3135">ssh_channel_poll_timeout</referencedby>
        <referencedby refid="group__libssh__channel_1ga2f4e02cb3b3adbc30a534623164068fd" compoundref="channels_8c" startline="2863" endline="2960">ssh_channel_read_timeout</referencedby>
      </memberdef>
      <memberdef kind="function" id="group__libssh__channel_1gac92381c4c5d4a7eab35f6e84686f033d" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>int ssh_channel_read</definition>
        <argsstring>(ssh_channel channel, void *dest, uint32_t count, int is_stderr)</argsstring>
        <name>ssh_channel_read</name>
        <param>
          <type><ref refid="libssh_8h_1aca32be8db7c865697a3de381dc7e9fc3" kindref="member">ssh_channel</ref></type>
          <declname>channel</declname>
        </param>
        <param>
          <type>void *</type>
          <declname>dest</declname>
        </param>
        <param>
          <type>uint32_t</type>
          <declname>count</declname>
        </param>
        <param>
          <type>int</type>
          <declname>is_stderr</declname>
        </param>
        <briefdescription>
<para>Reads data from a channel. </para>
        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername direction="in">channel</parametername>
</parameternamelist>
<parameterdescription>
<para>The channel to read from.</para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">dest</parametername>
</parameternamelist>
<parameterdescription>
<para>The destination buffer which will get the data.</para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">count</parametername>
</parameternamelist>
<parameterdescription>
<para>The count of bytes to be read.</para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">is_stderr</parametername>
</parameternamelist>
<parameterdescription>
<para>A boolean value to mark reading from the stderr flow.</para>
</parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>The number of bytes read, 0 on end of file or SSH_ERROR on error. In nonblocking mode it Can return 0 if no data is available or SSH_AGAIN.</para>
</simplesect>
<simplesect kind="warning"><para>This function may return less than count bytes of data, and won&apos;t block until count bytes have been read. </para>
</simplesect>
<simplesect kind="warning"><para>The read function using a buffer has been renamed to <ref refid="group__libssh__channel_1gab391f5c978cb1bc8df3ebd061f38e8c5" kindref="member">channel_read_buffer()</ref>. </para>
</simplesect>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/channels.c" line="2831" column="5" bodyfile="src/channels.c" bodystart="2831" bodyend="2838"/>
        <references refid="group__libssh__channel_1ga068a064822da15bbc84f0b888b3791e3" compoundref="channels_8c" startline="2793">ssh_channel_read_termination_struct::channel</references>
        <references refid="group__libssh__channel_1ga56d60a9f4b6cd70f239fdc20ebc0d17c" compoundref="channels_8c" startline="2794">ssh_channel_read_termination_struct::count</references>
        <references refid="group__libssh__channel_1ga2f4e02cb3b3adbc30a534623164068fd" compoundref="channels_8c" startline="2863" endline="2960">ssh_channel_read_timeout</references>
        <references refid="session_8h_1aa8c8d35c7f83d7b00218ebadfac2254b" compoundref="session_8h" startline="84">SSH_TIMEOUT_DEFAULT</references>
        <referencedby refid="agent_8c_1a5de461e227daa4f58be39d898ad861fb" compoundref="agent_8c" startline="66" endline="124">atomicio</referencedby>
        <referencedby refid="bench__raw_8c_1afd64b09e9ae3ce2136328be2cd0bac89" compoundref="bench__raw_8c" startline="227" endline="285">benchmarks_raw_down</referencedby>
        <referencedby refid="bench__raw_8c_1a070a579a7a62c222e5f28c9e074c0df7" compoundref="bench__raw_8c" startline="107" endline="182">benchmarks_raw_up</referencedby>
        <referencedby refid="legacy_8h_1af283d59d8d5ac489e00d93a487f89687" compoundref="legacy_8c" startline="225" endline="227">channel_read</referencedby>
        <referencedby refid="group__libssh__channel_1gab391f5c978cb1bc8df3ebd061f38e8c5" compoundref="channels_8c" startline="2731" endline="2790">channel_read_buffer</referencedby>
        <referencedby refid="scp__download_8c_1abf8ad844320270e1c0b49e510c9bb4a0" compoundref="scp__download_8c" startline="61" endline="100">create_files</referencedby>
        <referencedby refid="test__exec_8c_1acbd4f6c4ecc68d1c4cc45223741be81c" compoundref="test__exec_8c" startline="10" endline="49">do_connect</referencedby>
        <referencedby refid="exec_8c_1a840291bc02cba5474a4cb46a9b9566fe" compoundref="exec_8c" startline="7" endline="66">main</referencedby>
        <referencedby refid="sshnetcat_8c_1a38ba4d370f756491ce0d55e0c320d08b" compoundref="sshnetcat_8c" startline="77" endline="175">select_loop</referencedby>
        <referencedby refid="group__libssh__channel_1gaaca5a3fbe9839c3ffb37b746afc35f4c" compoundref="channels_8c" startline="2983" endline="3022">ssh_channel_read_nonblocking</referencedby>
        <referencedby refid="group__libssh__scp_1ga14d31059dcf6fb2325fb960da8e4474e" compoundref="scp_8c" startline="241" endline="277">ssh_scp_close</referencedby>
        <referencedby refid="group__libssh__scp_1ga10bf627407959b51a7c39b37e8d46460" compoundref="scp_8c" startline="956" endline="1014">ssh_scp_read</referencedby>
        <referencedby refid="group__libssh__scp_1ga0be44d8a450767d92668d36d1beb43b9" compoundref="scp_8c" startline="718" endline="748">ssh_scp_read_string</referencedby>
        <referencedby refid="group__libssh__scp_1gab713864881af7ebda7e1e9c609fdf604" compoundref="scp_8c" startline="574" endline="628">ssh_scp_response</referencedby>
        <referencedby refid="torture__session_8c_1a99c33d74eaa8af7ac88d2b2ffe1299ca" compoundref="torture__session_8c" startline="83" endline="119">torture_channel_read_error</referencedby>
        <referencedby refid="torture__request__env_8c_1af673d397cb089d358c279e3e6e082388" compoundref="torture__request__env_8c" startline="78" endline="118">torture_request_env</referencedby>
      </memberdef>
      <memberdef kind="function" id="group__libssh__channel_1ga2f4e02cb3b3adbc30a534623164068fd" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>int ssh_channel_read_timeout</definition>
        <argsstring>(ssh_channel channel, void *dest, uint32_t count, int is_stderr, int timeout_ms)</argsstring>
        <name>ssh_channel_read_timeout</name>
        <param>
          <type><ref refid="libssh_8h_1aca32be8db7c865697a3de381dc7e9fc3" kindref="member">ssh_channel</ref></type>
          <declname>channel</declname>
        </param>
        <param>
          <type>void *</type>
          <declname>dest</declname>
        </param>
        <param>
          <type>uint32_t</type>
          <declname>count</declname>
        </param>
        <param>
          <type>int</type>
          <declname>is_stderr</declname>
        </param>
        <param>
          <type>int</type>
          <declname>timeout_ms</declname>
        </param>
        <briefdescription>
<para>Reads data from a channel. </para>
        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername direction="in">channel</parametername>
</parameternamelist>
<parameterdescription>
<para>The channel to read from.</para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">dest</parametername>
</parameternamelist>
<parameterdescription>
<para>The destination buffer which will get the data.</para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">count</parametername>
</parameternamelist>
<parameterdescription>
<para>The count of bytes to be read.</para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">is_stderr</parametername>
</parameternamelist>
<parameterdescription>
<para>A boolean value to mark reading from the stderr flow.</para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">timeout_ms</parametername>
</parameternamelist>
<parameterdescription>
<para>A timeout in milliseconds. A value of -1 means infinite timeout.</para>
</parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>The number of bytes read, 0 on end of file or SSH_ERROR on error. In nonblocking mode it Can return 0 if no data is available or SSH_AGAIN.</para>
</simplesect>
<simplesect kind="warning"><para>This function may return less than count bytes of data, and won&apos;t block until count bytes have been read. </para>
</simplesect>
<simplesect kind="warning"><para>The read function using a buffer has been renamed to <ref refid="group__libssh__channel_1gab391f5c978cb1bc8df3ebd061f38e8c5" kindref="member">channel_read_buffer()</ref>. </para>
</simplesect>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/channels.c" line="2863" column="5" bodyfile="src/channels.c" bodystart="2863" bodyend="2960"/>
        <references refid="group__libssh__channel_1ga068a064822da15bbc84f0b888b3791e3" compoundref="channels_8c" startline="2793">ssh_channel_read_termination_struct::channel</references>
        <references refid="group__libssh__channel_1ga56d60a9f4b6cd70f239fdc20ebc0d17c" compoundref="channels_8c" startline="2794">ssh_channel_read_termination_struct::count</references>
        <references refid="structssh__channel__struct_1ab1beeacd4aff735258cb7488c079c6dc" compoundref="channels_8h" startline="84">ssh_channel_struct::counter</references>
        <references refid="pkd__daemon_8c_1a369ae25f82baa025322b03deb70aa5f3">ctx</references>
        <references refid="group__libssh__channel_1gac4fc789667578e8f0e2614f5274c9b5f" compoundref="channels_8c" startline="395" endline="440">grow_window</references>
        <references refid="structssh__counter__struct_1a4fb86ab2536688750c960f58ac414c79" compoundref="libssh_8h" startline="109">ssh_counter_struct::in_bytes</references>
        <references refid="structssh__channel__struct_1a7067e2963e961729416849785c1d1bd3" compoundref="channels_8h" startline="65">ssh_channel_struct::local_window</references>
        <references refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" compoundref="pkd__daemon_8c" startline="62">rc</references>
        <references refid="structssh__channel__struct_1a01fee161bb195c61e434e9bc7b330187" compoundref="channels_8h" startline="71">ssh_channel_struct::remote_eof</references>
        <references refid="structssh__channel__struct_1a0832dc830d09accd2f3a8f8349c3faf2" compoundref="channels_8h" startline="63">ssh_channel_struct::session</references>
        <references refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" compoundref="torture__session__keys_8c" startline="61">session</references>
        <references refid="structssh__session__struct_1a6f74d1a1eb6ed715b1073b67caa18460" compoundref="session_8h" startline="147">ssh_session_struct::session_state</references>
        <references refid="libssh_8h_1a240b02fb7c0475fbb5996d1f759221ee">ssh_buffer_get</references>
        <references refid="libssh_8h_1a61400c7267feb254046cd606a3fdfdbc">ssh_buffer_get_len</references>
        <references refid="buffer_8h_1a226d198c4274fac7c354b6a340049d47">ssh_buffer_pass_bytes</references>
        <references refid="group__libssh__channel_1ga7e90618e682963ae420321a16102d213" compoundref="channels_8c" startline="2798" endline="2806">ssh_channel_read_termination</references>
        <references refid="channels_8h_1a5a002159e5db31d156bb2a8ce8a10cd1a96872cd3f6e98f6f040097e3ee6cb900" compoundref="channels_8h" startline="47">SSH_CHANNEL_STATE_CLOSED</references>
        <references refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" compoundref="libssh_8h" startline="330">SSH_ERROR</references>
        <references refid="libssh_8h_1a036b2b00fb04337a4d06d719d1b62be1a86ff0b2e8da6ad8628efc556b6ce1887" compoundref="libssh_8h" startline="286">SSH_FATAL</references>
        <references refid="group__libssh__session_1ga4b84e1ae757c0d4007a5eefdf4651694" compoundref="session_8c" startline="692" endline="740">ssh_handle_packets_termination</references>
        <references refid="priv_8h_1aa21fd8a7a609329603b7b16da7939fca" compoundref="priv_8h" startline="240">SSH_LOG</references>
        <references refid="group__libssh__log_1ggadf764cbdea00d65edcd07bb9953ad2b7a6445dfe21592d69d9741d319538b6673" compoundref="libssh_8h" startline="352">SSH_LOG_PACKET</references>
        <references refid="session_8h_1a9bbd1d5ae11485e27279be6ad461992ca855474fc84a2fb170fcb72546af8eeb8" compoundref="session_8h" startline="46">SSH_SESSION_STATE_ERROR</references>
        <references refid="priv_8h_1a55177b3e8db90ca9adb435c44281963c" compoundref="priv_8h" startline="258">ssh_set_error</references>
        <references refid="priv_8h_1a351ea86857d33b3ba80b396e05c4517c" compoundref="priv_8h" startline="269">ssh_set_error_invalid</references>
        <references refid="session_8h_1aa8c8d35c7f83d7b00218ebadfac2254b" compoundref="session_8h" startline="84">SSH_TIMEOUT_DEFAULT</references>
        <references refid="session_8h_1ae931fa7865b3e4d87c18b5bd5e44e74e" compoundref="session_8h" startline="80">SSH_TIMEOUT_INFINITE</references>
        <references refid="structssh__channel__struct_1a272b198e279fa672afeaf9f2e610eb04" compoundref="channels_8h" startline="73">ssh_channel_struct::state</references>
        <references refid="structssh__channel__struct_1a6806319dfa8f417bbad93f6481ad99d4" compoundref="channels_8h" startline="77">ssh_channel_struct::stderr_buffer</references>
        <references refid="structssh__channel__struct_1a8ae1473aafd716256ce762d0115b2321" compoundref="channels_8h" startline="76">ssh_channel_struct::stdout_buffer</references>
        <references refid="channels_8c_1aebda54a24a840f266fcc864e4940f749" compoundref="channels_8c" startline="52">WINDOWLIMIT</references>
        <referencedby refid="classssh_1_1Channel_1a5bfcd6a3986d8a88128a806c062bbf3a" compoundref="libsshpp_8hpp" startline="545" endline="553">ssh::Channel::read</referencedby>
        <referencedby refid="group__libssh__channel_1gac92381c4c5d4a7eab35f6e84686f033d" compoundref="channels_8c" startline="2831" endline="2838">ssh_channel_read</referencedby>
      </memberdef>
      <memberdef kind="function" id="group__libssh__channel_1gaaca5a3fbe9839c3ffb37b746afc35f4c" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>int ssh_channel_read_nonblocking</definition>
        <argsstring>(ssh_channel channel, void *dest, uint32_t count, int is_stderr)</argsstring>
        <name>ssh_channel_read_nonblocking</name>
        <param>
          <type><ref refid="libssh_8h_1aca32be8db7c865697a3de381dc7e9fc3" kindref="member">ssh_channel</ref></type>
          <declname>channel</declname>
        </param>
        <param>
          <type>void *</type>
          <declname>dest</declname>
        </param>
        <param>
          <type>uint32_t</type>
          <declname>count</declname>
        </param>
        <param>
          <type>int</type>
          <declname>is_stderr</declname>
        </param>
        <briefdescription>
<para>Do a nonblocking read on the channel. </para>
        </briefdescription>
        <detaileddescription>
<para>A nonblocking read on the specified channel. it will return &lt;= count bytes of data read atomically.</para>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername direction="in">channel</parametername>
</parameternamelist>
<parameterdescription>
<para>The channel to read from.</para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">dest</parametername>
</parameternamelist>
<parameterdescription>
<para>A pointer to a destination buffer.</para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">count</parametername>
</parameternamelist>
<parameterdescription>
<para>The count of bytes of data to be read.</para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">is_stderr</parametername>
</parameternamelist>
<parameterdescription>
<para>A boolean to select the stderr stream.</para>
</parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>The number of bytes read, 0 if nothing is available or SSH_ERROR on error.</para>
</simplesect>
<simplesect kind="warning"><para>Don&apos;t forget to check for EOF as it would return 0 here.</para>
</simplesect>
<simplesect kind="see"><para><ref refid="group__libssh__channel_1gab535264029443d77214c0615a0788b0a" kindref="member">ssh_channel_is_eof()</ref> </para>
</simplesect>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/channels.c" line="2983" column="5" bodyfile="src/channels.c" bodystart="2983" bodyend="3022"/>
        <references refid="group__libssh__channel_1ga068a064822da15bbc84f0b888b3791e3" compoundref="channels_8c" startline="2793">ssh_channel_read_termination_struct::channel</references>
        <references refid="group__libssh__channel_1ga56d60a9f4b6cd70f239fdc20ebc0d17c" compoundref="channels_8c" startline="2794">ssh_channel_read_termination_struct::count</references>
        <references refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" compoundref="pkd__daemon_8c" startline="62">rc</references>
        <references refid="structssh__channel__struct_1a0832dc830d09accd2f3a8f8349c3faf2" compoundref="channels_8h" startline="63">ssh_channel_struct::session</references>
        <references refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" compoundref="torture__session__keys_8c" startline="61">session</references>
        <references refid="structssh__session__struct_1a6f74d1a1eb6ed715b1073b67caa18460" compoundref="session_8h" startline="147">ssh_session_struct::session_state</references>
        <references refid="group__libssh__channel_1ga157f7d1df5de07ec6c6976e2034ba6e2" compoundref="channels_8c" startline="3038" endline="3069">ssh_channel_poll</references>
        <references refid="group__libssh__channel_1gac92381c4c5d4a7eab35f6e84686f033d" compoundref="channels_8c" startline="2831" endline="2838">ssh_channel_read</references>
        <references refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" compoundref="libssh_8h" startline="330">SSH_ERROR</references>
        <references refid="group__libssh__session_1ga0c959bde817801ac5de2db1e64b52f26" compoundref="session_8c" startline="497" endline="500">ssh_is_blocking</references>
        <references refid="session_8h_1a9bbd1d5ae11485e27279be6ad461992ca855474fc84a2fb170fcb72546af8eeb8" compoundref="session_8h" startline="46">SSH_SESSION_STATE_ERROR</references>
        <references refid="group__libssh__session_1ga2a29cff08855611be84d050e5bec73bc" compoundref="session_8c" startline="482" endline="489">ssh_set_blocking</references>
        <references refid="priv_8h_1a351ea86857d33b3ba80b396e05c4517c" compoundref="priv_8h" startline="269">ssh_set_error_invalid</references>
        <referencedby refid="legacy_8h_1afe7a9a58426da98f67fd755426bf2b3b" compoundref="legacy_8c" startline="236" endline="239">channel_read_nonblocking</referencedby>
        <referencedby refid="test__tunnel_8c_1acbd4f6c4ecc68d1c4cc45223741be81c" compoundref="test__tunnel_8c" startline="10" endline="63">do_connect</referencedby>
        <referencedby refid="classssh_1_1Channel_1aef42ee6d77142e1a8369e06173ea550d" compoundref="libsshpp_8hpp" startline="572" endline="580">ssh::Channel::readNonblocking</referencedby>
        <referencedby refid="connector_8c_1a4cc7de304441a1cdb59c3656ad1a1678" compoundref="connector_8c" startline="513" endline="563">ssh_connector_channel_write_wontblock_cb</referencedby>
        <referencedby refid="connector_8c_1ad13c8d29eb297a425c51a53379450dd1" compoundref="connector_8c" startline="327" endline="370">ssh_connector_fd_out_cb</referencedby>
      </memberdef>
      <memberdef kind="function" id="group__libssh__channel_1ga157f7d1df5de07ec6c6976e2034ba6e2" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>int ssh_channel_poll</definition>
        <argsstring>(ssh_channel channel, int is_stderr)</argsstring>
        <name>ssh_channel_poll</name>
        <param>
          <type><ref refid="libssh_8h_1aca32be8db7c865697a3de381dc7e9fc3" kindref="member">ssh_channel</ref></type>
          <declname>channel</declname>
        </param>
        <param>
          <type>int</type>
          <declname>is_stderr</declname>
        </param>
        <briefdescription>
<para>Polls a channel for data to read. </para>
        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername direction="in">channel</parametername>
</parameternamelist>
<parameterdescription>
<para>The channel to poll.</para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">is_stderr</parametername>
</parameternamelist>
<parameterdescription>
<para>A boolean to select the stderr stream.</para>
</parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>The number of bytes available for reading, 0 if nothing is available or SSH_ERROR on error.</para>
</simplesect>
<simplesect kind="warning"><para>When the channel is in EOF state, the function returns SSH_EOF.</para>
</simplesect>
<simplesect kind="see"><para><ref refid="group__libssh__channel_1gab535264029443d77214c0615a0788b0a" kindref="member">ssh_channel_is_eof()</ref> </para>
</simplesect>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/channels.c" line="3038" column="5" bodyfile="src/channels.c" bodystart="3038" bodyend="3069"/>
        <references refid="group__libssh__channel_1ga068a064822da15bbc84f0b888b3791e3" compoundref="channels_8c" startline="2793">ssh_channel_read_termination_struct::channel</references>
        <references refid="structssh__channel__struct_1a01fee161bb195c61e434e9bc7b330187" compoundref="channels_8h" startline="71">ssh_channel_struct::remote_eof</references>
        <references refid="structssh__channel__struct_1a0832dc830d09accd2f3a8f8349c3faf2" compoundref="channels_8h" startline="63">ssh_channel_struct::session</references>
        <references refid="structssh__session__struct_1a6f74d1a1eb6ed715b1073b67caa18460" compoundref="session_8h" startline="147">ssh_session_struct::session_state</references>
        <references refid="libssh_8h_1a61400c7267feb254046cd606a3fdfdbc">ssh_buffer_get_len</references>
        <references refid="libssh_8h_1a8f938067bd84c30bd28b7c2705a37beb" compoundref="libssh_8h" startline="332">SSH_EOF</references>
        <references refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" compoundref="libssh_8h" startline="330">SSH_ERROR</references>
        <references refid="group__libssh__session_1gaa0e04dc9e24d5112a5ca2b7bd68031d0" compoundref="session_8c" startline="633" endline="665">ssh_handle_packets</references>
        <references refid="session_8h_1a9bbd1d5ae11485e27279be6ad461992ca855474fc84a2fb170fcb72546af8eeb8" compoundref="session_8h" startline="46">SSH_SESSION_STATE_ERROR</references>
        <references refid="session_8h_1a5dc7677b987888e7db552768afc9d9c6" compoundref="session_8h" startline="86">SSH_TIMEOUT_NONBLOCKING</references>
        <references refid="structssh__channel__struct_1a6806319dfa8f417bbad93f6481ad99d4" compoundref="channels_8h" startline="77">ssh_channel_struct::stderr_buffer</references>
        <references refid="structssh__channel__struct_1a8ae1473aafd716256ce762d0115b2321" compoundref="channels_8h" startline="76">ssh_channel_struct::stdout_buffer</references>
        <referencedby refid="legacy_8h_1af52849183ebe96a3836a8dad235a160c" compoundref="legacy_8c" startline="221" endline="223">channel_poll</referencedby>
        <referencedby refid="group__libssh__channel_1gab391f5c978cb1bc8df3ebd061f38e8c5" compoundref="channels_8c" startline="2731" endline="2790">channel_read_buffer</referencedby>
        <referencedby refid="test__tunnel_8c_1acbd4f6c4ecc68d1c4cc45223741be81c" compoundref="test__tunnel_8c" startline="10" endline="63">do_connect</referencedby>
        <referencedby refid="classssh_1_1Channel_1a661394ceb03e65bb7c02e040d23d6fc8" compoundref="libsshpp_8hpp" startline="540" endline="544">ssh::Channel::poll</referencedby>
        <referencedby refid="sshnetcat_8c_1a38ba4d370f756491ce0d55e0c320d08b" compoundref="sshnetcat_8c" startline="77" endline="175">select_loop</referencedby>
        <referencedby refid="group__libssh__channel_1gaaca5a3fbe9839c3ffb37b746afc35f4c" compoundref="channels_8c" startline="2983" endline="3022">ssh_channel_read_nonblocking</referencedby>
        <referencedby refid="group__libssh__scp_1ga11f48e2cf62bcec20d9232ed3ca41752" compoundref="scp_8c" startline="642" endline="702">ssh_scp_write</referencedby>
        <referencedby refid="group__libssh__session_1ga86cbf041bced56d18a2a5248c46cecb4" compoundref="connect_8c" startline="316" endline="395">ssh_select</referencedby>
      </memberdef>
      <memberdef kind="function" id="group__libssh__channel_1gab56c7b7959e4c23959f2989468811661" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>int ssh_channel_poll_timeout</definition>
        <argsstring>(ssh_channel channel, int timeout, int is_stderr)</argsstring>
        <name>ssh_channel_poll_timeout</name>
        <param>
          <type><ref refid="libssh_8h_1aca32be8db7c865697a3de381dc7e9fc3" kindref="member">ssh_channel</ref></type>
          <declname>channel</declname>
        </param>
        <param>
          <type>int</type>
          <declname>timeout</declname>
        </param>
        <param>
          <type>int</type>
          <declname>is_stderr</declname>
        </param>
        <briefdescription>
<para>Polls a channel for data to read, waiting for a certain timeout. </para>
        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername direction="in">channel</parametername>
</parameternamelist>
<parameterdescription>
<para>The channel to poll. </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">timeout</parametername>
</parameternamelist>
<parameterdescription>
<para>Set an upper limit on the time for which this function will block, in milliseconds. Specifying a negative value means an infinite timeout. This parameter is passed to the poll() function. </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">is_stderr</parametername>
</parameternamelist>
<parameterdescription>
<para>A boolean to select the stderr stream.</para>
</parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>The number of bytes available for reading, 0 if nothing is available (timeout elapsed), SSH_EOF on end of file, SSH_ERROR on error.</para>
</simplesect>
<simplesect kind="warning"><para>When the channel is in EOF state, the function returns SSH_EOF.</para>
</simplesect>
<simplesect kind="see"><para><ref refid="group__libssh__channel_1gab535264029443d77214c0615a0788b0a" kindref="member">ssh_channel_is_eof()</ref> </para>
</simplesect>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/channels.c" line="3090" column="5" bodyfile="src/channels.c" bodystart="3090" bodyend="3135"/>
        <references refid="group__libssh__channel_1ga068a064822da15bbc84f0b888b3791e3" compoundref="channels_8c" startline="2793">ssh_channel_read_termination_struct::channel</references>
        <references refid="pkd__daemon_8c_1a369ae25f82baa025322b03deb70aa5f3">ctx</references>
        <references refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" compoundref="pkd__daemon_8c" startline="62">rc</references>
        <references refid="structssh__channel__struct_1a01fee161bb195c61e434e9bc7b330187" compoundref="channels_8h" startline="71">ssh_channel_struct::remote_eof</references>
        <references refid="structssh__channel__struct_1a0832dc830d09accd2f3a8f8349c3faf2" compoundref="channels_8h" startline="63">ssh_channel_struct::session</references>
        <references refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" compoundref="torture__session__keys_8c" startline="61">session</references>
        <references refid="structssh__session__struct_1a6f74d1a1eb6ed715b1073b67caa18460" compoundref="session_8h" startline="147">ssh_session_struct::session_state</references>
        <references refid="libssh_8h_1a61400c7267feb254046cd606a3fdfdbc">ssh_buffer_get_len</references>
        <references refid="group__libssh__channel_1ga7e90618e682963ae420321a16102d213" compoundref="channels_8c" startline="2798" endline="2806">ssh_channel_read_termination</references>
        <references refid="libssh_8h_1a8f938067bd84c30bd28b7c2705a37beb" compoundref="libssh_8h" startline="332">SSH_EOF</references>
        <references refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" compoundref="libssh_8h" startline="330">SSH_ERROR</references>
        <references refid="group__libssh__session_1ga4b84e1ae757c0d4007a5eefdf4651694" compoundref="session_8c" startline="692" endline="740">ssh_handle_packets_termination</references>
        <references refid="session_8h_1a9bbd1d5ae11485e27279be6ad461992ca855474fc84a2fb170fcb72546af8eeb8" compoundref="session_8h" startline="46">SSH_SESSION_STATE_ERROR</references>
        <references refid="structssh__channel__struct_1a6806319dfa8f417bbad93f6481ad99d4" compoundref="channels_8h" startline="77">ssh_channel_struct::stderr_buffer</references>
        <references refid="structssh__channel__struct_1a8ae1473aafd716256ce762d0115b2321" compoundref="channels_8h" startline="76">ssh_channel_struct::stdout_buffer</references>
        <referencedby refid="priv_8h_1a84015bb99d7ac6fe60fe6e61dbd0e1cf" compoundref="connector_8c" startline="565" endline="628">ssh_connector_set_event</referencedby>
      </memberdef>
      <memberdef kind="function" id="group__libssh__channel_1ga747aa5315575aa7ac9d8367c7372d8dd" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="libssh_8h_1a02d3754de040612632cdd499c20f92f6" kindref="member">ssh_session</ref></type>
        <definition>ssh_session ssh_channel_get_session</definition>
        <argsstring>(ssh_channel channel)</argsstring>
        <name>ssh_channel_get_session</name>
        <param>
          <type><ref refid="libssh_8h_1aca32be8db7c865697a3de381dc7e9fc3" kindref="member">ssh_channel</ref></type>
          <declname>channel</declname>
        </param>
        <briefdescription>
<para>Recover the session in which belongs a channel. </para>
        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername direction="in">channel</parametername>
</parameternamelist>
<parameterdescription>
<para>The channel to recover the session from.</para>
</parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>The session pointer. </para>
</simplesect>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/channels.c" line="3144" column="13" bodyfile="src/channels.c" bodystart="3144" bodyend="3150"/>
        <references refid="group__libssh__channel_1ga068a064822da15bbc84f0b888b3791e3" compoundref="channels_8c" startline="2793">ssh_channel_read_termination_struct::channel</references>
        <references refid="structssh__channel__struct_1a0832dc830d09accd2f3a8f8349c3faf2" compoundref="channels_8h" startline="63">ssh_channel_struct::session</references>
        <referencedby refid="legacy_8h_1adbf18c187ac5794c54e336e96c178779" compoundref="legacy_8c" startline="191" endline="193">channel_get_session</referencedby>
        <referencedby refid="sshd__direct-tcpip_8c_1acb2eaf207c01cc503bec863448734a4f" compoundref="sshd__direct-tcpip_8c" startline="295" endline="388">my_fd_data_function</referencedby>
        <referencedby refid="priv_8h_1ad92def69fc9cce5d1d564588e668a862" compoundref="connector_8c" startline="630" endline="659">ssh_connector_remove_event</referencedby>
        <referencedby refid="priv_8h_1a84015bb99d7ac6fe60fe6e61dbd0e1cf" compoundref="connector_8c" startline="565" endline="628">ssh_connector_set_event</referencedby>
      </memberdef>
      <memberdef kind="function" id="group__libssh__channel_1gae6aa1eaafbacaa66577600e0c811ffd2" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>static int ssh_channel_exit_status_termination</definition>
        <argsstring>(void *c)</argsstring>
        <name>ssh_channel_exit_status_termination</name>
        <param>
          <type>void *</type>
          <declname>c</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/channels.c" line="3152" column="12" bodyfile="src/channels.c" bodystart="3152" bodyend="3162"/>
        <references refid="group__libssh__channel_1ga068a064822da15bbc84f0b888b3791e3" compoundref="channels_8c" startline="2793">ssh_channel_read_termination_struct::channel</references>
        <references refid="structssh__channel__struct_1a3e9106e477bee737abed43d8c57a7bd6" compoundref="channels_8h" startline="79">ssh_channel_struct::exit_status</references>
        <references refid="structssh__channel__struct_1a400dc0c0dc7cd02daaea731825c1a7c4" compoundref="channels_8h" startline="75">ssh_channel_struct::flags</references>
        <references refid="structssh__channel__struct_1a0832dc830d09accd2f3a8f8349c3faf2" compoundref="channels_8h" startline="63">ssh_channel_struct::session</references>
        <references refid="structssh__session__struct_1a6f74d1a1eb6ed715b1073b67caa18460" compoundref="session_8h" startline="147">ssh_session_struct::session_state</references>
        <references refid="channels_8h_1ade088105d65a071041027d9215213071" compoundref="channels_8h" startline="51">SSH_CHANNEL_FLAG_CLOSED_REMOTE</references>
        <references refid="session_8h_1a9bbd1d5ae11485e27279be6ad461992ca855474fc84a2fb170fcb72546af8eeb8" compoundref="session_8h" startline="46">SSH_SESSION_STATE_ERROR</references>
        <referencedby refid="group__libssh__channel_1ga9eea019dd0bbaa8a817fff2c762d1a2d" compoundref="channels_8c" startline="3180" endline="3193">ssh_channel_get_exit_status</referencedby>
      </memberdef>
      <memberdef kind="function" id="group__libssh__channel_1ga9eea019dd0bbaa8a817fff2c762d1a2d" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>int ssh_channel_get_exit_status</definition>
        <argsstring>(ssh_channel channel)</argsstring>
        <name>ssh_channel_get_exit_status</name>
        <param>
          <type><ref refid="libssh_8h_1aca32be8db7c865697a3de381dc7e9fc3" kindref="member">ssh_channel</ref></type>
          <declname>channel</declname>
        </param>
        <briefdescription>
<para>Get the exit status of the channel (error code from the executed instruction). </para>
        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername direction="in">channel</parametername>
</parameternamelist>
<parameterdescription>
<para>The channel to get the status from.</para>
</parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>The exit status, -1 if no exit status has been returned (yet), or SSH_ERROR on error. </para>
</simplesect>
<simplesect kind="warning"><para>This function may block until a timeout (or never) if the other side is not willing to close the channel.</para>
</simplesect>
If you&apos;re looking for an async handling of this register a callback for the exit status.</para>
<para><simplesect kind="see"><para><ref refid="group__libssh__callbacks_1ga6f834b43c812f871c7252bfbbb4ef6f4" kindref="member">ssh_channel_exit_status_callback</ref> </para>
</simplesect>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/channels.c" line="3180" column="5" bodyfile="src/channels.c" bodystart="3180" bodyend="3193"/>
        <references refid="group__libssh__channel_1ga068a064822da15bbc84f0b888b3791e3" compoundref="channels_8c" startline="2793">ssh_channel_read_termination_struct::channel</references>
        <references refid="structssh__channel__struct_1a3e9106e477bee737abed43d8c57a7bd6" compoundref="channels_8h" startline="79">ssh_channel_struct::exit_status</references>
        <references refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" compoundref="pkd__daemon_8c" startline="62">rc</references>
        <references refid="structssh__channel__struct_1a0832dc830d09accd2f3a8f8349c3faf2" compoundref="channels_8h" startline="63">ssh_channel_struct::session</references>
        <references refid="structssh__session__struct_1a6f74d1a1eb6ed715b1073b67caa18460" compoundref="session_8h" startline="147">ssh_session_struct::session_state</references>
        <references refid="group__libssh__channel_1gae6aa1eaafbacaa66577600e0c811ffd2" compoundref="channels_8c" startline="3152" endline="3162">ssh_channel_exit_status_termination</references>
        <references refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" compoundref="libssh_8h" startline="330">SSH_ERROR</references>
        <references refid="group__libssh__session_1ga4b84e1ae757c0d4007a5eefdf4651694" compoundref="session_8c" startline="692" endline="740">ssh_handle_packets_termination</references>
        <references refid="session_8h_1a9bbd1d5ae11485e27279be6ad461992ca855474fc84a2fb170fcb72546af8eeb8" compoundref="session_8h" startline="46">SSH_SESSION_STATE_ERROR</references>
        <references refid="session_8h_1aa8c8d35c7f83d7b00218ebadfac2254b" compoundref="session_8h" startline="84">SSH_TIMEOUT_DEFAULT</references>
        <referencedby refid="legacy_8h_1a18ff7f138d0cde945938576ca0eafb48" compoundref="legacy_8c" startline="187" endline="189">channel_get_exit_status</referencedby>
        <referencedby refid="test__exec_8c_1acbd4f6c4ecc68d1c4cc45223741be81c" compoundref="test__exec_8c" startline="10" endline="49">do_connect</referencedby>
        <referencedby refid="classssh_1_1Channel_1aa9bd03b50afa6f6c0126fe490e17112e" compoundref="libsshpp_8hpp" startline="503" endline="505">ssh::Channel::getExitStatus</referencedby>
      </memberdef>
      <memberdef kind="function" id="group__libssh__channel_1ga3a106d0c860b8ada098b4ed317c3cce4" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>static int channel_protocol_select</definition>
        <argsstring>(ssh_channel *rchans, ssh_channel *wchans, ssh_channel *echans, ssh_channel *rout, ssh_channel *wout, ssh_channel *eout)</argsstring>
        <name>channel_protocol_select</name>
        <param>
          <type><ref refid="libssh_8h_1aca32be8db7c865697a3de381dc7e9fc3" kindref="member">ssh_channel</ref> *</type>
          <declname>rchans</declname>
        </param>
        <param>
          <type><ref refid="libssh_8h_1aca32be8db7c865697a3de381dc7e9fc3" kindref="member">ssh_channel</ref> *</type>
          <declname>wchans</declname>
        </param>
        <param>
          <type><ref refid="libssh_8h_1aca32be8db7c865697a3de381dc7e9fc3" kindref="member">ssh_channel</ref> *</type>
          <declname>echans</declname>
        </param>
        <param>
          <type><ref refid="libssh_8h_1aca32be8db7c865697a3de381dc7e9fc3" kindref="member">ssh_channel</ref> *</type>
          <declname>rout</declname>
        </param>
        <param>
          <type><ref refid="libssh_8h_1aca32be8db7c865697a3de381dc7e9fc3" kindref="member">ssh_channel</ref> *</type>
          <declname>wout</declname>
        </param>
        <param>
          <type><ref refid="libssh_8h_1aca32be8db7c865697a3de381dc7e9fc3" kindref="member">ssh_channel</ref> *</type>
          <declname>eout</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/channels.c" line="3204" column="12" bodyfile="src/channels.c" bodystart="3204" bodyend="3250"/>
        <references refid="proxy_8c_1aadb4b99b6f71c3c49bd7b97096d033fa" compoundref="proxy_8c" startline="34">chan</references>
        <references refid="structssh__channel__struct_1a01fee161bb195c61e434e9bc7b330187" compoundref="channels_8h" startline="71">ssh_channel_struct::remote_eof</references>
        <references refid="structssh__channel__struct_1a1b5936420da03e6b64aa8f900eb8ad0c" compoundref="channels_8h" startline="70">ssh_channel_struct::remote_window</references>
        <references refid="structssh__channel__struct_1a0832dc830d09accd2f3a8f8349c3faf2" compoundref="channels_8h" startline="63">ssh_channel_struct::session</references>
        <references refid="structssh__session__struct_1a3e64318ee32b9880aafbded46fabf81d" compoundref="session_8h" startline="111">ssh_session_struct::socket</references>
        <references refid="libssh_8h_1a61400c7267feb254046cd606a3fdfdbc">ssh_buffer_get_len</references>
        <references refid="group__libssh__channel_1gab2720b44cb7f1dfe2b38ffe07c2f45c7" compoundref="channels_8c" startline="1582" endline="1587">ssh_channel_is_closed</references>
        <references refid="group__libssh__channel_1gaaafcda943c96ddb91e5c28c0bdee7045" compoundref="channels_8c" startline="1566" endline="1571">ssh_channel_is_open</references>
        <references refid="group__libssh__session_1gaa0e04dc9e24d5112a5ca2b7bd68031d0" compoundref="session_8c" startline="633" endline="665">ssh_handle_packets</references>
        <references refid="socket_8h_1a7b6d96bfb71ce6b9d5a4dc8406874691" compoundref="socket_8c" startline="744" endline="747">ssh_socket_data_available</references>
        <references refid="socket_8h_1ac9d2595a2e7ce42c7319d1dce077260c" compoundref="socket_8c" startline="749" endline="752">ssh_socket_data_writable</references>
        <references refid="socket_8h_1a29176fb6f348985227454a3f5daec745" compoundref="socket_8c" startline="525" endline="528">ssh_socket_is_open</references>
        <references refid="session_8h_1a5dc7677b987888e7db552768afc9d9c6" compoundref="session_8h" startline="86">SSH_TIMEOUT_NONBLOCKING</references>
        <references refid="structssh__channel__struct_1a6806319dfa8f417bbad93f6481ad99d4" compoundref="channels_8h" startline="77">ssh_channel_struct::stderr_buffer</references>
        <references refid="structssh__channel__struct_1a8ae1473aafd716256ce762d0115b2321" compoundref="channels_8h" startline="76">ssh_channel_struct::stdout_buffer</references>
        <referencedby refid="group__libssh__channel_1ga1026cfa48ecfc0b4898d4ea443acfc5d" compoundref="channels_8c" startline="3284" endline="3398">ssh_channel_select</referencedby>
      </memberdef>
      <memberdef kind="function" id="group__libssh__channel_1ga5f4fae06645c42c053e28b61ec186435" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>size_t</type>
        <definition>static size_t count_ptrs</definition>
        <argsstring>(ssh_channel *ptrs)</argsstring>
        <name>count_ptrs</name>
        <param>
          <type><ref refid="libssh_8h_1aca32be8db7c865697a3de381dc7e9fc3" kindref="member">ssh_channel</ref> *</type>
          <declname>ptrs</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/channels.c" line="3253" column="15" bodyfile="src/channels.c" bodystart="3253" bodyend="3260"/>
        <referencedby refid="group__libssh__channel_1ga1026cfa48ecfc0b4898d4ea443acfc5d" compoundref="channels_8c" startline="3284" endline="3398">ssh_channel_select</referencedby>
      </memberdef>
      <memberdef kind="function" id="group__libssh__channel_1ga1026cfa48ecfc0b4898d4ea443acfc5d" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>int ssh_channel_select</definition>
        <argsstring>(ssh_channel *readchans, ssh_channel *writechans, ssh_channel *exceptchans, struct timeval *timeout)</argsstring>
        <name>ssh_channel_select</name>
        <param>
          <type><ref refid="libssh_8h_1aca32be8db7c865697a3de381dc7e9fc3" kindref="member">ssh_channel</ref> *</type>
          <declname>readchans</declname>
        </param>
        <param>
          <type><ref refid="libssh_8h_1aca32be8db7c865697a3de381dc7e9fc3" kindref="member">ssh_channel</ref> *</type>
          <declname>writechans</declname>
        </param>
        <param>
          <type><ref refid="libssh_8h_1aca32be8db7c865697a3de381dc7e9fc3" kindref="member">ssh_channel</ref> *</type>
          <declname>exceptchans</declname>
        </param>
        <param>
          <type>struct timeval *</type>
          <declname>timeout</declname>
        </param>
        <briefdescription>
<para>Act like the standard select(2) on channels. </para>
        </briefdescription>
        <detaileddescription>
<para>The list of pointers are then actualized and will only contain pointers to channels that are respectively readable, writable or have an exception to trap.</para>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername direction="in">readchans</parametername>
</parameternamelist>
<parameterdescription>
<para>A NULL pointer or an array of channel pointers, terminated by a NULL.</para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">writechans</parametername>
</parameternamelist>
<parameterdescription>
<para>A NULL pointer or an array of channel pointers, terminated by a NULL.</para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">exceptchans</parametername>
</parameternamelist>
<parameterdescription>
<para>A NULL pointer or an array of channel pointers, terminated by a NULL.</para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">timeout</parametername>
</parameternamelist>
<parameterdescription>
<para>Timeout as defined by select(2).</para>
</parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>SSH_OK on a successful operation, SSH_EINTR if the select(2) syscall was interrupted, then relaunch the function, or SSH_ERROR on error. </para>
</simplesect>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/channels.c" line="3284" column="5" bodyfile="src/channels.c" bodystart="3284" bodyend="3398"/>
        <references refid="group__libssh__channel_1ga3a106d0c860b8ada098b4ed317c3cce4" compoundref="channels_8c" startline="3204" endline="3250">channel_protocol_select</references>
        <references refid="group__libssh__channel_1ga5f4fae06645c42c053e28b61ec186435" compoundref="channels_8c" startline="3253" endline="3260">count_ptrs</references>
        <references refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" compoundref="pkd__daemon_8c" startline="62">rc</references>
        <references refid="sshd__direct-tcpip_8c_1aed3129b7674034c979192bcca6b0ad8c" compoundref="sshd__direct-tcpip_8c" startline="36">SAFE_FREE</references>
        <references refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" compoundref="torture__session__keys_8c" startline="61">session</references>
        <references refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" compoundref="libssh_8h" startline="330">SSH_ERROR</references>
        <references refid="group__libssh__poll_1ga51af38de4cc3adbd5566ec1f1b91983d" compoundref="poll_8c" startline="884" endline="923">ssh_event_add_session</references>
        <references refid="group__libssh__poll_1gada90c0ca6919271708ba1ea0352632cb" compoundref="poll_8c" startline="957" endline="965">ssh_event_dopoll</references>
        <references refid="group__libssh__poll_1ga101388903c74d53ed550574b587449cd" compoundref="poll_8c" startline="1089" endline="1118">ssh_event_free</references>
        <references refid="group__libssh__poll_1ga406895f99b6b486c4b65536e5399ff96" compoundref="poll_8c" startline="760" endline="785">ssh_event_new</references>
        <references refid="libssh_8h_1ac1ee1d1e917456d4760a94a18015377d" compoundref="libssh_8h" startline="329">SSH_OK</references>
        <references refid="group__libssh__poll_1ga8ad007907f642d4aa2c25e5209bf337a" compoundref="poll_8c" startline="730" endline="736">ssh_poll_get_default_ctx</references>
        <references refid="group__libssh__misc_1ga1a6abbb2da16c6543f7de29b5c98f086" compoundref="misc_8c" startline="1388" endline="1411">ssh_timeout_elapsed</references>
        <references refid="session_8h_1ae931fa7865b3e4d87c18b5bd5e44e74e" compoundref="session_8h" startline="80">SSH_TIMEOUT_INFINITE</references>
        <references refid="group__libssh__misc_1gad1c4b29e2421eb8f9ca111d98b0c2976" compoundref="misc_8c" startline="1420" endline="1432">ssh_timeout_update</references>
        <references refid="group__libssh__misc_1gaaa0c97f49044d29f2a3b5b3ae82979ff" compoundref="misc_8c" startline="1324" endline="1335">ssh_timestamp_init</references>
        <referencedby refid="legacy_8h_1a3c3ebeee280f2e0cce6469e2cb0a903b" compoundref="legacy_8c" startline="284" endline="287">channel_select</referencedby>
      </memberdef>
      <memberdef kind="function" id="group__libssh__channel_1gab0649fe21b7a900b4a8e10ecb3401395" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void ssh_channel_set_counter</definition>
        <argsstring>(ssh_channel channel, ssh_counter counter)</argsstring>
        <name>ssh_channel_set_counter</name>
        <param>
          <type><ref refid="libssh_8h_1aca32be8db7c865697a3de381dc7e9fc3" kindref="member">ssh_channel</ref></type>
          <declname>channel</declname>
        </param>
        <param>
          <type><ref refid="libssh_8h_1a13411d2fe747ade4a420e64c25b121f6" kindref="member">ssh_counter</ref></type>
          <declname>counter</declname>
        </param>
        <briefdescription>
<para>Set the channel data counter. </para>
        </briefdescription>
        <detaileddescription>
<para><programlisting><codeline><highlight class="normal">struct<sp/>ssh_counter_struct<sp/>counter<sp/>=<sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>.in_bytes<sp/>=<sp/>0,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>.out_bytes<sp/>=<sp/>0,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>.in_packets<sp/>=<sp/>0,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>.out_packets<sp/>=<sp/>0</highlight></codeline>
<codeline><highlight class="normal">};</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">ssh_channel_set_counter(channel,<sp/>&amp;counter);</highlight></codeline>
</programlisting></para>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername direction="in">channel</parametername>
</parameternamelist>
<parameterdescription>
<para>The SSH channel.</para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">counter</parametername>
</parameternamelist>
<parameterdescription>
<para>Counter for bytes handled by the channel. </para>
</parameterdescription>
</parameteritem>
</parameterlist>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/channels.c" line="3418" column="6" bodyfile="src/channels.c" bodystart="3418" bodyend="3423"/>
        <references refid="structssh__channel__struct_1ab1beeacd4aff735258cb7488c079c6dc" compoundref="channels_8h" startline="84">ssh_channel_struct::counter</references>
      </memberdef>
      <memberdef kind="function" id="group__libssh__channel_1ga7ebd0ed490ee4485c6d5feb7d22bc162" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>int ssh_channel_write_stderr</definition>
        <argsstring>(ssh_channel channel, const void *data, uint32_t len)</argsstring>
        <name>ssh_channel_write_stderr</name>
        <param>
          <type><ref refid="libssh_8h_1aca32be8db7c865697a3de381dc7e9fc3" kindref="member">ssh_channel</ref></type>
          <declname>channel</declname>
        </param>
        <param>
          <type>const void *</type>
          <declname>data</declname>
        </param>
        <param>
          <type>uint32_t</type>
          <declname>len</declname>
        </param>
        <briefdescription>
<para>Blocking write on a channel stderr. </para>
        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername direction="in">channel</parametername>
</parameternamelist>
<parameterdescription>
<para>The channel to write to.</para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">data</parametername>
</parameternamelist>
<parameterdescription>
<para>A pointer to the data to write.</para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">len</parametername>
</parameternamelist>
<parameterdescription>
<para>The length of the buffer to write to.</para>
</parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>The number of bytes written, SSH_ERROR on error.</para>
</simplesect>
<simplesect kind="see"><para><ref refid="group__libssh__channel_1gac92381c4c5d4a7eab35f6e84686f033d" kindref="member">ssh_channel_read()</ref> </para>
</simplesect>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/channels.c" line="3438" column="5" bodyfile="src/channels.c" bodystart="3438" bodyend="3440"/>
        <references refid="group__libssh__channel_1ga918e9bde297309e977a872bc62c0d260" compoundref="channels_8c" startline="1376" endline="1517">channel_write_common</references>
        <referencedby refid="ssh__server__fork_8c_1a592df9fe9f0aa8be394e01cd6ddb94ca" compoundref="ssh__server__fork_8c" startline="521" endline="534">process_stderr</referencedby>
        <referencedby refid="connector_8c_1ad994e6c0acb9b1f2eab185da25fd46b8" compoundref="connector_8c" startline="424" endline="500">ssh_connector_channel_data_cb</referencedby>
        <referencedby refid="connector_8c_1a83806fe46fe887adb695eeca7f35682a" compoundref="connector_8c" startline="243" endline="322">ssh_connector_fd_in_cb</referencedby>
        <referencedby refid="classssh_1_1Channel_1a06cf7ffd971eff87783a169444fa09a2" compoundref="libsshpp_8hpp" startline="638" endline="647">ssh::Channel::write</referencedby>
      </memberdef>
      </sectiondef>
    <briefdescription>
    </briefdescription>
    <detaileddescription>
    </detaileddescription>
    <programlisting>
<codeline lineno="1"><highlight class="comment">/*</highlight></codeline>
<codeline lineno="2"><highlight class="comment"><sp/>*<sp/>channels.c<sp/>-<sp/>SSH<sp/>channel<sp/>functions</highlight></codeline>
<codeline lineno="3"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="4"><highlight class="comment"><sp/>*<sp/>This<sp/>file<sp/>is<sp/>part<sp/>of<sp/>the<sp/>SSH<sp/>Library</highlight></codeline>
<codeline lineno="5"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="6"><highlight class="comment"><sp/>*<sp/>Copyright<sp/>(c)<sp/>2003-2013<sp/>by<sp/>Aris<sp/>Adamantiadis</highlight></codeline>
<codeline lineno="7"><highlight class="comment"><sp/>*<sp/>Copyright<sp/>(c)<sp/>2009-2013<sp/>by<sp/>Andreas<sp/>Schneider<sp/>&lt;asn@cryptomilk.org&gt;</highlight></codeline>
<codeline lineno="8"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="9"><highlight class="comment"><sp/>*<sp/>The<sp/>SSH<sp/>Library<sp/>is<sp/>free<sp/>software;<sp/>you<sp/>can<sp/>redistribute<sp/>it<sp/>and/or<sp/>modify</highlight></codeline>
<codeline lineno="10"><highlight class="comment"><sp/>*<sp/>it<sp/>under<sp/>the<sp/>terms<sp/>of<sp/>the<sp/>GNU<sp/>Lesser<sp/>General<sp/>Public<sp/>License<sp/>as<sp/>published<sp/>by</highlight></codeline>
<codeline lineno="11"><highlight class="comment"><sp/>*<sp/>the<sp/>Free<sp/>Software<sp/>Foundation;<sp/>either<sp/>version<sp/>2.1<sp/>of<sp/>the<sp/>License,<sp/>or<sp/>(at<sp/>your</highlight></codeline>
<codeline lineno="12"><highlight class="comment"><sp/>*<sp/>option)<sp/>any<sp/>later<sp/>version.</highlight></codeline>
<codeline lineno="13"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="14"><highlight class="comment"><sp/>*<sp/>The<sp/>SSH<sp/>Library<sp/>is<sp/>distributed<sp/>in<sp/>the<sp/>hope<sp/>that<sp/>it<sp/>will<sp/>be<sp/>useful,<sp/>but</highlight></codeline>
<codeline lineno="15"><highlight class="comment"><sp/>*<sp/>WITHOUT<sp/>ANY<sp/>WARRANTY;<sp/>without<sp/>even<sp/>the<sp/>implied<sp/>warranty<sp/>of<sp/>MERCHANTABILITY</highlight></codeline>
<codeline lineno="16"><highlight class="comment"><sp/>*<sp/>or<sp/>FITNESS<sp/>FOR<sp/>A<sp/>PARTICULAR<sp/>PURPOSE.<sp/><sp/>See<sp/>the<sp/>GNU<sp/>Lesser<sp/>General<sp/>Public</highlight></codeline>
<codeline lineno="17"><highlight class="comment"><sp/>*<sp/>License<sp/>for<sp/>more<sp/>details.</highlight></codeline>
<codeline lineno="18"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="19"><highlight class="comment"><sp/>*<sp/>You<sp/>should<sp/>have<sp/>received<sp/>a<sp/>copy<sp/>of<sp/>the<sp/>GNU<sp/>Lesser<sp/>General<sp/>Public<sp/>License</highlight></codeline>
<codeline lineno="20"><highlight class="comment"><sp/>*<sp/>along<sp/>with<sp/>the<sp/>SSH<sp/>Library;<sp/>see<sp/>the<sp/>file<sp/>COPYING.<sp/><sp/>If<sp/>not,<sp/>write<sp/>to</highlight></codeline>
<codeline lineno="21"><highlight class="comment"><sp/>*<sp/>the<sp/>Free<sp/>Software<sp/>Foundation,<sp/>Inc.,<sp/>59<sp/>Temple<sp/>Place<sp/>-<sp/>Suite<sp/>330,<sp/>Boston,</highlight></codeline>
<codeline lineno="22"><highlight class="comment"><sp/>*<sp/>MA<sp/>02111-1307,<sp/>USA.</highlight></codeline>
<codeline lineno="23"><highlight class="comment"><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="24"><highlight class="normal"></highlight></codeline>
<codeline lineno="25"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="config_8h" kindref="compound">config.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="26"><highlight class="normal"></highlight></codeline>
<codeline lineno="27"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;limits.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="28"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;stdio.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="29"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;errno.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="30"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;time.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="31"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;stdbool.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="32"><highlight class="normal"></highlight></codeline>
<codeline lineno="33"><highlight class="normal"></highlight><highlight class="preprocessor">#ifndef<sp/>_WIN32</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="34"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;netinet/in.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="35"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;arpa/inet.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="36"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="37"><highlight class="normal"></highlight></codeline>
<codeline lineno="38"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="priv_8h" kindref="compound">libssh/priv.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="39"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="ssh2_8h" kindref="compound">libssh/ssh2.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="40"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="buffer_8h" kindref="compound">libssh/buffer.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="41"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="packet_8h" kindref="compound">libssh/packet.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="42"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="socket_8h" kindref="compound">libssh/socket.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="43"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="channels_8h" kindref="compound">libssh/channels.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="44"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="session_8h" kindref="compound">libssh/session.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="45"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="misc_8h" kindref="compound">libssh/misc.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="46"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="messages_8h" kindref="compound">libssh/messages.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="47"><highlight class="normal"></highlight><highlight class="preprocessor">#if<sp/>WITH_SERVER</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="48"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="server_8h" kindref="compound">libssh/server.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="49"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="50"><highlight class="normal"></highlight></codeline>
<codeline lineno="51" refid="channels_8c_1ab291488cbad12a5e02777a6d16c7fc1c" refkind="member"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>WINDOWBASE<sp/>1280000</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="52" refid="channels_8c_1aebda54a24a840f266fcc864e4940f749" refkind="member"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>WINDOWLIMIT<sp/>(WINDOWBASE/2)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="53"><highlight class="normal"></highlight></codeline>
<codeline lineno="54"><highlight class="normal"></highlight><highlight class="comment">/*</highlight></codeline>
<codeline lineno="55"><highlight class="comment"><sp/>*<sp/>All<sp/>implementations<sp/>MUST<sp/>be<sp/>able<sp/>to<sp/>process<sp/>packets<sp/>with<sp/>an</highlight></codeline>
<codeline lineno="56"><highlight class="comment"><sp/>*<sp/>uncompressed<sp/>payload<sp/>length<sp/>of<sp/>32768<sp/>bytes<sp/>or<sp/>less<sp/>and<sp/>a<sp/>total<sp/>packet</highlight></codeline>
<codeline lineno="57"><highlight class="comment"><sp/>*<sp/>size<sp/>of<sp/>35000<sp/>bytes<sp/>or<sp/>less.</highlight></codeline>
<codeline lineno="58"><highlight class="comment"><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="59" refid="channels_8c_1a2ab57c8b0eeaa7b8ef3733493a00bf55" refkind="member"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>CHANNEL_MAX_PACKET<sp/>32768</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="60" refid="channels_8c_1a6d5398350fc6c52561ed2674154161dc" refkind="member"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>CHANNEL_INITIAL_WINDOW<sp/>64000</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="61"><highlight class="normal"></highlight></codeline>
<codeline lineno="71"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/><ref refid="structssh__channel__struct" kindref="compound">ssh_channel</ref><sp/><ref refid="group__libssh__channel_1ga41254c9dd24ac1ae9ad9c0edd3825dee" kindref="member">channel_from_msg</ref>(<ref refid="structssh__session__struct" kindref="compound">ssh_session</ref><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>,<sp/><ref refid="structssh__buffer__struct" kindref="compound">ssh_buffer</ref><sp/>packet);</highlight></codeline>
<codeline lineno="72"><highlight class="normal"></highlight></codeline>
<codeline lineno="80" refid="group__libssh__channel_1gada8ccda7bf65165fe145d3096a252dcc" refkind="member"><highlight class="normal"><ref refid="structssh__channel__struct" kindref="compound">ssh_channel</ref><sp/><ref refid="group__libssh__channel_1gada8ccda7bf65165fe145d3096a252dcc" kindref="member">ssh_channel_new</ref>(<ref refid="structssh__session__struct" kindref="compound">ssh_session</ref><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>)</highlight></codeline>
<codeline lineno="81"><highlight class="normal">{</highlight></codeline>
<codeline lineno="82"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="structssh__channel__struct" kindref="compound">ssh_channel</ref><sp/>channel<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="83"><highlight class="normal"></highlight></codeline>
<codeline lineno="84"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref><sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="85"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>NULL;</highlight></codeline>
<codeline lineno="86"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="87"><highlight class="normal"></highlight></codeline>
<codeline lineno="88"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Check<sp/>if<sp/>we<sp/>have<sp/>an<sp/>authenticated<sp/>session<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="89"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a997060832a3419d8fe884d3da855ef4c" kindref="member">flags</ref><sp/>&amp;<sp/><ref refid="session_8h_1ae54e87f0565e24b25aed1372b3493a2b" kindref="member">SSH_SESSION_FLAG_AUTHENTICATED</ref>))<sp/>{</highlight></codeline>
<codeline lineno="90"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>NULL;</highlight></codeline>
<codeline lineno="91"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="92"><highlight class="normal"></highlight></codeline>
<codeline lineno="93"><highlight class="normal"><sp/><sp/><sp/><sp/>channel<sp/>=<sp/>calloc(1,<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(</highlight><highlight class="keyword">struct</highlight><highlight class="normal"><sp/><ref refid="structssh__channel__struct" kindref="compound">ssh_channel_struct</ref>));</highlight></codeline>
<codeline lineno="94"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(channel<sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="95"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="priv_8h_1ae280c413c792e04237f000841ac8ce44" kindref="member">ssh_set_error_oom</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>);</highlight></codeline>
<codeline lineno="96"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>NULL;</highlight></codeline>
<codeline lineno="97"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="98"><highlight class="normal"></highlight></codeline>
<codeline lineno="99"><highlight class="normal"><sp/><sp/><sp/><sp/>channel-&gt;<ref refid="structssh__channel__struct_1a8ae1473aafd716256ce762d0115b2321" kindref="member">stdout_buffer</ref><sp/>=<sp/><ref refid="group__libssh__buffer_1ga7ecc914104a5bf0da485d3e42f6a7d3b" kindref="member">ssh_buffer_new</ref>();</highlight></codeline>
<codeline lineno="100"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(channel-&gt;<ref refid="structssh__channel__struct_1a8ae1473aafd716256ce762d0115b2321" kindref="member">stdout_buffer</ref><sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="101"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="priv_8h_1ae280c413c792e04237f000841ac8ce44" kindref="member">ssh_set_error_oom</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>);</highlight></codeline>
<codeline lineno="102"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="sshd__direct-tcpip_8c_1aed3129b7674034c979192bcca6b0ad8c" kindref="member">SAFE_FREE</ref>(channel);</highlight></codeline>
<codeline lineno="103"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>NULL;</highlight></codeline>
<codeline lineno="104"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="105"><highlight class="normal"></highlight></codeline>
<codeline lineno="106"><highlight class="normal"><sp/><sp/><sp/><sp/>channel-&gt;<ref refid="structssh__channel__struct_1a6806319dfa8f417bbad93f6481ad99d4" kindref="member">stderr_buffer</ref><sp/>=<sp/><ref refid="group__libssh__buffer_1ga7ecc914104a5bf0da485d3e42f6a7d3b" kindref="member">ssh_buffer_new</ref>();</highlight></codeline>
<codeline lineno="107"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(channel-&gt;<ref refid="structssh__channel__struct_1a6806319dfa8f417bbad93f6481ad99d4" kindref="member">stderr_buffer</ref><sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="108"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="priv_8h_1ae280c413c792e04237f000841ac8ce44" kindref="member">ssh_set_error_oom</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>);</highlight></codeline>
<codeline lineno="109"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="libssh_8h_1a8b09f7d6f7066de7ef8dab4ed7494a52" kindref="member">SSH_BUFFER_FREE</ref>(channel-&gt;<ref refid="structssh__channel__struct_1a8ae1473aafd716256ce762d0115b2321" kindref="member">stdout_buffer</ref>);</highlight></codeline>
<codeline lineno="110"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="sshd__direct-tcpip_8c_1aed3129b7674034c979192bcca6b0ad8c" kindref="member">SAFE_FREE</ref>(channel);</highlight></codeline>
<codeline lineno="111"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>NULL;</highlight></codeline>
<codeline lineno="112"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="113"><highlight class="normal"></highlight></codeline>
<codeline lineno="114"><highlight class="normal"><sp/><sp/><sp/><sp/>channel-&gt;<ref refid="structssh__channel__struct_1a0832dc830d09accd2f3a8f8349c3faf2" kindref="member">session</ref><sp/>=<sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>;</highlight></codeline>
<codeline lineno="115"><highlight class="normal"><sp/><sp/><sp/><sp/>channel-&gt;<ref refid="structssh__channel__struct_1a3e9106e477bee737abed43d8c57a7bd6" kindref="member">exit_status</ref><sp/>=<sp/>-1;</highlight></codeline>
<codeline lineno="116"><highlight class="normal"><sp/><sp/><sp/><sp/>channel-&gt;<ref refid="structssh__channel__struct_1a400dc0c0dc7cd02daaea731825c1a7c4" kindref="member">flags</ref><sp/>=<sp/><ref refid="channels_8h_1a040c2d863bb3de2036d3b2fcde37450c" kindref="member">SSH_CHANNEL_FLAG_NOT_BOUND</ref>;</highlight></codeline>
<codeline lineno="117"><highlight class="normal"></highlight></codeline>
<codeline lineno="118"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a9445164beb02a1979171bef9b1a63182" kindref="member">channels</ref><sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="119"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a9445164beb02a1979171bef9b1a63182" kindref="member">channels</ref><sp/>=<sp/><ref refid="group__libssh__misc_1ga4c696e6fd38257737962971fa0362435" kindref="member">ssh_list_new</ref>();</highlight></codeline>
<codeline lineno="120"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="121"><highlight class="normal"></highlight></codeline>
<codeline lineno="122"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="group__libssh__misc_1ga7f1c23a518f3ca0b63189763b64141c4" kindref="member">ssh_list_prepend</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a9445164beb02a1979171bef9b1a63182" kindref="member">channels</ref>,<sp/>channel);</highlight></codeline>
<codeline lineno="123"><highlight class="normal"></highlight></codeline>
<codeline lineno="124"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Set<sp/>states<sp/>explicitly<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="125"><highlight class="normal"><sp/><sp/><sp/><sp/>channel-&gt;<ref refid="structssh__channel__struct_1a272b198e279fa672afeaf9f2e610eb04" kindref="member">state</ref><sp/>=<sp/><ref refid="channels_8h_1a5a002159e5db31d156bb2a8ce8a10cd1a1c7ade5ea201bca92177fa99becb3a0c" kindref="member">SSH_CHANNEL_STATE_NOT_OPEN</ref>;</highlight></codeline>
<codeline lineno="126"><highlight class="normal"><sp/><sp/><sp/><sp/>channel-&gt;<ref refid="structssh__channel__struct_1a25a8d874fbdccd50ecfff837ef69bad2" kindref="member">request_state</ref><sp/>=<sp/><ref refid="channels_8h_1a774597eb1605e8b48cd065965fdc2325a98c7a3dcf02759118261e2bac4d6e421" kindref="member">SSH_CHANNEL_REQ_STATE_NONE</ref>;</highlight></codeline>
<codeline lineno="127"><highlight class="normal"></highlight></codeline>
<codeline lineno="128"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>channel;</highlight></codeline>
<codeline lineno="129"><highlight class="normal">}</highlight></codeline>
<codeline lineno="130"><highlight class="normal"></highlight></codeline>
<codeline lineno="140" refid="group__libssh__channel_1gabb9c8cd95c0aab1a293e91d7b05f8fc4" refkind="member"><highlight class="normal">uint32_t<sp/><ref refid="group__libssh__channel_1gabb9c8cd95c0aab1a293e91d7b05f8fc4" kindref="member">ssh_channel_new_id</ref>(<ref refid="structssh__session__struct" kindref="compound">ssh_session</ref><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>)<sp/>{</highlight></codeline>
<codeline lineno="141"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>++(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a8fd8ef167e1236e76208827f50808a91" kindref="member">maxchannel</ref>);</highlight></codeline>
<codeline lineno="142"><highlight class="normal">}</highlight></codeline>
<codeline lineno="143"><highlight class="normal"></highlight></codeline>
<codeline lineno="151" refid="group__libssh__channel_1ga1f817e943f01e76843f60f9f9ca970f9" refkind="member"><highlight class="normal"><ref refid="group__libssh__channel_1ga1f817e943f01e76843f60f9f9ca970f9" kindref="member">SSH_PACKET_CALLBACK</ref>(ssh_packet_channel_open_conf){</highlight></codeline>
<codeline lineno="152"><highlight class="normal"><sp/><sp/>uint32_t<sp/>channelid=0;</highlight></codeline>
<codeline lineno="153"><highlight class="normal"><sp/><sp/><ref refid="structssh__channel__struct" kindref="compound">ssh_channel</ref><sp/>channel;</highlight></codeline>
<codeline lineno="154"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref>;</highlight></codeline>
<codeline lineno="155"><highlight class="normal"><sp/><sp/>(void)type;</highlight></codeline>
<codeline lineno="156"><highlight class="normal"><sp/><sp/>(void)<ref refid="ssh__client_8c_1a14871705f45ccdc5bb9f4549efd8e119" kindref="member">user</ref>;</highlight></codeline>
<codeline lineno="157"><highlight class="normal"></highlight></codeline>
<codeline lineno="158"><highlight class="normal"><sp/><sp/><ref refid="priv_8h_1aa21fd8a7a609329603b7b16da7939fca" kindref="member">SSH_LOG</ref>(<ref refid="group__libssh__log_1ggadf764cbdea00d65edcd07bb9953ad2b7a6445dfe21592d69d9741d319538b6673" kindref="member">SSH_LOG_PACKET</ref>,</highlight><highlight class="stringliteral">&quot;Received<sp/>SSH2_MSG_CHANNEL_OPEN_CONFIRMATION&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="159"><highlight class="normal"></highlight></codeline>
<codeline lineno="160"><highlight class="normal"><sp/><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="buffer_8h_1ab51014ef9a47e7cdbd235af3e62b81ee" kindref="member">ssh_buffer_unpack</ref>(packet,<sp/></highlight><highlight class="stringliteral">&quot;d&quot;</highlight><highlight class="normal">,<sp/>&amp;channelid);</highlight></codeline>
<codeline lineno="161"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>!=<sp/><ref refid="libssh_8h_1ac1ee1d1e917456d4760a94a18015377d" kindref="member">SSH_OK</ref>)</highlight></codeline>
<codeline lineno="162"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">goto</highlight><highlight class="normal"><sp/><ref refid="proxy_8c_1a11614f44ef4d939bdd984953346a7572" kindref="member">error</ref>;</highlight></codeline>
<codeline lineno="163"><highlight class="normal"><sp/><sp/>channel=<ref refid="group__libssh__channel_1ga4c25383c95b09d1b583ef0a9db4b08e2" kindref="member">ssh_channel_from_local</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>,channelid);</highlight></codeline>
<codeline lineno="164"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(channel==NULL){</highlight></codeline>
<codeline lineno="165"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="priv_8h_1a55177b3e8db90ca9adb435c44281963c" kindref="member">ssh_set_error</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>,<sp/><ref refid="libssh_8h_1a036b2b00fb04337a4d06d719d1b62be1a86ff0b2e8da6ad8628efc556b6ce1887" kindref="member">SSH_FATAL</ref>,</highlight></codeline>
<codeline lineno="166"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Unknown<sp/>channel<sp/>id<sp/>%&quot;</highlight><highlight class="normal">PRIu32,</highlight></codeline>
<codeline lineno="167"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(uint32_t)<sp/>channelid);</highlight></codeline>
<codeline lineno="168"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>TODO:<sp/>Set<sp/>error<sp/>marking<sp/>in<sp/>channel<sp/>object<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="169"><highlight class="normal"></highlight></codeline>
<codeline lineno="170"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="group__libssh__callbacks_1gac29df803aa1295d6a498c1b081f3b494" kindref="member">SSH_PACKET_USED</ref>;</highlight></codeline>
<codeline lineno="171"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="172"><highlight class="normal"></highlight></codeline>
<codeline lineno="173"><highlight class="normal"><sp/><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="buffer_8h_1ab51014ef9a47e7cdbd235af3e62b81ee" kindref="member">ssh_buffer_unpack</ref>(packet,<sp/></highlight><highlight class="stringliteral">&quot;ddd&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="174"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&amp;channel-&gt;<ref refid="structssh__channel__struct_1aa553acf6d12fffb1ae18b11196c2c0e9" kindref="member">remote_channel</ref>,</highlight></codeline>
<codeline lineno="175"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&amp;channel-&gt;<ref refid="structssh__channel__struct_1a1b5936420da03e6b64aa8f900eb8ad0c" kindref="member">remote_window</ref>,</highlight></codeline>
<codeline lineno="176"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&amp;channel-&gt;<ref refid="structssh__channel__struct_1a748cbf4c5d3af22bd8e8fea69144128d" kindref="member">remote_maxpacket</ref>);</highlight></codeline>
<codeline lineno="177"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>!=<sp/><ref refid="libssh_8h_1ac1ee1d1e917456d4760a94a18015377d" kindref="member">SSH_OK</ref>)</highlight></codeline>
<codeline lineno="178"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">goto</highlight><highlight class="normal"><sp/><ref refid="proxy_8c_1a11614f44ef4d939bdd984953346a7572" kindref="member">error</ref>;</highlight></codeline>
<codeline lineno="179"><highlight class="normal"></highlight></codeline>
<codeline lineno="180"><highlight class="normal"><sp/><sp/><ref refid="priv_8h_1aa21fd8a7a609329603b7b16da7939fca" kindref="member">SSH_LOG</ref>(<ref refid="group__libssh__log_1ggadf764cbdea00d65edcd07bb9953ad2b7a75fa79e63947b66462db977d9b5ae27c" kindref="member">SSH_LOG_PROTOCOL</ref>,</highlight></codeline>
<codeline lineno="181"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Received<sp/>a<sp/>CHANNEL_OPEN_CONFIRMATION<sp/>for<sp/>channel<sp/>%d:%d&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="182"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>channel-&gt;<ref refid="structssh__channel__struct_1a39cdc105ee0bbd1b7faea169db30f0a1" kindref="member">local_channel</ref>,</highlight></codeline>
<codeline lineno="183"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>channel-&gt;<ref refid="structssh__channel__struct_1aa553acf6d12fffb1ae18b11196c2c0e9" kindref="member">remote_channel</ref>);</highlight></codeline>
<codeline lineno="184"><highlight class="normal"></highlight></codeline>
<codeline lineno="185"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(channel-&gt;<ref refid="structssh__channel__struct_1a272b198e279fa672afeaf9f2e610eb04" kindref="member">state</ref><sp/>!=<sp/><ref refid="channels_8h_1a5a002159e5db31d156bb2a8ce8a10cd1a5a7cc3348940d3df41d2fd293cdb2e4c" kindref="member">SSH_CHANNEL_STATE_OPENING</ref>)<sp/>{</highlight></codeline>
<codeline lineno="186"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="priv_8h_1aa21fd8a7a609329603b7b16da7939fca" kindref="member">SSH_LOG</ref>(<ref refid="libssh_8h_1a1c08cc9177a5598e0675abfb833d2993" kindref="member">SSH_LOG_RARE</ref>,</highlight></codeline>
<codeline lineno="187"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;SSH2_MSG_CHANNEL_OPEN_CONFIRMATION<sp/>received<sp/>in<sp/>incorrect<sp/>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="188"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;channel<sp/>state<sp/>%d&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="189"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>channel-&gt;<ref refid="structssh__channel__struct_1a272b198e279fa672afeaf9f2e610eb04" kindref="member">state</ref>);</highlight></codeline>
<codeline lineno="190"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">goto</highlight><highlight class="normal"><sp/><ref refid="proxy_8c_1a11614f44ef4d939bdd984953346a7572" kindref="member">error</ref>;</highlight></codeline>
<codeline lineno="191"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="192"><highlight class="normal"></highlight></codeline>
<codeline lineno="193"><highlight class="normal"><sp/><sp/><ref refid="priv_8h_1aa21fd8a7a609329603b7b16da7939fca" kindref="member">SSH_LOG</ref>(<ref refid="group__libssh__log_1ggadf764cbdea00d65edcd07bb9953ad2b7a75fa79e63947b66462db977d9b5ae27c" kindref="member">SSH_LOG_PROTOCOL</ref>,</highlight></codeline>
<codeline lineno="194"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Remote<sp/>window<sp/>:<sp/>%&quot;</highlight><highlight class="normal">PRIu32</highlight><highlight class="stringliteral">&quot;,<sp/>maxpacket<sp/>:<sp/>%&quot;</highlight><highlight class="normal">PRIu32,</highlight></codeline>
<codeline lineno="195"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>(uint32_t)<sp/>channel-&gt;<ref refid="structssh__channel__struct_1a1b5936420da03e6b64aa8f900eb8ad0c" kindref="member">remote_window</ref>,</highlight></codeline>
<codeline lineno="196"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>(uint32_t)<sp/>channel-&gt;<ref refid="structssh__channel__struct_1a748cbf4c5d3af22bd8e8fea69144128d" kindref="member">remote_maxpacket</ref>);</highlight></codeline>
<codeline lineno="197"><highlight class="normal"></highlight></codeline>
<codeline lineno="198"><highlight class="normal"><sp/><sp/>channel-&gt;<ref refid="structssh__channel__struct_1a272b198e279fa672afeaf9f2e610eb04" kindref="member">state</ref><sp/>=<sp/><ref refid="channels_8h_1a5a002159e5db31d156bb2a8ce8a10cd1a488a78707192c35250392423b5058e2b" kindref="member">SSH_CHANNEL_STATE_OPEN</ref>;</highlight></codeline>
<codeline lineno="199"><highlight class="normal"><sp/><sp/>channel-&gt;<ref refid="structssh__channel__struct_1a400dc0c0dc7cd02daaea731825c1a7c4" kindref="member">flags</ref><sp/>&amp;=<sp/>~<ref refid="channels_8h_1a040c2d863bb3de2036d3b2fcde37450c" kindref="member">SSH_CHANNEL_FLAG_NOT_BOUND</ref>;</highlight></codeline>
<codeline lineno="200"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="group__libssh__callbacks_1gac29df803aa1295d6a498c1b081f3b494" kindref="member">SSH_PACKET_USED</ref>;</highlight></codeline>
<codeline lineno="201"><highlight class="normal"></highlight></codeline>
<codeline lineno="202"><highlight class="normal"><ref refid="proxy_8c_1a11614f44ef4d939bdd984953346a7572" kindref="member">error</ref>:</highlight></codeline>
<codeline lineno="203"><highlight class="normal"><sp/><sp/><ref refid="priv_8h_1a55177b3e8db90ca9adb435c44281963c" kindref="member">ssh_set_error</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>,<sp/><ref refid="libssh_8h_1a036b2b00fb04337a4d06d719d1b62be1a86ff0b2e8da6ad8628efc556b6ce1887" kindref="member">SSH_FATAL</ref>,<sp/></highlight><highlight class="stringliteral">&quot;Invalid<sp/>packet&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="204"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="group__libssh__callbacks_1gac29df803aa1295d6a498c1b081f3b494" kindref="member">SSH_PACKET_USED</ref>;</highlight></codeline>
<codeline lineno="205"><highlight class="normal">}</highlight></codeline>
<codeline lineno="206"><highlight class="normal"></highlight></codeline>
<codeline lineno="212" refid="group__libssh__channel_1ga18df7b076dd041ef43e8f174eecdc02a" refkind="member"><highlight class="normal"><ref refid="group__libssh__channel_1ga1f817e943f01e76843f60f9f9ca970f9" kindref="member">SSH_PACKET_CALLBACK</ref>(ssh_packet_channel_open_fail){</highlight></codeline>
<codeline lineno="213"><highlight class="normal"></highlight></codeline>
<codeline lineno="214"><highlight class="normal"><sp/><sp/><ref refid="structssh__channel__struct" kindref="compound">ssh_channel</ref><sp/>channel;</highlight></codeline>
<codeline lineno="215"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*<ref refid="proxy_8c_1a11614f44ef4d939bdd984953346a7572" kindref="member">error</ref><sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="216"><highlight class="normal"><sp/><sp/>uint32_t<sp/>code;</highlight></codeline>
<codeline lineno="217"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref>;</highlight></codeline>
<codeline lineno="218"><highlight class="normal"><sp/><sp/>(void)<ref refid="ssh__client_8c_1a14871705f45ccdc5bb9f4549efd8e119" kindref="member">user</ref>;</highlight></codeline>
<codeline lineno="219"><highlight class="normal"><sp/><sp/>(void)type;</highlight></codeline>
<codeline lineno="220"><highlight class="normal"></highlight></codeline>
<codeline lineno="221"><highlight class="normal"><sp/><sp/>channel=<ref refid="group__libssh__channel_1ga41254c9dd24ac1ae9ad9c0edd3825dee" kindref="member">channel_from_msg</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>,packet);</highlight></codeline>
<codeline lineno="222"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(channel==NULL){</highlight></codeline>
<codeline lineno="223"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="priv_8h_1aa21fd8a7a609329603b7b16da7939fca" kindref="member">SSH_LOG</ref>(<ref refid="libssh_8h_1a1c08cc9177a5598e0675abfb833d2993" kindref="member">SSH_LOG_RARE</ref>,</highlight><highlight class="stringliteral">&quot;Invalid<sp/>channel<sp/>in<sp/>packet&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="224"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="group__libssh__callbacks_1gac29df803aa1295d6a498c1b081f3b494" kindref="member">SSH_PACKET_USED</ref>;</highlight></codeline>
<codeline lineno="225"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="226"><highlight class="normal"></highlight></codeline>
<codeline lineno="227"><highlight class="normal"><sp/><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="buffer_8h_1ab51014ef9a47e7cdbd235af3e62b81ee" kindref="member">ssh_buffer_unpack</ref>(packet,<sp/></highlight><highlight class="stringliteral">&quot;ds&quot;</highlight><highlight class="normal">,<sp/>&amp;code,<sp/>&amp;<ref refid="proxy_8c_1a11614f44ef4d939bdd984953346a7572" kindref="member">error</ref>);</highlight></codeline>
<codeline lineno="228"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>!=<sp/><ref refid="libssh_8h_1ac1ee1d1e917456d4760a94a18015377d" kindref="member">SSH_OK</ref>){</highlight></codeline>
<codeline lineno="229"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="priv_8h_1a55177b3e8db90ca9adb435c44281963c" kindref="member">ssh_set_error</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>,<sp/><ref refid="libssh_8h_1a036b2b00fb04337a4d06d719d1b62be1a86ff0b2e8da6ad8628efc556b6ce1887" kindref="member">SSH_FATAL</ref>,<sp/></highlight><highlight class="stringliteral">&quot;Invalid<sp/>packet&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="230"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="group__libssh__callbacks_1gac29df803aa1295d6a498c1b081f3b494" kindref="member">SSH_PACKET_USED</ref>;</highlight></codeline>
<codeline lineno="231"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="232"><highlight class="normal"></highlight></codeline>
<codeline lineno="233"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(channel-&gt;<ref refid="structssh__channel__struct_1a272b198e279fa672afeaf9f2e610eb04" kindref="member">state</ref><sp/>!=<sp/><ref refid="channels_8h_1a5a002159e5db31d156bb2a8ce8a10cd1a5a7cc3348940d3df41d2fd293cdb2e4c" kindref="member">SSH_CHANNEL_STATE_OPENING</ref>)<sp/>{</highlight></codeline>
<codeline lineno="234"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="priv_8h_1aa21fd8a7a609329603b7b16da7939fca" kindref="member">SSH_LOG</ref>(<ref refid="libssh_8h_1a1c08cc9177a5598e0675abfb833d2993" kindref="member">SSH_LOG_RARE</ref>,</highlight></codeline>
<codeline lineno="235"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;SSH2_MSG_CHANNEL_OPEN_FAILURE<sp/>received<sp/>in<sp/>incorrect<sp/>channel<sp/>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="236"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;state<sp/>%d&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="237"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>channel-&gt;<ref refid="structssh__channel__struct_1a272b198e279fa672afeaf9f2e610eb04" kindref="member">state</ref>);</highlight></codeline>
<codeline lineno="238"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">goto</highlight><highlight class="normal"><sp/><ref refid="proxy_8c_1a11614f44ef4d939bdd984953346a7572" kindref="member">error</ref>;</highlight></codeline>
<codeline lineno="239"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="240"><highlight class="normal"></highlight></codeline>
<codeline lineno="241"><highlight class="normal"><sp/><sp/><ref refid="priv_8h_1a55177b3e8db90ca9adb435c44281963c" kindref="member">ssh_set_error</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>,<sp/><ref refid="libssh_8h_1a036b2b00fb04337a4d06d719d1b62be1ad1339fb4b92a9d25bdb99df5de5c4f88" kindref="member">SSH_REQUEST_DENIED</ref>,</highlight></codeline>
<codeline lineno="242"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Channel<sp/>opening<sp/>failure:<sp/>channel<sp/>%u<sp/>error<sp/>(%&quot;</highlight><highlight class="normal">PRIu32</highlight><highlight class="stringliteral">&quot;)<sp/>%s&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="243"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>channel-&gt;<ref refid="structssh__channel__struct_1a39cdc105ee0bbd1b7faea169db30f0a1" kindref="member">local_channel</ref>,</highlight></codeline>
<codeline lineno="244"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>(uint32_t)<sp/>code,</highlight></codeline>
<codeline lineno="245"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="proxy_8c_1a11614f44ef4d939bdd984953346a7572" kindref="member">error</ref>);</highlight></codeline>
<codeline lineno="246"><highlight class="normal"><sp/><sp/><ref refid="sshd__direct-tcpip_8c_1aed3129b7674034c979192bcca6b0ad8c" kindref="member">SAFE_FREE</ref>(<ref refid="proxy_8c_1a11614f44ef4d939bdd984953346a7572" kindref="member">error</ref>);</highlight></codeline>
<codeline lineno="247"><highlight class="normal"><sp/><sp/>channel-&gt;<ref refid="structssh__channel__struct_1a272b198e279fa672afeaf9f2e610eb04" kindref="member">state</ref>=<ref refid="channels_8h_1a5a002159e5db31d156bb2a8ce8a10cd1ac55b9c695524684a57a3a817ca06b444" kindref="member">SSH_CHANNEL_STATE_OPEN_DENIED</ref>;</highlight></codeline>
<codeline lineno="248"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="group__libssh__callbacks_1gac29df803aa1295d6a498c1b081f3b494" kindref="member">SSH_PACKET_USED</ref>;</highlight></codeline>
<codeline lineno="249"><highlight class="normal"></highlight></codeline>
<codeline lineno="250"><highlight class="normal"><ref refid="proxy_8c_1a11614f44ef4d939bdd984953346a7572" kindref="member">error</ref>:</highlight></codeline>
<codeline lineno="251"><highlight class="normal"><sp/><sp/><ref refid="priv_8h_1a55177b3e8db90ca9adb435c44281963c" kindref="member">ssh_set_error</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>,<sp/><ref refid="libssh_8h_1a036b2b00fb04337a4d06d719d1b62be1a86ff0b2e8da6ad8628efc556b6ce1887" kindref="member">SSH_FATAL</ref>,<sp/></highlight><highlight class="stringliteral">&quot;Invalid<sp/>packet&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="252"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="group__libssh__callbacks_1gac29df803aa1295d6a498c1b081f3b494" kindref="member">SSH_PACKET_USED</ref>;</highlight></codeline>
<codeline lineno="253"><highlight class="normal">}</highlight></codeline>
<codeline lineno="254"><highlight class="normal"></highlight></codeline>
<codeline lineno="255" refid="group__libssh__channel_1ga3c2fe7cf69c947046bbfae132afa7ff4" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="group__libssh__channel_1ga3c2fe7cf69c947046bbfae132afa7ff4" kindref="member">ssh_channel_open_termination</ref>(</highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>*c){</highlight></codeline>
<codeline lineno="256"><highlight class="normal"><sp/><sp/><ref refid="structssh__channel__struct" kindref="compound">ssh_channel</ref><sp/>channel<sp/>=<sp/>(<ref refid="libssh_8h_1aca32be8db7c865697a3de381dc7e9fc3" kindref="member">ssh_channel</ref>)<sp/>c;</highlight></codeline>
<codeline lineno="257"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(channel-&gt;<ref refid="structssh__channel__struct_1a272b198e279fa672afeaf9f2e610eb04" kindref="member">state</ref><sp/>!=<sp/><ref refid="channels_8h_1a5a002159e5db31d156bb2a8ce8a10cd1a5a7cc3348940d3df41d2fd293cdb2e4c" kindref="member">SSH_CHANNEL_STATE_OPENING</ref><sp/>||</highlight></codeline>
<codeline lineno="258"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>channel-&gt;<ref refid="structssh__channel__struct_1a0832dc830d09accd2f3a8f8349c3faf2" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a6f74d1a1eb6ed715b1073b67caa18460" kindref="member">session_state</ref><sp/>==<sp/><ref refid="session_8h_1a9bbd1d5ae11485e27279be6ad461992ca855474fc84a2fb170fcb72546af8eeb8" kindref="member">SSH_SESSION_STATE_ERROR</ref>)</highlight></codeline>
<codeline lineno="259"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>1;</highlight></codeline>
<codeline lineno="260"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="261"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>0;</highlight></codeline>
<codeline lineno="262"><highlight class="normal">}</highlight></codeline>
<codeline lineno="263"><highlight class="normal"></highlight></codeline>
<codeline lineno="284"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="285" refid="group__libssh__channel_1gaa3d6d7d4ab8191f8b8eb14464b0f0e1e" refkind="member"><highlight class="normal"><ref refid="group__libssh__channel_1gaa3d6d7d4ab8191f8b8eb14464b0f0e1e" kindref="member">channel_open</ref>(<ref refid="structssh__channel__struct" kindref="compound">ssh_channel</ref><sp/>channel,</highlight></codeline>
<codeline lineno="286"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*type,</highlight></codeline>
<codeline lineno="287"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>uint32_t<sp/>window,</highlight></codeline>
<codeline lineno="288"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>uint32_t<sp/>maxpacket,</highlight></codeline>
<codeline lineno="289"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structssh__buffer__struct" kindref="compound">ssh_buffer</ref><sp/>payload)</highlight></codeline>
<codeline lineno="290"><highlight class="normal">{</highlight></codeline>
<codeline lineno="291"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="structssh__session__struct" kindref="compound">ssh_session</ref><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref><sp/>=<sp/>channel-&gt;<ref refid="structssh__channel__struct_1a0832dc830d09accd2f3a8f8349c3faf2" kindref="member">session</ref>;</highlight></codeline>
<codeline lineno="292"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>err<sp/>=<sp/><ref refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" kindref="member">SSH_ERROR</ref>;</highlight></codeline>
<codeline lineno="293"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref>;</highlight></codeline>
<codeline lineno="294"><highlight class="normal"></highlight></codeline>
<codeline lineno="295"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">switch</highlight><highlight class="normal"><sp/>(channel-&gt;<ref refid="structssh__channel__struct_1a272b198e279fa672afeaf9f2e610eb04" kindref="member">state</ref>)<sp/>{</highlight></codeline>
<codeline lineno="296"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="channels_8h_1a5a002159e5db31d156bb2a8ce8a10cd1a1c7ade5ea201bca92177fa99becb3a0c" kindref="member">SSH_CHANNEL_STATE_NOT_OPEN</ref>:</highlight></codeline>
<codeline lineno="297"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="298"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="channels_8h_1a5a002159e5db31d156bb2a8ce8a10cd1a5a7cc3348940d3df41d2fd293cdb2e4c" kindref="member">SSH_CHANNEL_STATE_OPENING</ref>:</highlight></codeline>
<codeline lineno="299"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">goto</highlight><highlight class="normal"><sp/>pending;</highlight></codeline>
<codeline lineno="300"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="channels_8h_1a5a002159e5db31d156bb2a8ce8a10cd1a488a78707192c35250392423b5058e2b" kindref="member">SSH_CHANNEL_STATE_OPEN</ref>:</highlight></codeline>
<codeline lineno="301"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="channels_8h_1a5a002159e5db31d156bb2a8ce8a10cd1a96872cd3f6e98f6f040097e3ee6cb900" kindref="member">SSH_CHANNEL_STATE_CLOSED</ref>:</highlight></codeline>
<codeline lineno="302"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="channels_8h_1a5a002159e5db31d156bb2a8ce8a10cd1ac55b9c695524684a57a3a817ca06b444" kindref="member">SSH_CHANNEL_STATE_OPEN_DENIED</ref>:</highlight></codeline>
<codeline lineno="303"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">goto</highlight><highlight class="normal"><sp/>end;</highlight></codeline>
<codeline lineno="304"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">default</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="305"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="priv_8h_1a55177b3e8db90ca9adb435c44281963c" kindref="member">ssh_set_error</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>,<sp/><ref refid="libssh_8h_1a036b2b00fb04337a4d06d719d1b62be1a86ff0b2e8da6ad8628efc556b6ce1887" kindref="member">SSH_FATAL</ref>,<sp/></highlight><highlight class="stringliteral">&quot;Bad<sp/>state<sp/>in<sp/>channel_open:<sp/>%d&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="306"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>channel-&gt;<ref refid="structssh__channel__struct_1a272b198e279fa672afeaf9f2e610eb04" kindref="member">state</ref>);</highlight></codeline>
<codeline lineno="307"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="308"><highlight class="normal"></highlight></codeline>
<codeline lineno="309"><highlight class="normal"><sp/><sp/><sp/><sp/>channel-&gt;<ref refid="structssh__channel__struct_1a39cdc105ee0bbd1b7faea169db30f0a1" kindref="member">local_channel</ref><sp/>=<sp/><ref refid="group__libssh__channel_1gabb9c8cd95c0aab1a293e91d7b05f8fc4" kindref="member">ssh_channel_new_id</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>);</highlight></codeline>
<codeline lineno="310"><highlight class="normal"><sp/><sp/><sp/><sp/>channel-&gt;<ref refid="structssh__channel__struct_1a0a0b3f3813c49edf2540e35853d2f791" kindref="member">local_maxpacket</ref><sp/>=<sp/>maxpacket;</highlight></codeline>
<codeline lineno="311"><highlight class="normal"><sp/><sp/><sp/><sp/>channel-&gt;<ref refid="structssh__channel__struct_1a7067e2963e961729416849785c1d1bd3" kindref="member">local_window</ref><sp/>=<sp/>window;</highlight></codeline>
<codeline lineno="312"><highlight class="normal"></highlight></codeline>
<codeline lineno="313"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="priv_8h_1aa21fd8a7a609329603b7b16da7939fca" kindref="member">SSH_LOG</ref>(<ref refid="group__libssh__log_1ggadf764cbdea00d65edcd07bb9953ad2b7a75fa79e63947b66462db977d9b5ae27c" kindref="member">SSH_LOG_PROTOCOL</ref>,</highlight></codeline>
<codeline lineno="314"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Creating<sp/>a<sp/>channel<sp/>%d<sp/>with<sp/>%d<sp/>window<sp/>and<sp/>%d<sp/>max<sp/>packet&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="315"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>channel-&gt;<ref refid="structssh__channel__struct_1a39cdc105ee0bbd1b7faea169db30f0a1" kindref="member">local_channel</ref>,<sp/>window,<sp/>maxpacket);</highlight></codeline>
<codeline lineno="316"><highlight class="normal"></highlight></codeline>
<codeline lineno="317"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="buffer_8h_1ae17848a86043f0abfc60c1c4f6126ccd" kindref="member">ssh_buffer_pack</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1af0aed60c1e529bbfdcb483fd80bf98a0" kindref="member">out_buffer</ref>,</highlight></codeline>
<codeline lineno="318"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;bsddd&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="319"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ssh2_8h_1ad24b399bd1fe32588984e09d35dfd14d" kindref="member">SSH2_MSG_CHANNEL_OPEN</ref>,</highlight></codeline>
<codeline lineno="320"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>type,</highlight></codeline>
<codeline lineno="321"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>channel-&gt;<ref refid="structssh__channel__struct_1a39cdc105ee0bbd1b7faea169db30f0a1" kindref="member">local_channel</ref>,</highlight></codeline>
<codeline lineno="322"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>channel-&gt;<ref refid="structssh__channel__struct_1a7067e2963e961729416849785c1d1bd3" kindref="member">local_window</ref>,</highlight></codeline>
<codeline lineno="323"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>channel-&gt;<ref refid="structssh__channel__struct_1a0a0b3f3813c49edf2540e35853d2f791" kindref="member">local_maxpacket</ref>);</highlight></codeline>
<codeline lineno="324"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>!=<sp/><ref refid="libssh_8h_1ac1ee1d1e917456d4760a94a18015377d" kindref="member">SSH_OK</ref>)<sp/>{</highlight></codeline>
<codeline lineno="325"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="priv_8h_1ae280c413c792e04237f000841ac8ce44" kindref="member">ssh_set_error_oom</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>);</highlight></codeline>
<codeline lineno="326"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>err;</highlight></codeline>
<codeline lineno="327"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="328"><highlight class="normal"></highlight></codeline>
<codeline lineno="329"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(payload<sp/>!=<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="330"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="buffer_8h_1af2ca5e302f5395c48657a1bad52f3a12" kindref="member">ssh_buffer_add_buffer</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1af0aed60c1e529bbfdcb483fd80bf98a0" kindref="member">out_buffer</ref>,<sp/>payload)<sp/>&lt;<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="331"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="priv_8h_1ae280c413c792e04237f000841ac8ce44" kindref="member">ssh_set_error_oom</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>);</highlight></codeline>
<codeline lineno="332"><highlight class="normal"></highlight></codeline>
<codeline lineno="333"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>err;</highlight></codeline>
<codeline lineno="334"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="335"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="336"><highlight class="normal"><sp/><sp/><sp/><sp/>channel-&gt;<ref refid="structssh__channel__struct_1a272b198e279fa672afeaf9f2e610eb04" kindref="member">state</ref><sp/>=<sp/><ref refid="channels_8h_1a5a002159e5db31d156bb2a8ce8a10cd1a5a7cc3348940d3df41d2fd293cdb2e4c" kindref="member">SSH_CHANNEL_STATE_OPENING</ref>;</highlight></codeline>
<codeline lineno="337"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="packet_8h_1a7e6c7ed74c23ace432476aa8a6841140" kindref="member">ssh_packet_send</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>)<sp/>==<sp/><ref refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" kindref="member">SSH_ERROR</ref>)<sp/>{</highlight></codeline>
<codeline lineno="338"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>err;</highlight></codeline>
<codeline lineno="339"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="340"><highlight class="normal"></highlight></codeline>
<codeline lineno="341"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="priv_8h_1aa21fd8a7a609329603b7b16da7939fca" kindref="member">SSH_LOG</ref>(<ref refid="group__libssh__log_1ggadf764cbdea00d65edcd07bb9953ad2b7a6445dfe21592d69d9741d319538b6673" kindref="member">SSH_LOG_PACKET</ref>,</highlight></codeline>
<codeline lineno="342"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Sent<sp/>a<sp/>SSH_MSG_CHANNEL_OPEN<sp/>type<sp/>%s<sp/>for<sp/>channel<sp/>%d&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="343"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>type,<sp/>channel-&gt;<ref refid="structssh__channel__struct_1a39cdc105ee0bbd1b7faea169db30f0a1" kindref="member">local_channel</ref>);</highlight></codeline>
<codeline lineno="344"><highlight class="normal"></highlight></codeline>
<codeline lineno="345"><highlight class="normal">pending:</highlight></codeline>
<codeline lineno="346"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>wait<sp/>until<sp/>channel<sp/>is<sp/>opened<sp/>by<sp/>server<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="347"><highlight class="normal"><sp/><sp/><sp/><sp/>err<sp/>=<sp/><ref refid="group__libssh__session_1ga4b84e1ae757c0d4007a5eefdf4651694" kindref="member">ssh_handle_packets_termination</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>,</highlight></codeline>
<codeline lineno="348"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="session_8h_1aa8c8d35c7f83d7b00218ebadfac2254b" kindref="member">SSH_TIMEOUT_DEFAULT</ref>,</highlight></codeline>
<codeline lineno="349"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="group__libssh__channel_1ga3c2fe7cf69c947046bbfae132afa7ff4" kindref="member">ssh_channel_open_termination</ref>,</highlight></codeline>
<codeline lineno="350"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>channel);</highlight></codeline>
<codeline lineno="351"><highlight class="normal"></highlight></codeline>
<codeline lineno="352"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a6f74d1a1eb6ed715b1073b67caa18460" kindref="member">session_state</ref><sp/>==<sp/><ref refid="session_8h_1a9bbd1d5ae11485e27279be6ad461992ca855474fc84a2fb170fcb72546af8eeb8" kindref="member">SSH_SESSION_STATE_ERROR</ref>)<sp/>{</highlight></codeline>
<codeline lineno="353"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>err<sp/>=<sp/><ref refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" kindref="member">SSH_ERROR</ref>;</highlight></codeline>
<codeline lineno="354"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="355"><highlight class="normal"></highlight></codeline>
<codeline lineno="356"><highlight class="normal">end:</highlight></codeline>
<codeline lineno="357"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>This<sp/>needs<sp/>to<sp/>pass<sp/>the<sp/>SSH_AGAIN<sp/>from<sp/>the<sp/>above,</highlight></codeline>
<codeline lineno="358"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/>*<sp/>but<sp/>needs<sp/>to<sp/>catch<sp/>failed<sp/>channel<sp/>states<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="359"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(channel-&gt;<ref refid="structssh__channel__struct_1a272b198e279fa672afeaf9f2e610eb04" kindref="member">state</ref><sp/>==<sp/><ref refid="channels_8h_1a5a002159e5db31d156bb2a8ce8a10cd1a488a78707192c35250392423b5058e2b" kindref="member">SSH_CHANNEL_STATE_OPEN</ref>)<sp/>{</highlight></codeline>
<codeline lineno="360"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>err<sp/>=<sp/><ref refid="libssh_8h_1ac1ee1d1e917456d4760a94a18015377d" kindref="member">SSH_OK</ref>;</highlight></codeline>
<codeline lineno="361"><highlight class="normal"><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(err<sp/>!=<sp/><ref refid="libssh_8h_1a9c57e4f6482106336045a4d25a55f28e" kindref="member">SSH_AGAIN</ref>)<sp/>{</highlight></codeline>
<codeline lineno="362"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Messages<sp/>were<sp/>handled<sp/>correctly,<sp/>but<sp/>he<sp/>channel<sp/>state<sp/>is<sp/>invalid<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="363"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>err<sp/>=<sp/><ref refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" kindref="member">SSH_ERROR</ref>;</highlight></codeline>
<codeline lineno="364"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="365"><highlight class="normal"></highlight></codeline>
<codeline lineno="366"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>err;</highlight></codeline>
<codeline lineno="367"><highlight class="normal">}</highlight></codeline>
<codeline lineno="368"><highlight class="normal"></highlight></codeline>
<codeline lineno="369"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>return<sp/>channel<sp/>with<sp/>corresponding<sp/>local<sp/>id,<sp/>or<sp/>NULL<sp/>if<sp/>not<sp/>found<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="370" refid="group__libssh__channel_1ga4c25383c95b09d1b583ef0a9db4b08e2" refkind="member"><highlight class="normal"><ref refid="structssh__channel__struct" kindref="compound">ssh_channel</ref><sp/><ref refid="group__libssh__channel_1ga4c25383c95b09d1b583ef0a9db4b08e2" kindref="member">ssh_channel_from_local</ref>(<ref refid="structssh__session__struct" kindref="compound">ssh_session</ref><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>,<sp/>uint32_t<sp/></highlight><highlight class="keywordtype">id</highlight><highlight class="normal">)<sp/>{</highlight></codeline>
<codeline lineno="371"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">struct<sp/></highlight><highlight class="normal"><ref refid="structssh__iterator" kindref="compound">ssh_iterator</ref><sp/>*it;</highlight></codeline>
<codeline lineno="372"><highlight class="normal"><sp/><sp/><ref refid="structssh__channel__struct" kindref="compound">ssh_channel</ref><sp/>channel;</highlight></codeline>
<codeline lineno="373"><highlight class="normal"></highlight></codeline>
<codeline lineno="374"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(it<sp/>=<sp/><ref refid="group__libssh__misc_1gad36d247bfcae7965d6aca8245d061e0d" kindref="member">ssh_list_get_iterator</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a9445164beb02a1979171bef9b1a63182" kindref="member">channels</ref>);<sp/>it<sp/>!=<sp/>NULL<sp/>;<sp/>it=it-&gt;<ref refid="structssh__iterator_1a7fd7219325e56f365796ad59c8443ee5" kindref="member">next</ref>)<sp/>{</highlight></codeline>
<codeline lineno="375"><highlight class="normal"><sp/><sp/><sp/><sp/>channel<sp/>=<sp/><ref refid="misc_8h_1a1f44c71b6f7ba10a4a543f73a07a85aa" kindref="member">ssh_iterator_value</ref>(<ref refid="structssh__channel__struct" kindref="compound">ssh_channel</ref>,<sp/>it);</highlight></codeline>
<codeline lineno="376"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(channel<sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="377"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">continue</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="378"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="379"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(channel-&gt;<ref refid="structssh__channel__struct_1a39cdc105ee0bbd1b7faea169db30f0a1" kindref="member">local_channel</ref><sp/>==<sp/></highlight><highlight class="keywordtype">id</highlight><highlight class="normal">)<sp/>{</highlight></codeline>
<codeline lineno="380"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>channel;</highlight></codeline>
<codeline lineno="381"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="382"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="383"><highlight class="normal"></highlight></codeline>
<codeline lineno="384"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>NULL;</highlight></codeline>
<codeline lineno="385"><highlight class="normal">}</highlight></codeline>
<codeline lineno="386"><highlight class="normal"></highlight></codeline>
<codeline lineno="395" refid="group__libssh__channel_1gac4fc789667578e8f0e2614f5274c9b5f" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="group__libssh__channel_1gac4fc789667578e8f0e2614f5274c9b5f" kindref="member">grow_window</ref>(<ref refid="structssh__session__struct" kindref="compound">ssh_session</ref><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>,</highlight></codeline>
<codeline lineno="396"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structssh__channel__struct" kindref="compound">ssh_channel</ref><sp/>channel,</highlight></codeline>
<codeline lineno="397"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>uint32_t<sp/>minimumsize)</highlight></codeline>
<codeline lineno="398"><highlight class="normal">{</highlight></codeline>
<codeline lineno="399"><highlight class="normal"><sp/><sp/>uint32_t<sp/>new_window<sp/>=<sp/>minimumsize<sp/>&gt;<sp/><ref refid="channels_8c_1ab291488cbad12a5e02777a6d16c7fc1c" kindref="member">WINDOWBASE</ref><sp/>?<sp/>minimumsize<sp/>:<sp/><ref refid="channels_8c_1ab291488cbad12a5e02777a6d16c7fc1c" kindref="member">WINDOWBASE</ref>;</highlight></codeline>
<codeline lineno="400"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref>;</highlight></codeline>
<codeline lineno="401"><highlight class="normal"></highlight></codeline>
<codeline lineno="402"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(new_window<sp/>&lt;=<sp/>channel-&gt;local_window){</highlight></codeline>
<codeline lineno="403"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="priv_8h_1aa21fd8a7a609329603b7b16da7939fca" kindref="member">SSH_LOG</ref>(<ref refid="group__libssh__log_1ggadf764cbdea00d65edcd07bb9953ad2b7a75fa79e63947b66462db977d9b5ae27c" kindref="member">SSH_LOG_PROTOCOL</ref>,</highlight></codeline>
<codeline lineno="404"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;growing<sp/>window<sp/>(channel<sp/>%d:%d)<sp/>to<sp/>%d<sp/>bytes<sp/>:<sp/>not<sp/>needed<sp/>(%d<sp/>bytes)&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="405"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>channel-&gt;<ref refid="structssh__channel__struct_1a39cdc105ee0bbd1b7faea169db30f0a1" kindref="member">local_channel</ref>,<sp/>channel-&gt;<ref refid="structssh__channel__struct_1aa553acf6d12fffb1ae18b11196c2c0e9" kindref="member">remote_channel</ref>,<sp/>new_window,</highlight></codeline>
<codeline lineno="406"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>channel-&gt;<ref refid="structssh__channel__struct_1a7067e2963e961729416849785c1d1bd3" kindref="member">local_window</ref>);</highlight></codeline>
<codeline lineno="407"><highlight class="normal"></highlight></codeline>
<codeline lineno="408"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="libssh_8h_1ac1ee1d1e917456d4760a94a18015377d" kindref="member">SSH_OK</ref>;</highlight></codeline>
<codeline lineno="409"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="410"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">/*<sp/>WINDOW_ADJUST<sp/>packet<sp/>needs<sp/>a<sp/>relative<sp/>increment<sp/>rather<sp/>than<sp/>an<sp/>absolute</highlight></codeline>
<codeline lineno="411"><highlight class="comment"><sp/><sp/><sp/>*<sp/>value,<sp/>so<sp/>we<sp/>give<sp/>here<sp/>the<sp/>missing<sp/>bytes<sp/>needed<sp/>to<sp/>reach<sp/>new_window</highlight></codeline>
<codeline lineno="412"><highlight class="comment"><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="413"><highlight class="normal"><sp/><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="buffer_8h_1ae17848a86043f0abfc60c1c4f6126ccd" kindref="member">ssh_buffer_pack</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1af0aed60c1e529bbfdcb483fd80bf98a0" kindref="member">out_buffer</ref>,</highlight></codeline>
<codeline lineno="414"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;bdd&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="415"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ssh2_8h_1a3ff2e2a8f3b31a90985291f0c0eff418" kindref="member">SSH2_MSG_CHANNEL_WINDOW_ADJUST</ref>,</highlight></codeline>
<codeline lineno="416"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>channel-&gt;<ref refid="structssh__channel__struct_1aa553acf6d12fffb1ae18b11196c2c0e9" kindref="member">remote_channel</ref>,</highlight></codeline>
<codeline lineno="417"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>new_window<sp/>-<sp/>channel-&gt;<ref refid="structssh__channel__struct_1a7067e2963e961729416849785c1d1bd3" kindref="member">local_window</ref>);</highlight></codeline>
<codeline lineno="418"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>!=<sp/><ref refid="libssh_8h_1ac1ee1d1e917456d4760a94a18015377d" kindref="member">SSH_OK</ref>)<sp/>{</highlight></codeline>
<codeline lineno="419"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="priv_8h_1ae280c413c792e04237f000841ac8ce44" kindref="member">ssh_set_error_oom</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>);</highlight></codeline>
<codeline lineno="420"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">goto</highlight><highlight class="normal"><sp/><ref refid="proxy_8c_1a11614f44ef4d939bdd984953346a7572" kindref="member">error</ref>;</highlight></codeline>
<codeline lineno="421"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="422"><highlight class="normal"></highlight></codeline>
<codeline lineno="423"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="packet_8h_1a7e6c7ed74c23ace432476aa8a6841140" kindref="member">ssh_packet_send</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>)<sp/>==<sp/><ref refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" kindref="member">SSH_ERROR</ref>)<sp/>{</highlight></codeline>
<codeline lineno="424"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">goto</highlight><highlight class="normal"><sp/><ref refid="proxy_8c_1a11614f44ef4d939bdd984953346a7572" kindref="member">error</ref>;</highlight></codeline>
<codeline lineno="425"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="426"><highlight class="normal"></highlight></codeline>
<codeline lineno="427"><highlight class="normal"><sp/><sp/><ref refid="priv_8h_1aa21fd8a7a609329603b7b16da7939fca" kindref="member">SSH_LOG</ref>(<ref refid="group__libssh__log_1ggadf764cbdea00d65edcd07bb9953ad2b7a75fa79e63947b66462db977d9b5ae27c" kindref="member">SSH_LOG_PROTOCOL</ref>,</highlight></codeline>
<codeline lineno="428"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;growing<sp/>window<sp/>(channel<sp/>%d:%d)<sp/>to<sp/>%d<sp/>bytes&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="429"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>channel-&gt;<ref refid="structssh__channel__struct_1a39cdc105ee0bbd1b7faea169db30f0a1" kindref="member">local_channel</ref>,</highlight></codeline>
<codeline lineno="430"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>channel-&gt;<ref refid="structssh__channel__struct_1aa553acf6d12fffb1ae18b11196c2c0e9" kindref="member">remote_channel</ref>,</highlight></codeline>
<codeline lineno="431"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>new_window);</highlight></codeline>
<codeline lineno="432"><highlight class="normal"></highlight></codeline>
<codeline lineno="433"><highlight class="normal"><sp/><sp/>channel-&gt;<ref refid="structssh__channel__struct_1a7067e2963e961729416849785c1d1bd3" kindref="member">local_window</ref><sp/>=<sp/>new_window;</highlight></codeline>
<codeline lineno="434"><highlight class="normal"></highlight></codeline>
<codeline lineno="435"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="libssh_8h_1ac1ee1d1e917456d4760a94a18015377d" kindref="member">SSH_OK</ref>;</highlight></codeline>
<codeline lineno="436"><highlight class="normal"><ref refid="proxy_8c_1a11614f44ef4d939bdd984953346a7572" kindref="member">error</ref>:</highlight></codeline>
<codeline lineno="437"><highlight class="normal"><sp/><sp/><ref refid="libssh_8h_1ac8802ff7f5348d0145dab5242623f740" kindref="member">ssh_buffer_reinit</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1af0aed60c1e529bbfdcb483fd80bf98a0" kindref="member">out_buffer</ref>);</highlight></codeline>
<codeline lineno="438"><highlight class="normal"></highlight></codeline>
<codeline lineno="439"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" kindref="member">SSH_ERROR</ref>;</highlight></codeline>
<codeline lineno="440"><highlight class="normal">}</highlight></codeline>
<codeline lineno="441"><highlight class="normal"></highlight></codeline>
<codeline lineno="455" refid="group__libssh__channel_1ga41254c9dd24ac1ae9ad9c0edd3825dee" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/><ref refid="structssh__channel__struct" kindref="compound">ssh_channel</ref><sp/><ref refid="group__libssh__channel_1ga41254c9dd24ac1ae9ad9c0edd3825dee" kindref="member">channel_from_msg</ref>(<ref refid="structssh__session__struct" kindref="compound">ssh_session</ref><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>,<sp/><ref refid="structssh__buffer__struct" kindref="compound">ssh_buffer</ref><sp/>packet)<sp/>{</highlight></codeline>
<codeline lineno="456"><highlight class="normal"><sp/><sp/><ref refid="structssh__channel__struct" kindref="compound">ssh_channel</ref><sp/>channel;</highlight></codeline>
<codeline lineno="457"><highlight class="normal"><sp/><sp/>uint32_t<sp/><ref refid="proxy_8c_1aadb4b99b6f71c3c49bd7b97096d033fa" kindref="member">chan</ref>;</highlight></codeline>
<codeline lineno="458"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref>;</highlight></codeline>
<codeline lineno="459"><highlight class="normal"></highlight></codeline>
<codeline lineno="460"><highlight class="normal"><sp/><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="buffer_8h_1ab51014ef9a47e7cdbd235af3e62b81ee" kindref="member">ssh_buffer_unpack</ref>(packet,</highlight><highlight class="stringliteral">&quot;d&quot;</highlight><highlight class="normal">,&amp;<ref refid="proxy_8c_1aadb4b99b6f71c3c49bd7b97096d033fa" kindref="member">chan</ref>);</highlight></codeline>
<codeline lineno="461"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>!=<sp/><ref refid="libssh_8h_1ac1ee1d1e917456d4760a94a18015377d" kindref="member">SSH_OK</ref>)<sp/>{</highlight></codeline>
<codeline lineno="462"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="priv_8h_1a55177b3e8db90ca9adb435c44281963c" kindref="member">ssh_set_error</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>,<sp/><ref refid="libssh_8h_1a036b2b00fb04337a4d06d719d1b62be1a86ff0b2e8da6ad8628efc556b6ce1887" kindref="member">SSH_FATAL</ref>,</highlight></codeline>
<codeline lineno="463"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Getting<sp/>channel<sp/>from<sp/>message:<sp/>short<sp/>read&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="464"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>NULL;</highlight></codeline>
<codeline lineno="465"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="466"><highlight class="normal"></highlight></codeline>
<codeline lineno="467"><highlight class="normal"><sp/><sp/>channel<sp/>=<sp/><ref refid="group__libssh__channel_1ga4c25383c95b09d1b583ef0a9db4b08e2" kindref="member">ssh_channel_from_local</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>,<sp/><ref refid="proxy_8c_1aadb4b99b6f71c3c49bd7b97096d033fa" kindref="member">chan</ref>);</highlight></codeline>
<codeline lineno="468"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(channel<sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="469"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="priv_8h_1a55177b3e8db90ca9adb435c44281963c" kindref="member">ssh_set_error</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>,<sp/><ref refid="libssh_8h_1a036b2b00fb04337a4d06d719d1b62be1a86ff0b2e8da6ad8628efc556b6ce1887" kindref="member">SSH_FATAL</ref>,</highlight></codeline>
<codeline lineno="470"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Server<sp/>specified<sp/>invalid<sp/>channel<sp/>%&quot;</highlight><highlight class="normal">PRIu32,</highlight></codeline>
<codeline lineno="471"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(uint32_t)<sp/><ref refid="proxy_8c_1aadb4b99b6f71c3c49bd7b97096d033fa" kindref="member">chan</ref>);</highlight></codeline>
<codeline lineno="472"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="473"><highlight class="normal"></highlight></codeline>
<codeline lineno="474"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>channel;</highlight></codeline>
<codeline lineno="475"><highlight class="normal">}</highlight></codeline>
<codeline lineno="476"><highlight class="normal"></highlight></codeline>
<codeline lineno="477" refid="group__libssh__channel_1ga9ddc86ac082a2b8992426c70c0b9e2ef" refkind="member"><highlight class="normal"><ref refid="group__libssh__channel_1ga1f817e943f01e76843f60f9f9ca970f9" kindref="member">SSH_PACKET_CALLBACK</ref>(channel_rcv_change_window)<sp/>{</highlight></codeline>
<codeline lineno="478"><highlight class="normal"><sp/><sp/><ref refid="structssh__channel__struct" kindref="compound">ssh_channel</ref><sp/>channel;</highlight></codeline>
<codeline lineno="479"><highlight class="normal"><sp/><sp/>uint32_t<sp/>bytes;</highlight></codeline>
<codeline lineno="480"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref>;</highlight></codeline>
<codeline lineno="481"><highlight class="normal"><sp/><sp/>(void)<ref refid="ssh__client_8c_1a14871705f45ccdc5bb9f4549efd8e119" kindref="member">user</ref>;</highlight></codeline>
<codeline lineno="482"><highlight class="normal"><sp/><sp/>(void)type;</highlight></codeline>
<codeline lineno="483"><highlight class="normal"></highlight></codeline>
<codeline lineno="484"><highlight class="normal"><sp/><sp/>channel<sp/>=<sp/><ref refid="group__libssh__channel_1ga41254c9dd24ac1ae9ad9c0edd3825dee" kindref="member">channel_from_msg</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>,packet);</highlight></codeline>
<codeline lineno="485"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(channel<sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="486"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="priv_8h_1aa21fd8a7a609329603b7b16da7939fca" kindref="member">SSH_LOG</ref>(<ref refid="group__libssh__log_1ggadf764cbdea00d65edcd07bb9953ad2b7a926c933f61d1afa64003c1cc66f6a01c" kindref="member">SSH_LOG_FUNCTIONS</ref>,<sp/></highlight><highlight class="stringliteral">&quot;%s&quot;</highlight><highlight class="normal">,<sp/><ref refid="group__libssh__error_1ga9241586665bf21f823806473fc386258" kindref="member">ssh_get_error</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>));</highlight></codeline>
<codeline lineno="487"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="488"><highlight class="normal"></highlight></codeline>
<codeline lineno="489"><highlight class="normal"><sp/><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="buffer_8h_1ab51014ef9a47e7cdbd235af3e62b81ee" kindref="member">ssh_buffer_unpack</ref>(packet,<sp/></highlight><highlight class="stringliteral">&quot;d&quot;</highlight><highlight class="normal">,<sp/>&amp;bytes);</highlight></codeline>
<codeline lineno="490"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(channel<sp/>==<sp/>NULL<sp/>||<sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>!=<sp/><ref refid="libssh_8h_1ac1ee1d1e917456d4760a94a18015377d" kindref="member">SSH_OK</ref>)<sp/>{</highlight></codeline>
<codeline lineno="491"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="priv_8h_1aa21fd8a7a609329603b7b16da7939fca" kindref="member">SSH_LOG</ref>(<ref refid="group__libssh__log_1ggadf764cbdea00d65edcd07bb9953ad2b7a6445dfe21592d69d9741d319538b6673" kindref="member">SSH_LOG_PACKET</ref>,</highlight></codeline>
<codeline lineno="492"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Error<sp/>getting<sp/>a<sp/>window<sp/>adjust<sp/>message:<sp/>invalid<sp/>packet&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="493"><highlight class="normal"></highlight></codeline>
<codeline lineno="494"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="group__libssh__callbacks_1gac29df803aa1295d6a498c1b081f3b494" kindref="member">SSH_PACKET_USED</ref>;</highlight></codeline>
<codeline lineno="495"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="496"><highlight class="normal"></highlight></codeline>
<codeline lineno="497"><highlight class="normal"><sp/><sp/><ref refid="priv_8h_1aa21fd8a7a609329603b7b16da7939fca" kindref="member">SSH_LOG</ref>(<ref refid="group__libssh__log_1ggadf764cbdea00d65edcd07bb9953ad2b7a75fa79e63947b66462db977d9b5ae27c" kindref="member">SSH_LOG_PROTOCOL</ref>,</highlight></codeline>
<codeline lineno="498"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Adding<sp/>%d<sp/>bytes<sp/>to<sp/>channel<sp/>(%d:%d)<sp/>(from<sp/>%d<sp/>bytes)&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="499"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>bytes,</highlight></codeline>
<codeline lineno="500"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>channel-&gt;<ref refid="structssh__channel__struct_1a39cdc105ee0bbd1b7faea169db30f0a1" kindref="member">local_channel</ref>,</highlight></codeline>
<codeline lineno="501"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>channel-&gt;<ref refid="structssh__channel__struct_1aa553acf6d12fffb1ae18b11196c2c0e9" kindref="member">remote_channel</ref>,</highlight></codeline>
<codeline lineno="502"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>channel-&gt;<ref refid="structssh__channel__struct_1a1b5936420da03e6b64aa8f900eb8ad0c" kindref="member">remote_window</ref>);</highlight></codeline>
<codeline lineno="503"><highlight class="normal"></highlight></codeline>
<codeline lineno="504"><highlight class="normal"><sp/><sp/>channel-&gt;<ref refid="structssh__channel__struct_1a1b5936420da03e6b64aa8f900eb8ad0c" kindref="member">remote_window</ref><sp/>+=<sp/>bytes;</highlight></codeline>
<codeline lineno="505"><highlight class="normal"></highlight></codeline>
<codeline lineno="506"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="group__libssh__callbacks_1gac29df803aa1295d6a498c1b081f3b494" kindref="member">SSH_PACKET_USED</ref>;</highlight></codeline>
<codeline lineno="507"><highlight class="normal">}</highlight></codeline>
<codeline lineno="508"><highlight class="normal"></highlight></codeline>
<codeline lineno="509"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>is_stderr<sp/>is<sp/>set<sp/>to<sp/>1<sp/>if<sp/>the<sp/>data<sp/>are<sp/>extended,<sp/>ie<sp/>stderr<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="510" refid="group__libssh__channel_1ga2a1924f01a292478aaf2f140a8a107e3" refkind="member"><highlight class="normal"><ref refid="group__libssh__channel_1ga1f817e943f01e76843f60f9f9ca970f9" kindref="member">SSH_PACKET_CALLBACK</ref>(channel_rcv_data){</highlight></codeline>
<codeline lineno="511"><highlight class="normal"><sp/><sp/><ref refid="structssh__channel__struct" kindref="compound">ssh_channel</ref><sp/>channel;</highlight></codeline>
<codeline lineno="512"><highlight class="normal"><sp/><sp/><ref refid="structssh__string__struct" kindref="compound">ssh_string</ref><sp/>str;</highlight></codeline>
<codeline lineno="513"><highlight class="normal"><sp/><sp/><ref refid="structssh__buffer__struct" kindref="compound">ssh_buffer</ref><sp/>buf;</highlight></codeline>
<codeline lineno="514"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/>len;</highlight></codeline>
<codeline lineno="515"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>is_stderr;</highlight></codeline>
<codeline lineno="516"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>rest;</highlight></codeline>
<codeline lineno="517"><highlight class="normal"><sp/><sp/>(void)<ref refid="ssh__client_8c_1a14871705f45ccdc5bb9f4549efd8e119" kindref="member">user</ref>;</highlight></codeline>
<codeline lineno="518"><highlight class="normal"></highlight></codeline>
<codeline lineno="519"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(type==<ref refid="ssh2_8h_1ab4dc0d7b8a45a0f902a5332c6a7c2b35" kindref="member">SSH2_MSG_CHANNEL_DATA</ref>)</highlight></codeline>
<codeline lineno="520"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>is_stderr=0;</highlight></codeline>
<codeline lineno="521"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="522"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>is_stderr=1;</highlight></codeline>
<codeline lineno="523"><highlight class="normal"></highlight></codeline>
<codeline lineno="524"><highlight class="normal"><sp/><sp/>channel<sp/>=<sp/><ref refid="group__libssh__channel_1ga41254c9dd24ac1ae9ad9c0edd3825dee" kindref="member">channel_from_msg</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>,packet);</highlight></codeline>
<codeline lineno="525"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(channel<sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="526"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="priv_8h_1aa21fd8a7a609329603b7b16da7939fca" kindref="member">SSH_LOG</ref>(<ref refid="group__libssh__log_1ggadf764cbdea00d65edcd07bb9953ad2b7a926c933f61d1afa64003c1cc66f6a01c" kindref="member">SSH_LOG_FUNCTIONS</ref>,</highlight></codeline>
<codeline lineno="527"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;%s&quot;</highlight><highlight class="normal">,<sp/><ref refid="group__libssh__error_1ga9241586665bf21f823806473fc386258" kindref="member">ssh_get_error</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>));</highlight></codeline>
<codeline lineno="528"><highlight class="normal"></highlight></codeline>
<codeline lineno="529"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="group__libssh__callbacks_1gac29df803aa1295d6a498c1b081f3b494" kindref="member">SSH_PACKET_USED</ref>;</highlight></codeline>
<codeline lineno="530"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="531"><highlight class="normal"></highlight></codeline>
<codeline lineno="532"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(is_stderr)<sp/>{</highlight></codeline>
<codeline lineno="533"><highlight class="normal"><sp/><sp/><sp/><sp/>uint32_t<sp/>ignore;</highlight></codeline>
<codeline lineno="534"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>uint32<sp/>data<sp/>type<sp/>code.<sp/>we<sp/>can<sp/>ignore<sp/>it<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="535"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="buffer_8h_1a71d2508b2ed54654c2fae5f0e4422a8f" kindref="member">ssh_buffer_get_u32</ref>(packet,<sp/>&amp;ignore);</highlight></codeline>
<codeline lineno="536"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="537"><highlight class="normal"></highlight></codeline>
<codeline lineno="538"><highlight class="normal"><sp/><sp/>str<sp/>=<sp/><ref refid="buffer_8h_1ae9ba83ddeaf673b2d15be5312495ed7e" kindref="member">ssh_buffer_get_ssh_string</ref>(packet);</highlight></codeline>
<codeline lineno="539"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(str<sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="540"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="priv_8h_1aa21fd8a7a609329603b7b16da7939fca" kindref="member">SSH_LOG</ref>(<ref refid="group__libssh__log_1ggadf764cbdea00d65edcd07bb9953ad2b7a6445dfe21592d69d9741d319538b6673" kindref="member">SSH_LOG_PACKET</ref>,<sp/></highlight><highlight class="stringliteral">&quot;Invalid<sp/>data<sp/>packet!&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="541"><highlight class="normal"></highlight></codeline>
<codeline lineno="542"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="group__libssh__callbacks_1gac29df803aa1295d6a498c1b081f3b494" kindref="member">SSH_PACKET_USED</ref>;</highlight></codeline>
<codeline lineno="543"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="544"><highlight class="normal"><sp/><sp/>len<sp/>=<sp/><ref refid="libssh_8h_1aad7b2fc092973a478df54a40af69abf2" kindref="member">ssh_string_len</ref>(str);</highlight></codeline>
<codeline lineno="545"><highlight class="normal"></highlight></codeline>
<codeline lineno="546"><highlight class="normal"><sp/><sp/><ref refid="priv_8h_1aa21fd8a7a609329603b7b16da7939fca" kindref="member">SSH_LOG</ref>(<ref refid="group__libssh__log_1ggadf764cbdea00d65edcd07bb9953ad2b7a6445dfe21592d69d9741d319538b6673" kindref="member">SSH_LOG_PACKET</ref>,</highlight></codeline>
<codeline lineno="547"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Channel<sp/>receiving<sp/>%&quot;</highlight><highlight class="normal"><sp/><ref refid="priv_8h_1a9a1a185142f0e05d19758ac524f862e2" kindref="member">PRIdS</ref><sp/></highlight><highlight class="stringliteral">&quot;<sp/>bytes<sp/>data<sp/>in<sp/>%d<sp/>(local<sp/>win=%d<sp/>remote<sp/>win=%d)&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="548"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>len,</highlight></codeline>
<codeline lineno="549"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>is_stderr,</highlight></codeline>
<codeline lineno="550"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>channel-&gt;<ref refid="structssh__channel__struct_1a7067e2963e961729416849785c1d1bd3" kindref="member">local_window</ref>,</highlight></codeline>
<codeline lineno="551"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>channel-&gt;<ref refid="structssh__channel__struct_1a1b5936420da03e6b64aa8f900eb8ad0c" kindref="member">remote_window</ref>);</highlight></codeline>
<codeline lineno="552"><highlight class="normal"></highlight></codeline>
<codeline lineno="553"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">/*<sp/>What<sp/>shall<sp/>we<sp/>do<sp/>in<sp/>this<sp/>case?<sp/>Let&apos;s<sp/>accept<sp/>it<sp/>anyway<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="554"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(len<sp/>&gt;<sp/>channel-&gt;<ref refid="structssh__channel__struct_1a7067e2963e961729416849785c1d1bd3" kindref="member">local_window</ref>)<sp/>{</highlight></codeline>
<codeline lineno="555"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="priv_8h_1aa21fd8a7a609329603b7b16da7939fca" kindref="member">SSH_LOG</ref>(<ref refid="libssh_8h_1a1c08cc9177a5598e0675abfb833d2993" kindref="member">SSH_LOG_RARE</ref>,</highlight></codeline>
<codeline lineno="556"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Data<sp/>packet<sp/>too<sp/>big<sp/>for<sp/>our<sp/>window(%&quot;</highlight><highlight class="normal"><sp/><ref refid="priv_8h_1a9a1a185142f0e05d19758ac524f862e2" kindref="member">PRIdS</ref><sp/></highlight><highlight class="stringliteral">&quot;<sp/>vs<sp/>%d)&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="557"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>len,</highlight></codeline>
<codeline lineno="558"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>channel-&gt;<ref refid="structssh__channel__struct_1a7067e2963e961729416849785c1d1bd3" kindref="member">local_window</ref>);</highlight></codeline>
<codeline lineno="559"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="560"><highlight class="normal"></highlight></codeline>
<codeline lineno="561"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="group__libssh__channel_1ga3f6b844e236802c6780e7bcf0c0f3fce" kindref="member">channel_default_bufferize</ref>(channel,<sp/><ref refid="libssh_8h_1aca901aa97257413ddf60ef74ff2bf7a6" kindref="member">ssh_string_data</ref>(str),<sp/>len,</highlight></codeline>
<codeline lineno="562"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>is_stderr)<sp/>&lt;<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="563"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="libssh_8h_1a5bc8710c8633117ff449d15489fca051" kindref="member">SSH_STRING_FREE</ref>(str);</highlight></codeline>
<codeline lineno="564"><highlight class="normal"></highlight></codeline>
<codeline lineno="565"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="group__libssh__callbacks_1gac29df803aa1295d6a498c1b081f3b494" kindref="member">SSH_PACKET_USED</ref>;</highlight></codeline>
<codeline lineno="566"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="567"><highlight class="normal"></highlight></codeline>
<codeline lineno="568"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(len<sp/>&lt;=<sp/>channel-&gt;local_window)<sp/>{</highlight></codeline>
<codeline lineno="569"><highlight class="normal"><sp/><sp/><sp/><sp/>channel-&gt;<ref refid="structssh__channel__struct_1a7067e2963e961729416849785c1d1bd3" kindref="member">local_window</ref><sp/>-=<sp/>len;</highlight></codeline>
<codeline lineno="570"><highlight class="normal"><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="571"><highlight class="normal"><sp/><sp/><sp/><sp/>channel-&gt;<ref refid="structssh__channel__struct_1a7067e2963e961729416849785c1d1bd3" kindref="member">local_window</ref><sp/>=<sp/>0;<sp/></highlight><highlight class="comment">/*<sp/>buggy<sp/>remote<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="572"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="573"><highlight class="normal"></highlight></codeline>
<codeline lineno="574"><highlight class="normal"><sp/><sp/><ref refid="priv_8h_1aa21fd8a7a609329603b7b16da7939fca" kindref="member">SSH_LOG</ref>(<ref refid="group__libssh__log_1ggadf764cbdea00d65edcd07bb9953ad2b7a6445dfe21592d69d9741d319538b6673" kindref="member">SSH_LOG_PACKET</ref>,</highlight></codeline>
<codeline lineno="575"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Channel<sp/>windows<sp/>are<sp/>now<sp/>(local<sp/>win=%d<sp/>remote<sp/>win=%d)&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="576"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>channel-&gt;<ref refid="structssh__channel__struct_1a7067e2963e961729416849785c1d1bd3" kindref="member">local_window</ref>,</highlight></codeline>
<codeline lineno="577"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>channel-&gt;<ref refid="structssh__channel__struct_1a1b5936420da03e6b64aa8f900eb8ad0c" kindref="member">remote_window</ref>);</highlight></codeline>
<codeline lineno="578"><highlight class="normal"></highlight></codeline>
<codeline lineno="579"><highlight class="normal"><sp/><sp/><ref refid="libssh_8h_1a5bc8710c8633117ff449d15489fca051" kindref="member">SSH_STRING_FREE</ref>(str);</highlight></codeline>
<codeline lineno="580"><highlight class="normal"></highlight></codeline>
<codeline lineno="581"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(is_stderr)<sp/>{</highlight></codeline>
<codeline lineno="582"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>buf<sp/>=<sp/>channel-&gt;<ref refid="structssh__channel__struct_1a6806319dfa8f417bbad93f6481ad99d4" kindref="member">stderr_buffer</ref>;</highlight></codeline>
<codeline lineno="583"><highlight class="normal"><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="584"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>buf<sp/>=<sp/>channel-&gt;<ref refid="structssh__channel__struct_1a8ae1473aafd716256ce762d0115b2321" kindref="member">stdout_buffer</ref>;</highlight></codeline>
<codeline lineno="585"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="586"><highlight class="normal"></highlight></codeline>
<codeline lineno="587"><highlight class="normal"><sp/><sp/><ref refid="group__libssh__callbacks_1gaaba68eea7a3cfbe8ea8038841861a412" kindref="member">ssh_callbacks_iterate</ref>(channel-&gt;<ref refid="structssh__channel__struct_1ad526c0401837d1636e3f9075226f7cd9" kindref="member">callbacks</ref>,</highlight></codeline>
<codeline lineno="588"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structssh__channel__callbacks__struct" kindref="compound">ssh_channel_callbacks</ref>,</highlight></codeline>
<codeline lineno="589"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>channel_data_function)<sp/>{</highlight></codeline>
<codeline lineno="590"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="libssh_8h_1a240b02fb7c0475fbb5996d1f759221ee" kindref="member">ssh_buffer_get</ref>(buf)<sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="591"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="592"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="593"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>rest<sp/>=<sp/><ref refid="group__libssh__callbacks_1ga805c03a07f2d9e1f1f6daaaf9aaccf07" kindref="member">ssh_callbacks_iterate_exec</ref>(channel_data_function,</highlight></codeline>
<codeline lineno="594"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>channel-&gt;<ref refid="structssh__channel__struct_1a0832dc830d09accd2f3a8f8349c3faf2" kindref="member">session</ref>,</highlight></codeline>
<codeline lineno="595"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>channel,</highlight></codeline>
<codeline lineno="596"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="libssh_8h_1a240b02fb7c0475fbb5996d1f759221ee" kindref="member">ssh_buffer_get</ref>(buf),</highlight></codeline>
<codeline lineno="597"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="libssh_8h_1a61400c7267feb254046cd606a3fdfdbc" kindref="member">ssh_buffer_get_len</ref>(buf),</highlight></codeline>
<codeline lineno="598"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>is_stderr);</highlight></codeline>
<codeline lineno="599"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(rest<sp/>&gt;<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="600"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(channel-&gt;<ref refid="structssh__channel__struct_1ab1beeacd4aff735258cb7488c079c6dc" kindref="member">counter</ref><sp/>!=<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="601"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>channel-&gt;<ref refid="structssh__channel__struct_1ab1beeacd4aff735258cb7488c079c6dc" kindref="member">counter</ref>-&gt;<ref refid="structssh__counter__struct_1a4fb86ab2536688750c960f58ac414c79" kindref="member">in_bytes</ref><sp/>+=<sp/>rest;</highlight></codeline>
<codeline lineno="602"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="603"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="buffer_8h_1a226d198c4274fac7c354b6a340049d47" kindref="member">ssh_buffer_pass_bytes</ref>(buf,<sp/>rest);</highlight></codeline>
<codeline lineno="604"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="605"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="606"><highlight class="normal"><sp/><sp/><ref refid="group__libssh__callbacks_1gab814c9f6d54a92a304577d67b8db726b" kindref="member">ssh_callbacks_iterate_end</ref>();</highlight></codeline>
<codeline lineno="607"><highlight class="normal"></highlight></codeline>
<codeline lineno="608"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(channel-&gt;<ref refid="structssh__channel__struct_1a7067e2963e961729416849785c1d1bd3" kindref="member">local_window</ref><sp/>+<sp/><ref refid="libssh_8h_1a61400c7267feb254046cd606a3fdfdbc" kindref="member">ssh_buffer_get_len</ref>(buf)<sp/>&lt;<sp/><ref refid="channels_8c_1aebda54a24a840f266fcc864e4940f749" kindref="member">WINDOWLIMIT</ref>)<sp/>{</highlight></codeline>
<codeline lineno="609"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="group__libssh__channel_1gac4fc789667578e8f0e2614f5274c9b5f" kindref="member">grow_window</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>,<sp/>channel,<sp/>0)<sp/>&lt;<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="610"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>-1;</highlight></codeline>
<codeline lineno="611"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="612"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="613"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="group__libssh__callbacks_1gac29df803aa1295d6a498c1b081f3b494" kindref="member">SSH_PACKET_USED</ref>;</highlight></codeline>
<codeline lineno="614"><highlight class="normal">}</highlight></codeline>
<codeline lineno="615"><highlight class="normal"></highlight></codeline>
<codeline lineno="616" refid="group__libssh__channel_1ga21f963dbe5ac591cc181244f00a6a396" refkind="member"><highlight class="normal"><ref refid="group__libssh__channel_1ga1f817e943f01e76843f60f9f9ca970f9" kindref="member">SSH_PACKET_CALLBACK</ref>(channel_rcv_eof)<sp/>{</highlight></codeline>
<codeline lineno="617"><highlight class="normal"><sp/><sp/><ref refid="structssh__channel__struct" kindref="compound">ssh_channel</ref><sp/>channel;</highlight></codeline>
<codeline lineno="618"><highlight class="normal"><sp/><sp/>(void)<ref refid="ssh__client_8c_1a14871705f45ccdc5bb9f4549efd8e119" kindref="member">user</ref>;</highlight></codeline>
<codeline lineno="619"><highlight class="normal"><sp/><sp/>(void)type;</highlight></codeline>
<codeline lineno="620"><highlight class="normal"></highlight></codeline>
<codeline lineno="621"><highlight class="normal"><sp/><sp/>channel<sp/>=<sp/><ref refid="group__libssh__channel_1ga41254c9dd24ac1ae9ad9c0edd3825dee" kindref="member">channel_from_msg</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>,packet);</highlight></codeline>
<codeline lineno="622"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(channel<sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="623"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="priv_8h_1aa21fd8a7a609329603b7b16da7939fca" kindref="member">SSH_LOG</ref>(<ref refid="group__libssh__log_1ggadf764cbdea00d65edcd07bb9953ad2b7a926c933f61d1afa64003c1cc66f6a01c" kindref="member">SSH_LOG_FUNCTIONS</ref>,<sp/></highlight><highlight class="stringliteral">&quot;%s&quot;</highlight><highlight class="normal">,<sp/><ref refid="group__libssh__error_1ga9241586665bf21f823806473fc386258" kindref="member">ssh_get_error</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>));</highlight></codeline>
<codeline lineno="624"><highlight class="normal"></highlight></codeline>
<codeline lineno="625"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="group__libssh__callbacks_1gac29df803aa1295d6a498c1b081f3b494" kindref="member">SSH_PACKET_USED</ref>;</highlight></codeline>
<codeline lineno="626"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="627"><highlight class="normal"></highlight></codeline>
<codeline lineno="628"><highlight class="normal"><sp/><sp/><ref refid="priv_8h_1aa21fd8a7a609329603b7b16da7939fca" kindref="member">SSH_LOG</ref>(<ref refid="group__libssh__log_1ggadf764cbdea00d65edcd07bb9953ad2b7a6445dfe21592d69d9741d319538b6673" kindref="member">SSH_LOG_PACKET</ref>,</highlight></codeline>
<codeline lineno="629"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Received<sp/>eof<sp/>on<sp/>channel<sp/>(%d:%d)&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="630"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>channel-&gt;<ref refid="structssh__channel__struct_1a39cdc105ee0bbd1b7faea169db30f0a1" kindref="member">local_channel</ref>,</highlight></codeline>
<codeline lineno="631"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>channel-&gt;<ref refid="structssh__channel__struct_1aa553acf6d12fffb1ae18b11196c2c0e9" kindref="member">remote_channel</ref>);</highlight></codeline>
<codeline lineno="632"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">/*<sp/>channel-&gt;remote_window<sp/>=<sp/>0;<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="633"><highlight class="normal"><sp/><sp/>channel-&gt;<ref refid="structssh__channel__struct_1a01fee161bb195c61e434e9bc7b330187" kindref="member">remote_eof</ref><sp/>=<sp/>1;</highlight></codeline>
<codeline lineno="634"><highlight class="normal"></highlight></codeline>
<codeline lineno="635"><highlight class="normal"><sp/><sp/><ref refid="group__libssh__callbacks_1ga4dc546e7406ce5642a2278aaad3b1e35" kindref="member">ssh_callbacks_execute_list</ref>(channel-&gt;<ref refid="structssh__channel__struct_1ad526c0401837d1636e3f9075226f7cd9" kindref="member">callbacks</ref>,</highlight></codeline>
<codeline lineno="636"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structssh__channel__callbacks__struct" kindref="compound">ssh_channel_callbacks</ref>,</highlight></codeline>
<codeline lineno="637"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>channel_eof_function,</highlight></codeline>
<codeline lineno="638"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>channel-&gt;<ref refid="structssh__channel__struct_1a0832dc830d09accd2f3a8f8349c3faf2" kindref="member">session</ref>,</highlight></codeline>
<codeline lineno="639"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>channel);</highlight></codeline>
<codeline lineno="640"><highlight class="normal"></highlight></codeline>
<codeline lineno="641"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="group__libssh__callbacks_1gac29df803aa1295d6a498c1b081f3b494" kindref="member">SSH_PACKET_USED</ref>;</highlight></codeline>
<codeline lineno="642"><highlight class="normal">}</highlight></codeline>
<codeline lineno="643"><highlight class="normal"></highlight></codeline>
<codeline lineno="644" refid="group__libssh__channel_1ga174d7f6268abeab5bc5d427d3ba0fc90" refkind="member"><highlight class="normal"><ref refid="group__libssh__channel_1ga1f817e943f01e76843f60f9f9ca970f9" kindref="member">SSH_PACKET_CALLBACK</ref>(channel_rcv_close)<sp/>{</highlight></codeline>
<codeline lineno="645"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="structssh__channel__struct" kindref="compound">ssh_channel</ref><sp/>channel;</highlight></codeline>
<codeline lineno="646"><highlight class="normal"><sp/><sp/><sp/><sp/>(void)<ref refid="ssh__client_8c_1a14871705f45ccdc5bb9f4549efd8e119" kindref="member">user</ref>;</highlight></codeline>
<codeline lineno="647"><highlight class="normal"><sp/><sp/><sp/><sp/>(void)type;</highlight></codeline>
<codeline lineno="648"><highlight class="normal"></highlight></codeline>
<codeline lineno="649"><highlight class="normal"><sp/><sp/><sp/><sp/>channel<sp/>=<sp/><ref refid="group__libssh__channel_1ga41254c9dd24ac1ae9ad9c0edd3825dee" kindref="member">channel_from_msg</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>,packet);</highlight></codeline>
<codeline lineno="650"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(channel<sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="651"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="priv_8h_1aa21fd8a7a609329603b7b16da7939fca" kindref="member">SSH_LOG</ref>(<ref refid="group__libssh__log_1ggadf764cbdea00d65edcd07bb9953ad2b7a926c933f61d1afa64003c1cc66f6a01c" kindref="member">SSH_LOG_FUNCTIONS</ref>,<sp/></highlight><highlight class="stringliteral">&quot;%s&quot;</highlight><highlight class="normal">,<sp/><ref refid="group__libssh__error_1ga9241586665bf21f823806473fc386258" kindref="member">ssh_get_error</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>));</highlight></codeline>
<codeline lineno="652"><highlight class="normal"></highlight></codeline>
<codeline lineno="653"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="group__libssh__callbacks_1gac29df803aa1295d6a498c1b081f3b494" kindref="member">SSH_PACKET_USED</ref>;</highlight></codeline>
<codeline lineno="654"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="655"><highlight class="normal"></highlight></codeline>
<codeline lineno="656"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="priv_8h_1aa21fd8a7a609329603b7b16da7939fca" kindref="member">SSH_LOG</ref>(<ref refid="group__libssh__log_1ggadf764cbdea00d65edcd07bb9953ad2b7a6445dfe21592d69d9741d319538b6673" kindref="member">SSH_LOG_PACKET</ref>,</highlight></codeline>
<codeline lineno="657"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Received<sp/>close<sp/>on<sp/>channel<sp/>(%d:%d)&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="658"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>channel-&gt;<ref refid="structssh__channel__struct_1a39cdc105ee0bbd1b7faea169db30f0a1" kindref="member">local_channel</ref>,</highlight></codeline>
<codeline lineno="659"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>channel-&gt;<ref refid="structssh__channel__struct_1aa553acf6d12fffb1ae18b11196c2c0e9" kindref="member">remote_channel</ref>);</highlight></codeline>
<codeline lineno="660"><highlight class="normal"></highlight></codeline>
<codeline lineno="661"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>((channel-&gt;<ref refid="structssh__channel__struct_1a8ae1473aafd716256ce762d0115b2321" kindref="member">stdout_buffer</ref><sp/>&amp;&amp;</highlight></codeline>
<codeline lineno="662"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="libssh_8h_1a61400c7267feb254046cd606a3fdfdbc" kindref="member">ssh_buffer_get_len</ref>(channel-&gt;<ref refid="structssh__channel__struct_1a8ae1473aafd716256ce762d0115b2321" kindref="member">stdout_buffer</ref>)<sp/>&gt;<sp/>0)<sp/>||</highlight></codeline>
<codeline lineno="663"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(channel-&gt;<ref refid="structssh__channel__struct_1a6806319dfa8f417bbad93f6481ad99d4" kindref="member">stderr_buffer</ref><sp/>&amp;&amp;</highlight></codeline>
<codeline lineno="664"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="libssh_8h_1a61400c7267feb254046cd606a3fdfdbc" kindref="member">ssh_buffer_get_len</ref>(channel-&gt;<ref refid="structssh__channel__struct_1a6806319dfa8f417bbad93f6481ad99d4" kindref="member">stderr_buffer</ref>)<sp/>&gt;<sp/>0))<sp/>{</highlight></codeline>
<codeline lineno="665"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>channel-&gt;<ref refid="structssh__channel__struct_1a23f4022c397cfd2cfc05a1358f8082f6" kindref="member">delayed_close</ref><sp/>=<sp/>1;</highlight></codeline>
<codeline lineno="666"><highlight class="normal"><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="667"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>channel-&gt;<ref refid="structssh__channel__struct_1a272b198e279fa672afeaf9f2e610eb04" kindref="member">state</ref><sp/>=<sp/><ref refid="channels_8h_1a5a002159e5db31d156bb2a8ce8a10cd1a96872cd3f6e98f6f040097e3ee6cb900" kindref="member">SSH_CHANNEL_STATE_CLOSED</ref>;</highlight></codeline>
<codeline lineno="668"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="669"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(channel-&gt;<ref refid="structssh__channel__struct_1a01fee161bb195c61e434e9bc7b330187" kindref="member">remote_eof</ref><sp/>==<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="670"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="priv_8h_1aa21fd8a7a609329603b7b16da7939fca" kindref="member">SSH_LOG</ref>(<ref refid="group__libssh__log_1ggadf764cbdea00d65edcd07bb9953ad2b7a6445dfe21592d69d9741d319538b6673" kindref="member">SSH_LOG_PACKET</ref>,</highlight></codeline>
<codeline lineno="671"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Remote<sp/>host<sp/>not<sp/>polite<sp/>enough<sp/>to<sp/>send<sp/>an<sp/>eof<sp/>before<sp/>close&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="672"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="673"><highlight class="normal"><sp/><sp/><sp/><sp/>channel-&gt;<ref refid="structssh__channel__struct_1a01fee161bb195c61e434e9bc7b330187" kindref="member">remote_eof</ref><sp/>=<sp/>1;</highlight></codeline>
<codeline lineno="674"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*</highlight></codeline>
<codeline lineno="675"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/>*<sp/>The<sp/>remote<sp/>eof<sp/>doesn&apos;t<sp/>break<sp/>things<sp/>if<sp/>there<sp/>was<sp/>still<sp/>data<sp/>into<sp/>read</highlight></codeline>
<codeline lineno="676"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/>*<sp/>buffer<sp/>because<sp/>the<sp/>eof<sp/>is<sp/>ignored<sp/>until<sp/>the<sp/>buffer<sp/>is<sp/>empty.</highlight></codeline>
<codeline lineno="677"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="678"><highlight class="normal"></highlight></codeline>
<codeline lineno="679"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="group__libssh__callbacks_1ga4dc546e7406ce5642a2278aaad3b1e35" kindref="member">ssh_callbacks_execute_list</ref>(channel-&gt;<ref refid="structssh__channel__struct_1ad526c0401837d1636e3f9075226f7cd9" kindref="member">callbacks</ref>,</highlight></codeline>
<codeline lineno="680"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structssh__channel__callbacks__struct" kindref="compound">ssh_channel_callbacks</ref>,</highlight></codeline>
<codeline lineno="681"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>channel_close_function,</highlight></codeline>
<codeline lineno="682"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>channel-&gt;<ref refid="structssh__channel__struct_1a0832dc830d09accd2f3a8f8349c3faf2" kindref="member">session</ref>,</highlight></codeline>
<codeline lineno="683"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>channel);</highlight></codeline>
<codeline lineno="684"><highlight class="normal"></highlight></codeline>
<codeline lineno="685"><highlight class="normal"><sp/><sp/><sp/><sp/>channel-&gt;<ref refid="structssh__channel__struct_1a400dc0c0dc7cd02daaea731825c1a7c4" kindref="member">flags</ref><sp/>|=<sp/><ref refid="channels_8h_1ade088105d65a071041027d9215213071" kindref="member">SSH_CHANNEL_FLAG_CLOSED_REMOTE</ref>;</highlight></codeline>
<codeline lineno="686"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(channel-&gt;<ref refid="structssh__channel__struct_1a400dc0c0dc7cd02daaea731825c1a7c4" kindref="member">flags</ref><sp/>&amp;<sp/><ref refid="channels_8h_1af83f3c2360379b70925e90d9c0a8f0dd" kindref="member">SSH_CHANNEL_FLAG_FREED_LOCAL</ref>)</highlight></codeline>
<codeline lineno="687"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="group__libssh__channel_1ga1e7211251562c5e1ec64647236caa745" kindref="member">ssh_channel_do_free</ref>(channel);</highlight></codeline>
<codeline lineno="688"><highlight class="normal"></highlight></codeline>
<codeline lineno="689"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="group__libssh__callbacks_1gac29df803aa1295d6a498c1b081f3b494" kindref="member">SSH_PACKET_USED</ref>;</highlight></codeline>
<codeline lineno="690"><highlight class="normal">}</highlight></codeline>
<codeline lineno="691"><highlight class="normal"></highlight></codeline>
<codeline lineno="692" refid="group__libssh__channel_1ga04a182f13550058a18b9ba97d8d63ded" refkind="member"><highlight class="normal"><ref refid="group__libssh__channel_1ga1f817e943f01e76843f60f9f9ca970f9" kindref="member">SSH_PACKET_CALLBACK</ref>(channel_rcv_request)<sp/>{</highlight></codeline>
<codeline lineno="693"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="structssh__channel__struct" kindref="compound">ssh_channel</ref><sp/>channel;</highlight></codeline>
<codeline lineno="694"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*request=NULL;</highlight></codeline>
<codeline lineno="695"><highlight class="normal"><sp/><sp/><sp/><sp/>uint8_t<sp/>status;</highlight></codeline>
<codeline lineno="696"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref>;</highlight></codeline>
<codeline lineno="697"><highlight class="normal"><sp/><sp/><sp/><sp/>(void)<ref refid="ssh__client_8c_1a14871705f45ccdc5bb9f4549efd8e119" kindref="member">user</ref>;</highlight></codeline>
<codeline lineno="698"><highlight class="normal"><sp/><sp/><sp/><sp/>(void)type;</highlight></codeline>
<codeline lineno="699"><highlight class="normal"></highlight></codeline>
<codeline lineno="700"><highlight class="normal"><sp/><sp/><sp/><sp/>channel<sp/>=<sp/><ref refid="group__libssh__channel_1ga41254c9dd24ac1ae9ad9c0edd3825dee" kindref="member">channel_from_msg</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>,packet);</highlight></codeline>
<codeline lineno="701"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(channel<sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="702"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="priv_8h_1aa21fd8a7a609329603b7b16da7939fca" kindref="member">SSH_LOG</ref>(<ref refid="group__libssh__log_1ggadf764cbdea00d65edcd07bb9953ad2b7a926c933f61d1afa64003c1cc66f6a01c" kindref="member">SSH_LOG_FUNCTIONS</ref>,</highlight><highlight class="stringliteral">&quot;%s&quot;</highlight><highlight class="normal">,<sp/><ref refid="group__libssh__error_1ga9241586665bf21f823806473fc386258" kindref="member">ssh_get_error</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>));</highlight></codeline>
<codeline lineno="703"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="group__libssh__callbacks_1gac29df803aa1295d6a498c1b081f3b494" kindref="member">SSH_PACKET_USED</ref>;</highlight></codeline>
<codeline lineno="704"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="705"><highlight class="normal"></highlight></codeline>
<codeline lineno="706"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="buffer_8h_1ab51014ef9a47e7cdbd235af3e62b81ee" kindref="member">ssh_buffer_unpack</ref>(packet,<sp/></highlight><highlight class="stringliteral">&quot;sb&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="707"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&amp;request,</highlight></codeline>
<codeline lineno="708"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&amp;status);</highlight></codeline>
<codeline lineno="709"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>!=<sp/><ref refid="libssh_8h_1ac1ee1d1e917456d4760a94a18015377d" kindref="member">SSH_OK</ref>)<sp/>{</highlight></codeline>
<codeline lineno="710"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="priv_8h_1aa21fd8a7a609329603b7b16da7939fca" kindref="member">SSH_LOG</ref>(<ref refid="group__libssh__log_1ggadf764cbdea00d65edcd07bb9953ad2b7a6445dfe21592d69d9741d319538b6673" kindref="member">SSH_LOG_PACKET</ref>,<sp/></highlight><highlight class="stringliteral">&quot;Invalid<sp/>MSG_CHANNEL_REQUEST&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="711"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="group__libssh__callbacks_1gac29df803aa1295d6a498c1b081f3b494" kindref="member">SSH_PACKET_USED</ref>;</highlight></codeline>
<codeline lineno="712"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="713"><highlight class="normal"></highlight></codeline>
<codeline lineno="714"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(strcmp(request,</highlight><highlight class="stringliteral">&quot;exit-status&quot;</highlight><highlight class="normal">)<sp/>==<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="715"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="sshd__direct-tcpip_8c_1aed3129b7674034c979192bcca6b0ad8c" kindref="member">SAFE_FREE</ref>(request);</highlight></codeline>
<codeline lineno="716"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="buffer_8h_1ab51014ef9a47e7cdbd235af3e62b81ee" kindref="member">ssh_buffer_unpack</ref>(packet,<sp/></highlight><highlight class="stringliteral">&quot;d&quot;</highlight><highlight class="normal">,<sp/>&amp;channel-&gt;<ref refid="structssh__channel__struct_1a3e9106e477bee737abed43d8c57a7bd6" kindref="member">exit_status</ref>);</highlight></codeline>
<codeline lineno="717"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>!=<sp/><ref refid="libssh_8h_1ac1ee1d1e917456d4760a94a18015377d" kindref="member">SSH_OK</ref>)<sp/>{</highlight></codeline>
<codeline lineno="718"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="priv_8h_1aa21fd8a7a609329603b7b16da7939fca" kindref="member">SSH_LOG</ref>(<ref refid="group__libssh__log_1ggadf764cbdea00d65edcd07bb9953ad2b7a6445dfe21592d69d9741d319538b6673" kindref="member">SSH_LOG_PACKET</ref>,<sp/></highlight><highlight class="stringliteral">&quot;Invalid<sp/>exit-status<sp/>packet&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="719"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="group__libssh__callbacks_1gac29df803aa1295d6a498c1b081f3b494" kindref="member">SSH_PACKET_USED</ref>;</highlight></codeline>
<codeline lineno="720"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="721"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="priv_8h_1aa21fd8a7a609329603b7b16da7939fca" kindref="member">SSH_LOG</ref>(<ref refid="group__libssh__log_1ggadf764cbdea00d65edcd07bb9953ad2b7a6445dfe21592d69d9741d319538b6673" kindref="member">SSH_LOG_PACKET</ref>,<sp/></highlight><highlight class="stringliteral">&quot;received<sp/>exit-status<sp/>%d&quot;</highlight><highlight class="normal">,<sp/>channel-&gt;<ref refid="structssh__channel__struct_1a3e9106e477bee737abed43d8c57a7bd6" kindref="member">exit_status</ref>);</highlight></codeline>
<codeline lineno="722"><highlight class="normal"></highlight></codeline>
<codeline lineno="723"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="group__libssh__callbacks_1ga4dc546e7406ce5642a2278aaad3b1e35" kindref="member">ssh_callbacks_execute_list</ref>(channel-&gt;<ref refid="structssh__channel__struct_1ad526c0401837d1636e3f9075226f7cd9" kindref="member">callbacks</ref>,</highlight></codeline>
<codeline lineno="724"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structssh__channel__callbacks__struct" kindref="compound">ssh_channel_callbacks</ref>,</highlight></codeline>
<codeline lineno="725"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>channel_exit_status_function,</highlight></codeline>
<codeline lineno="726"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>channel-&gt;<ref refid="structssh__channel__struct_1a0832dc830d09accd2f3a8f8349c3faf2" kindref="member">session</ref>,</highlight></codeline>
<codeline lineno="727"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>channel,</highlight></codeline>
<codeline lineno="728"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>channel-&gt;<ref refid="structssh__channel__struct_1a3e9106e477bee737abed43d8c57a7bd6" kindref="member">exit_status</ref>);</highlight></codeline>
<codeline lineno="729"><highlight class="normal"></highlight></codeline>
<codeline lineno="730"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="group__libssh__callbacks_1gac29df803aa1295d6a498c1b081f3b494" kindref="member">SSH_PACKET_USED</ref>;</highlight></codeline>
<codeline lineno="731"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="732"><highlight class="normal"></highlight></codeline>
<codeline lineno="733"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(strcmp(request,</highlight><highlight class="stringliteral">&quot;signal&quot;</highlight><highlight class="normal">)<sp/>==<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="734"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*sig<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="735"><highlight class="normal"></highlight></codeline>
<codeline lineno="736"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="sshd__direct-tcpip_8c_1aed3129b7674034c979192bcca6b0ad8c" kindref="member">SAFE_FREE</ref>(request);</highlight></codeline>
<codeline lineno="737"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="priv_8h_1aa21fd8a7a609329603b7b16da7939fca" kindref="member">SSH_LOG</ref>(<ref refid="group__libssh__log_1ggadf764cbdea00d65edcd07bb9953ad2b7a6445dfe21592d69d9741d319538b6673" kindref="member">SSH_LOG_PACKET</ref>,<sp/></highlight><highlight class="stringliteral">&quot;received<sp/>signal&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="738"><highlight class="normal"></highlight></codeline>
<codeline lineno="739"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="buffer_8h_1ab51014ef9a47e7cdbd235af3e62b81ee" kindref="member">ssh_buffer_unpack</ref>(packet,<sp/></highlight><highlight class="stringliteral">&quot;s&quot;</highlight><highlight class="normal">,<sp/>&amp;sig);</highlight></codeline>
<codeline lineno="740"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>!=<sp/><ref refid="libssh_8h_1ac1ee1d1e917456d4760a94a18015377d" kindref="member">SSH_OK</ref>)<sp/>{</highlight></codeline>
<codeline lineno="741"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="priv_8h_1aa21fd8a7a609329603b7b16da7939fca" kindref="member">SSH_LOG</ref>(<ref refid="group__libssh__log_1ggadf764cbdea00d65edcd07bb9953ad2b7a6445dfe21592d69d9741d319538b6673" kindref="member">SSH_LOG_PACKET</ref>,<sp/></highlight><highlight class="stringliteral">&quot;Invalid<sp/>MSG_CHANNEL_REQUEST&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="742"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="group__libssh__callbacks_1gac29df803aa1295d6a498c1b081f3b494" kindref="member">SSH_PACKET_USED</ref>;</highlight></codeline>
<codeline lineno="743"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="744"><highlight class="normal"></highlight></codeline>
<codeline lineno="745"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="priv_8h_1aa21fd8a7a609329603b7b16da7939fca" kindref="member">SSH_LOG</ref>(<ref refid="group__libssh__log_1ggadf764cbdea00d65edcd07bb9953ad2b7a6445dfe21592d69d9741d319538b6673" kindref="member">SSH_LOG_PACKET</ref>,</highlight></codeline>
<codeline lineno="746"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Remote<sp/>connection<sp/>sent<sp/>a<sp/>signal<sp/>SIG<sp/>%s&quot;</highlight><highlight class="normal">,<sp/>sig);</highlight></codeline>
<codeline lineno="747"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="group__libssh__callbacks_1ga4dc546e7406ce5642a2278aaad3b1e35" kindref="member">ssh_callbacks_execute_list</ref>(channel-&gt;<ref refid="structssh__channel__struct_1ad526c0401837d1636e3f9075226f7cd9" kindref="member">callbacks</ref>,</highlight></codeline>
<codeline lineno="748"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structssh__channel__callbacks__struct" kindref="compound">ssh_channel_callbacks</ref>,</highlight></codeline>
<codeline lineno="749"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>channel_signal_function,</highlight></codeline>
<codeline lineno="750"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>channel-&gt;<ref refid="structssh__channel__struct_1a0832dc830d09accd2f3a8f8349c3faf2" kindref="member">session</ref>,</highlight></codeline>
<codeline lineno="751"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>channel,</highlight></codeline>
<codeline lineno="752"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sig);</highlight></codeline>
<codeline lineno="753"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="sshd__direct-tcpip_8c_1aed3129b7674034c979192bcca6b0ad8c" kindref="member">SAFE_FREE</ref>(sig);</highlight></codeline>
<codeline lineno="754"><highlight class="normal"></highlight></codeline>
<codeline lineno="755"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="group__libssh__callbacks_1gac29df803aa1295d6a498c1b081f3b494" kindref="member">SSH_PACKET_USED</ref>;</highlight></codeline>
<codeline lineno="756"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="757"><highlight class="normal"></highlight></codeline>
<codeline lineno="758"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(strcmp(request,<sp/></highlight><highlight class="stringliteral">&quot;exit-signal&quot;</highlight><highlight class="normal">)<sp/>==<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="759"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*core<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;(core<sp/>dumped)&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="760"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*sig<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="761"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*errmsg<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="762"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*lang<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="763"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>uint8_t<sp/>core_dumped;</highlight></codeline>
<codeline lineno="764"><highlight class="normal"></highlight></codeline>
<codeline lineno="765"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="sshd__direct-tcpip_8c_1aed3129b7674034c979192bcca6b0ad8c" kindref="member">SAFE_FREE</ref>(request);</highlight></codeline>
<codeline lineno="766"><highlight class="normal"></highlight></codeline>
<codeline lineno="767"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="buffer_8h_1ab51014ef9a47e7cdbd235af3e62b81ee" kindref="member">ssh_buffer_unpack</ref>(packet,<sp/></highlight><highlight class="stringliteral">&quot;sbss&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="768"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&amp;sig,<sp/></highlight><highlight class="comment">/*<sp/>signal<sp/>name<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="769"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&amp;core_dumped,<sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>core<sp/>dumped<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="770"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&amp;errmsg,<sp/></highlight><highlight class="comment">/*<sp/>error<sp/>message<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="771"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&amp;lang);</highlight></codeline>
<codeline lineno="772"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>!=<sp/><ref refid="libssh_8h_1ac1ee1d1e917456d4760a94a18015377d" kindref="member">SSH_OK</ref>)<sp/>{</highlight></codeline>
<codeline lineno="773"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="priv_8h_1aa21fd8a7a609329603b7b16da7939fca" kindref="member">SSH_LOG</ref>(<ref refid="group__libssh__log_1ggadf764cbdea00d65edcd07bb9953ad2b7a6445dfe21592d69d9741d319538b6673" kindref="member">SSH_LOG_PACKET</ref>,<sp/></highlight><highlight class="stringliteral">&quot;Invalid<sp/>MSG_CHANNEL_REQUEST&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="774"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="group__libssh__callbacks_1gac29df803aa1295d6a498c1b081f3b494" kindref="member">SSH_PACKET_USED</ref>;</highlight></codeline>
<codeline lineno="775"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="776"><highlight class="normal"></highlight></codeline>
<codeline lineno="777"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(core_dumped<sp/>==<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="778"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>core<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="779"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="780"><highlight class="normal"></highlight></codeline>
<codeline lineno="781"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="priv_8h_1aa21fd8a7a609329603b7b16da7939fca" kindref="member">SSH_LOG</ref>(<ref refid="group__libssh__log_1ggadf764cbdea00d65edcd07bb9953ad2b7a6445dfe21592d69d9741d319538b6673" kindref="member">SSH_LOG_PACKET</ref>,</highlight></codeline>
<codeline lineno="782"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Remote<sp/>connection<sp/>closed<sp/>by<sp/>signal<sp/>SIG<sp/>%s<sp/>%s&quot;</highlight><highlight class="normal">,<sp/>sig,<sp/>core);</highlight></codeline>
<codeline lineno="783"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="group__libssh__callbacks_1ga4dc546e7406ce5642a2278aaad3b1e35" kindref="member">ssh_callbacks_execute_list</ref>(channel-&gt;<ref refid="structssh__channel__struct_1ad526c0401837d1636e3f9075226f7cd9" kindref="member">callbacks</ref>,</highlight></codeline>
<codeline lineno="784"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structssh__channel__callbacks__struct" kindref="compound">ssh_channel_callbacks</ref>,</highlight></codeline>
<codeline lineno="785"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>channel_exit_signal_function,</highlight></codeline>
<codeline lineno="786"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>channel-&gt;<ref refid="structssh__channel__struct_1a0832dc830d09accd2f3a8f8349c3faf2" kindref="member">session</ref>,</highlight></codeline>
<codeline lineno="787"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>channel,</highlight></codeline>
<codeline lineno="788"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sig,</highlight></codeline>
<codeline lineno="789"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>core_dumped,</highlight></codeline>
<codeline lineno="790"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>errmsg,</highlight></codeline>
<codeline lineno="791"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>lang);</highlight></codeline>
<codeline lineno="792"><highlight class="normal"></highlight></codeline>
<codeline lineno="793"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="sshd__direct-tcpip_8c_1aed3129b7674034c979192bcca6b0ad8c" kindref="member">SAFE_FREE</ref>(lang);</highlight></codeline>
<codeline lineno="794"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="sshd__direct-tcpip_8c_1aed3129b7674034c979192bcca6b0ad8c" kindref="member">SAFE_FREE</ref>(errmsg);</highlight></codeline>
<codeline lineno="795"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="sshd__direct-tcpip_8c_1aed3129b7674034c979192bcca6b0ad8c" kindref="member">SAFE_FREE</ref>(sig);</highlight></codeline>
<codeline lineno="796"><highlight class="normal"></highlight></codeline>
<codeline lineno="797"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="group__libssh__callbacks_1gac29df803aa1295d6a498c1b081f3b494" kindref="member">SSH_PACKET_USED</ref>;</highlight></codeline>
<codeline lineno="798"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="799"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(strcmp(request,</highlight><highlight class="stringliteral">&quot;keepalive@openssh.com&quot;</highlight><highlight class="normal">)==0){</highlight></codeline>
<codeline lineno="800"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="sshd__direct-tcpip_8c_1aed3129b7674034c979192bcca6b0ad8c" kindref="member">SAFE_FREE</ref>(request);</highlight></codeline>
<codeline lineno="801"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="priv_8h_1aa21fd8a7a609329603b7b16da7939fca" kindref="member">SSH_LOG</ref>(<ref refid="group__libssh__log_1ggadf764cbdea00d65edcd07bb9953ad2b7a75fa79e63947b66462db977d9b5ae27c" kindref="member">SSH_LOG_PROTOCOL</ref>,</highlight><highlight class="stringliteral">&quot;Responding<sp/>to<sp/>Openssh&apos;s<sp/>keepalive&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="802"><highlight class="normal"></highlight></codeline>
<codeline lineno="803"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="buffer_8h_1ae17848a86043f0abfc60c1c4f6126ccd" kindref="member">ssh_buffer_pack</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1af0aed60c1e529bbfdcb483fd80bf98a0" kindref="member">out_buffer</ref>,</highlight></codeline>
<codeline lineno="804"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;bd&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="805"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ssh2_8h_1a2b23fd7211615f33319a267d1728c785" kindref="member">SSH2_MSG_CHANNEL_FAILURE</ref>,</highlight></codeline>
<codeline lineno="806"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>channel-&gt;<ref refid="structssh__channel__struct_1aa553acf6d12fffb1ae18b11196c2c0e9" kindref="member">remote_channel</ref>);</highlight></codeline>
<codeline lineno="807"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>!=<sp/><ref refid="libssh_8h_1ac1ee1d1e917456d4760a94a18015377d" kindref="member">SSH_OK</ref>)<sp/>{</highlight></codeline>
<codeline lineno="808"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="group__libssh__callbacks_1gac29df803aa1295d6a498c1b081f3b494" kindref="member">SSH_PACKET_USED</ref>;</highlight></codeline>
<codeline lineno="809"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="810"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="packet_8h_1a7e6c7ed74c23ace432476aa8a6841140" kindref="member">ssh_packet_send</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>);</highlight></codeline>
<codeline lineno="811"><highlight class="normal"></highlight></codeline>
<codeline lineno="812"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="group__libssh__callbacks_1gac29df803aa1295d6a498c1b081f3b494" kindref="member">SSH_PACKET_USED</ref>;</highlight></codeline>
<codeline lineno="813"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="814"><highlight class="normal"></highlight></codeline>
<codeline lineno="815"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(strcmp(request,<sp/></highlight><highlight class="stringliteral">&quot;auth-agent-req@openssh.com&quot;</highlight><highlight class="normal">)<sp/>==<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="816"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="sshd__direct-tcpip_8c_1aed3129b7674034c979192bcca6b0ad8c" kindref="member">SAFE_FREE</ref>(request);</highlight></codeline>
<codeline lineno="817"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="priv_8h_1aa21fd8a7a609329603b7b16da7939fca" kindref="member">SSH_LOG</ref>(<ref refid="group__libssh__log_1ggadf764cbdea00d65edcd07bb9953ad2b7a75fa79e63947b66462db977d9b5ae27c" kindref="member">SSH_LOG_PROTOCOL</ref>,<sp/></highlight><highlight class="stringliteral">&quot;Received<sp/>an<sp/>auth-agent-req<sp/>request&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="818"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="group__libssh__callbacks_1ga4dc546e7406ce5642a2278aaad3b1e35" kindref="member">ssh_callbacks_execute_list</ref>(channel-&gt;<ref refid="structssh__channel__struct_1ad526c0401837d1636e3f9075226f7cd9" kindref="member">callbacks</ref>,</highlight></codeline>
<codeline lineno="819"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structssh__channel__callbacks__struct" kindref="compound">ssh_channel_callbacks</ref>,</highlight></codeline>
<codeline lineno="820"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>channel_auth_agent_req_function,</highlight></codeline>
<codeline lineno="821"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>channel-&gt;<ref refid="structssh__channel__struct_1a0832dc830d09accd2f3a8f8349c3faf2" kindref="member">session</ref>,</highlight></codeline>
<codeline lineno="822"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>channel);</highlight></codeline>
<codeline lineno="823"><highlight class="normal"></highlight></codeline>
<codeline lineno="824"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="group__libssh__callbacks_1gac29df803aa1295d6a498c1b081f3b494" kindref="member">SSH_PACKET_USED</ref>;</highlight></codeline>
<codeline lineno="825"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="826"><highlight class="normal"></highlight><highlight class="preprocessor">#ifdef<sp/>WITH_SERVER</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="827"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>If<sp/>we<sp/>are<sp/>here,<sp/>that<sp/>means<sp/>we<sp/>have<sp/>a<sp/>request<sp/>that<sp/>is<sp/>not<sp/>in<sp/>the<sp/>understood</highlight></codeline>
<codeline lineno="828"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/>*<sp/>client<sp/>requests.<sp/>That<sp/>means<sp/>we<sp/>need<sp/>to<sp/>create<sp/>a<sp/>ssh<sp/>message<sp/>to<sp/>be<sp/>passed</highlight></codeline>
<codeline lineno="829"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/>*<sp/>to<sp/>the<sp/>user<sp/>code<sp/>handling<sp/>ssh<sp/>messages</highlight></codeline>
<codeline lineno="830"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="831"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="group__libssh__messages_1gad4f7f7dc02ac8dd0f07492b104a0dd7e" kindref="member">ssh_message_handle_channel_request</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>,channel,packet,request,status);</highlight></codeline>
<codeline lineno="832"><highlight class="normal"></highlight><highlight class="preprocessor">#else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="833"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="priv_8h_1aa21fd8a7a609329603b7b16da7939fca" kindref="member">SSH_LOG</ref>(<ref refid="group__libssh__log_1ggadf764cbdea00d65edcd07bb9953ad2b7a12e6bbab0c5a667e259e2f9599a72550" kindref="member">SSH_LOG_WARNING</ref>,<sp/></highlight><highlight class="stringliteral">&quot;Unhandled<sp/>channel<sp/>request<sp/>%s&quot;</highlight><highlight class="normal">,<sp/>request);</highlight></codeline>
<codeline lineno="834"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="835"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="836"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="sshd__direct-tcpip_8c_1aed3129b7674034c979192bcca6b0ad8c" kindref="member">SAFE_FREE</ref>(request);</highlight></codeline>
<codeline lineno="837"><highlight class="normal"></highlight></codeline>
<codeline lineno="838"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="group__libssh__callbacks_1gac29df803aa1295d6a498c1b081f3b494" kindref="member">SSH_PACKET_USED</ref>;</highlight></codeline>
<codeline lineno="839"><highlight class="normal">}</highlight></codeline>
<codeline lineno="840"><highlight class="normal"></highlight></codeline>
<codeline lineno="841"><highlight class="normal"></highlight><highlight class="comment">/*</highlight></codeline>
<codeline lineno="842"><highlight class="comment"><sp/>*<sp/>When<sp/>data<sp/>has<sp/>been<sp/>received<sp/>from<sp/>the<sp/>ssh<sp/>server,<sp/>it<sp/>can<sp/>be<sp/>applied<sp/>to<sp/>the</highlight></codeline>
<codeline lineno="843"><highlight class="comment"><sp/>*<sp/>known<sp/>user<sp/>function,<sp/>with<sp/>help<sp/>of<sp/>the<sp/>callback,<sp/>or<sp/>inserted<sp/>here</highlight></codeline>
<codeline lineno="844"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="845"><highlight class="comment"><sp/>*<sp/>FIXME<sp/>is<sp/>the<sp/>window<sp/>changed?</highlight></codeline>
<codeline lineno="846"><highlight class="comment"><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="847" refid="group__libssh__channel_1ga3f6b844e236802c6780e7bcf0c0f3fce" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="group__libssh__channel_1ga3f6b844e236802c6780e7bcf0c0f3fce" kindref="member">channel_default_bufferize</ref>(<ref refid="structssh__channel__struct" kindref="compound">ssh_channel</ref><sp/>channel,</highlight></codeline>
<codeline lineno="848"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>*<ref refid="structssh__iterator_1a4cc4eb8c8599a487e7e3321d32a9e9cd" kindref="member">data</ref>,<sp/></highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/>len,</highlight></codeline>
<codeline lineno="849"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>is_stderr)</highlight></codeline>
<codeline lineno="850"><highlight class="normal">{</highlight></codeline>
<codeline lineno="851"><highlight class="normal"><sp/><sp/><ref refid="structssh__session__struct" kindref="compound">ssh_session</ref><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>;</highlight></codeline>
<codeline lineno="852"><highlight class="normal"></highlight></codeline>
<codeline lineno="853"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(channel<sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="854"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>-1;</highlight></codeline>
<codeline lineno="855"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="856"><highlight class="normal"></highlight></codeline>
<codeline lineno="857"><highlight class="normal"><sp/><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref><sp/>=<sp/>channel-&gt;<ref refid="structssh__channel__struct_1a0832dc830d09accd2f3a8f8349c3faf2" kindref="member">session</ref>;</highlight></codeline>
<codeline lineno="858"><highlight class="normal"></highlight></codeline>
<codeline lineno="859"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<ref refid="structssh__iterator_1a4cc4eb8c8599a487e7e3321d32a9e9cd" kindref="member">data</ref><sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="860"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="priv_8h_1a351ea86857d33b3ba80b396e05c4517c" kindref="member">ssh_set_error_invalid</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>);</highlight></codeline>
<codeline lineno="861"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>-1;</highlight></codeline>
<codeline lineno="862"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="863"><highlight class="normal"></highlight></codeline>
<codeline lineno="864"><highlight class="normal"><sp/><sp/><ref refid="priv_8h_1aa21fd8a7a609329603b7b16da7939fca" kindref="member">SSH_LOG</ref>(<ref refid="group__libssh__log_1ggadf764cbdea00d65edcd07bb9953ad2b7a6445dfe21592d69d9741d319538b6673" kindref="member">SSH_LOG_PACKET</ref>,</highlight></codeline>
<codeline lineno="865"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;placing<sp/>%zu<sp/>bytes<sp/>into<sp/>channel<sp/>buffer<sp/>(%s)&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="866"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>len,</highlight></codeline>
<codeline lineno="867"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>is_stderr<sp/>?<sp/></highlight><highlight class="stringliteral">&quot;stderr&quot;</highlight><highlight class="normal"><sp/>:<sp/></highlight><highlight class="stringliteral">&quot;stdout&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="868"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!is_stderr)<sp/>{</highlight></codeline>
<codeline lineno="869"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>stdout<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="870"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(channel-&gt;<ref refid="structssh__channel__struct_1a8ae1473aafd716256ce762d0115b2321" kindref="member">stdout_buffer</ref><sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="871"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>channel-&gt;<ref refid="structssh__channel__struct_1a8ae1473aafd716256ce762d0115b2321" kindref="member">stdout_buffer</ref><sp/>=<sp/><ref refid="group__libssh__buffer_1ga7ecc914104a5bf0da485d3e42f6a7d3b" kindref="member">ssh_buffer_new</ref>();</highlight></codeline>
<codeline lineno="872"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(channel-&gt;<ref refid="structssh__channel__struct_1a8ae1473aafd716256ce762d0115b2321" kindref="member">stdout_buffer</ref><sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="873"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="priv_8h_1ae280c413c792e04237f000841ac8ce44" kindref="member">ssh_set_error_oom</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>);</highlight></codeline>
<codeline lineno="874"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>-1;</highlight></codeline>
<codeline lineno="875"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="876"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="877"><highlight class="normal"></highlight></codeline>
<codeline lineno="878"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="libssh_8h_1a92d37237bf129961367accd4a9e0dcfc" kindref="member">ssh_buffer_add_data</ref>(channel-&gt;<ref refid="structssh__channel__struct_1a8ae1473aafd716256ce762d0115b2321" kindref="member">stdout_buffer</ref>,<sp/><ref refid="structssh__iterator_1a4cc4eb8c8599a487e7e3321d32a9e9cd" kindref="member">data</ref>,<sp/>len)<sp/>&lt;<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="879"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="priv_8h_1ae280c413c792e04237f000841ac8ce44" kindref="member">ssh_set_error_oom</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>);</highlight></codeline>
<codeline lineno="880"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="libssh_8h_1a8b09f7d6f7066de7ef8dab4ed7494a52" kindref="member">SSH_BUFFER_FREE</ref>(channel-&gt;<ref refid="structssh__channel__struct_1a8ae1473aafd716256ce762d0115b2321" kindref="member">stdout_buffer</ref>);</highlight></codeline>
<codeline lineno="881"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>channel-&gt;<ref refid="structssh__channel__struct_1a8ae1473aafd716256ce762d0115b2321" kindref="member">stdout_buffer</ref><sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="882"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>-1;</highlight></codeline>
<codeline lineno="883"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="884"><highlight class="normal"><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="885"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>stderr<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="886"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(channel-&gt;<ref refid="structssh__channel__struct_1a6806319dfa8f417bbad93f6481ad99d4" kindref="member">stderr_buffer</ref><sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="887"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>channel-&gt;<ref refid="structssh__channel__struct_1a6806319dfa8f417bbad93f6481ad99d4" kindref="member">stderr_buffer</ref><sp/>=<sp/><ref refid="group__libssh__buffer_1ga7ecc914104a5bf0da485d3e42f6a7d3b" kindref="member">ssh_buffer_new</ref>();</highlight></codeline>
<codeline lineno="888"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(channel-&gt;<ref refid="structssh__channel__struct_1a6806319dfa8f417bbad93f6481ad99d4" kindref="member">stderr_buffer</ref><sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="889"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="priv_8h_1ae280c413c792e04237f000841ac8ce44" kindref="member">ssh_set_error_oom</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>);</highlight></codeline>
<codeline lineno="890"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>-1;</highlight></codeline>
<codeline lineno="891"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="892"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="893"><highlight class="normal"></highlight></codeline>
<codeline lineno="894"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="libssh_8h_1a92d37237bf129961367accd4a9e0dcfc" kindref="member">ssh_buffer_add_data</ref>(channel-&gt;<ref refid="structssh__channel__struct_1a6806319dfa8f417bbad93f6481ad99d4" kindref="member">stderr_buffer</ref>,<sp/><ref refid="structssh__iterator_1a4cc4eb8c8599a487e7e3321d32a9e9cd" kindref="member">data</ref>,<sp/>len)<sp/>&lt;<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="895"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="priv_8h_1ae280c413c792e04237f000841ac8ce44" kindref="member">ssh_set_error_oom</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>);</highlight></codeline>
<codeline lineno="896"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="libssh_8h_1a8b09f7d6f7066de7ef8dab4ed7494a52" kindref="member">SSH_BUFFER_FREE</ref>(channel-&gt;<ref refid="structssh__channel__struct_1a6806319dfa8f417bbad93f6481ad99d4" kindref="member">stderr_buffer</ref>);</highlight></codeline>
<codeline lineno="897"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>channel-&gt;<ref refid="structssh__channel__struct_1a6806319dfa8f417bbad93f6481ad99d4" kindref="member">stderr_buffer</ref><sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="898"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>-1;</highlight></codeline>
<codeline lineno="899"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="900"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="901"><highlight class="normal"></highlight></codeline>
<codeline lineno="902"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>0;</highlight></codeline>
<codeline lineno="903"><highlight class="normal">}</highlight></codeline>
<codeline lineno="904"><highlight class="normal"></highlight></codeline>
<codeline lineno="920" refid="group__libssh__channel_1gaf051dd30d75bf6dc45d1a5088cf970bd" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="group__libssh__channel_1gaf051dd30d75bf6dc45d1a5088cf970bd" kindref="member">ssh_channel_open_session</ref>(<ref refid="structssh__channel__struct" kindref="compound">ssh_channel</ref><sp/>channel)<sp/>{</highlight></codeline>
<codeline lineno="921"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(channel<sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="922"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" kindref="member">SSH_ERROR</ref>;</highlight></codeline>
<codeline lineno="923"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="924"><highlight class="normal"></highlight></codeline>
<codeline lineno="925"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="group__libssh__channel_1gaa3d6d7d4ab8191f8b8eb14464b0f0e1e" kindref="member">channel_open</ref>(channel,</highlight></codeline>
<codeline lineno="926"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;session&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="927"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="channels_8c_1a6d5398350fc6c52561ed2674154161dc" kindref="member">CHANNEL_INITIAL_WINDOW</ref>,</highlight></codeline>
<codeline lineno="928"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="channels_8c_1a2ab57c8b0eeaa7b8ef3733493a00bf55" kindref="member">CHANNEL_MAX_PACKET</ref>,</highlight></codeline>
<codeline lineno="929"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>NULL);</highlight></codeline>
<codeline lineno="930"><highlight class="normal">}</highlight></codeline>
<codeline lineno="931"><highlight class="normal"></highlight></codeline>
<codeline lineno="947" refid="group__libssh__channel_1ga6c4d4f5436dd5be58973606c6bcd8bb4" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="group__libssh__channel_1ga6c4d4f5436dd5be58973606c6bcd8bb4" kindref="member">ssh_channel_open_auth_agent</ref>(<ref refid="structssh__channel__struct" kindref="compound">ssh_channel</ref><sp/>channel){</highlight></codeline>
<codeline lineno="948"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(channel<sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="949"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" kindref="member">SSH_ERROR</ref>;</highlight></codeline>
<codeline lineno="950"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="951"><highlight class="normal"></highlight></codeline>
<codeline lineno="952"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="group__libssh__channel_1gaa3d6d7d4ab8191f8b8eb14464b0f0e1e" kindref="member">channel_open</ref>(channel,</highlight></codeline>
<codeline lineno="953"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;auth-agent@openssh.com&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="954"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="channels_8c_1a6d5398350fc6c52561ed2674154161dc" kindref="member">CHANNEL_INITIAL_WINDOW</ref>,</highlight></codeline>
<codeline lineno="955"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="channels_8c_1a2ab57c8b0eeaa7b8ef3733493a00bf55" kindref="member">CHANNEL_MAX_PACKET</ref>,</highlight></codeline>
<codeline lineno="956"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>NULL);</highlight></codeline>
<codeline lineno="957"><highlight class="normal">}</highlight></codeline>
<codeline lineno="958"><highlight class="normal"></highlight></codeline>
<codeline lineno="959"><highlight class="normal"></highlight></codeline>
<codeline lineno="985" refid="group__libssh__channel_1gae86b0704a1f2bdebb268b55567f7f47b" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="group__libssh__channel_1gae86b0704a1f2bdebb268b55567f7f47b" kindref="member">ssh_channel_open_forward</ref>(<ref refid="structssh__channel__struct" kindref="compound">ssh_channel</ref><sp/>channel,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*remotehost,</highlight></codeline>
<codeline lineno="986"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>remoteport,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*sourcehost,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>localport)<sp/>{</highlight></codeline>
<codeline lineno="987"><highlight class="normal"><sp/><sp/><ref refid="structssh__session__struct" kindref="compound">ssh_session</ref><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>;</highlight></codeline>
<codeline lineno="988"><highlight class="normal"><sp/><sp/><ref refid="structssh__buffer__struct" kindref="compound">ssh_buffer</ref><sp/>payload<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="989"><highlight class="normal"><sp/><sp/><ref refid="structssh__string__struct" kindref="compound">ssh_string</ref><sp/>str<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="990"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" kindref="member">SSH_ERROR</ref>;</highlight></codeline>
<codeline lineno="991"><highlight class="normal"></highlight></codeline>
<codeline lineno="992"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(channel<sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="993"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref>;</highlight></codeline>
<codeline lineno="994"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="995"><highlight class="normal"></highlight></codeline>
<codeline lineno="996"><highlight class="normal"><sp/><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref><sp/>=<sp/>channel-&gt;<ref refid="structssh__channel__struct_1a0832dc830d09accd2f3a8f8349c3faf2" kindref="member">session</ref>;</highlight></codeline>
<codeline lineno="997"><highlight class="normal"></highlight></codeline>
<codeline lineno="998"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(remotehost<sp/>==<sp/>NULL<sp/>||<sp/>sourcehost<sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="999"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="priv_8h_1a351ea86857d33b3ba80b396e05c4517c" kindref="member">ssh_set_error_invalid</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>);</highlight></codeline>
<codeline lineno="1000"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref>;</highlight></codeline>
<codeline lineno="1001"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="1002"><highlight class="normal"></highlight></codeline>
<codeline lineno="1003"><highlight class="normal"><sp/><sp/>payload<sp/>=<sp/><ref refid="group__libssh__buffer_1ga7ecc914104a5bf0da485d3e42f6a7d3b" kindref="member">ssh_buffer_new</ref>();</highlight></codeline>
<codeline lineno="1004"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(payload<sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="1005"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="priv_8h_1ae280c413c792e04237f000841ac8ce44" kindref="member">ssh_set_error_oom</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>);</highlight></codeline>
<codeline lineno="1006"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">goto</highlight><highlight class="normal"><sp/><ref refid="proxy_8c_1a11614f44ef4d939bdd984953346a7572" kindref="member">error</ref>;</highlight></codeline>
<codeline lineno="1007"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="1008"><highlight class="normal"></highlight></codeline>
<codeline lineno="1009"><highlight class="normal"><sp/><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="buffer_8h_1ae17848a86043f0abfc60c1c4f6126ccd" kindref="member">ssh_buffer_pack</ref>(payload,</highlight></codeline>
<codeline lineno="1010"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;sdsd&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="1011"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>remotehost,</highlight></codeline>
<codeline lineno="1012"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>remoteport,</highlight></codeline>
<codeline lineno="1013"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sourcehost,</highlight></codeline>
<codeline lineno="1014"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>localport);</highlight></codeline>
<codeline lineno="1015"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>!=<sp/><ref refid="libssh_8h_1ac1ee1d1e917456d4760a94a18015377d" kindref="member">SSH_OK</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1016"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="priv_8h_1ae280c413c792e04237f000841ac8ce44" kindref="member">ssh_set_error_oom</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>);</highlight></codeline>
<codeline lineno="1017"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">goto</highlight><highlight class="normal"><sp/><ref refid="proxy_8c_1a11614f44ef4d939bdd984953346a7572" kindref="member">error</ref>;</highlight></codeline>
<codeline lineno="1018"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="1019"><highlight class="normal"></highlight></codeline>
<codeline lineno="1020"><highlight class="normal"><sp/><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="group__libssh__channel_1gaa3d6d7d4ab8191f8b8eb14464b0f0e1e" kindref="member">channel_open</ref>(channel,</highlight></codeline>
<codeline lineno="1021"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;direct-tcpip&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="1022"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="channels_8c_1a6d5398350fc6c52561ed2674154161dc" kindref="member">CHANNEL_INITIAL_WINDOW</ref>,</highlight></codeline>
<codeline lineno="1023"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="channels_8c_1a2ab57c8b0eeaa7b8ef3733493a00bf55" kindref="member">CHANNEL_MAX_PACKET</ref>,</highlight></codeline>
<codeline lineno="1024"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>payload);</highlight></codeline>
<codeline lineno="1025"><highlight class="normal"></highlight></codeline>
<codeline lineno="1026"><highlight class="normal"><ref refid="proxy_8c_1a11614f44ef4d939bdd984953346a7572" kindref="member">error</ref>:</highlight></codeline>
<codeline lineno="1027"><highlight class="normal"><sp/><sp/><ref refid="libssh_8h_1a8b09f7d6f7066de7ef8dab4ed7494a52" kindref="member">SSH_BUFFER_FREE</ref>(payload);</highlight></codeline>
<codeline lineno="1028"><highlight class="normal"><sp/><sp/><ref refid="libssh_8h_1a5bc8710c8633117ff449d15489fca051" kindref="member">SSH_STRING_FREE</ref>(str);</highlight></codeline>
<codeline lineno="1029"><highlight class="normal"></highlight></codeline>
<codeline lineno="1030"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref>;</highlight></codeline>
<codeline lineno="1031"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1032"><highlight class="normal"></highlight></codeline>
<codeline lineno="1057" refid="group__libssh__channel_1ga93ddd5055eb3322d38c70986aa63c673" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="group__libssh__channel_1ga93ddd5055eb3322d38c70986aa63c673" kindref="member">ssh_channel_open_forward_unix</ref>(<ref refid="structssh__channel__struct" kindref="compound">ssh_channel</ref><sp/>channel,</highlight></codeline>
<codeline lineno="1058"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*remotepath,</highlight></codeline>
<codeline lineno="1059"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*sourcehost,</highlight></codeline>
<codeline lineno="1060"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>localport)</highlight></codeline>
<codeline lineno="1061"><highlight class="normal">{</highlight></codeline>
<codeline lineno="1062"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="structssh__session__struct" kindref="compound">ssh_session</ref><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref><sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="1063"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="structssh__buffer__struct" kindref="compound">ssh_buffer</ref><sp/>payload<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="1064"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="structssh__string__struct" kindref="compound">ssh_string</ref><sp/>str<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="1065"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" kindref="member">SSH_ERROR</ref>;</highlight></codeline>
<codeline lineno="1066"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>version;</highlight></codeline>
<codeline lineno="1067"><highlight class="normal"></highlight></codeline>
<codeline lineno="1068"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(channel<sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="1069"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref>;</highlight></codeline>
<codeline lineno="1070"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1071"><highlight class="normal"></highlight></codeline>
<codeline lineno="1072"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref><sp/>=<sp/>channel-&gt;<ref refid="structssh__channel__struct_1a0832dc830d09accd2f3a8f8349c3faf2" kindref="member">session</ref>;</highlight></codeline>
<codeline lineno="1073"><highlight class="normal"></highlight></codeline>
<codeline lineno="1074"><highlight class="normal"><sp/><sp/><sp/><sp/>version<sp/>=<sp/><ref refid="group__libssh__session_1gac55d2895467a1e898ee75b4710d836a5" kindref="member">ssh_get_openssh_version</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>);</highlight></codeline>
<codeline lineno="1075"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(version<sp/>==<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="1076"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="priv_8h_1a55177b3e8db90ca9adb435c44281963c" kindref="member">ssh_set_error</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>,</highlight></codeline>
<codeline lineno="1077"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="libssh_8h_1a036b2b00fb04337a4d06d719d1b62be1ad1339fb4b92a9d25bdb99df5de5c4f88" kindref="member">SSH_REQUEST_DENIED</ref>,</highlight></codeline>
<codeline lineno="1078"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;We&apos;re<sp/>not<sp/>connected<sp/>to<sp/>an<sp/>OpenSSH<sp/>server!&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="1079"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" kindref="member">SSH_ERROR</ref>;</highlight></codeline>
<codeline lineno="1080"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1081"><highlight class="normal"></highlight></codeline>
<codeline lineno="1082"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(remotepath<sp/>==<sp/>NULL<sp/>||<sp/>sourcehost<sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="1083"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="priv_8h_1a351ea86857d33b3ba80b396e05c4517c" kindref="member">ssh_set_error_invalid</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>);</highlight></codeline>
<codeline lineno="1084"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref>;</highlight></codeline>
<codeline lineno="1085"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1086"><highlight class="normal"></highlight></codeline>
<codeline lineno="1087"><highlight class="normal"><sp/><sp/><sp/><sp/>payload<sp/>=<sp/><ref refid="group__libssh__buffer_1ga7ecc914104a5bf0da485d3e42f6a7d3b" kindref="member">ssh_buffer_new</ref>();</highlight></codeline>
<codeline lineno="1088"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(payload<sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="1089"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="priv_8h_1ae280c413c792e04237f000841ac8ce44" kindref="member">ssh_set_error_oom</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>);</highlight></codeline>
<codeline lineno="1090"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">goto</highlight><highlight class="normal"><sp/><ref refid="proxy_8c_1a11614f44ef4d939bdd984953346a7572" kindref="member">error</ref>;</highlight></codeline>
<codeline lineno="1091"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1092"><highlight class="normal"></highlight></codeline>
<codeline lineno="1093"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="buffer_8h_1ae17848a86043f0abfc60c1c4f6126ccd" kindref="member">ssh_buffer_pack</ref>(payload,</highlight></codeline>
<codeline lineno="1094"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;ssd&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="1095"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>remotepath,</highlight></codeline>
<codeline lineno="1096"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sourcehost,</highlight></codeline>
<codeline lineno="1097"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>localport);</highlight></codeline>
<codeline lineno="1098"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>!=<sp/><ref refid="libssh_8h_1ac1ee1d1e917456d4760a94a18015377d" kindref="member">SSH_OK</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1099"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="priv_8h_1ae280c413c792e04237f000841ac8ce44" kindref="member">ssh_set_error_oom</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>);</highlight></codeline>
<codeline lineno="1100"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">goto</highlight><highlight class="normal"><sp/><ref refid="proxy_8c_1a11614f44ef4d939bdd984953346a7572" kindref="member">error</ref>;</highlight></codeline>
<codeline lineno="1101"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1102"><highlight class="normal"></highlight></codeline>
<codeline lineno="1103"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="group__libssh__channel_1gaa3d6d7d4ab8191f8b8eb14464b0f0e1e" kindref="member">channel_open</ref>(channel,</highlight></codeline>
<codeline lineno="1104"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;direct-streamlocal@openssh.com&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="1105"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="channels_8c_1a6d5398350fc6c52561ed2674154161dc" kindref="member">CHANNEL_INITIAL_WINDOW</ref>,</highlight></codeline>
<codeline lineno="1106"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="channels_8c_1a2ab57c8b0eeaa7b8ef3733493a00bf55" kindref="member">CHANNEL_MAX_PACKET</ref>,</highlight></codeline>
<codeline lineno="1107"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>payload);</highlight></codeline>
<codeline lineno="1108"><highlight class="normal"></highlight></codeline>
<codeline lineno="1109"><highlight class="normal"><ref refid="proxy_8c_1a11614f44ef4d939bdd984953346a7572" kindref="member">error</ref>:</highlight></codeline>
<codeline lineno="1110"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="libssh_8h_1a8b09f7d6f7066de7ef8dab4ed7494a52" kindref="member">SSH_BUFFER_FREE</ref>(payload);</highlight></codeline>
<codeline lineno="1111"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="libssh_8h_1a5bc8710c8633117ff449d15489fca051" kindref="member">SSH_STRING_FREE</ref>(str);</highlight></codeline>
<codeline lineno="1112"><highlight class="normal"></highlight></codeline>
<codeline lineno="1113"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref>;</highlight></codeline>
<codeline lineno="1114"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1115"><highlight class="normal"></highlight></codeline>
<codeline lineno="1123" refid="group__libssh__channel_1gad1417f9eae8928fed20faafe2d9dbfff" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="group__libssh__channel_1gad1417f9eae8928fed20faafe2d9dbfff" kindref="member">ssh_channel_free</ref>(<ref refid="structssh__channel__struct" kindref="compound">ssh_channel</ref><sp/>channel)</highlight></codeline>
<codeline lineno="1124"><highlight class="normal">{</highlight></codeline>
<codeline lineno="1125"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="structssh__session__struct" kindref="compound">ssh_session</ref><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>;</highlight></codeline>
<codeline lineno="1126"><highlight class="normal"></highlight></codeline>
<codeline lineno="1127"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(channel<sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="1128"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1129"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1130"><highlight class="normal"></highlight></codeline>
<codeline lineno="1131"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref><sp/>=<sp/>channel-&gt;<ref refid="structssh__channel__struct_1a0832dc830d09accd2f3a8f8349c3faf2" kindref="member">session</ref>;</highlight></codeline>
<codeline lineno="1132"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a729d3c7f6ae20cb5a00ac7cd28a630f7" kindref="member">alive</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1133"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>send_close<sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1134"><highlight class="normal"></highlight></codeline>
<codeline lineno="1135"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">switch</highlight><highlight class="normal"><sp/>(channel-&gt;<ref refid="structssh__channel__struct_1a272b198e279fa672afeaf9f2e610eb04" kindref="member">state</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1136"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="channels_8h_1a5a002159e5db31d156bb2a8ce8a10cd1a488a78707192c35250392423b5058e2b" kindref="member">SSH_CHANNEL_STATE_OPEN</ref>:</highlight></codeline>
<codeline lineno="1137"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>send_close<sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1138"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1139"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="channels_8h_1a5a002159e5db31d156bb2a8ce8a10cd1a96872cd3f6e98f6f040097e3ee6cb900" kindref="member">SSH_CHANNEL_STATE_CLOSED</ref>:</highlight></codeline>
<codeline lineno="1140"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(channel-&gt;<ref refid="structssh__channel__struct_1a400dc0c0dc7cd02daaea731825c1a7c4" kindref="member">flags</ref><sp/>&amp;<sp/><ref refid="channels_8h_1ade088105d65a071041027d9215213071" kindref="member">SSH_CHANNEL_FLAG_CLOSED_REMOTE</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1141"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>send_close<sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1142"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1143"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(channel-&gt;<ref refid="structssh__channel__struct_1a400dc0c0dc7cd02daaea731825c1a7c4" kindref="member">flags</ref><sp/>&amp;<sp/><ref refid="channels_8h_1ad2f890619dac7055258ce90e9944b65f" kindref="member">SSH_CHANNEL_FLAG_CLOSED_LOCAL</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1144"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>send_close<sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1145"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1146"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1147"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">default</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="1148"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>send_close<sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1149"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1150"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1151"><highlight class="normal"></highlight></codeline>
<codeline lineno="1152"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(send_close)<sp/>{</highlight></codeline>
<codeline lineno="1153"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="group__libssh__channel_1ga238f07e0455456a5bfd8a49ead917732" kindref="member">ssh_channel_close</ref>(channel);</highlight></codeline>
<codeline lineno="1154"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1155"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1156"><highlight class="normal"><sp/><sp/><sp/><sp/>channel-&gt;<ref refid="structssh__channel__struct_1a400dc0c0dc7cd02daaea731825c1a7c4" kindref="member">flags</ref><sp/>|=<sp/><ref refid="channels_8h_1af83f3c2360379b70925e90d9c0a8f0dd" kindref="member">SSH_CHANNEL_FLAG_FREED_LOCAL</ref>;</highlight></codeline>
<codeline lineno="1157"><highlight class="normal"></highlight></codeline>
<codeline lineno="1158"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>The<sp/>idea<sp/>behind<sp/>the<sp/>flags<sp/>is<sp/>the<sp/>following<sp/>:<sp/>it<sp/>is<sp/>well<sp/>possible</highlight></codeline>
<codeline lineno="1159"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/>*<sp/>that<sp/>a<sp/>client<sp/>closes<sp/>a<sp/>channel<sp/>that<sp/>stills<sp/>exists<sp/>on<sp/>the<sp/>server<sp/>side.</highlight></codeline>
<codeline lineno="1160"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/>*<sp/>We<sp/>definitively<sp/>close<sp/>the<sp/>channel<sp/>when<sp/>we<sp/>receive<sp/>a<sp/>close<sp/>message<sp/>*and*</highlight></codeline>
<codeline lineno="1161"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/>*<sp/>the<sp/>user<sp/>closed<sp/>it.</highlight></codeline>
<codeline lineno="1162"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1163"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>((channel-&gt;<ref refid="structssh__channel__struct_1a400dc0c0dc7cd02daaea731825c1a7c4" kindref="member">flags</ref><sp/>&amp;<sp/><ref refid="channels_8h_1ade088105d65a071041027d9215213071" kindref="member">SSH_CHANNEL_FLAG_CLOSED_REMOTE</ref>)<sp/>||</highlight></codeline>
<codeline lineno="1164"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(channel-&gt;<ref refid="structssh__channel__struct_1a400dc0c0dc7cd02daaea731825c1a7c4" kindref="member">flags</ref><sp/>&amp;<sp/><ref refid="channels_8h_1a040c2d863bb3de2036d3b2fcde37450c" kindref="member">SSH_CHANNEL_FLAG_NOT_BOUND</ref>))<sp/>{</highlight></codeline>
<codeline lineno="1165"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="group__libssh__channel_1ga1e7211251562c5e1ec64647236caa745" kindref="member">ssh_channel_do_free</ref>(channel);</highlight></codeline>
<codeline lineno="1166"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1167"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1168"><highlight class="normal"></highlight></codeline>
<codeline lineno="1174" refid="group__libssh__channel_1ga1e7211251562c5e1ec64647236caa745" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="group__libssh__channel_1ga1e7211251562c5e1ec64647236caa745" kindref="member">ssh_channel_do_free</ref>(<ref refid="structssh__channel__struct" kindref="compound">ssh_channel</ref><sp/>channel)</highlight></codeline>
<codeline lineno="1175"><highlight class="normal">{</highlight></codeline>
<codeline lineno="1176"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">struct<sp/></highlight><highlight class="normal"><ref refid="structssh__iterator" kindref="compound">ssh_iterator</ref><sp/>*it<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="1177"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="structssh__session__struct" kindref="compound">ssh_session</ref><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref><sp/>=<sp/>channel-&gt;<ref refid="structssh__channel__struct_1a0832dc830d09accd2f3a8f8349c3faf2" kindref="member">session</ref>;</highlight></codeline>
<codeline lineno="1178"><highlight class="normal"></highlight></codeline>
<codeline lineno="1179"><highlight class="normal"><sp/><sp/><sp/><sp/>it<sp/>=<sp/><ref refid="group__libssh__misc_1ga7a929a68f02650d474604a10252afd68" kindref="member">ssh_list_find</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a9445164beb02a1979171bef9b1a63182" kindref="member">channels</ref>,<sp/>channel);</highlight></codeline>
<codeline lineno="1180"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(it<sp/>!=<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="1181"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="group__libssh__misc_1gac862429660a1f93dcf625d08f407b85e" kindref="member">ssh_list_remove</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a9445164beb02a1979171bef9b1a63182" kindref="member">channels</ref>,<sp/>it);</highlight></codeline>
<codeline lineno="1182"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1183"><highlight class="normal"></highlight></codeline>
<codeline lineno="1184"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="libssh_8h_1a8b09f7d6f7066de7ef8dab4ed7494a52" kindref="member">SSH_BUFFER_FREE</ref>(channel-&gt;<ref refid="structssh__channel__struct_1a8ae1473aafd716256ce762d0115b2321" kindref="member">stdout_buffer</ref>);</highlight></codeline>
<codeline lineno="1185"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="libssh_8h_1a8b09f7d6f7066de7ef8dab4ed7494a52" kindref="member">SSH_BUFFER_FREE</ref>(channel-&gt;<ref refid="structssh__channel__struct_1a6806319dfa8f417bbad93f6481ad99d4" kindref="member">stderr_buffer</ref>);</highlight></codeline>
<codeline lineno="1186"><highlight class="normal"></highlight></codeline>
<codeline lineno="1187"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(channel-&gt;<ref refid="structssh__channel__struct_1ad526c0401837d1636e3f9075226f7cd9" kindref="member">callbacks</ref><sp/>!=<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="1188"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="group__libssh__misc_1ga069155e0b5924eb930022b8d566f6d28" kindref="member">ssh_list_free</ref>(channel-&gt;<ref refid="structssh__channel__struct_1ad526c0401837d1636e3f9075226f7cd9" kindref="member">callbacks</ref>);</highlight></codeline>
<codeline lineno="1189"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>channel-&gt;<ref refid="structssh__channel__struct_1ad526c0401837d1636e3f9075226f7cd9" kindref="member">callbacks</ref><sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="1190"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1191"><highlight class="normal"></highlight></codeline>
<codeline lineno="1192"><highlight class="normal"><sp/><sp/><sp/><sp/>channel-&gt;<ref refid="structssh__channel__struct_1a0832dc830d09accd2f3a8f8349c3faf2" kindref="member">session</ref><sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="1193"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="sshd__direct-tcpip_8c_1aed3129b7674034c979192bcca6b0ad8c" kindref="member">SAFE_FREE</ref>(channel);</highlight></codeline>
<codeline lineno="1194"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1195"><highlight class="normal"></highlight></codeline>
<codeline lineno="1224" refid="group__libssh__channel_1ga072f82fdf3e50514f747653af2c99004" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="group__libssh__channel_1ga072f82fdf3e50514f747653af2c99004" kindref="member">ssh_channel_send_eof</ref>(<ref refid="structssh__channel__struct" kindref="compound">ssh_channel</ref><sp/>channel)</highlight></codeline>
<codeline lineno="1225"><highlight class="normal">{</highlight></codeline>
<codeline lineno="1226"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="structssh__session__struct" kindref="compound">ssh_session</ref><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>;</highlight></codeline>
<codeline lineno="1227"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" kindref="member">SSH_ERROR</ref>;</highlight></codeline>
<codeline lineno="1228"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>err;</highlight></codeline>
<codeline lineno="1229"><highlight class="normal"></highlight></codeline>
<codeline lineno="1230"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(channel<sp/>==<sp/>NULL<sp/>||<sp/>channel-&gt;<ref refid="structssh__channel__struct_1a0832dc830d09accd2f3a8f8349c3faf2" kindref="member">session</ref><sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="1231"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref>;</highlight></codeline>
<codeline lineno="1232"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1233"><highlight class="normal"></highlight></codeline>
<codeline lineno="1234"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>If<sp/>the<sp/>EOF<sp/>has<sp/>already<sp/>been<sp/>sent<sp/>we&apos;re<sp/>done<sp/>here.<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1235"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(channel-&gt;<ref refid="structssh__channel__struct_1a84b4de0420fa99e2b0673d4b5eeb4875" kindref="member">local_eof</ref><sp/>!=<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="1236"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="libssh_8h_1ac1ee1d1e917456d4760a94a18015377d" kindref="member">SSH_OK</ref>;</highlight></codeline>
<codeline lineno="1237"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1238"><highlight class="normal"></highlight></codeline>
<codeline lineno="1239"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref><sp/>=<sp/>channel-&gt;<ref refid="structssh__channel__struct_1a0832dc830d09accd2f3a8f8349c3faf2" kindref="member">session</ref>;</highlight></codeline>
<codeline lineno="1240"><highlight class="normal"></highlight></codeline>
<codeline lineno="1241"><highlight class="normal"><sp/><sp/><sp/><sp/>err<sp/>=<sp/><ref refid="buffer_8h_1ae17848a86043f0abfc60c1c4f6126ccd" kindref="member">ssh_buffer_pack</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1af0aed60c1e529bbfdcb483fd80bf98a0" kindref="member">out_buffer</ref>,</highlight></codeline>
<codeline lineno="1242"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;bd&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="1243"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ssh2_8h_1a71f0974db7fd436bb5c29d4761d2f176" kindref="member">SSH2_MSG_CHANNEL_EOF</ref>,</highlight></codeline>
<codeline lineno="1244"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>channel-&gt;<ref refid="structssh__channel__struct_1aa553acf6d12fffb1ae18b11196c2c0e9" kindref="member">remote_channel</ref>);</highlight></codeline>
<codeline lineno="1245"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(err<sp/>!=<sp/><ref refid="libssh_8h_1ac1ee1d1e917456d4760a94a18015377d" kindref="member">SSH_OK</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1246"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="priv_8h_1ae280c413c792e04237f000841ac8ce44" kindref="member">ssh_set_error_oom</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>);</highlight></codeline>
<codeline lineno="1247"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">goto</highlight><highlight class="normal"><sp/><ref refid="proxy_8c_1a11614f44ef4d939bdd984953346a7572" kindref="member">error</ref>;</highlight></codeline>
<codeline lineno="1248"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1249"><highlight class="normal"></highlight></codeline>
<codeline lineno="1250"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="packet_8h_1a7e6c7ed74c23ace432476aa8a6841140" kindref="member">ssh_packet_send</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>);</highlight></codeline>
<codeline lineno="1251"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="priv_8h_1aa21fd8a7a609329603b7b16da7939fca" kindref="member">SSH_LOG</ref>(<ref refid="group__libssh__log_1ggadf764cbdea00d65edcd07bb9953ad2b7a6445dfe21592d69d9741d319538b6673" kindref="member">SSH_LOG_PACKET</ref>,</highlight></codeline>
<codeline lineno="1252"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Sent<sp/>a<sp/>EOF<sp/>on<sp/>client<sp/>channel<sp/>(%d:%d)&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="1253"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>channel-&gt;<ref refid="structssh__channel__struct_1a39cdc105ee0bbd1b7faea169db30f0a1" kindref="member">local_channel</ref>,</highlight></codeline>
<codeline lineno="1254"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>channel-&gt;<ref refid="structssh__channel__struct_1aa553acf6d12fffb1ae18b11196c2c0e9" kindref="member">remote_channel</ref>);</highlight></codeline>
<codeline lineno="1255"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>!=<sp/><ref refid="libssh_8h_1ac1ee1d1e917456d4760a94a18015377d" kindref="member">SSH_OK</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1256"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">goto</highlight><highlight class="normal"><sp/><ref refid="proxy_8c_1a11614f44ef4d939bdd984953346a7572" kindref="member">error</ref>;</highlight></codeline>
<codeline lineno="1257"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1258"><highlight class="normal"></highlight></codeline>
<codeline lineno="1259"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="group__libssh__channel_1gae61fe034965d58e1fb6da1bee98de191" kindref="member">ssh_channel_flush</ref>(channel);</highlight></codeline>
<codeline lineno="1260"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>==<sp/><ref refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" kindref="member">SSH_ERROR</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1261"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">goto</highlight><highlight class="normal"><sp/><ref refid="proxy_8c_1a11614f44ef4d939bdd984953346a7572" kindref="member">error</ref>;</highlight></codeline>
<codeline lineno="1262"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1263"><highlight class="normal"><sp/><sp/><sp/><sp/>channel-&gt;<ref refid="structssh__channel__struct_1a84b4de0420fa99e2b0673d4b5eeb4875" kindref="member">local_eof</ref><sp/>=<sp/>1;</highlight></codeline>
<codeline lineno="1264"><highlight class="normal"></highlight></codeline>
<codeline lineno="1265"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref>;</highlight></codeline>
<codeline lineno="1266"><highlight class="normal"><ref refid="proxy_8c_1a11614f44ef4d939bdd984953346a7572" kindref="member">error</ref>:</highlight></codeline>
<codeline lineno="1267"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="libssh_8h_1ac8802ff7f5348d0145dab5242623f740" kindref="member">ssh_buffer_reinit</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1af0aed60c1e529bbfdcb483fd80bf98a0" kindref="member">out_buffer</ref>);</highlight></codeline>
<codeline lineno="1268"><highlight class="normal"></highlight></codeline>
<codeline lineno="1269"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref>;</highlight></codeline>
<codeline lineno="1270"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1271"><highlight class="normal"></highlight></codeline>
<codeline lineno="1285" refid="group__libssh__channel_1ga238f07e0455456a5bfd8a49ead917732" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="group__libssh__channel_1ga238f07e0455456a5bfd8a49ead917732" kindref="member">ssh_channel_close</ref>(<ref refid="structssh__channel__struct" kindref="compound">ssh_channel</ref><sp/>channel)</highlight></codeline>
<codeline lineno="1286"><highlight class="normal">{</highlight></codeline>
<codeline lineno="1287"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="structssh__session__struct" kindref="compound">ssh_session</ref><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>;</highlight></codeline>
<codeline lineno="1288"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="1289"><highlight class="normal"></highlight></codeline>
<codeline lineno="1290"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(channel<sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="1291"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" kindref="member">SSH_ERROR</ref>;</highlight></codeline>
<codeline lineno="1292"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1293"><highlight class="normal"></highlight></codeline>
<codeline lineno="1294"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>If<sp/>the<sp/>channel<sp/>close<sp/>has<sp/>already<sp/>been<sp/>sent<sp/>we&apos;re<sp/>done<sp/>here.<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1295"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(channel-&gt;<ref refid="structssh__channel__struct_1a400dc0c0dc7cd02daaea731825c1a7c4" kindref="member">flags</ref><sp/>&amp;<sp/><ref refid="channels_8h_1ad2f890619dac7055258ce90e9944b65f" kindref="member">SSH_CHANNEL_FLAG_CLOSED_LOCAL</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1296"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="libssh_8h_1ac1ee1d1e917456d4760a94a18015377d" kindref="member">SSH_OK</ref>;</highlight></codeline>
<codeline lineno="1297"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1298"><highlight class="normal"></highlight></codeline>
<codeline lineno="1299"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref><sp/>=<sp/>channel-&gt;<ref refid="structssh__channel__struct_1a0832dc830d09accd2f3a8f8349c3faf2" kindref="member">session</ref>;</highlight></codeline>
<codeline lineno="1300"><highlight class="normal"></highlight></codeline>
<codeline lineno="1301"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="group__libssh__channel_1ga072f82fdf3e50514f747653af2c99004" kindref="member">ssh_channel_send_eof</ref>(channel);</highlight></codeline>
<codeline lineno="1302"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>!=<sp/><ref refid="libssh_8h_1ac1ee1d1e917456d4760a94a18015377d" kindref="member">SSH_OK</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1303"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref>;</highlight></codeline>
<codeline lineno="1304"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1305"><highlight class="normal"></highlight></codeline>
<codeline lineno="1306"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="buffer_8h_1ae17848a86043f0abfc60c1c4f6126ccd" kindref="member">ssh_buffer_pack</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1af0aed60c1e529bbfdcb483fd80bf98a0" kindref="member">out_buffer</ref>,</highlight></codeline>
<codeline lineno="1307"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;bd&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="1308"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ssh2_8h_1a8397a7ba3abc36c7866340f3c3fa80ee" kindref="member">SSH2_MSG_CHANNEL_CLOSE</ref>,</highlight></codeline>
<codeline lineno="1309"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>channel-&gt;<ref refid="structssh__channel__struct_1aa553acf6d12fffb1ae18b11196c2c0e9" kindref="member">remote_channel</ref>);</highlight></codeline>
<codeline lineno="1310"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>!=<sp/><ref refid="libssh_8h_1ac1ee1d1e917456d4760a94a18015377d" kindref="member">SSH_OK</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1311"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="priv_8h_1ae280c413c792e04237f000841ac8ce44" kindref="member">ssh_set_error_oom</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>);</highlight></codeline>
<codeline lineno="1312"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">goto</highlight><highlight class="normal"><sp/><ref refid="proxy_8c_1a11614f44ef4d939bdd984953346a7572" kindref="member">error</ref>;</highlight></codeline>
<codeline lineno="1313"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1314"><highlight class="normal"></highlight></codeline>
<codeline lineno="1315"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="packet_8h_1a7e6c7ed74c23ace432476aa8a6841140" kindref="member">ssh_packet_send</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>);</highlight></codeline>
<codeline lineno="1316"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="priv_8h_1aa21fd8a7a609329603b7b16da7939fca" kindref="member">SSH_LOG</ref>(<ref refid="group__libssh__log_1ggadf764cbdea00d65edcd07bb9953ad2b7a6445dfe21592d69d9741d319538b6673" kindref="member">SSH_LOG_PACKET</ref>,</highlight></codeline>
<codeline lineno="1317"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Sent<sp/>a<sp/>close<sp/>on<sp/>client<sp/>channel<sp/>(%d:%d)&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="1318"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>channel-&gt;<ref refid="structssh__channel__struct_1a39cdc105ee0bbd1b7faea169db30f0a1" kindref="member">local_channel</ref>,</highlight></codeline>
<codeline lineno="1319"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>channel-&gt;<ref refid="structssh__channel__struct_1aa553acf6d12fffb1ae18b11196c2c0e9" kindref="member">remote_channel</ref>);</highlight></codeline>
<codeline lineno="1320"><highlight class="normal"></highlight></codeline>
<codeline lineno="1321"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>==<sp/><ref refid="libssh_8h_1ac1ee1d1e917456d4760a94a18015377d" kindref="member">SSH_OK</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1322"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>channel-&gt;<ref refid="structssh__channel__struct_1a272b198e279fa672afeaf9f2e610eb04" kindref="member">state</ref><sp/>=<sp/><ref refid="channels_8h_1a5a002159e5db31d156bb2a8ce8a10cd1a96872cd3f6e98f6f040097e3ee6cb900" kindref="member">SSH_CHANNEL_STATE_CLOSED</ref>;</highlight></codeline>
<codeline lineno="1323"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>channel-&gt;<ref refid="structssh__channel__struct_1a400dc0c0dc7cd02daaea731825c1a7c4" kindref="member">flags</ref><sp/>|=<sp/><ref refid="channels_8h_1ad2f890619dac7055258ce90e9944b65f" kindref="member">SSH_CHANNEL_FLAG_CLOSED_LOCAL</ref>;</highlight></codeline>
<codeline lineno="1324"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1325"><highlight class="normal"></highlight></codeline>
<codeline lineno="1326"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="group__libssh__channel_1gae61fe034965d58e1fb6da1bee98de191" kindref="member">ssh_channel_flush</ref>(channel);</highlight></codeline>
<codeline lineno="1327"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>==<sp/><ref refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" kindref="member">SSH_ERROR</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1328"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">goto</highlight><highlight class="normal"><sp/><ref refid="proxy_8c_1a11614f44ef4d939bdd984953346a7572" kindref="member">error</ref>;</highlight></codeline>
<codeline lineno="1329"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1330"><highlight class="normal"></highlight></codeline>
<codeline lineno="1331"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref>;</highlight></codeline>
<codeline lineno="1332"><highlight class="normal"><ref refid="proxy_8c_1a11614f44ef4d939bdd984953346a7572" kindref="member">error</ref>:</highlight></codeline>
<codeline lineno="1333"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="libssh_8h_1ac8802ff7f5348d0145dab5242623f740" kindref="member">ssh_buffer_reinit</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1af0aed60c1e529bbfdcb483fd80bf98a0" kindref="member">out_buffer</ref>);</highlight></codeline>
<codeline lineno="1334"><highlight class="normal"></highlight></codeline>
<codeline lineno="1335"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref>;</highlight></codeline>
<codeline lineno="1336"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1337"><highlight class="normal"></highlight></codeline>
<codeline lineno="1338"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>this<sp/>termination<sp/>function<sp/>waits<sp/>for<sp/>a<sp/>window<sp/>growing<sp/>condition<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1339" refid="group__libssh__channel_1gac85f6c47b96159e7e912f25c7ba5f2a1" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="group__libssh__channel_1gac85f6c47b96159e7e912f25c7ba5f2a1" kindref="member">ssh_channel_waitwindow_termination</ref>(</highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>*c){</highlight></codeline>
<codeline lineno="1340"><highlight class="normal"><sp/><sp/><ref refid="structssh__channel__struct" kindref="compound">ssh_channel</ref><sp/>channel<sp/>=<sp/>(<ref refid="libssh_8h_1aca32be8db7c865697a3de381dc7e9fc3" kindref="member">ssh_channel</ref>)<sp/>c;</highlight></codeline>
<codeline lineno="1341"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(channel-&gt;<ref refid="structssh__channel__struct_1a1b5936420da03e6b64aa8f900eb8ad0c" kindref="member">remote_window</ref><sp/>&gt;<sp/>0<sp/>||</highlight></codeline>
<codeline lineno="1342"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>channel-&gt;<ref refid="structssh__channel__struct_1a0832dc830d09accd2f3a8f8349c3faf2" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a6f74d1a1eb6ed715b1073b67caa18460" kindref="member">session_state</ref><sp/>==<sp/><ref refid="session_8h_1a9bbd1d5ae11485e27279be6ad461992ca855474fc84a2fb170fcb72546af8eeb8" kindref="member">SSH_SESSION_STATE_ERROR</ref><sp/>||</highlight></codeline>
<codeline lineno="1343"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>channel-&gt;<ref refid="structssh__channel__struct_1a272b198e279fa672afeaf9f2e610eb04" kindref="member">state</ref><sp/>==<sp/><ref refid="channels_8h_1a5a002159e5db31d156bb2a8ce8a10cd1a96872cd3f6e98f6f040097e3ee6cb900" kindref="member">SSH_CHANNEL_STATE_CLOSED</ref>)</highlight></codeline>
<codeline lineno="1344"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>1;</highlight></codeline>
<codeline lineno="1345"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1346"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>0;</highlight></codeline>
<codeline lineno="1347"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1348"><highlight class="normal"></highlight></codeline>
<codeline lineno="1349"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>This<sp/>termination<sp/>function<sp/>waits<sp/>until<sp/>the<sp/>session<sp/>is<sp/>not<sp/>in<sp/>blocked<sp/>status</highlight></codeline>
<codeline lineno="1350"><highlight class="comment"><sp/>*<sp/>anymore,<sp/>e.g.<sp/>because<sp/>of<sp/>a<sp/>key<sp/>re-exchange.</highlight></codeline>
<codeline lineno="1351"><highlight class="comment"><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1352" refid="group__libssh__channel_1gae8a61c46f07fc2b242a8b8cee0c50596" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="group__libssh__channel_1gae8a61c46f07fc2b242a8b8cee0c50596" kindref="member">ssh_waitsession_unblocked</ref>(</highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>*<ref refid="test__socket_8c_1a73991beba1accdcc64730cb00c146fe2" kindref="member">s</ref>){</highlight></codeline>
<codeline lineno="1353"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="structssh__session__struct" kindref="compound">ssh_session</ref><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref><sp/>=<sp/>(<ref refid="libssh_8h_1a02d3754de040612632cdd499c20f92f6" kindref="member">ssh_session</ref>)<ref refid="test__socket_8c_1a73991beba1accdcc64730cb00c146fe2" kindref="member">s</ref>;</highlight></codeline>
<codeline lineno="1354"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">switch</highlight><highlight class="normal"><sp/>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a6f74d1a1eb6ed715b1073b67caa18460" kindref="member">session_state</ref>){</highlight></codeline>
<codeline lineno="1355"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="session_8h_1a9bbd1d5ae11485e27279be6ad461992ca1dcace0fedd97312d6829ecc526d3606" kindref="member">SSH_SESSION_STATE_DH</ref>:</highlight></codeline>
<codeline lineno="1356"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="session_8h_1a9bbd1d5ae11485e27279be6ad461992ca64f98e48c54ec9ae09070b92c1f47659" kindref="member">SSH_SESSION_STATE_INITIAL_KEX</ref>:</highlight></codeline>
<codeline lineno="1357"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="session_8h_1a9bbd1d5ae11485e27279be6ad461992ca336024640ab057d21d87ded010687dc7" kindref="member">SSH_SESSION_STATE_KEXINIT_RECEIVED</ref>:</highlight></codeline>
<codeline lineno="1358"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>0;</highlight></codeline>
<codeline lineno="1359"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">default</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="1360"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>1;</highlight></codeline>
<codeline lineno="1361"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1362"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1372" refid="group__libssh__channel_1gae61fe034965d58e1fb6da1bee98de191" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="group__libssh__channel_1gae61fe034965d58e1fb6da1bee98de191" kindref="member">ssh_channel_flush</ref>(<ref refid="structssh__channel__struct" kindref="compound">ssh_channel</ref><sp/>channel){</highlight></codeline>
<codeline lineno="1373"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="group__libssh__session_1ga60da8e2c47897a209a455923c35d52d8" kindref="member">ssh_blocking_flush</ref>(channel-&gt;<ref refid="structssh__channel__struct_1a0832dc830d09accd2f3a8f8349c3faf2" kindref="member">session</ref>,<sp/><ref refid="session_8h_1aa8c8d35c7f83d7b00218ebadfac2254b" kindref="member">SSH_TIMEOUT_DEFAULT</ref>);</highlight></codeline>
<codeline lineno="1374"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1375"><highlight class="normal"></highlight></codeline>
<codeline lineno="1376" refid="group__libssh__channel_1ga918e9bde297309e977a872bc62c0d260" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="group__libssh__channel_1ga918e9bde297309e977a872bc62c0d260" kindref="member">channel_write_common</ref>(<ref refid="structssh__channel__struct" kindref="compound">ssh_channel</ref><sp/>channel,</highlight></codeline>
<codeline lineno="1377"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>*<ref refid="structssh__iterator_1a4cc4eb8c8599a487e7e3321d32a9e9cd" kindref="member">data</ref>,</highlight></codeline>
<codeline lineno="1378"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>uint32_t<sp/>len,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>is_stderr)</highlight></codeline>
<codeline lineno="1379"><highlight class="normal">{</highlight></codeline>
<codeline lineno="1380"><highlight class="normal"><sp/><sp/><ref refid="structssh__session__struct" kindref="compound">ssh_session</ref><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>;</highlight></codeline>
<codeline lineno="1381"><highlight class="normal"><sp/><sp/>uint32_t<sp/>origlen<sp/>=<sp/>len;</highlight></codeline>
<codeline lineno="1382"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/>effectivelen;</highlight></codeline>
<codeline lineno="1383"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/>maxpacketlen;</highlight></codeline>
<codeline lineno="1384"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref>;</highlight></codeline>
<codeline lineno="1385"><highlight class="normal"></highlight></codeline>
<codeline lineno="1386"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(channel<sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="1387"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>-1;</highlight></codeline>
<codeline lineno="1388"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="1389"><highlight class="normal"><sp/><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref><sp/>=<sp/>channel-&gt;<ref refid="structssh__channel__struct_1a0832dc830d09accd2f3a8f8349c3faf2" kindref="member">session</ref>;</highlight></codeline>
<codeline lineno="1390"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<ref refid="structssh__iterator_1a4cc4eb8c8599a487e7e3321d32a9e9cd" kindref="member">data</ref><sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="1391"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="priv_8h_1a351ea86857d33b3ba80b396e05c4517c" kindref="member">ssh_set_error_invalid</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>);</highlight></codeline>
<codeline lineno="1392"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>-1;</highlight></codeline>
<codeline lineno="1393"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="1394"><highlight class="normal"></highlight></codeline>
<codeline lineno="1395"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(len<sp/>&gt;<sp/>INT_MAX)<sp/>{</highlight></codeline>
<codeline lineno="1396"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="priv_8h_1aa21fd8a7a609329603b7b16da7939fca" kindref="member">SSH_LOG</ref>(<ref refid="group__libssh__log_1ggadf764cbdea00d65edcd07bb9953ad2b7a75fa79e63947b66462db977d9b5ae27c" kindref="member">SSH_LOG_PROTOCOL</ref>,</highlight></codeline>
<codeline lineno="1397"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Length<sp/>(%u)<sp/>is<sp/>bigger<sp/>than<sp/>INT_MAX&quot;</highlight><highlight class="normal">,<sp/>len);</highlight></codeline>
<codeline lineno="1398"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" kindref="member">SSH_ERROR</ref>;</highlight></codeline>
<codeline lineno="1399"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="1400"><highlight class="normal"></highlight></codeline>
<codeline lineno="1401"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">/*</highlight></codeline>
<codeline lineno="1402"><highlight class="comment"><sp/><sp/><sp/>*<sp/>Handle<sp/>the<sp/>max<sp/>packet<sp/>len<sp/>from<sp/>remote<sp/>side,<sp/>be<sp/>nice</highlight></codeline>
<codeline lineno="1403"><highlight class="comment"><sp/><sp/><sp/>*<sp/>10<sp/>bytes<sp/>for<sp/>the<sp/>headers</highlight></codeline>
<codeline lineno="1404"><highlight class="comment"><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1405"><highlight class="normal"><sp/><sp/>maxpacketlen<sp/>=<sp/>channel-&gt;<ref refid="structssh__channel__struct_1a748cbf4c5d3af22bd8e8fea69144128d" kindref="member">remote_maxpacket</ref><sp/>-<sp/>10;</highlight></codeline>
<codeline lineno="1406"><highlight class="normal"></highlight></codeline>
<codeline lineno="1407"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(channel-&gt;<ref refid="structssh__channel__struct_1a84b4de0420fa99e2b0673d4b5eeb4875" kindref="member">local_eof</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1408"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="priv_8h_1a55177b3e8db90ca9adb435c44281963c" kindref="member">ssh_set_error</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>,<sp/><ref refid="libssh_8h_1a036b2b00fb04337a4d06d719d1b62be1ad1339fb4b92a9d25bdb99df5de5c4f88" kindref="member">SSH_REQUEST_DENIED</ref>,</highlight></codeline>
<codeline lineno="1409"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Can&apos;t<sp/>write<sp/>to<sp/>channel<sp/>%d:%d<sp/><sp/>after<sp/>EOF<sp/>was<sp/>sent&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="1410"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>channel-&gt;<ref refid="structssh__channel__struct_1a39cdc105ee0bbd1b7faea169db30f0a1" kindref="member">local_channel</ref>,</highlight></codeline>
<codeline lineno="1411"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>channel-&gt;<ref refid="structssh__channel__struct_1aa553acf6d12fffb1ae18b11196c2c0e9" kindref="member">remote_channel</ref>);</highlight></codeline>
<codeline lineno="1412"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>-1;</highlight></codeline>
<codeline lineno="1413"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="1414"><highlight class="normal"></highlight></codeline>
<codeline lineno="1415"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(channel-&gt;<ref refid="structssh__channel__struct_1a272b198e279fa672afeaf9f2e610eb04" kindref="member">state</ref><sp/>!=<sp/><ref refid="channels_8h_1a5a002159e5db31d156bb2a8ce8a10cd1a488a78707192c35250392423b5058e2b" kindref="member">SSH_CHANNEL_STATE_OPEN</ref><sp/>||<sp/>channel-&gt;<ref refid="structssh__channel__struct_1a23f4022c397cfd2cfc05a1358f8082f6" kindref="member">delayed_close</ref><sp/>!=<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="1416"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="priv_8h_1a55177b3e8db90ca9adb435c44281963c" kindref="member">ssh_set_error</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>,<sp/><ref refid="libssh_8h_1a036b2b00fb04337a4d06d719d1b62be1ad1339fb4b92a9d25bdb99df5de5c4f88" kindref="member">SSH_REQUEST_DENIED</ref>,<sp/></highlight><highlight class="stringliteral">&quot;Remote<sp/>channel<sp/>is<sp/>closed&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="1417"><highlight class="normal"></highlight></codeline>
<codeline lineno="1418"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>-1;</highlight></codeline>
<codeline lineno="1419"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="1420"><highlight class="normal"></highlight></codeline>
<codeline lineno="1421"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a6f74d1a1eb6ed715b1073b67caa18460" kindref="member">session_state</ref><sp/>==<sp/><ref refid="session_8h_1a9bbd1d5ae11485e27279be6ad461992ca855474fc84a2fb170fcb72546af8eeb8" kindref="member">SSH_SESSION_STATE_ERROR</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1422"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" kindref="member">SSH_ERROR</ref>;</highlight></codeline>
<codeline lineno="1423"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="1424"><highlight class="normal"></highlight></codeline>
<codeline lineno="1425"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="group__libssh__channel_1gae8a61c46f07fc2b242a8b8cee0c50596" kindref="member">ssh_waitsession_unblocked</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>)<sp/>==<sp/>0){</highlight></codeline>
<codeline lineno="1426"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="group__libssh__session_1ga4b84e1ae757c0d4007a5eefdf4651694" kindref="member">ssh_handle_packets_termination</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>,<sp/><ref refid="session_8h_1aa8c8d35c7f83d7b00218ebadfac2254b" kindref="member">SSH_TIMEOUT_DEFAULT</ref>,</highlight></codeline>
<codeline lineno="1427"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="group__libssh__channel_1gae8a61c46f07fc2b242a8b8cee0c50596" kindref="member">ssh_waitsession_unblocked</ref>,<sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>);</highlight></codeline>
<codeline lineno="1428"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>==<sp/><ref refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" kindref="member">SSH_ERROR</ref><sp/>||<sp/>!<ref refid="group__libssh__channel_1gae8a61c46f07fc2b242a8b8cee0c50596" kindref="member">ssh_waitsession_unblocked</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>))</highlight></codeline>
<codeline lineno="1429"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">goto</highlight><highlight class="normal"><sp/>out;</highlight></codeline>
<codeline lineno="1430"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="1431"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>(len<sp/>&gt;<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="1432"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(channel-&gt;<ref refid="structssh__channel__struct_1a1b5936420da03e6b64aa8f900eb8ad0c" kindref="member">remote_window</ref><sp/>&lt;<sp/>len)<sp/>{</highlight></codeline>
<codeline lineno="1433"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="priv_8h_1aa21fd8a7a609329603b7b16da7939fca" kindref="member">SSH_LOG</ref>(<ref refid="group__libssh__log_1ggadf764cbdea00d65edcd07bb9953ad2b7a75fa79e63947b66462db977d9b5ae27c" kindref="member">SSH_LOG_PROTOCOL</ref>,</highlight></codeline>
<codeline lineno="1434"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Remote<sp/>window<sp/>is<sp/>%d<sp/>bytes.<sp/>going<sp/>to<sp/>write<sp/>%d<sp/>bytes&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="1435"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>channel-&gt;<ref refid="structssh__channel__struct_1a1b5936420da03e6b64aa8f900eb8ad0c" kindref="member">remote_window</ref>,</highlight></codeline>
<codeline lineno="1436"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>len);</highlight></codeline>
<codeline lineno="1437"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>What<sp/>happens<sp/>when<sp/>the<sp/>channel<sp/>window<sp/>is<sp/>zero?<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1438"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(channel-&gt;<ref refid="structssh__channel__struct_1a1b5936420da03e6b64aa8f900eb8ad0c" kindref="member">remote_window</ref><sp/>==<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="1439"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>nothing<sp/>can<sp/>be<sp/>written<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1440"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="priv_8h_1aa21fd8a7a609329603b7b16da7939fca" kindref="member">SSH_LOG</ref>(<ref refid="group__libssh__log_1ggadf764cbdea00d65edcd07bb9953ad2b7a75fa79e63947b66462db977d9b5ae27c" kindref="member">SSH_LOG_PROTOCOL</ref>,</highlight></codeline>
<codeline lineno="1441"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Wait<sp/>for<sp/>a<sp/>growing<sp/>window<sp/>message...&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="1442"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="group__libssh__session_1ga4b84e1ae757c0d4007a5eefdf4651694" kindref="member">ssh_handle_packets_termination</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>,<sp/><ref refid="session_8h_1aa8c8d35c7f83d7b00218ebadfac2254b" kindref="member">SSH_TIMEOUT_DEFAULT</ref>,</highlight></codeline>
<codeline lineno="1443"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="group__libssh__channel_1gac85f6c47b96159e7e912f25c7ba5f2a1" kindref="member">ssh_channel_waitwindow_termination</ref>,channel);</highlight></codeline>
<codeline lineno="1444"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>==<sp/><ref refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" kindref="member">SSH_ERROR</ref><sp/>||</highlight></codeline>
<codeline lineno="1445"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>!<ref refid="group__libssh__channel_1gac85f6c47b96159e7e912f25c7ba5f2a1" kindref="member">ssh_channel_waitwindow_termination</ref>(channel)<sp/>||</highlight></codeline>
<codeline lineno="1446"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a6f74d1a1eb6ed715b1073b67caa18460" kindref="member">session_state</ref><sp/>==<sp/><ref refid="session_8h_1a9bbd1d5ae11485e27279be6ad461992ca855474fc84a2fb170fcb72546af8eeb8" kindref="member">SSH_SESSION_STATE_ERROR</ref><sp/>||</highlight></codeline>
<codeline lineno="1447"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>channel-&gt;<ref refid="structssh__channel__struct_1a272b198e279fa672afeaf9f2e610eb04" kindref="member">state</ref><sp/>==<sp/><ref refid="channels_8h_1a5a002159e5db31d156bb2a8ce8a10cd1a96872cd3f6e98f6f040097e3ee6cb900" kindref="member">SSH_CHANNEL_STATE_CLOSED</ref>)</highlight></codeline>
<codeline lineno="1448"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">goto</highlight><highlight class="normal"><sp/>out;</highlight></codeline>
<codeline lineno="1449"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">continue</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1450"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1451"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>effectivelen<sp/>=<sp/><ref refid="priv_8h_1a3acffbd305ee72dcd4593c0d8af64a4f" kindref="member">MIN</ref>(len,<sp/>channel-&gt;<ref refid="structssh__channel__struct_1a1b5936420da03e6b64aa8f900eb8ad0c" kindref="member">remote_window</ref>);</highlight></codeline>
<codeline lineno="1452"><highlight class="normal"><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="1453"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>effectivelen<sp/>=<sp/>len;</highlight></codeline>
<codeline lineno="1454"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1455"><highlight class="normal"></highlight></codeline>
<codeline lineno="1456"><highlight class="normal"><sp/><sp/><sp/><sp/>effectivelen<sp/>=<sp/><ref refid="priv_8h_1a3acffbd305ee72dcd4593c0d8af64a4f" kindref="member">MIN</ref>(effectivelen,<sp/>maxpacketlen);;</highlight></codeline>
<codeline lineno="1457"><highlight class="normal"></highlight></codeline>
<codeline lineno="1458"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="buffer_8h_1ae17848a86043f0abfc60c1c4f6126ccd" kindref="member">ssh_buffer_pack</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1af0aed60c1e529bbfdcb483fd80bf98a0" kindref="member">out_buffer</ref>,</highlight></codeline>
<codeline lineno="1459"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;bd&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="1460"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>is_stderr<sp/>?<sp/><ref refid="ssh2_8h_1a29768987bed67fbe3e7d537c5ee05f29" kindref="member">SSH2_MSG_CHANNEL_EXTENDED_DATA</ref><sp/>:<sp/><ref refid="ssh2_8h_1ab4dc0d7b8a45a0f902a5332c6a7c2b35" kindref="member">SSH2_MSG_CHANNEL_DATA</ref>,</highlight></codeline>
<codeline lineno="1461"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>channel-&gt;<ref refid="structssh__channel__struct_1aa553acf6d12fffb1ae18b11196c2c0e9" kindref="member">remote_channel</ref>);</highlight></codeline>
<codeline lineno="1462"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>!=<sp/><ref refid="libssh_8h_1ac1ee1d1e917456d4760a94a18015377d" kindref="member">SSH_OK</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1463"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="priv_8h_1ae280c413c792e04237f000841ac8ce44" kindref="member">ssh_set_error_oom</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>);</highlight></codeline>
<codeline lineno="1464"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">goto</highlight><highlight class="normal"><sp/><ref refid="proxy_8c_1a11614f44ef4d939bdd984953346a7572" kindref="member">error</ref>;</highlight></codeline>
<codeline lineno="1465"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1466"><highlight class="normal"></highlight></codeline>
<codeline lineno="1467"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>stderr<sp/>message<sp/>has<sp/>an<sp/>extra<sp/>field<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1468"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(is_stderr)<sp/>{</highlight></codeline>
<codeline lineno="1469"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="buffer_8h_1ae17848a86043f0abfc60c1c4f6126ccd" kindref="member">ssh_buffer_pack</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1af0aed60c1e529bbfdcb483fd80bf98a0" kindref="member">out_buffer</ref>,</highlight></codeline>
<codeline lineno="1470"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;d&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="1471"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ssh2_8h_1aa185eb435ac3cb25552c6c82112c979c" kindref="member">SSH2_EXTENDED_DATA_STDERR</ref>);</highlight></codeline>
<codeline lineno="1472"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>!=<sp/><ref refid="libssh_8h_1ac1ee1d1e917456d4760a94a18015377d" kindref="member">SSH_OK</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1473"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="priv_8h_1ae280c413c792e04237f000841ac8ce44" kindref="member">ssh_set_error_oom</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>);</highlight></codeline>
<codeline lineno="1474"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">goto</highlight><highlight class="normal"><sp/><ref refid="proxy_8c_1a11614f44ef4d939bdd984953346a7572" kindref="member">error</ref>;</highlight></codeline>
<codeline lineno="1475"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1476"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1477"><highlight class="normal"></highlight></codeline>
<codeline lineno="1478"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>append<sp/>payload<sp/>data<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1479"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="buffer_8h_1ae17848a86043f0abfc60c1c4f6126ccd" kindref="member">ssh_buffer_pack</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1af0aed60c1e529bbfdcb483fd80bf98a0" kindref="member">out_buffer</ref>,</highlight></codeline>
<codeline lineno="1480"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;dP&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="1481"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>effectivelen,</highlight></codeline>
<codeline lineno="1482"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(</highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal">)effectivelen,<sp/><ref refid="structssh__iterator_1a4cc4eb8c8599a487e7e3321d32a9e9cd" kindref="member">data</ref>);</highlight></codeline>
<codeline lineno="1483"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>!=<sp/><ref refid="libssh_8h_1ac1ee1d1e917456d4760a94a18015377d" kindref="member">SSH_OK</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1484"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="priv_8h_1ae280c413c792e04237f000841ac8ce44" kindref="member">ssh_set_error_oom</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>);</highlight></codeline>
<codeline lineno="1485"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">goto</highlight><highlight class="normal"><sp/><ref refid="proxy_8c_1a11614f44ef4d939bdd984953346a7572" kindref="member">error</ref>;</highlight></codeline>
<codeline lineno="1486"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1487"><highlight class="normal"></highlight></codeline>
<codeline lineno="1488"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="packet_8h_1a7e6c7ed74c23ace432476aa8a6841140" kindref="member">ssh_packet_send</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>);</highlight></codeline>
<codeline lineno="1489"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>==<sp/><ref refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" kindref="member">SSH_ERROR</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1490"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" kindref="member">SSH_ERROR</ref>;</highlight></codeline>
<codeline lineno="1491"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1492"><highlight class="normal"></highlight></codeline>
<codeline lineno="1493"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="priv_8h_1aa21fd8a7a609329603b7b16da7939fca" kindref="member">SSH_LOG</ref>(<ref refid="group__libssh__log_1ggadf764cbdea00d65edcd07bb9953ad2b7a6445dfe21592d69d9741d319538b6673" kindref="member">SSH_LOG_PACKET</ref>,</highlight></codeline>
<codeline lineno="1494"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;channel_write<sp/>wrote<sp/>%ld<sp/>bytes&quot;</highlight><highlight class="normal">,<sp/>(</highlight><highlight class="keywordtype">long</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal">)<sp/>effectivelen);</highlight></codeline>
<codeline lineno="1495"><highlight class="normal"></highlight></codeline>
<codeline lineno="1496"><highlight class="normal"><sp/><sp/><sp/><sp/>channel-&gt;<ref refid="structssh__channel__struct_1a1b5936420da03e6b64aa8f900eb8ad0c" kindref="member">remote_window</ref><sp/>-=<sp/>effectivelen;</highlight></codeline>
<codeline lineno="1497"><highlight class="normal"><sp/><sp/><sp/><sp/>len<sp/>-=<sp/>effectivelen;</highlight></codeline>
<codeline lineno="1498"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="structssh__iterator_1a4cc4eb8c8599a487e7e3321d32a9e9cd" kindref="member">data</ref><sp/>=<sp/>((uint8_t*)<ref refid="structssh__iterator_1a4cc4eb8c8599a487e7e3321d32a9e9cd" kindref="member">data</ref><sp/>+<sp/>effectivelen);</highlight></codeline>
<codeline lineno="1499"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(channel-&gt;<ref refid="structssh__channel__struct_1ab1beeacd4aff735258cb7488c079c6dc" kindref="member">counter</ref><sp/>!=<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="1500"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>channel-&gt;<ref refid="structssh__channel__struct_1ab1beeacd4aff735258cb7488c079c6dc" kindref="member">counter</ref>-&gt;<ref refid="structssh__counter__struct_1a0fc155fa51fb41bc8011da0df017e182" kindref="member">out_bytes</ref><sp/>+=<sp/>effectivelen;</highlight></codeline>
<codeline lineno="1501"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1502"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="1503"><highlight class="normal"></highlight></codeline>
<codeline lineno="1504"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">/*<sp/>it&apos;s<sp/>a<sp/>good<sp/>idea<sp/>to<sp/>flush<sp/>the<sp/>socket<sp/>now<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1505"><highlight class="normal"><sp/><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="group__libssh__channel_1gae61fe034965d58e1fb6da1bee98de191" kindref="member">ssh_channel_flush</ref>(channel);</highlight></codeline>
<codeline lineno="1506"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>==<sp/><ref refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" kindref="member">SSH_ERROR</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1507"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">goto</highlight><highlight class="normal"><sp/><ref refid="proxy_8c_1a11614f44ef4d939bdd984953346a7572" kindref="member">error</ref>;</highlight></codeline>
<codeline lineno="1508"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="1509"><highlight class="normal"></highlight></codeline>
<codeline lineno="1510"><highlight class="normal">out:</highlight></codeline>
<codeline lineno="1511"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal">)(origlen<sp/>-<sp/>len);</highlight></codeline>
<codeline lineno="1512"><highlight class="normal"></highlight></codeline>
<codeline lineno="1513"><highlight class="normal"><ref refid="proxy_8c_1a11614f44ef4d939bdd984953346a7572" kindref="member">error</ref>:</highlight></codeline>
<codeline lineno="1514"><highlight class="normal"><sp/><sp/><ref refid="libssh_8h_1ac8802ff7f5348d0145dab5242623f740" kindref="member">ssh_buffer_reinit</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1af0aed60c1e529bbfdcb483fd80bf98a0" kindref="member">out_buffer</ref>);</highlight></codeline>
<codeline lineno="1515"><highlight class="normal"></highlight></codeline>
<codeline lineno="1516"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" kindref="member">SSH_ERROR</ref>;</highlight></codeline>
<codeline lineno="1517"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1518"><highlight class="normal"></highlight></codeline>
<codeline lineno="1536" refid="group__libssh__channel_1gadf53c5a5b501086af26d06cba3f1491f" refkind="member"><highlight class="normal">uint32_t<sp/><ref refid="group__libssh__channel_1gadf53c5a5b501086af26d06cba3f1491f" kindref="member">ssh_channel_window_size</ref>(<ref refid="structssh__channel__struct" kindref="compound">ssh_channel</ref><sp/>channel)<sp/>{</highlight></codeline>
<codeline lineno="1537"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>channel-&gt;<ref refid="structssh__channel__struct_1a1b5936420da03e6b64aa8f900eb8ad0c" kindref="member">remote_window</ref>;</highlight></codeline>
<codeline lineno="1538"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1539"><highlight class="normal"></highlight></codeline>
<codeline lineno="1553" refid="group__libssh__channel_1ga5d658df773ba854b35ff9f905341e2fb" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="group__libssh__channel_1ga5d658df773ba854b35ff9f905341e2fb" kindref="member">ssh_channel_write</ref>(<ref refid="structssh__channel__struct" kindref="compound">ssh_channel</ref><sp/>channel,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>*<ref refid="structssh__iterator_1a4cc4eb8c8599a487e7e3321d32a9e9cd" kindref="member">data</ref>,<sp/>uint32_t<sp/>len)<sp/>{</highlight></codeline>
<codeline lineno="1554"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="group__libssh__channel_1ga918e9bde297309e977a872bc62c0d260" kindref="member">channel_write_common</ref>(channel,<sp/><ref refid="structssh__iterator_1a4cc4eb8c8599a487e7e3321d32a9e9cd" kindref="member">data</ref>,<sp/>len,<sp/>0);</highlight></codeline>
<codeline lineno="1555"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1556"><highlight class="normal"></highlight></codeline>
<codeline lineno="1566" refid="group__libssh__channel_1gaaafcda943c96ddb91e5c28c0bdee7045" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="group__libssh__channel_1gaaafcda943c96ddb91e5c28c0bdee7045" kindref="member">ssh_channel_is_open</ref>(<ref refid="structssh__channel__struct" kindref="compound">ssh_channel</ref><sp/>channel)<sp/>{</highlight></codeline>
<codeline lineno="1567"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(channel<sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="1568"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>0;</highlight></codeline>
<codeline lineno="1569"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1570"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>(channel-&gt;<ref refid="structssh__channel__struct_1a272b198e279fa672afeaf9f2e610eb04" kindref="member">state</ref><sp/>==<sp/><ref refid="channels_8h_1a5a002159e5db31d156bb2a8ce8a10cd1a488a78707192c35250392423b5058e2b" kindref="member">SSH_CHANNEL_STATE_OPEN</ref><sp/>&amp;&amp;<sp/>channel-&gt;<ref refid="structssh__channel__struct_1a0832dc830d09accd2f3a8f8349c3faf2" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a729d3c7f6ae20cb5a00ac7cd28a630f7" kindref="member">alive</ref><sp/>!=<sp/>0);</highlight></codeline>
<codeline lineno="1571"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1572"><highlight class="normal"></highlight></codeline>
<codeline lineno="1582" refid="group__libssh__channel_1gab2720b44cb7f1dfe2b38ffe07c2f45c7" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="group__libssh__channel_1gab2720b44cb7f1dfe2b38ffe07c2f45c7" kindref="member">ssh_channel_is_closed</ref>(<ref refid="structssh__channel__struct" kindref="compound">ssh_channel</ref><sp/>channel)<sp/>{</highlight></codeline>
<codeline lineno="1583"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(channel<sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="1584"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" kindref="member">SSH_ERROR</ref>;</highlight></codeline>
<codeline lineno="1585"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1586"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>(channel-&gt;<ref refid="structssh__channel__struct_1a272b198e279fa672afeaf9f2e610eb04" kindref="member">state</ref><sp/>!=<sp/><ref refid="channels_8h_1a5a002159e5db31d156bb2a8ce8a10cd1a488a78707192c35250392423b5058e2b" kindref="member">SSH_CHANNEL_STATE_OPEN</ref><sp/>||<sp/>channel-&gt;<ref refid="structssh__channel__struct_1a0832dc830d09accd2f3a8f8349c3faf2" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a729d3c7f6ae20cb5a00ac7cd28a630f7" kindref="member">alive</ref><sp/>==<sp/>0);</highlight></codeline>
<codeline lineno="1587"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1588"><highlight class="normal"></highlight></codeline>
<codeline lineno="1596" refid="group__libssh__channel_1gab535264029443d77214c0615a0788b0a" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="group__libssh__channel_1gab535264029443d77214c0615a0788b0a" kindref="member">ssh_channel_is_eof</ref>(<ref refid="structssh__channel__struct" kindref="compound">ssh_channel</ref><sp/>channel)<sp/>{</highlight></codeline>
<codeline lineno="1597"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(channel<sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="1598"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" kindref="member">SSH_ERROR</ref>;</highlight></codeline>
<codeline lineno="1599"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="1600"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>((channel-&gt;<ref refid="structssh__channel__struct_1a8ae1473aafd716256ce762d0115b2321" kindref="member">stdout_buffer</ref><sp/>&amp;&amp;</highlight></codeline>
<codeline lineno="1601"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="libssh_8h_1a61400c7267feb254046cd606a3fdfdbc" kindref="member">ssh_buffer_get_len</ref>(channel-&gt;<ref refid="structssh__channel__struct_1a8ae1473aafd716256ce762d0115b2321" kindref="member">stdout_buffer</ref>)<sp/>&gt;<sp/>0)<sp/>||</highlight></codeline>
<codeline lineno="1602"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>(channel-&gt;<ref refid="structssh__channel__struct_1a6806319dfa8f417bbad93f6481ad99d4" kindref="member">stderr_buffer</ref><sp/>&amp;&amp;</highlight></codeline>
<codeline lineno="1603"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="libssh_8h_1a61400c7267feb254046cd606a3fdfdbc" kindref="member">ssh_buffer_get_len</ref>(channel-&gt;<ref refid="structssh__channel__struct_1a6806319dfa8f417bbad93f6481ad99d4" kindref="member">stderr_buffer</ref>)<sp/>&gt;<sp/>0))<sp/>{</highlight></codeline>
<codeline lineno="1604"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>0;</highlight></codeline>
<codeline lineno="1605"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="1606"><highlight class="normal"></highlight></codeline>
<codeline lineno="1607"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>(channel-&gt;<ref refid="structssh__channel__struct_1a01fee161bb195c61e434e9bc7b330187" kindref="member">remote_eof</ref><sp/>!=<sp/>0);</highlight></codeline>
<codeline lineno="1608"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1609"><highlight class="normal"></highlight></codeline>
<codeline lineno="1621" refid="group__libssh__channel_1ga1c00ed18679d9a8c5b971260b5df13a2" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="group__libssh__channel_1ga1c00ed18679d9a8c5b971260b5df13a2" kindref="member">ssh_channel_set_blocking</ref>(<ref refid="structssh__channel__struct" kindref="compound">ssh_channel</ref><sp/>channel,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>blocking)<sp/>{</highlight></codeline>
<codeline lineno="1622"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(channel<sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="1623"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1624"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="1625"><highlight class="normal"><sp/><sp/><ref refid="group__libssh__session_1ga2a29cff08855611be84d050e5bec73bc" kindref="member">ssh_set_blocking</ref>(channel-&gt;<ref refid="structssh__channel__struct_1a0832dc830d09accd2f3a8f8349c3faf2" kindref="member">session</ref>,blocking);</highlight></codeline>
<codeline lineno="1626"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1627"><highlight class="normal"></highlight></codeline>
<codeline lineno="1633" refid="group__libssh__channel_1ga198e96d111ee3dd2a0551fe10bd3ce16" refkind="member"><highlight class="normal"><ref refid="group__libssh__channel_1ga1f817e943f01e76843f60f9f9ca970f9" kindref="member">SSH_PACKET_CALLBACK</ref>(ssh_packet_channel_success){</highlight></codeline>
<codeline lineno="1634"><highlight class="normal"><sp/><sp/><ref refid="structssh__channel__struct" kindref="compound">ssh_channel</ref><sp/>channel;</highlight></codeline>
<codeline lineno="1635"><highlight class="normal"><sp/><sp/>(void)type;</highlight></codeline>
<codeline lineno="1636"><highlight class="normal"><sp/><sp/>(void)<ref refid="ssh__client_8c_1a14871705f45ccdc5bb9f4549efd8e119" kindref="member">user</ref>;</highlight></codeline>
<codeline lineno="1637"><highlight class="normal"></highlight></codeline>
<codeline lineno="1638"><highlight class="normal"><sp/><sp/>channel=<ref refid="group__libssh__channel_1ga41254c9dd24ac1ae9ad9c0edd3825dee" kindref="member">channel_from_msg</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>,packet);</highlight></codeline>
<codeline lineno="1639"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(channel<sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="1640"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="priv_8h_1aa21fd8a7a609329603b7b16da7939fca" kindref="member">SSH_LOG</ref>(<ref refid="group__libssh__log_1ggadf764cbdea00d65edcd07bb9953ad2b7a926c933f61d1afa64003c1cc66f6a01c" kindref="member">SSH_LOG_FUNCTIONS</ref>,<sp/></highlight><highlight class="stringliteral">&quot;%s&quot;</highlight><highlight class="normal">,<sp/><ref refid="group__libssh__error_1ga9241586665bf21f823806473fc386258" kindref="member">ssh_get_error</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>));</highlight></codeline>
<codeline lineno="1641"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="group__libssh__callbacks_1gac29df803aa1295d6a498c1b081f3b494" kindref="member">SSH_PACKET_USED</ref>;</highlight></codeline>
<codeline lineno="1642"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="1643"><highlight class="normal"></highlight></codeline>
<codeline lineno="1644"><highlight class="normal"><sp/><sp/><ref refid="priv_8h_1aa21fd8a7a609329603b7b16da7939fca" kindref="member">SSH_LOG</ref>(<ref refid="group__libssh__log_1ggadf764cbdea00d65edcd07bb9953ad2b7a6445dfe21592d69d9741d319538b6673" kindref="member">SSH_LOG_PACKET</ref>,</highlight></codeline>
<codeline lineno="1645"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Received<sp/>SSH_CHANNEL_SUCCESS<sp/>on<sp/>channel<sp/>(%d:%d)&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="1646"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>channel-&gt;<ref refid="structssh__channel__struct_1a39cdc105ee0bbd1b7faea169db30f0a1" kindref="member">local_channel</ref>,</highlight></codeline>
<codeline lineno="1647"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>channel-&gt;<ref refid="structssh__channel__struct_1aa553acf6d12fffb1ae18b11196c2c0e9" kindref="member">remote_channel</ref>);</highlight></codeline>
<codeline lineno="1648"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(channel-&gt;<ref refid="structssh__channel__struct_1a25a8d874fbdccd50ecfff837ef69bad2" kindref="member">request_state</ref><sp/>!=<sp/><ref refid="channels_8h_1a774597eb1605e8b48cd065965fdc2325a1229a4614fb5d58a7bcd4d6b0bd4816e" kindref="member">SSH_CHANNEL_REQ_STATE_PENDING</ref>){</highlight></codeline>
<codeline lineno="1649"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="priv_8h_1aa21fd8a7a609329603b7b16da7939fca" kindref="member">SSH_LOG</ref>(<ref refid="libssh_8h_1a1c08cc9177a5598e0675abfb833d2993" kindref="member">SSH_LOG_RARE</ref>,<sp/></highlight><highlight class="stringliteral">&quot;SSH_CHANNEL_SUCCESS<sp/>received<sp/>in<sp/>incorrect<sp/>state<sp/>%d&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="1650"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>channel-&gt;<ref refid="structssh__channel__struct_1a25a8d874fbdccd50ecfff837ef69bad2" kindref="member">request_state</ref>);</highlight></codeline>
<codeline lineno="1651"><highlight class="normal"><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="1652"><highlight class="normal"><sp/><sp/><sp/><sp/>channel-&gt;<ref refid="structssh__channel__struct_1a25a8d874fbdccd50ecfff837ef69bad2" kindref="member">request_state</ref>=<ref refid="channels_8h_1a774597eb1605e8b48cd065965fdc2325a4054be6a6327c97579cb9dce89c90590" kindref="member">SSH_CHANNEL_REQ_STATE_ACCEPTED</ref>;</highlight></codeline>
<codeline lineno="1653"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="1654"><highlight class="normal"></highlight></codeline>
<codeline lineno="1655"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="group__libssh__callbacks_1gac29df803aa1295d6a498c1b081f3b494" kindref="member">SSH_PACKET_USED</ref>;</highlight></codeline>
<codeline lineno="1656"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1657"><highlight class="normal"></highlight></codeline>
<codeline lineno="1663" refid="group__libssh__channel_1gad05566d70f79b960a8ffdddbd65600cb" refkind="member"><highlight class="normal"><ref refid="group__libssh__channel_1ga1f817e943f01e76843f60f9f9ca970f9" kindref="member">SSH_PACKET_CALLBACK</ref>(ssh_packet_channel_failure){</highlight></codeline>
<codeline lineno="1664"><highlight class="normal"><sp/><sp/><ref refid="structssh__channel__struct" kindref="compound">ssh_channel</ref><sp/>channel;</highlight></codeline>
<codeline lineno="1665"><highlight class="normal"><sp/><sp/>(void)type;</highlight></codeline>
<codeline lineno="1666"><highlight class="normal"><sp/><sp/>(void)<ref refid="ssh__client_8c_1a14871705f45ccdc5bb9f4549efd8e119" kindref="member">user</ref>;</highlight></codeline>
<codeline lineno="1667"><highlight class="normal"></highlight></codeline>
<codeline lineno="1668"><highlight class="normal"><sp/><sp/>channel=<ref refid="group__libssh__channel_1ga41254c9dd24ac1ae9ad9c0edd3825dee" kindref="member">channel_from_msg</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>,packet);</highlight></codeline>
<codeline lineno="1669"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(channel<sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="1670"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="priv_8h_1aa21fd8a7a609329603b7b16da7939fca" kindref="member">SSH_LOG</ref>(<ref refid="group__libssh__log_1ggadf764cbdea00d65edcd07bb9953ad2b7a926c933f61d1afa64003c1cc66f6a01c" kindref="member">SSH_LOG_FUNCTIONS</ref>,<sp/></highlight><highlight class="stringliteral">&quot;%s&quot;</highlight><highlight class="normal">,<sp/><ref refid="group__libssh__error_1ga9241586665bf21f823806473fc386258" kindref="member">ssh_get_error</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>));</highlight></codeline>
<codeline lineno="1671"><highlight class="normal"></highlight></codeline>
<codeline lineno="1672"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="group__libssh__callbacks_1gac29df803aa1295d6a498c1b081f3b494" kindref="member">SSH_PACKET_USED</ref>;</highlight></codeline>
<codeline lineno="1673"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="1674"><highlight class="normal"></highlight></codeline>
<codeline lineno="1675"><highlight class="normal"><sp/><sp/><ref refid="priv_8h_1aa21fd8a7a609329603b7b16da7939fca" kindref="member">SSH_LOG</ref>(<ref refid="group__libssh__log_1ggadf764cbdea00d65edcd07bb9953ad2b7a6445dfe21592d69d9741d319538b6673" kindref="member">SSH_LOG_PACKET</ref>,</highlight></codeline>
<codeline lineno="1676"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Received<sp/>SSH_CHANNEL_FAILURE<sp/>on<sp/>channel<sp/>(%d:%d)&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="1677"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>channel-&gt;<ref refid="structssh__channel__struct_1a39cdc105ee0bbd1b7faea169db30f0a1" kindref="member">local_channel</ref>,</highlight></codeline>
<codeline lineno="1678"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>channel-&gt;<ref refid="structssh__channel__struct_1aa553acf6d12fffb1ae18b11196c2c0e9" kindref="member">remote_channel</ref>);</highlight></codeline>
<codeline lineno="1679"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(channel-&gt;<ref refid="structssh__channel__struct_1a25a8d874fbdccd50ecfff837ef69bad2" kindref="member">request_state</ref><sp/>!=<sp/><ref refid="channels_8h_1a774597eb1605e8b48cd065965fdc2325a1229a4614fb5d58a7bcd4d6b0bd4816e" kindref="member">SSH_CHANNEL_REQ_STATE_PENDING</ref>){</highlight></codeline>
<codeline lineno="1680"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="priv_8h_1aa21fd8a7a609329603b7b16da7939fca" kindref="member">SSH_LOG</ref>(<ref refid="libssh_8h_1a1c08cc9177a5598e0675abfb833d2993" kindref="member">SSH_LOG_RARE</ref>,<sp/></highlight><highlight class="stringliteral">&quot;SSH_CHANNEL_FAILURE<sp/>received<sp/>in<sp/>incorrect<sp/>state<sp/>%d&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="1681"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>channel-&gt;<ref refid="structssh__channel__struct_1a25a8d874fbdccd50ecfff837ef69bad2" kindref="member">request_state</ref>);</highlight></codeline>
<codeline lineno="1682"><highlight class="normal"><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="1683"><highlight class="normal"><sp/><sp/><sp/><sp/>channel-&gt;<ref refid="structssh__channel__struct_1a25a8d874fbdccd50ecfff837ef69bad2" kindref="member">request_state</ref>=<ref refid="channels_8h_1a774597eb1605e8b48cd065965fdc2325a4947de111ac917be11de88f4e9147d14" kindref="member">SSH_CHANNEL_REQ_STATE_DENIED</ref>;</highlight></codeline>
<codeline lineno="1684"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="1685"><highlight class="normal"></highlight></codeline>
<codeline lineno="1686"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="group__libssh__callbacks_1gac29df803aa1295d6a498c1b081f3b494" kindref="member">SSH_PACKET_USED</ref>;</highlight></codeline>
<codeline lineno="1687"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1688"><highlight class="normal"></highlight></codeline>
<codeline lineno="1689" refid="group__libssh__channel_1gae3eefab282bb408e096fdeeeba676618" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="group__libssh__channel_1gae3eefab282bb408e096fdeeeba676618" kindref="member">ssh_channel_request_termination</ref>(</highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>*c){</highlight></codeline>
<codeline lineno="1690"><highlight class="normal"><sp/><sp/><ref refid="structssh__channel__struct" kindref="compound">ssh_channel</ref><sp/>channel<sp/>=<sp/>(<ref refid="libssh_8h_1aca32be8db7c865697a3de381dc7e9fc3" kindref="member">ssh_channel</ref>)c;</highlight></codeline>
<codeline lineno="1691"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(channel-&gt;<ref refid="structssh__channel__struct_1a25a8d874fbdccd50ecfff837ef69bad2" kindref="member">request_state</ref><sp/>!=<sp/><ref refid="channels_8h_1a774597eb1605e8b48cd065965fdc2325a1229a4614fb5d58a7bcd4d6b0bd4816e" kindref="member">SSH_CHANNEL_REQ_STATE_PENDING</ref><sp/>||</highlight></codeline>
<codeline lineno="1692"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>channel-&gt;<ref refid="structssh__channel__struct_1a0832dc830d09accd2f3a8f8349c3faf2" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a6f74d1a1eb6ed715b1073b67caa18460" kindref="member">session_state</ref><sp/>==<sp/><ref refid="session_8h_1a9bbd1d5ae11485e27279be6ad461992ca855474fc84a2fb170fcb72546af8eeb8" kindref="member">SSH_SESSION_STATE_ERROR</ref>)</highlight></codeline>
<codeline lineno="1693"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>1;</highlight></codeline>
<codeline lineno="1694"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1695"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>0;</highlight></codeline>
<codeline lineno="1696"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1697"><highlight class="normal"></highlight></codeline>
<codeline lineno="1698" refid="group__libssh__channel_1gaee35ccabe6998568d138d35f538765d9" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="group__libssh__channel_1gaee35ccabe6998568d138d35f538765d9" kindref="member">channel_request</ref>(<ref refid="structssh__channel__struct" kindref="compound">ssh_channel</ref><sp/>channel,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*request,</highlight></codeline>
<codeline lineno="1699"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="structssh__buffer__struct" kindref="compound">ssh_buffer</ref><sp/><ref refid="benchmarks_8c_1aff2566f4c366b48d73479bef43ee4d2e" kindref="member">buffer</ref>,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>reply)<sp/>{</highlight></codeline>
<codeline lineno="1700"><highlight class="normal"><sp/><sp/><ref refid="structssh__session__struct" kindref="compound">ssh_session</ref><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref><sp/>=<sp/>channel-&gt;<ref refid="structssh__channel__struct_1a0832dc830d09accd2f3a8f8349c3faf2" kindref="member">session</ref>;</highlight></codeline>
<codeline lineno="1701"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" kindref="member">SSH_ERROR</ref>;</highlight></codeline>
<codeline lineno="1702"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>ret;</highlight></codeline>
<codeline lineno="1703"><highlight class="normal"></highlight></codeline>
<codeline lineno="1704"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">switch</highlight><highlight class="normal">(channel-&gt;<ref refid="structssh__channel__struct_1a25a8d874fbdccd50ecfff837ef69bad2" kindref="member">request_state</ref>){</highlight></codeline>
<codeline lineno="1705"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="channels_8h_1a774597eb1605e8b48cd065965fdc2325a98c7a3dcf02759118261e2bac4d6e421" kindref="member">SSH_CHANNEL_REQ_STATE_NONE</ref>:</highlight></codeline>
<codeline lineno="1706"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1707"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">default</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="1708"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">goto</highlight><highlight class="normal"><sp/>pending;</highlight></codeline>
<codeline lineno="1709"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="1710"><highlight class="normal"></highlight></codeline>
<codeline lineno="1711"><highlight class="normal"><sp/><sp/>ret<sp/>=<sp/><ref refid="buffer_8h_1ae17848a86043f0abfc60c1c4f6126ccd" kindref="member">ssh_buffer_pack</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1af0aed60c1e529bbfdcb483fd80bf98a0" kindref="member">out_buffer</ref>,</highlight></codeline>
<codeline lineno="1712"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;bdsb&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="1713"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ssh2_8h_1a553c9488e17f091fa39dd01f7abc48d8" kindref="member">SSH2_MSG_CHANNEL_REQUEST</ref>,</highlight></codeline>
<codeline lineno="1714"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>channel-&gt;<ref refid="structssh__channel__struct_1aa553acf6d12fffb1ae18b11196c2c0e9" kindref="member">remote_channel</ref>,</highlight></codeline>
<codeline lineno="1715"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>request,</highlight></codeline>
<codeline lineno="1716"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>reply<sp/>==<sp/>0<sp/>?<sp/>0<sp/>:<sp/>1);</highlight></codeline>
<codeline lineno="1717"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(ret<sp/>!=<sp/><ref refid="libssh_8h_1ac1ee1d1e917456d4760a94a18015377d" kindref="member">SSH_OK</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1718"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="priv_8h_1ae280c413c792e04237f000841ac8ce44" kindref="member">ssh_set_error_oom</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>);</highlight></codeline>
<codeline lineno="1719"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">goto</highlight><highlight class="normal"><sp/><ref refid="proxy_8c_1a11614f44ef4d939bdd984953346a7572" kindref="member">error</ref>;</highlight></codeline>
<codeline lineno="1720"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="1721"><highlight class="normal"></highlight></codeline>
<codeline lineno="1722"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="benchmarks_8c_1aff2566f4c366b48d73479bef43ee4d2e" kindref="member">buffer</ref><sp/>!=<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="1723"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="libssh_8h_1a92d37237bf129961367accd4a9e0dcfc" kindref="member">ssh_buffer_add_data</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1af0aed60c1e529bbfdcb483fd80bf98a0" kindref="member">out_buffer</ref>,<sp/><ref refid="libssh_8h_1a240b02fb7c0475fbb5996d1f759221ee" kindref="member">ssh_buffer_get</ref>(<ref refid="benchmarks_8c_1aff2566f4c366b48d73479bef43ee4d2e" kindref="member">buffer</ref>),</highlight></codeline>
<codeline lineno="1724"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="libssh_8h_1a61400c7267feb254046cd606a3fdfdbc" kindref="member">ssh_buffer_get_len</ref>(<ref refid="benchmarks_8c_1aff2566f4c366b48d73479bef43ee4d2e" kindref="member">buffer</ref>))<sp/>&lt;<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="1725"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="priv_8h_1ae280c413c792e04237f000841ac8ce44" kindref="member">ssh_set_error_oom</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>);</highlight></codeline>
<codeline lineno="1726"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">goto</highlight><highlight class="normal"><sp/><ref refid="proxy_8c_1a11614f44ef4d939bdd984953346a7572" kindref="member">error</ref>;</highlight></codeline>
<codeline lineno="1727"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1728"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="1729"><highlight class="normal"><sp/><sp/>channel-&gt;<ref refid="structssh__channel__struct_1a25a8d874fbdccd50ecfff837ef69bad2" kindref="member">request_state</ref><sp/>=<sp/><ref refid="channels_8h_1a774597eb1605e8b48cd065965fdc2325a1229a4614fb5d58a7bcd4d6b0bd4816e" kindref="member">SSH_CHANNEL_REQ_STATE_PENDING</ref>;</highlight></codeline>
<codeline lineno="1730"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="packet_8h_1a7e6c7ed74c23ace432476aa8a6841140" kindref="member">ssh_packet_send</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>)<sp/>==<sp/><ref refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" kindref="member">SSH_ERROR</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1731"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref>;</highlight></codeline>
<codeline lineno="1732"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="1733"><highlight class="normal"></highlight></codeline>
<codeline lineno="1734"><highlight class="normal"><sp/><sp/><ref refid="priv_8h_1aa21fd8a7a609329603b7b16da7939fca" kindref="member">SSH_LOG</ref>(<ref refid="group__libssh__log_1ggadf764cbdea00d65edcd07bb9953ad2b7a6445dfe21592d69d9741d319538b6673" kindref="member">SSH_LOG_PACKET</ref>,</highlight></codeline>
<codeline lineno="1735"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Sent<sp/>a<sp/>SSH_MSG_CHANNEL_REQUEST<sp/>%s&quot;</highlight><highlight class="normal">,<sp/>request);</highlight></codeline>
<codeline lineno="1736"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(reply<sp/>==<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="1737"><highlight class="normal"><sp/><sp/><sp/><sp/>channel-&gt;<ref refid="structssh__channel__struct_1a25a8d874fbdccd50ecfff837ef69bad2" kindref="member">request_state</ref><sp/>=<sp/><ref refid="channels_8h_1a774597eb1605e8b48cd065965fdc2325a98c7a3dcf02759118261e2bac4d6e421" kindref="member">SSH_CHANNEL_REQ_STATE_NONE</ref>;</highlight></codeline>
<codeline lineno="1738"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="libssh_8h_1ac1ee1d1e917456d4760a94a18015377d" kindref="member">SSH_OK</ref>;</highlight></codeline>
<codeline lineno="1739"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="1740"><highlight class="normal">pending:</highlight></codeline>
<codeline lineno="1741"><highlight class="normal"><sp/><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="group__libssh__session_1ga4b84e1ae757c0d4007a5eefdf4651694" kindref="member">ssh_handle_packets_termination</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>,</highlight></codeline>
<codeline lineno="1742"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="session_8h_1aa8c8d35c7f83d7b00218ebadfac2254b" kindref="member">SSH_TIMEOUT_DEFAULT</ref>,</highlight></codeline>
<codeline lineno="1743"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="group__libssh__channel_1gae3eefab282bb408e096fdeeeba676618" kindref="member">ssh_channel_request_termination</ref>,</highlight></codeline>
<codeline lineno="1744"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>channel);</highlight></codeline>
<codeline lineno="1745"><highlight class="normal"></highlight></codeline>
<codeline lineno="1746"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a6f74d1a1eb6ed715b1073b67caa18460" kindref="member">session_state</ref><sp/>==<sp/><ref refid="session_8h_1a9bbd1d5ae11485e27279be6ad461992ca855474fc84a2fb170fcb72546af8eeb8" kindref="member">SSH_SESSION_STATE_ERROR</ref><sp/>||<sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>==<sp/><ref refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" kindref="member">SSH_ERROR</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1747"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>channel-&gt;<ref refid="structssh__channel__struct_1a25a8d874fbdccd50ecfff837ef69bad2" kindref="member">request_state</ref><sp/>=<sp/><ref refid="channels_8h_1a774597eb1605e8b48cd065965fdc2325a7d2c1ea4f49536c9bea8c1187d950378" kindref="member">SSH_CHANNEL_REQ_STATE_ERROR</ref>;</highlight></codeline>
<codeline lineno="1748"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="1749"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">/*<sp/>we<sp/>received<sp/>something<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1750"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">switch</highlight><highlight class="normal"><sp/>(channel-&gt;<ref refid="structssh__channel__struct_1a25a8d874fbdccd50ecfff837ef69bad2" kindref="member">request_state</ref>){</highlight></codeline>
<codeline lineno="1751"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="channels_8h_1a774597eb1605e8b48cd065965fdc2325a7d2c1ea4f49536c9bea8c1187d950378" kindref="member">SSH_CHANNEL_REQ_STATE_ERROR</ref>:</highlight></codeline>
<codeline lineno="1752"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref>=<ref refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" kindref="member">SSH_ERROR</ref>;</highlight></codeline>
<codeline lineno="1753"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1754"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="channels_8h_1a774597eb1605e8b48cd065965fdc2325a4947de111ac917be11de88f4e9147d14" kindref="member">SSH_CHANNEL_REQ_STATE_DENIED</ref>:</highlight></codeline>
<codeline lineno="1755"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="priv_8h_1a55177b3e8db90ca9adb435c44281963c" kindref="member">ssh_set_error</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>,<sp/><ref refid="libssh_8h_1a036b2b00fb04337a4d06d719d1b62be1ad1339fb4b92a9d25bdb99df5de5c4f88" kindref="member">SSH_REQUEST_DENIED</ref>,</highlight></codeline>
<codeline lineno="1756"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Channel<sp/>request<sp/>%s<sp/>failed&quot;</highlight><highlight class="normal">,<sp/>request);</highlight></codeline>
<codeline lineno="1757"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref>=<ref refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" kindref="member">SSH_ERROR</ref>;</highlight></codeline>
<codeline lineno="1758"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1759"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="channels_8h_1a774597eb1605e8b48cd065965fdc2325a4054be6a6327c97579cb9dce89c90590" kindref="member">SSH_CHANNEL_REQ_STATE_ACCEPTED</ref>:</highlight></codeline>
<codeline lineno="1760"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="priv_8h_1aa21fd8a7a609329603b7b16da7939fca" kindref="member">SSH_LOG</ref>(<ref refid="group__libssh__log_1ggadf764cbdea00d65edcd07bb9953ad2b7a75fa79e63947b66462db977d9b5ae27c" kindref="member">SSH_LOG_PROTOCOL</ref>,</highlight></codeline>
<codeline lineno="1761"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Channel<sp/>request<sp/>%s<sp/>success&quot;</highlight><highlight class="normal">,request);</highlight></codeline>
<codeline lineno="1762"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref>=<ref refid="libssh_8h_1ac1ee1d1e917456d4760a94a18015377d" kindref="member">SSH_OK</ref>;</highlight></codeline>
<codeline lineno="1763"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1764"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="channels_8h_1a774597eb1605e8b48cd065965fdc2325a1229a4614fb5d58a7bcd4d6b0bd4816e" kindref="member">SSH_CHANNEL_REQ_STATE_PENDING</ref>:</highlight></codeline>
<codeline lineno="1765"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="libssh_8h_1a9c57e4f6482106336045a4d25a55f28e" kindref="member">SSH_AGAIN</ref>;</highlight></codeline>
<codeline lineno="1766"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref>;</highlight></codeline>
<codeline lineno="1767"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="channels_8h_1a774597eb1605e8b48cd065965fdc2325a98c7a3dcf02759118261e2bac4d6e421" kindref="member">SSH_CHANNEL_REQ_STATE_NONE</ref>:</highlight></codeline>
<codeline lineno="1768"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Never<sp/>reached<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1769"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="priv_8h_1a55177b3e8db90ca9adb435c44281963c" kindref="member">ssh_set_error</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>,<sp/><ref refid="libssh_8h_1a036b2b00fb04337a4d06d719d1b62be1a86ff0b2e8da6ad8628efc556b6ce1887" kindref="member">SSH_FATAL</ref>,<sp/></highlight><highlight class="stringliteral">&quot;Invalid<sp/>state<sp/>in<sp/>channel_request()&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="1770"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref>=<ref refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" kindref="member">SSH_ERROR</ref>;</highlight></codeline>
<codeline lineno="1771"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1772"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="1773"><highlight class="normal"><sp/><sp/>channel-&gt;<ref refid="structssh__channel__struct_1a25a8d874fbdccd50ecfff837ef69bad2" kindref="member">request_state</ref>=<ref refid="channels_8h_1a774597eb1605e8b48cd065965fdc2325a98c7a3dcf02759118261e2bac4d6e421" kindref="member">SSH_CHANNEL_REQ_STATE_NONE</ref>;</highlight></codeline>
<codeline lineno="1774"><highlight class="normal"></highlight></codeline>
<codeline lineno="1775"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref>;</highlight></codeline>
<codeline lineno="1776"><highlight class="normal"><ref refid="proxy_8c_1a11614f44ef4d939bdd984953346a7572" kindref="member">error</ref>:</highlight></codeline>
<codeline lineno="1777"><highlight class="normal"><sp/><sp/><ref refid="libssh_8h_1ac8802ff7f5348d0145dab5242623f740" kindref="member">ssh_buffer_reinit</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1af0aed60c1e529bbfdcb483fd80bf98a0" kindref="member">out_buffer</ref>);</highlight></codeline>
<codeline lineno="1778"><highlight class="normal"></highlight></codeline>
<codeline lineno="1779"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref>;</highlight></codeline>
<codeline lineno="1780"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1781"><highlight class="normal"></highlight></codeline>
<codeline lineno="1798" refid="group__libssh__channel_1gabb175414352256e1602286e0ab50886c" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="group__libssh__channel_1gabb175414352256e1602286e0ab50886c" kindref="member">ssh_channel_request_pty_size</ref>(<ref refid="structssh__channel__struct" kindref="compound">ssh_channel</ref><sp/>channel,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*<ref refid="ssh__client_8c_1a029e0d76938d65623721b901853405a4" kindref="member">terminal</ref>,</highlight></codeline>
<codeline lineno="1799"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>col,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>row)<sp/>{</highlight></codeline>
<codeline lineno="1800"><highlight class="normal"><sp/><sp/><ref refid="structssh__session__struct" kindref="compound">ssh_session</ref><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>;</highlight></codeline>
<codeline lineno="1801"><highlight class="normal"><sp/><sp/><ref refid="structssh__buffer__struct" kindref="compound">ssh_buffer</ref><sp/><ref refid="benchmarks_8c_1aff2566f4c366b48d73479bef43ee4d2e" kindref="member">buffer</ref><sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="1802"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" kindref="member">SSH_ERROR</ref>;</highlight></codeline>
<codeline lineno="1803"><highlight class="normal"></highlight></codeline>
<codeline lineno="1804"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(channel<sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="1805"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" kindref="member">SSH_ERROR</ref>;</highlight></codeline>
<codeline lineno="1806"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="1807"><highlight class="normal"><sp/><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref><sp/>=<sp/>channel-&gt;<ref refid="structssh__channel__struct_1a0832dc830d09accd2f3a8f8349c3faf2" kindref="member">session</ref>;</highlight></codeline>
<codeline lineno="1808"><highlight class="normal"></highlight></codeline>
<codeline lineno="1809"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<ref refid="ssh__client_8c_1a029e0d76938d65623721b901853405a4" kindref="member">terminal</ref><sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="1810"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="priv_8h_1a351ea86857d33b3ba80b396e05c4517c" kindref="member">ssh_set_error_invalid</ref>(channel-&gt;<ref refid="structssh__channel__struct_1a0832dc830d09accd2f3a8f8349c3faf2" kindref="member">session</ref>);</highlight></codeline>
<codeline lineno="1811"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref>;</highlight></codeline>
<codeline lineno="1812"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="1813"><highlight class="normal"></highlight></codeline>
<codeline lineno="1814"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">switch</highlight><highlight class="normal">(channel-&gt;<ref refid="structssh__channel__struct_1a25a8d874fbdccd50ecfff837ef69bad2" kindref="member">request_state</ref>){</highlight></codeline>
<codeline lineno="1815"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="channels_8h_1a774597eb1605e8b48cd065965fdc2325a98c7a3dcf02759118261e2bac4d6e421" kindref="member">SSH_CHANNEL_REQ_STATE_NONE</ref>:</highlight></codeline>
<codeline lineno="1816"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1817"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">default</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="1818"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">goto</highlight><highlight class="normal"><sp/>pending;</highlight></codeline>
<codeline lineno="1819"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="1820"><highlight class="normal"></highlight></codeline>
<codeline lineno="1821"><highlight class="normal"><sp/><sp/><ref refid="benchmarks_8c_1aff2566f4c366b48d73479bef43ee4d2e" kindref="member">buffer</ref><sp/>=<sp/><ref refid="group__libssh__buffer_1ga7ecc914104a5bf0da485d3e42f6a7d3b" kindref="member">ssh_buffer_new</ref>();</highlight></codeline>
<codeline lineno="1822"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="benchmarks_8c_1aff2566f4c366b48d73479bef43ee4d2e" kindref="member">buffer</ref><sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="1823"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="priv_8h_1ae280c413c792e04237f000841ac8ce44" kindref="member">ssh_set_error_oom</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>);</highlight></codeline>
<codeline lineno="1824"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">goto</highlight><highlight class="normal"><sp/><ref refid="proxy_8c_1a11614f44ef4d939bdd984953346a7572" kindref="member">error</ref>;</highlight></codeline>
<codeline lineno="1825"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="1826"><highlight class="normal"></highlight></codeline>
<codeline lineno="1827"><highlight class="normal"><sp/><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="buffer_8h_1ae17848a86043f0abfc60c1c4f6126ccd" kindref="member">ssh_buffer_pack</ref>(<ref refid="benchmarks_8c_1aff2566f4c366b48d73479bef43ee4d2e" kindref="member">buffer</ref>,</highlight></codeline>
<codeline lineno="1828"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;sdddddb&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="1829"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ssh__client_8c_1a029e0d76938d65623721b901853405a4" kindref="member">terminal</ref>,</highlight></codeline>
<codeline lineno="1830"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>col,</highlight></codeline>
<codeline lineno="1831"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>row,</highlight></codeline>
<codeline lineno="1832"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0,<sp/></highlight><highlight class="comment">/*<sp/>pix<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1833"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0,<sp/></highlight><highlight class="comment">/*<sp/>pix<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1834"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>1,<sp/></highlight><highlight class="comment">/*<sp/>add<sp/>a<sp/>0byte<sp/>string<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1835"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0);</highlight></codeline>
<codeline lineno="1836"><highlight class="normal"></highlight></codeline>
<codeline lineno="1837"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>!=<sp/><ref refid="libssh_8h_1ac1ee1d1e917456d4760a94a18015377d" kindref="member">SSH_OK</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1838"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="priv_8h_1ae280c413c792e04237f000841ac8ce44" kindref="member">ssh_set_error_oom</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>);</highlight></codeline>
<codeline lineno="1839"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">goto</highlight><highlight class="normal"><sp/><ref refid="proxy_8c_1a11614f44ef4d939bdd984953346a7572" kindref="member">error</ref>;</highlight></codeline>
<codeline lineno="1840"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="1841"><highlight class="normal">pending:</highlight></codeline>
<codeline lineno="1842"><highlight class="normal"><sp/><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="group__libssh__channel_1gaee35ccabe6998568d138d35f538765d9" kindref="member">channel_request</ref>(channel,<sp/></highlight><highlight class="stringliteral">&quot;pty-req&quot;</highlight><highlight class="normal">,<sp/><ref refid="benchmarks_8c_1aff2566f4c366b48d73479bef43ee4d2e" kindref="member">buffer</ref>,<sp/>1);</highlight></codeline>
<codeline lineno="1843"><highlight class="normal"><ref refid="proxy_8c_1a11614f44ef4d939bdd984953346a7572" kindref="member">error</ref>:</highlight></codeline>
<codeline lineno="1844"><highlight class="normal"><sp/><sp/><ref refid="libssh_8h_1a8b09f7d6f7066de7ef8dab4ed7494a52" kindref="member">SSH_BUFFER_FREE</ref>(<ref refid="benchmarks_8c_1aff2566f4c366b48d73479bef43ee4d2e" kindref="member">buffer</ref>);</highlight></codeline>
<codeline lineno="1845"><highlight class="normal"></highlight></codeline>
<codeline lineno="1846"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref>;</highlight></codeline>
<codeline lineno="1847"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1848"><highlight class="normal"></highlight></codeline>
<codeline lineno="1861" refid="group__libssh__channel_1ga37c1cec33fe5a2f184768aba52e3a0db" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="group__libssh__channel_1ga37c1cec33fe5a2f184768aba52e3a0db" kindref="member">ssh_channel_request_pty</ref>(<ref refid="structssh__channel__struct" kindref="compound">ssh_channel</ref><sp/>channel)<sp/>{</highlight></codeline>
<codeline lineno="1862"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="group__libssh__channel_1gabb175414352256e1602286e0ab50886c" kindref="member">ssh_channel_request_pty_size</ref>(channel,<sp/></highlight><highlight class="stringliteral">&quot;xterm&quot;</highlight><highlight class="normal">,<sp/>80,<sp/>24);</highlight></codeline>
<codeline lineno="1863"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1864"><highlight class="normal"></highlight></codeline>
<codeline lineno="1880" refid="group__libssh__channel_1gaf5d55c90f3d98c583df23d21905c1127" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="group__libssh__channel_1gaf5d55c90f3d98c583df23d21905c1127" kindref="member">ssh_channel_change_pty_size</ref>(<ref refid="structssh__channel__struct" kindref="compound">ssh_channel</ref><sp/>channel,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>cols,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>rows)<sp/>{</highlight></codeline>
<codeline lineno="1881"><highlight class="normal"><sp/><sp/><ref refid="structssh__session__struct" kindref="compound">ssh_session</ref><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref><sp/>=<sp/>channel-&gt;<ref refid="structssh__channel__struct_1a0832dc830d09accd2f3a8f8349c3faf2" kindref="member">session</ref>;</highlight></codeline>
<codeline lineno="1882"><highlight class="normal"><sp/><sp/><ref refid="structssh__buffer__struct" kindref="compound">ssh_buffer</ref><sp/><ref refid="benchmarks_8c_1aff2566f4c366b48d73479bef43ee4d2e" kindref="member">buffer</ref><sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="1883"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" kindref="member">SSH_ERROR</ref>;</highlight></codeline>
<codeline lineno="1884"><highlight class="normal"></highlight></codeline>
<codeline lineno="1885"><highlight class="normal"><sp/><sp/><ref refid="benchmarks_8c_1aff2566f4c366b48d73479bef43ee4d2e" kindref="member">buffer</ref><sp/>=<sp/><ref refid="group__libssh__buffer_1ga7ecc914104a5bf0da485d3e42f6a7d3b" kindref="member">ssh_buffer_new</ref>();</highlight></codeline>
<codeline lineno="1886"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="benchmarks_8c_1aff2566f4c366b48d73479bef43ee4d2e" kindref="member">buffer</ref><sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="1887"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="priv_8h_1ae280c413c792e04237f000841ac8ce44" kindref="member">ssh_set_error_oom</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>);</highlight></codeline>
<codeline lineno="1888"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">goto</highlight><highlight class="normal"><sp/><ref refid="proxy_8c_1a11614f44ef4d939bdd984953346a7572" kindref="member">error</ref>;</highlight></codeline>
<codeline lineno="1889"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="1890"><highlight class="normal"></highlight></codeline>
<codeline lineno="1891"><highlight class="normal"><sp/><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="buffer_8h_1ae17848a86043f0abfc60c1c4f6126ccd" kindref="member">ssh_buffer_pack</ref>(<ref refid="benchmarks_8c_1aff2566f4c366b48d73479bef43ee4d2e" kindref="member">buffer</ref>,</highlight></codeline>
<codeline lineno="1892"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;dddd&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="1893"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>cols,</highlight></codeline>
<codeline lineno="1894"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rows,</highlight></codeline>
<codeline lineno="1895"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0,<sp/></highlight><highlight class="comment">/*<sp/>pix<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1896"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0<sp/></highlight><highlight class="comment">/*<sp/>pix<sp/>*/</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="1897"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>!=<sp/><ref refid="libssh_8h_1ac1ee1d1e917456d4760a94a18015377d" kindref="member">SSH_OK</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1898"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="priv_8h_1ae280c413c792e04237f000841ac8ce44" kindref="member">ssh_set_error_oom</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>);</highlight></codeline>
<codeline lineno="1899"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">goto</highlight><highlight class="normal"><sp/><ref refid="proxy_8c_1a11614f44ef4d939bdd984953346a7572" kindref="member">error</ref>;</highlight></codeline>
<codeline lineno="1900"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="1901"><highlight class="normal"></highlight></codeline>
<codeline lineno="1902"><highlight class="normal"><sp/><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="group__libssh__channel_1gaee35ccabe6998568d138d35f538765d9" kindref="member">channel_request</ref>(channel,<sp/></highlight><highlight class="stringliteral">&quot;window-change&quot;</highlight><highlight class="normal">,<sp/><ref refid="benchmarks_8c_1aff2566f4c366b48d73479bef43ee4d2e" kindref="member">buffer</ref>,<sp/>0);</highlight></codeline>
<codeline lineno="1903"><highlight class="normal"><ref refid="proxy_8c_1a11614f44ef4d939bdd984953346a7572" kindref="member">error</ref>:</highlight></codeline>
<codeline lineno="1904"><highlight class="normal"><sp/><sp/><ref refid="libssh_8h_1a8b09f7d6f7066de7ef8dab4ed7494a52" kindref="member">SSH_BUFFER_FREE</ref>(<ref refid="benchmarks_8c_1aff2566f4c366b48d73479bef43ee4d2e" kindref="member">buffer</ref>);</highlight></codeline>
<codeline lineno="1905"><highlight class="normal"></highlight></codeline>
<codeline lineno="1906"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref>;</highlight></codeline>
<codeline lineno="1907"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1908"><highlight class="normal"></highlight></codeline>
<codeline lineno="1919" refid="group__libssh__channel_1gaed4c5fb30c9df2b2548421ccf4e81bf1" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="group__libssh__channel_1gaed4c5fb30c9df2b2548421ccf4e81bf1" kindref="member">ssh_channel_request_shell</ref>(<ref refid="structssh__channel__struct" kindref="compound">ssh_channel</ref><sp/>channel)<sp/>{</highlight></codeline>
<codeline lineno="1920"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(channel<sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="1921"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" kindref="member">SSH_ERROR</ref>;</highlight></codeline>
<codeline lineno="1922"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1923"><highlight class="normal"></highlight></codeline>
<codeline lineno="1924"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="group__libssh__channel_1gaee35ccabe6998568d138d35f538765d9" kindref="member">channel_request</ref>(channel,<sp/></highlight><highlight class="stringliteral">&quot;shell&quot;</highlight><highlight class="normal">,<sp/>NULL,<sp/>1);</highlight></codeline>
<codeline lineno="1925"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1926"><highlight class="normal"></highlight></codeline>
<codeline lineno="1941" refid="group__libssh__channel_1ga06024b070f9b2a3d6964b79ae36695b7" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="group__libssh__channel_1ga06024b070f9b2a3d6964b79ae36695b7" kindref="member">ssh_channel_request_subsystem</ref>(<ref refid="structssh__channel__struct" kindref="compound">ssh_channel</ref><sp/>channel,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*subsys)<sp/>{</highlight></codeline>
<codeline lineno="1942"><highlight class="normal"><sp/><sp/><ref refid="structssh__buffer__struct" kindref="compound">ssh_buffer</ref><sp/><ref refid="benchmarks_8c_1aff2566f4c366b48d73479bef43ee4d2e" kindref="member">buffer</ref><sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="1943"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" kindref="member">SSH_ERROR</ref>;</highlight></codeline>
<codeline lineno="1944"><highlight class="normal"></highlight></codeline>
<codeline lineno="1945"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(channel<sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="1946"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" kindref="member">SSH_ERROR</ref>;</highlight></codeline>
<codeline lineno="1947"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="1948"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(subsys<sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="1949"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="priv_8h_1a351ea86857d33b3ba80b396e05c4517c" kindref="member">ssh_set_error_invalid</ref>(channel-&gt;<ref refid="structssh__channel__struct_1a0832dc830d09accd2f3a8f8349c3faf2" kindref="member">session</ref>);</highlight></codeline>
<codeline lineno="1950"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref>;</highlight></codeline>
<codeline lineno="1951"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="1952"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">switch</highlight><highlight class="normal">(channel-&gt;<ref refid="structssh__channel__struct_1a25a8d874fbdccd50ecfff837ef69bad2" kindref="member">request_state</ref>){</highlight></codeline>
<codeline lineno="1953"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="channels_8h_1a774597eb1605e8b48cd065965fdc2325a98c7a3dcf02759118261e2bac4d6e421" kindref="member">SSH_CHANNEL_REQ_STATE_NONE</ref>:</highlight></codeline>
<codeline lineno="1954"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1955"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">default</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="1956"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">goto</highlight><highlight class="normal"><sp/>pending;</highlight></codeline>
<codeline lineno="1957"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="1958"><highlight class="normal"></highlight></codeline>
<codeline lineno="1959"><highlight class="normal"><sp/><sp/><ref refid="benchmarks_8c_1aff2566f4c366b48d73479bef43ee4d2e" kindref="member">buffer</ref><sp/>=<sp/><ref refid="group__libssh__buffer_1ga7ecc914104a5bf0da485d3e42f6a7d3b" kindref="member">ssh_buffer_new</ref>();</highlight></codeline>
<codeline lineno="1960"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="benchmarks_8c_1aff2566f4c366b48d73479bef43ee4d2e" kindref="member">buffer</ref><sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="1961"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="priv_8h_1ae280c413c792e04237f000841ac8ce44" kindref="member">ssh_set_error_oom</ref>(channel-&gt;<ref refid="structssh__channel__struct_1a0832dc830d09accd2f3a8f8349c3faf2" kindref="member">session</ref>);</highlight></codeline>
<codeline lineno="1962"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">goto</highlight><highlight class="normal"><sp/><ref refid="proxy_8c_1a11614f44ef4d939bdd984953346a7572" kindref="member">error</ref>;</highlight></codeline>
<codeline lineno="1963"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="1964"><highlight class="normal"></highlight></codeline>
<codeline lineno="1965"><highlight class="normal"><sp/><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="buffer_8h_1ae17848a86043f0abfc60c1c4f6126ccd" kindref="member">ssh_buffer_pack</ref>(<ref refid="benchmarks_8c_1aff2566f4c366b48d73479bef43ee4d2e" kindref="member">buffer</ref>,<sp/></highlight><highlight class="stringliteral">&quot;s&quot;</highlight><highlight class="normal">,<sp/>subsys);</highlight></codeline>
<codeline lineno="1966"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>!=<sp/><ref refid="libssh_8h_1ac1ee1d1e917456d4760a94a18015377d" kindref="member">SSH_OK</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1967"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="priv_8h_1ae280c413c792e04237f000841ac8ce44" kindref="member">ssh_set_error_oom</ref>(channel-&gt;<ref refid="structssh__channel__struct_1a0832dc830d09accd2f3a8f8349c3faf2" kindref="member">session</ref>);</highlight></codeline>
<codeline lineno="1968"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">goto</highlight><highlight class="normal"><sp/><ref refid="proxy_8c_1a11614f44ef4d939bdd984953346a7572" kindref="member">error</ref>;</highlight></codeline>
<codeline lineno="1969"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="1970"><highlight class="normal">pending:</highlight></codeline>
<codeline lineno="1971"><highlight class="normal"><sp/><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="group__libssh__channel_1gaee35ccabe6998568d138d35f538765d9" kindref="member">channel_request</ref>(channel,<sp/></highlight><highlight class="stringliteral">&quot;subsystem&quot;</highlight><highlight class="normal">,<sp/><ref refid="benchmarks_8c_1aff2566f4c366b48d73479bef43ee4d2e" kindref="member">buffer</ref>,<sp/>1);</highlight></codeline>
<codeline lineno="1972"><highlight class="normal"><ref refid="proxy_8c_1a11614f44ef4d939bdd984953346a7572" kindref="member">error</ref>:</highlight></codeline>
<codeline lineno="1973"><highlight class="normal"><sp/><sp/><ref refid="libssh_8h_1a8b09f7d6f7066de7ef8dab4ed7494a52" kindref="member">SSH_BUFFER_FREE</ref>(<ref refid="benchmarks_8c_1aff2566f4c366b48d73479bef43ee4d2e" kindref="member">buffer</ref>);</highlight></codeline>
<codeline lineno="1974"><highlight class="normal"></highlight></codeline>
<codeline lineno="1975"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref>;</highlight></codeline>
<codeline lineno="1976"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1977"><highlight class="normal"></highlight></codeline>
<codeline lineno="1990" refid="group__libssh__channel_1ga3d2a402cddd799036006294eb61649fe" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="group__libssh__channel_1ga3d2a402cddd799036006294eb61649fe" kindref="member">ssh_channel_request_sftp</ref>(<sp/><ref refid="structssh__channel__struct" kindref="compound">ssh_channel</ref><sp/>channel){</highlight></codeline>
<codeline lineno="1991"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(channel<sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="1992"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" kindref="member">SSH_ERROR</ref>;</highlight></codeline>
<codeline lineno="1993"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1994"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="group__libssh__channel_1ga06024b070f9b2a3d6964b79ae36695b7" kindref="member">ssh_channel_request_subsystem</ref>(channel,<sp/></highlight><highlight class="stringliteral">&quot;sftp&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="1995"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1996"><highlight class="normal"></highlight></codeline>
<codeline lineno="1997" refid="group__libssh__channel_1gad14fc6d15d825654af4312764a970d04" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*<ref refid="group__libssh__channel_1gad14fc6d15d825654af4312764a970d04" kindref="member">generate_cookie</ref>(</highlight><highlight class="keywordtype">void</highlight><highlight class="normal">)<sp/>{</highlight></codeline>
<codeline lineno="1998"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*hex<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;0123456789abcdef&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1999"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/><ref refid="test__socket_8c_1a73991beba1accdcc64730cb00c146fe2" kindref="member">s</ref>[36];</highlight></codeline>
<codeline lineno="2000"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">unsigned</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>rnd[16];</highlight></codeline>
<codeline lineno="2001"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>ok;</highlight></codeline>
<codeline lineno="2002"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i;</highlight></codeline>
<codeline lineno="2003"><highlight class="normal"></highlight></codeline>
<codeline lineno="2004"><highlight class="normal"><sp/><sp/>ok<sp/>=<sp/><ref refid="libssh_8h_1aa04e01bdb1b607b705233a5d3587ae11" kindref="member">ssh_get_random</ref>(rnd,<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(rnd),<sp/>0);</highlight></codeline>
<codeline lineno="2005"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!ok)<sp/>{</highlight></codeline>
<codeline lineno="2006"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>NULL;</highlight></codeline>
<codeline lineno="2007"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="2008"><highlight class="normal"></highlight></codeline>
<codeline lineno="2009"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/>16;<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="2010"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="test__socket_8c_1a73991beba1accdcc64730cb00c146fe2" kindref="member">s</ref>[i*2]<sp/>=<sp/>hex[rnd[i]<sp/>&amp;<sp/>0x0f];</highlight></codeline>
<codeline lineno="2011"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="test__socket_8c_1a73991beba1accdcc64730cb00c146fe2" kindref="member">s</ref>[i*2+1]<sp/>=<sp/>hex[rnd[i]<sp/>&gt;&gt;<sp/>4];</highlight></codeline>
<codeline lineno="2012"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="2013"><highlight class="normal"><sp/><sp/><ref refid="test__socket_8c_1a73991beba1accdcc64730cb00c146fe2" kindref="member">s</ref>[32]<sp/>=<sp/></highlight><highlight class="charliteral">&apos;\0&apos;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="2014"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>strdup(<ref refid="test__socket_8c_1a73991beba1accdcc64730cb00c146fe2" kindref="member">s</ref>);</highlight></codeline>
<codeline lineno="2015"><highlight class="normal">}</highlight></codeline>
<codeline lineno="2016"><highlight class="normal"></highlight></codeline>
<codeline lineno="2042" refid="group__libssh__channel_1gadfa34624c28164bd73453cd04aa64c1f" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="group__libssh__channel_1gadfa34624c28164bd73453cd04aa64c1f" kindref="member">ssh_channel_request_x11</ref>(<ref refid="structssh__channel__struct" kindref="compound">ssh_channel</ref><sp/>channel,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>single_connection,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*protocol,</highlight></codeline>
<codeline lineno="2043"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*cookie,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>screen_number)<sp/>{</highlight></codeline>
<codeline lineno="2044"><highlight class="normal"><sp/><sp/><ref refid="structssh__buffer__struct" kindref="compound">ssh_buffer</ref><sp/><ref refid="benchmarks_8c_1aff2566f4c366b48d73479bef43ee4d2e" kindref="member">buffer</ref><sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="2045"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*c<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="2046"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" kindref="member">SSH_ERROR</ref>;</highlight></codeline>
<codeline lineno="2047"><highlight class="normal"></highlight></codeline>
<codeline lineno="2048"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(channel<sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="2049"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" kindref="member">SSH_ERROR</ref>;</highlight></codeline>
<codeline lineno="2050"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="2051"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">switch</highlight><highlight class="normal">(channel-&gt;<ref refid="structssh__channel__struct_1a25a8d874fbdccd50ecfff837ef69bad2" kindref="member">request_state</ref>){</highlight></codeline>
<codeline lineno="2052"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="channels_8h_1a774597eb1605e8b48cd065965fdc2325a98c7a3dcf02759118261e2bac4d6e421" kindref="member">SSH_CHANNEL_REQ_STATE_NONE</ref>:</highlight></codeline>
<codeline lineno="2053"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="2054"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">default</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="2055"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">goto</highlight><highlight class="normal"><sp/>pending;</highlight></codeline>
<codeline lineno="2056"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="2057"><highlight class="normal"></highlight></codeline>
<codeline lineno="2058"><highlight class="normal"><sp/><sp/><ref refid="benchmarks_8c_1aff2566f4c366b48d73479bef43ee4d2e" kindref="member">buffer</ref><sp/>=<sp/><ref refid="group__libssh__buffer_1ga7ecc914104a5bf0da485d3e42f6a7d3b" kindref="member">ssh_buffer_new</ref>();</highlight></codeline>
<codeline lineno="2059"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="benchmarks_8c_1aff2566f4c366b48d73479bef43ee4d2e" kindref="member">buffer</ref><sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="2060"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="priv_8h_1ae280c413c792e04237f000841ac8ce44" kindref="member">ssh_set_error_oom</ref>(channel-&gt;<ref refid="structssh__channel__struct_1a0832dc830d09accd2f3a8f8349c3faf2" kindref="member">session</ref>);</highlight></codeline>
<codeline lineno="2061"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">goto</highlight><highlight class="normal"><sp/><ref refid="proxy_8c_1a11614f44ef4d939bdd984953346a7572" kindref="member">error</ref>;</highlight></codeline>
<codeline lineno="2062"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="2063"><highlight class="normal"></highlight></codeline>
<codeline lineno="2064"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(cookie<sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="2065"><highlight class="normal"><sp/><sp/><sp/><sp/>c<sp/>=<sp/><ref refid="group__libssh__channel_1gad14fc6d15d825654af4312764a970d04" kindref="member">generate_cookie</ref>();</highlight></codeline>
<codeline lineno="2066"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(c<sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="2067"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="priv_8h_1ae280c413c792e04237f000841ac8ce44" kindref="member">ssh_set_error_oom</ref>(channel-&gt;<ref refid="structssh__channel__struct_1a0832dc830d09accd2f3a8f8349c3faf2" kindref="member">session</ref>);</highlight></codeline>
<codeline lineno="2068"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">goto</highlight><highlight class="normal"><sp/><ref refid="proxy_8c_1a11614f44ef4d939bdd984953346a7572" kindref="member">error</ref>;</highlight></codeline>
<codeline lineno="2069"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2070"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="2071"><highlight class="normal"></highlight></codeline>
<codeline lineno="2072"><highlight class="normal"><sp/><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="buffer_8h_1ae17848a86043f0abfc60c1c4f6126ccd" kindref="member">ssh_buffer_pack</ref>(<ref refid="benchmarks_8c_1aff2566f4c366b48d73479bef43ee4d2e" kindref="member">buffer</ref>,</highlight></codeline>
<codeline lineno="2073"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;bssd&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="2074"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>single_connection<sp/>==<sp/>0<sp/>?<sp/>0<sp/>:<sp/>1,</highlight></codeline>
<codeline lineno="2075"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>protocol<sp/>?<sp/>protocol<sp/>:<sp/></highlight><highlight class="stringliteral">&quot;MIT-MAGIC-COOKIE-1&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="2076"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>cookie<sp/>?<sp/>cookie<sp/>:<sp/>c,</highlight></codeline>
<codeline lineno="2077"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>screen_number);</highlight></codeline>
<codeline lineno="2078"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(c<sp/>!=<sp/>NULL){</highlight></codeline>
<codeline lineno="2079"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="sshd__direct-tcpip_8c_1aed3129b7674034c979192bcca6b0ad8c" kindref="member">SAFE_FREE</ref>(c);</highlight></codeline>
<codeline lineno="2080"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="2081"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>!=<sp/><ref refid="libssh_8h_1ac1ee1d1e917456d4760a94a18015377d" kindref="member">SSH_OK</ref>)<sp/>{</highlight></codeline>
<codeline lineno="2082"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="priv_8h_1ae280c413c792e04237f000841ac8ce44" kindref="member">ssh_set_error_oom</ref>(channel-&gt;<ref refid="structssh__channel__struct_1a0832dc830d09accd2f3a8f8349c3faf2" kindref="member">session</ref>);</highlight></codeline>
<codeline lineno="2083"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">goto</highlight><highlight class="normal"><sp/><ref refid="proxy_8c_1a11614f44ef4d939bdd984953346a7572" kindref="member">error</ref>;</highlight></codeline>
<codeline lineno="2084"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="2085"><highlight class="normal">pending:</highlight></codeline>
<codeline lineno="2086"><highlight class="normal"><sp/><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="group__libssh__channel_1gaee35ccabe6998568d138d35f538765d9" kindref="member">channel_request</ref>(channel,<sp/></highlight><highlight class="stringliteral">&quot;x11-req&quot;</highlight><highlight class="normal">,<sp/><ref refid="benchmarks_8c_1aff2566f4c366b48d73479bef43ee4d2e" kindref="member">buffer</ref>,<sp/>1);</highlight></codeline>
<codeline lineno="2087"><highlight class="normal"></highlight></codeline>
<codeline lineno="2088"><highlight class="normal"><ref refid="proxy_8c_1a11614f44ef4d939bdd984953346a7572" kindref="member">error</ref>:</highlight></codeline>
<codeline lineno="2089"><highlight class="normal"><sp/><sp/><ref refid="libssh_8h_1a8b09f7d6f7066de7ef8dab4ed7494a52" kindref="member">SSH_BUFFER_FREE</ref>(<ref refid="benchmarks_8c_1aff2566f4c366b48d73479bef43ee4d2e" kindref="member">buffer</ref>);</highlight></codeline>
<codeline lineno="2090"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref>;</highlight></codeline>
<codeline lineno="2091"><highlight class="normal">}</highlight></codeline>
<codeline lineno="2092"><highlight class="normal"></highlight></codeline>
<codeline lineno="2093" refid="group__libssh__channel_1gac43bae56048b912205d102249b436eec" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/><ref refid="structssh__channel__struct" kindref="compound">ssh_channel</ref><sp/><ref refid="group__libssh__channel_1gac43bae56048b912205d102249b436eec" kindref="member">ssh_channel_accept</ref>(<ref refid="structssh__session__struct" kindref="compound">ssh_session</ref><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>channeltype,</highlight></codeline>
<codeline lineno="2094"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>timeout_ms,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>*destination_port)<sp/>{</highlight></codeline>
<codeline lineno="2095"><highlight class="normal"></highlight><highlight class="preprocessor">#ifndef<sp/>_WIN32</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2096"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">struct<sp/></highlight><highlight class="normal">timespec<sp/>ts<sp/>=<sp/>{</highlight></codeline>
<codeline lineno="2097"><highlight class="normal"><sp/><sp/><sp/><sp/>.tv_sec<sp/>=<sp/>0,</highlight></codeline>
<codeline lineno="2098"><highlight class="normal"><sp/><sp/><sp/><sp/>.tv_nsec<sp/>=<sp/>50000000<sp/></highlight><highlight class="comment">/*<sp/>50ms<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2099"><highlight class="normal"><sp/><sp/>};</highlight></codeline>
<codeline lineno="2100"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2101"><highlight class="normal"><sp/><sp/><ref refid="structssh__message__struct" kindref="compound">ssh_message</ref><sp/>msg<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="2102"><highlight class="normal"><sp/><sp/><ref refid="structssh__channel__struct" kindref="compound">ssh_channel</ref><sp/>channel<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="2103"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">struct<sp/></highlight><highlight class="normal"><ref refid="structssh__iterator" kindref="compound">ssh_iterator</ref><sp/>*iterator;</highlight></codeline>
<codeline lineno="2104"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>t;</highlight></codeline>
<codeline lineno="2105"><highlight class="normal"></highlight></codeline>
<codeline lineno="2106"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">/*</highlight></codeline>
<codeline lineno="2107"><highlight class="comment"><sp/><sp/><sp/>*<sp/>We<sp/>sleep<sp/>for<sp/>50<sp/>ms<sp/>in<sp/>ssh_handle_packets()<sp/>and<sp/>later<sp/>sleep<sp/>for</highlight></codeline>
<codeline lineno="2108"><highlight class="comment"><sp/><sp/><sp/>*<sp/>50<sp/>ms.<sp/>So<sp/>we<sp/>need<sp/>to<sp/>decrement<sp/>by<sp/>100<sp/>ms.</highlight></codeline>
<codeline lineno="2109"><highlight class="comment"><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2110"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(t<sp/>=<sp/>timeout_ms;<sp/>t<sp/>&gt;=<sp/>0;<sp/>t<sp/>-=<sp/>100)<sp/>{</highlight></codeline>
<codeline lineno="2111"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(timeout_ms<sp/>==<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="2112"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="group__libssh__session_1gaa0e04dc9e24d5112a5ca2b7bd68031d0" kindref="member">ssh_handle_packets</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>,<sp/>0);</highlight></codeline>
<codeline lineno="2113"><highlight class="normal"><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="2114"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="group__libssh__session_1gaa0e04dc9e24d5112a5ca2b7bd68031d0" kindref="member">ssh_handle_packets</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>,<sp/>50);</highlight></codeline>
<codeline lineno="2115"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2116"><highlight class="normal"></highlight></codeline>
<codeline lineno="2117"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1ac18fe9d39a3b73274e03ca0e2ae55db2" kindref="member">ssh_message_list</ref>)<sp/>{</highlight></codeline>
<codeline lineno="2118"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>iterator<sp/>=<sp/><ref refid="group__libssh__misc_1gad36d247bfcae7965d6aca8245d061e0d" kindref="member">ssh_list_get_iterator</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1ac18fe9d39a3b73274e03ca0e2ae55db2" kindref="member">ssh_message_list</ref>);</highlight></codeline>
<codeline lineno="2119"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>(iterator)<sp/>{</highlight></codeline>
<codeline lineno="2120"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>msg<sp/>=<sp/>(<ref refid="libssh_8h_1aee0e83a574ad7c842ae73ae2aa449d07" kindref="member">ssh_message</ref>)iterator-&gt;<ref refid="structssh__iterator_1a4cc4eb8c8599a487e7e3321d32a9e9cd" kindref="member">data</ref>;</highlight></codeline>
<codeline lineno="2121"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="doc_2CMakeLists_8txt_1a8ac464f14522528c145064f01020e23e" kindref="member">if</ref><sp/>(<ref refid="group__libssh__messages_1ga20fc6e536f170b98c7d62ce3675d8cdb" kindref="member">ssh_message_type</ref>(msg)<sp/>==<sp/><ref refid="libssh_8h_1a9484ca6b9fd0460e31a80fb8d0e81da6a55349816be9b38f7187447782dcd8d06" kindref="member">SSH_REQUEST_CHANNEL_OPEN</ref><sp/>&amp;&amp;</highlight></codeline>
<codeline lineno="2122"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="group__libssh__messages_1ga7aa19d51c443b779fe454f0be3c666d4" kindref="member">ssh_message_subtype</ref>(msg)<sp/>==<sp/>channeltype)<sp/>{</highlight></codeline>
<codeline lineno="2123"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="group__libssh__misc_1gac862429660a1f93dcf625d08f407b85e" kindref="member">ssh_list_remove</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1ac18fe9d39a3b73274e03ca0e2ae55db2" kindref="member">ssh_message_list</ref>,<sp/>iterator);</highlight></codeline>
<codeline lineno="2124"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>channel<sp/>=<sp/><ref refid="group__libssh__messages_1gaf9afe350861a5085901b37c5ff9b7702" kindref="member">ssh_message_channel_request_open_reply_accept</ref>(msg);</highlight></codeline>
<codeline lineno="2125"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(destination_port)<sp/>{</highlight></codeline>
<codeline lineno="2126"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*destination_port=msg-&gt;<ref refid="structssh__message__struct_1a7579d1e2cd4136f2e152985d0018777f" kindref="member">channel_request_open</ref>.<ref refid="structssh__channel__request__open_1a855a0ab9192961301638a007eed1a2ba" kindref="member">destination_port</ref>;</highlight></codeline>
<codeline lineno="2127"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2128"><highlight class="normal"></highlight></codeline>
<codeline lineno="2129"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="group__libssh__messages_1ga9d1b1d2279c6be3539f2b630960759c3" kindref="member">ssh_message_free</ref>(msg);</highlight></codeline>
<codeline lineno="2130"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>channel;</highlight></codeline>
<codeline lineno="2131"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2132"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>iterator<sp/>=<sp/>iterator-&gt;<ref refid="structssh__iterator_1a7fd7219325e56f365796ad59c8443ee5" kindref="member">next</ref>;</highlight></codeline>
<codeline lineno="2133"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2134"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2135"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(t&gt;0){</highlight></codeline>
<codeline lineno="2136"><highlight class="normal"></highlight><highlight class="preprocessor">#ifdef<sp/>_WIN32</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2137"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>Sleep(50);<sp/></highlight><highlight class="comment">/*<sp/>50ms<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2138"><highlight class="normal"></highlight><highlight class="preprocessor">#else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2139"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>nanosleep(&amp;ts,<sp/>NULL);</highlight></codeline>
<codeline lineno="2140"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2141"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2142"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="2143"><highlight class="normal"></highlight></codeline>
<codeline lineno="2144"><highlight class="normal"><sp/><sp/><ref refid="priv_8h_1a55177b3e8db90ca9adb435c44281963c" kindref="member">ssh_set_error</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>,<sp/><ref refid="libssh_8h_1a036b2b00fb04337a4d06d719d1b62be1ac3aceef794ead7991dc7a2d0cf93f5c5" kindref="member">SSH_NO_ERROR</ref>,<sp/></highlight><highlight class="stringliteral">&quot;No<sp/>channel<sp/>request<sp/>of<sp/>this<sp/>type<sp/>from<sp/>server&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="2145"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>NULL;</highlight></codeline>
<codeline lineno="2146"><highlight class="normal">}</highlight></codeline>
<codeline lineno="2147"><highlight class="normal"></highlight></codeline>
<codeline lineno="2158" refid="group__libssh__channel_1ga548bd0f77a50b7c8180942544b375866" refkind="member"><highlight class="normal"><ref refid="structssh__channel__struct" kindref="compound">ssh_channel</ref><sp/><ref refid="group__libssh__channel_1ga548bd0f77a50b7c8180942544b375866" kindref="member">ssh_channel_accept_x11</ref>(<ref refid="structssh__channel__struct" kindref="compound">ssh_channel</ref><sp/>channel,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>timeout_ms)<sp/>{</highlight></codeline>
<codeline lineno="2159"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="group__libssh__channel_1gac43bae56048b912205d102249b436eec" kindref="member">ssh_channel_accept</ref>(channel-&gt;<ref refid="structssh__channel__struct_1a0832dc830d09accd2f3a8f8349c3faf2" kindref="member">session</ref>,<sp/><ref refid="libssh_8h_1acc2732b8c54002b0031fa1e40ee60b24aeae4049d38c91066926580f9cbefb3b5" kindref="member">SSH_CHANNEL_X11</ref>,<sp/>timeout_ms,<sp/>NULL);</highlight></codeline>
<codeline lineno="2160"><highlight class="normal">}</highlight></codeline>
<codeline lineno="2161"><highlight class="normal"></highlight></codeline>
<codeline lineno="2173" refid="group__libssh__channel_1gab2e28b520b8f8fe5ff5626de2a4113d9" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="group__libssh__channel_1gab2e28b520b8f8fe5ff5626de2a4113d9" kindref="member">ssh_channel_request_auth_agent</ref>(<ref refid="structssh__channel__struct" kindref="compound">ssh_channel</ref><sp/>channel)<sp/>{</highlight></codeline>
<codeline lineno="2174"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(channel<sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="2175"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" kindref="member">SSH_ERROR</ref>;</highlight></codeline>
<codeline lineno="2176"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="2177"><highlight class="normal"></highlight></codeline>
<codeline lineno="2178"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="group__libssh__channel_1gaee35ccabe6998568d138d35f538765d9" kindref="member">channel_request</ref>(channel,<sp/></highlight><highlight class="stringliteral">&quot;auth-agent-req@openssh.com&quot;</highlight><highlight class="normal">,<sp/>NULL,<sp/>0);</highlight></codeline>
<codeline lineno="2179"><highlight class="normal">}</highlight></codeline>
<codeline lineno="2180"><highlight class="normal"></highlight></codeline>
<codeline lineno="2187" refid="group__libssh__channel_1gadf43d7b10268fb16127d1dc441bbd226" refkind="member"><highlight class="normal"><ref refid="group__libssh__channel_1ga1f817e943f01e76843f60f9f9ca970f9" kindref="member">SSH_PACKET_CALLBACK</ref>(ssh_request_success){</highlight></codeline>
<codeline lineno="2188"><highlight class="normal"><sp/><sp/>(void)type;</highlight></codeline>
<codeline lineno="2189"><highlight class="normal"><sp/><sp/>(void)<ref refid="ssh__client_8c_1a14871705f45ccdc5bb9f4549efd8e119" kindref="member">user</ref>;</highlight></codeline>
<codeline lineno="2190"><highlight class="normal"><sp/><sp/>(void)packet;</highlight></codeline>
<codeline lineno="2191"><highlight class="normal"></highlight></codeline>
<codeline lineno="2192"><highlight class="normal"><sp/><sp/><ref refid="priv_8h_1aa21fd8a7a609329603b7b16da7939fca" kindref="member">SSH_LOG</ref>(<ref refid="group__libssh__log_1ggadf764cbdea00d65edcd07bb9953ad2b7a6445dfe21592d69d9741d319538b6673" kindref="member">SSH_LOG_PACKET</ref>,</highlight></codeline>
<codeline lineno="2193"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Received<sp/>SSH_REQUEST_SUCCESS&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="2194"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a70a72ecdca89309b5a19e8c887f2ca2c" kindref="member">global_req_state</ref><sp/>!=<sp/><ref refid="channels_8h_1a774597eb1605e8b48cd065965fdc2325a1229a4614fb5d58a7bcd4d6b0bd4816e" kindref="member">SSH_CHANNEL_REQ_STATE_PENDING</ref>){</highlight></codeline>
<codeline lineno="2195"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="priv_8h_1aa21fd8a7a609329603b7b16da7939fca" kindref="member">SSH_LOG</ref>(<ref refid="libssh_8h_1a1c08cc9177a5598e0675abfb833d2993" kindref="member">SSH_LOG_RARE</ref>,<sp/></highlight><highlight class="stringliteral">&quot;SSH_REQUEST_SUCCESS<sp/>received<sp/>in<sp/>incorrect<sp/>state<sp/>%d&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="2196"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a70a72ecdca89309b5a19e8c887f2ca2c" kindref="member">global_req_state</ref>);</highlight></codeline>
<codeline lineno="2197"><highlight class="normal"><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="2198"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a70a72ecdca89309b5a19e8c887f2ca2c" kindref="member">global_req_state</ref>=<ref refid="channels_8h_1a774597eb1605e8b48cd065965fdc2325a4054be6a6327c97579cb9dce89c90590" kindref="member">SSH_CHANNEL_REQ_STATE_ACCEPTED</ref>;</highlight></codeline>
<codeline lineno="2199"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="2200"><highlight class="normal"></highlight></codeline>
<codeline lineno="2201"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="group__libssh__callbacks_1gac29df803aa1295d6a498c1b081f3b494" kindref="member">SSH_PACKET_USED</ref>;</highlight></codeline>
<codeline lineno="2202"><highlight class="normal">}</highlight></codeline>
<codeline lineno="2203"><highlight class="normal"></highlight></codeline>
<codeline lineno="2210" refid="group__libssh__channel_1ga8518f0b33a413a4b6d55d78816fb092d" refkind="member"><highlight class="normal"><ref refid="group__libssh__channel_1ga1f817e943f01e76843f60f9f9ca970f9" kindref="member">SSH_PACKET_CALLBACK</ref>(ssh_request_denied){</highlight></codeline>
<codeline lineno="2211"><highlight class="normal"><sp/><sp/>(void)type;</highlight></codeline>
<codeline lineno="2212"><highlight class="normal"><sp/><sp/>(void)<ref refid="ssh__client_8c_1a14871705f45ccdc5bb9f4549efd8e119" kindref="member">user</ref>;</highlight></codeline>
<codeline lineno="2213"><highlight class="normal"><sp/><sp/>(void)packet;</highlight></codeline>
<codeline lineno="2214"><highlight class="normal"></highlight></codeline>
<codeline lineno="2215"><highlight class="normal"><sp/><sp/><ref refid="priv_8h_1aa21fd8a7a609329603b7b16da7939fca" kindref="member">SSH_LOG</ref>(<ref refid="group__libssh__log_1ggadf764cbdea00d65edcd07bb9953ad2b7a6445dfe21592d69d9741d319538b6673" kindref="member">SSH_LOG_PACKET</ref>,</highlight></codeline>
<codeline lineno="2216"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Received<sp/>SSH_REQUEST_FAILURE&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="2217"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a70a72ecdca89309b5a19e8c887f2ca2c" kindref="member">global_req_state</ref><sp/>!=<sp/><ref refid="channels_8h_1a774597eb1605e8b48cd065965fdc2325a1229a4614fb5d58a7bcd4d6b0bd4816e" kindref="member">SSH_CHANNEL_REQ_STATE_PENDING</ref>){</highlight></codeline>
<codeline lineno="2218"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="priv_8h_1aa21fd8a7a609329603b7b16da7939fca" kindref="member">SSH_LOG</ref>(<ref refid="libssh_8h_1a1c08cc9177a5598e0675abfb833d2993" kindref="member">SSH_LOG_RARE</ref>,<sp/></highlight><highlight class="stringliteral">&quot;SSH_REQUEST_DENIED<sp/>received<sp/>in<sp/>incorrect<sp/>state<sp/>%d&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="2219"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a70a72ecdca89309b5a19e8c887f2ca2c" kindref="member">global_req_state</ref>);</highlight></codeline>
<codeline lineno="2220"><highlight class="normal"><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="2221"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a70a72ecdca89309b5a19e8c887f2ca2c" kindref="member">global_req_state</ref>=<ref refid="channels_8h_1a774597eb1605e8b48cd065965fdc2325a4947de111ac917be11de88f4e9147d14" kindref="member">SSH_CHANNEL_REQ_STATE_DENIED</ref>;</highlight></codeline>
<codeline lineno="2222"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="2223"><highlight class="normal"></highlight></codeline>
<codeline lineno="2224"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="group__libssh__callbacks_1gac29df803aa1295d6a498c1b081f3b494" kindref="member">SSH_PACKET_USED</ref>;</highlight></codeline>
<codeline lineno="2225"><highlight class="normal"></highlight></codeline>
<codeline lineno="2226"><highlight class="normal">}</highlight></codeline>
<codeline lineno="2227"><highlight class="normal"></highlight></codeline>
<codeline lineno="2228" refid="group__libssh__channel_1gad181aa43648dc1a380051d55f53855ad" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="group__libssh__channel_1gad181aa43648dc1a380051d55f53855ad" kindref="member">ssh_global_request_termination</ref>(</highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>*<ref refid="test__socket_8c_1a73991beba1accdcc64730cb00c146fe2" kindref="member">s</ref>){</highlight></codeline>
<codeline lineno="2229"><highlight class="normal"><sp/><sp/><ref refid="structssh__session__struct" kindref="compound">ssh_session</ref><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref><sp/>=<sp/>(<ref refid="libssh_8h_1a02d3754de040612632cdd499c20f92f6" kindref="member">ssh_session</ref>)<sp/><ref refid="test__socket_8c_1a73991beba1accdcc64730cb00c146fe2" kindref="member">s</ref>;</highlight></codeline>
<codeline lineno="2230"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a70a72ecdca89309b5a19e8c887f2ca2c" kindref="member">global_req_state</ref><sp/>!=<sp/><ref refid="channels_8h_1a774597eb1605e8b48cd065965fdc2325a1229a4614fb5d58a7bcd4d6b0bd4816e" kindref="member">SSH_CHANNEL_REQ_STATE_PENDING</ref><sp/>||</highlight></codeline>
<codeline lineno="2231"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a6f74d1a1eb6ed715b1073b67caa18460" kindref="member">session_state</ref><sp/>==<sp/><ref refid="session_8h_1a9bbd1d5ae11485e27279be6ad461992ca855474fc84a2fb170fcb72546af8eeb8" kindref="member">SSH_SESSION_STATE_ERROR</ref>)</highlight></codeline>
<codeline lineno="2232"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>1;</highlight></codeline>
<codeline lineno="2233"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2234"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>0;</highlight></codeline>
<codeline lineno="2235"><highlight class="normal">}</highlight></codeline>
<codeline lineno="2236"><highlight class="normal"></highlight></codeline>
<codeline lineno="2256" refid="group__libssh__channel_1ga814cf8a82b4098b8994f9029fed572c0" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="group__libssh__channel_1ga814cf8a82b4098b8994f9029fed572c0" kindref="member">ssh_global_request</ref>(<ref refid="structssh__session__struct" kindref="compound">ssh_session</ref><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>,</highlight></codeline>
<codeline lineno="2257"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*request,</highlight></codeline>
<codeline lineno="2258"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structssh__buffer__struct" kindref="compound">ssh_buffer</ref><sp/><ref refid="benchmarks_8c_1aff2566f4c366b48d73479bef43ee4d2e" kindref="member">buffer</ref>,</highlight></codeline>
<codeline lineno="2259"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>reply)</highlight></codeline>
<codeline lineno="2260"><highlight class="normal">{</highlight></codeline>
<codeline lineno="2261"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref>;</highlight></codeline>
<codeline lineno="2262"><highlight class="normal"></highlight></codeline>
<codeline lineno="2263"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">switch</highlight><highlight class="normal"><sp/>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a70a72ecdca89309b5a19e8c887f2ca2c" kindref="member">global_req_state</ref>)<sp/>{</highlight></codeline>
<codeline lineno="2264"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="channels_8h_1a774597eb1605e8b48cd065965fdc2325a98c7a3dcf02759118261e2bac4d6e421" kindref="member">SSH_CHANNEL_REQ_STATE_NONE</ref>:</highlight></codeline>
<codeline lineno="2265"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="2266"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">default</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="2267"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">goto</highlight><highlight class="normal"><sp/>pending;</highlight></codeline>
<codeline lineno="2268"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="2269"><highlight class="normal"></highlight></codeline>
<codeline lineno="2270"><highlight class="normal"><sp/><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="buffer_8h_1ae17848a86043f0abfc60c1c4f6126ccd" kindref="member">ssh_buffer_pack</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1af0aed60c1e529bbfdcb483fd80bf98a0" kindref="member">out_buffer</ref>,</highlight></codeline>
<codeline lineno="2271"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;bsb&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="2272"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ssh2_8h_1a4eadfca7fb359cdaa08b9c3cec05c54d" kindref="member">SSH2_MSG_GLOBAL_REQUEST</ref>,</highlight></codeline>
<codeline lineno="2273"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>request,</highlight></codeline>
<codeline lineno="2274"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>reply<sp/>==<sp/>0<sp/>?<sp/>0<sp/>:<sp/>1);</highlight></codeline>
<codeline lineno="2275"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>!=<sp/><ref refid="libssh_8h_1ac1ee1d1e917456d4760a94a18015377d" kindref="member">SSH_OK</ref>){</highlight></codeline>
<codeline lineno="2276"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="priv_8h_1ae280c413c792e04237f000841ac8ce44" kindref="member">ssh_set_error_oom</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>);</highlight></codeline>
<codeline lineno="2277"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" kindref="member">SSH_ERROR</ref>;</highlight></codeline>
<codeline lineno="2278"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">goto</highlight><highlight class="normal"><sp/><ref refid="proxy_8c_1a11614f44ef4d939bdd984953346a7572" kindref="member">error</ref>;</highlight></codeline>
<codeline lineno="2279"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="2280"><highlight class="normal"></highlight></codeline>
<codeline lineno="2281"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="benchmarks_8c_1aff2566f4c366b48d73479bef43ee4d2e" kindref="member">buffer</ref><sp/>!=<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="2282"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="libssh_8h_1a92d37237bf129961367accd4a9e0dcfc" kindref="member">ssh_buffer_add_data</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1af0aed60c1e529bbfdcb483fd80bf98a0" kindref="member">out_buffer</ref>,</highlight></codeline>
<codeline lineno="2283"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="libssh_8h_1a240b02fb7c0475fbb5996d1f759221ee" kindref="member">ssh_buffer_get</ref>(<ref refid="benchmarks_8c_1aff2566f4c366b48d73479bef43ee4d2e" kindref="member">buffer</ref>),</highlight></codeline>
<codeline lineno="2284"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="libssh_8h_1a61400c7267feb254046cd606a3fdfdbc" kindref="member">ssh_buffer_get_len</ref>(<ref refid="benchmarks_8c_1aff2566f4c366b48d73479bef43ee4d2e" kindref="member">buffer</ref>));</highlight></codeline>
<codeline lineno="2285"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>&lt;<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="2286"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="priv_8h_1ae280c413c792e04237f000841ac8ce44" kindref="member">ssh_set_error_oom</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>);</highlight></codeline>
<codeline lineno="2287"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" kindref="member">SSH_ERROR</ref>;</highlight></codeline>
<codeline lineno="2288"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">goto</highlight><highlight class="normal"><sp/><ref refid="proxy_8c_1a11614f44ef4d939bdd984953346a7572" kindref="member">error</ref>;</highlight></codeline>
<codeline lineno="2289"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2290"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="2291"><highlight class="normal"></highlight></codeline>
<codeline lineno="2292"><highlight class="normal"><sp/><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a70a72ecdca89309b5a19e8c887f2ca2c" kindref="member">global_req_state</ref><sp/>=<sp/><ref refid="channels_8h_1a774597eb1605e8b48cd065965fdc2325a1229a4614fb5d58a7bcd4d6b0bd4816e" kindref="member">SSH_CHANNEL_REQ_STATE_PENDING</ref>;</highlight></codeline>
<codeline lineno="2293"><highlight class="normal"><sp/><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="packet_8h_1a7e6c7ed74c23ace432476aa8a6841140" kindref="member">ssh_packet_send</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>);</highlight></codeline>
<codeline lineno="2294"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>==<sp/><ref refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" kindref="member">SSH_ERROR</ref>)<sp/>{</highlight></codeline>
<codeline lineno="2295"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref>;</highlight></codeline>
<codeline lineno="2296"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="2297"><highlight class="normal"></highlight></codeline>
<codeline lineno="2298"><highlight class="normal"><sp/><sp/><ref refid="priv_8h_1aa21fd8a7a609329603b7b16da7939fca" kindref="member">SSH_LOG</ref>(<ref refid="group__libssh__log_1ggadf764cbdea00d65edcd07bb9953ad2b7a6445dfe21592d69d9741d319538b6673" kindref="member">SSH_LOG_PACKET</ref>,</highlight></codeline>
<codeline lineno="2299"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Sent<sp/>a<sp/>SSH_MSG_GLOBAL_REQUEST<sp/>%s&quot;</highlight><highlight class="normal">,<sp/>request);</highlight></codeline>
<codeline lineno="2300"><highlight class="normal"></highlight></codeline>
<codeline lineno="2301"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(reply<sp/>==<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="2302"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a70a72ecdca89309b5a19e8c887f2ca2c" kindref="member">global_req_state</ref><sp/>=<sp/><ref refid="channels_8h_1a774597eb1605e8b48cd065965fdc2325a98c7a3dcf02759118261e2bac4d6e421" kindref="member">SSH_CHANNEL_REQ_STATE_NONE</ref>;</highlight></codeline>
<codeline lineno="2303"><highlight class="normal"></highlight></codeline>
<codeline lineno="2304"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="libssh_8h_1ac1ee1d1e917456d4760a94a18015377d" kindref="member">SSH_OK</ref>;</highlight></codeline>
<codeline lineno="2305"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="2306"><highlight class="normal">pending:</highlight></codeline>
<codeline lineno="2307"><highlight class="normal"><sp/><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="group__libssh__session_1ga4b84e1ae757c0d4007a5eefdf4651694" kindref="member">ssh_handle_packets_termination</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>,</highlight></codeline>
<codeline lineno="2308"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="session_8h_1aa8c8d35c7f83d7b00218ebadfac2254b" kindref="member">SSH_TIMEOUT_DEFAULT</ref>,</highlight></codeline>
<codeline lineno="2309"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="group__libssh__channel_1gad181aa43648dc1a380051d55f53855ad" kindref="member">ssh_global_request_termination</ref>,</highlight></codeline>
<codeline lineno="2310"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>);</highlight></codeline>
<codeline lineno="2311"><highlight class="normal"></highlight></codeline>
<codeline lineno="2312"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref>==<ref refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" kindref="member">SSH_ERROR</ref><sp/>||<sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a6f74d1a1eb6ed715b1073b67caa18460" kindref="member">session_state</ref><sp/>==<sp/><ref refid="session_8h_1a9bbd1d5ae11485e27279be6ad461992ca855474fc84a2fb170fcb72546af8eeb8" kindref="member">SSH_SESSION_STATE_ERROR</ref>){</highlight></codeline>
<codeline lineno="2313"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a70a72ecdca89309b5a19e8c887f2ca2c" kindref="member">global_req_state</ref><sp/>=<sp/><ref refid="channels_8h_1a774597eb1605e8b48cd065965fdc2325a7d2c1ea4f49536c9bea8c1187d950378" kindref="member">SSH_CHANNEL_REQ_STATE_ERROR</ref>;</highlight></codeline>
<codeline lineno="2314"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="2315"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">switch</highlight><highlight class="normal">(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a70a72ecdca89309b5a19e8c887f2ca2c" kindref="member">global_req_state</ref>){</highlight></codeline>
<codeline lineno="2316"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="channels_8h_1a774597eb1605e8b48cd065965fdc2325a4054be6a6327c97579cb9dce89c90590" kindref="member">SSH_CHANNEL_REQ_STATE_ACCEPTED</ref>:</highlight></codeline>
<codeline lineno="2317"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="priv_8h_1aa21fd8a7a609329603b7b16da7939fca" kindref="member">SSH_LOG</ref>(<ref refid="group__libssh__log_1ggadf764cbdea00d65edcd07bb9953ad2b7a75fa79e63947b66462db977d9b5ae27c" kindref="member">SSH_LOG_PROTOCOL</ref>,<sp/></highlight><highlight class="stringliteral">&quot;Global<sp/>request<sp/>%s<sp/>success&quot;</highlight><highlight class="normal">,request);</highlight></codeline>
<codeline lineno="2318"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref>=<ref refid="libssh_8h_1ac1ee1d1e917456d4760a94a18015377d" kindref="member">SSH_OK</ref>;</highlight></codeline>
<codeline lineno="2319"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="2320"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="channels_8h_1a774597eb1605e8b48cd065965fdc2325a4947de111ac917be11de88f4e9147d14" kindref="member">SSH_CHANNEL_REQ_STATE_DENIED</ref>:</highlight></codeline>
<codeline lineno="2321"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="priv_8h_1aa21fd8a7a609329603b7b16da7939fca" kindref="member">SSH_LOG</ref>(<ref refid="group__libssh__log_1ggadf764cbdea00d65edcd07bb9953ad2b7a6445dfe21592d69d9741d319538b6673" kindref="member">SSH_LOG_PACKET</ref>,</highlight></codeline>
<codeline lineno="2322"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Global<sp/>request<sp/>%s<sp/>failed&quot;</highlight><highlight class="normal">,<sp/>request);</highlight></codeline>
<codeline lineno="2323"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="priv_8h_1a55177b3e8db90ca9adb435c44281963c" kindref="member">ssh_set_error</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>,<sp/><ref refid="libssh_8h_1a036b2b00fb04337a4d06d719d1b62be1ad1339fb4b92a9d25bdb99df5de5c4f88" kindref="member">SSH_REQUEST_DENIED</ref>,</highlight></codeline>
<codeline lineno="2324"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Global<sp/>request<sp/>%s<sp/>failed&quot;</highlight><highlight class="normal">,<sp/>request);</highlight></codeline>
<codeline lineno="2325"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref>=<ref refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" kindref="member">SSH_ERROR</ref>;</highlight></codeline>
<codeline lineno="2326"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="2327"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="channels_8h_1a774597eb1605e8b48cd065965fdc2325a7d2c1ea4f49536c9bea8c1187d950378" kindref="member">SSH_CHANNEL_REQ_STATE_ERROR</ref>:</highlight></codeline>
<codeline lineno="2328"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="channels_8h_1a774597eb1605e8b48cd065965fdc2325a98c7a3dcf02759118261e2bac4d6e421" kindref="member">SSH_CHANNEL_REQ_STATE_NONE</ref>:</highlight></codeline>
<codeline lineno="2329"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" kindref="member">SSH_ERROR</ref>;</highlight></codeline>
<codeline lineno="2330"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="2331"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="channels_8h_1a774597eb1605e8b48cd065965fdc2325a1229a4614fb5d58a7bcd4d6b0bd4816e" kindref="member">SSH_CHANNEL_REQ_STATE_PENDING</ref>:</highlight></codeline>
<codeline lineno="2332"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="libssh_8h_1a9c57e4f6482106336045a4d25a55f28e" kindref="member">SSH_AGAIN</ref>;</highlight></codeline>
<codeline lineno="2333"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="2334"><highlight class="normal"><sp/><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a70a72ecdca89309b5a19e8c887f2ca2c" kindref="member">global_req_state</ref><sp/>=<sp/><ref refid="channels_8h_1a774597eb1605e8b48cd065965fdc2325a98c7a3dcf02759118261e2bac4d6e421" kindref="member">SSH_CHANNEL_REQ_STATE_NONE</ref>;</highlight></codeline>
<codeline lineno="2335"><highlight class="normal"></highlight></codeline>
<codeline lineno="2336"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref>;</highlight></codeline>
<codeline lineno="2337"><highlight class="normal"><ref refid="proxy_8c_1a11614f44ef4d939bdd984953346a7572" kindref="member">error</ref>:</highlight></codeline>
<codeline lineno="2338"><highlight class="normal"><sp/><sp/><ref refid="libssh_8h_1ac8802ff7f5348d0145dab5242623f740" kindref="member">ssh_buffer_reinit</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1af0aed60c1e529bbfdcb483fd80bf98a0" kindref="member">out_buffer</ref>);</highlight></codeline>
<codeline lineno="2339"><highlight class="normal"></highlight></codeline>
<codeline lineno="2340"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref>;</highlight></codeline>
<codeline lineno="2341"><highlight class="normal">}</highlight></codeline>
<codeline lineno="2342"><highlight class="normal"></highlight></codeline>
<codeline lineno="2365" refid="group__libssh__channel_1ga758cda957227751870c8772df46e5b39" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="group__libssh__channel_1ga758cda957227751870c8772df46e5b39" kindref="member">ssh_channel_listen_forward</ref>(<ref refid="structssh__session__struct" kindref="compound">ssh_session</ref><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>,</highlight></codeline>
<codeline lineno="2366"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*address,</highlight></codeline>
<codeline lineno="2367"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="sshnetcat_8c_1ad723da1801ae1586eb330380e2d9a912" kindref="member">port</ref>,</highlight></codeline>
<codeline lineno="2368"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>*bound_port)</highlight></codeline>
<codeline lineno="2369"><highlight class="normal">{</highlight></codeline>
<codeline lineno="2370"><highlight class="normal"><sp/><sp/><ref refid="structssh__buffer__struct" kindref="compound">ssh_buffer</ref><sp/><ref refid="benchmarks_8c_1aff2566f4c366b48d73479bef43ee4d2e" kindref="member">buffer</ref><sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="2371"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" kindref="member">SSH_ERROR</ref>;</highlight></codeline>
<codeline lineno="2372"><highlight class="normal"></highlight></codeline>
<codeline lineno="2373"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a70a72ecdca89309b5a19e8c887f2ca2c" kindref="member">global_req_state</ref><sp/>!=<sp/><ref refid="channels_8h_1a774597eb1605e8b48cd065965fdc2325a98c7a3dcf02759118261e2bac4d6e421" kindref="member">SSH_CHANNEL_REQ_STATE_NONE</ref>)</highlight></codeline>
<codeline lineno="2374"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">goto</highlight><highlight class="normal"><sp/>pending;</highlight></codeline>
<codeline lineno="2375"><highlight class="normal"></highlight></codeline>
<codeline lineno="2376"><highlight class="normal"><sp/><sp/><ref refid="benchmarks_8c_1aff2566f4c366b48d73479bef43ee4d2e" kindref="member">buffer</ref><sp/>=<sp/><ref refid="group__libssh__buffer_1ga7ecc914104a5bf0da485d3e42f6a7d3b" kindref="member">ssh_buffer_new</ref>();</highlight></codeline>
<codeline lineno="2377"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="benchmarks_8c_1aff2566f4c366b48d73479bef43ee4d2e" kindref="member">buffer</ref><sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="2378"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="priv_8h_1ae280c413c792e04237f000841ac8ce44" kindref="member">ssh_set_error_oom</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>);</highlight></codeline>
<codeline lineno="2379"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">goto</highlight><highlight class="normal"><sp/><ref refid="proxy_8c_1a11614f44ef4d939bdd984953346a7572" kindref="member">error</ref>;</highlight></codeline>
<codeline lineno="2380"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="2381"><highlight class="normal"></highlight></codeline>
<codeline lineno="2382"><highlight class="normal"><sp/><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="buffer_8h_1ae17848a86043f0abfc60c1c4f6126ccd" kindref="member">ssh_buffer_pack</ref>(<ref refid="benchmarks_8c_1aff2566f4c366b48d73479bef43ee4d2e" kindref="member">buffer</ref>,</highlight></codeline>
<codeline lineno="2383"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;sd&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="2384"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>address<sp/>?<sp/>address<sp/>:<sp/></highlight><highlight class="stringliteral">&quot;&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="2385"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="sshnetcat_8c_1ad723da1801ae1586eb330380e2d9a912" kindref="member">port</ref>);</highlight></codeline>
<codeline lineno="2386"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>!=<sp/><ref refid="libssh_8h_1ac1ee1d1e917456d4760a94a18015377d" kindref="member">SSH_OK</ref>){</highlight></codeline>
<codeline lineno="2387"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="priv_8h_1ae280c413c792e04237f000841ac8ce44" kindref="member">ssh_set_error_oom</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>);</highlight></codeline>
<codeline lineno="2388"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">goto</highlight><highlight class="normal"><sp/><ref refid="proxy_8c_1a11614f44ef4d939bdd984953346a7572" kindref="member">error</ref>;</highlight></codeline>
<codeline lineno="2389"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="2390"><highlight class="normal">pending:</highlight></codeline>
<codeline lineno="2391"><highlight class="normal"><sp/><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="group__libssh__channel_1ga814cf8a82b4098b8994f9029fed572c0" kindref="member">ssh_global_request</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>,<sp/></highlight><highlight class="stringliteral">&quot;tcpip-forward&quot;</highlight><highlight class="normal">,<sp/><ref refid="benchmarks_8c_1aff2566f4c366b48d73479bef43ee4d2e" kindref="member">buffer</ref>,<sp/>1);</highlight></codeline>
<codeline lineno="2392"><highlight class="normal"></highlight></codeline>
<codeline lineno="2393"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">/*<sp/>TODO:<sp/>FIXME<sp/>no<sp/>guarantee<sp/>the<sp/>last<sp/>packet<sp/>we<sp/>received<sp/>contains</highlight></codeline>
<codeline lineno="2394"><highlight class="comment"><sp/><sp/><sp/>*<sp/>that<sp/>info<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2395"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>==<sp/><ref refid="libssh_8h_1ac1ee1d1e917456d4760a94a18015377d" kindref="member">SSH_OK</ref><sp/>&amp;&amp;<sp/><ref refid="sshnetcat_8c_1ad723da1801ae1586eb330380e2d9a912" kindref="member">port</ref><sp/>==<sp/>0<sp/>&amp;&amp;<sp/>bound_port<sp/>!=<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="2396"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="buffer_8h_1ab51014ef9a47e7cdbd235af3e62b81ee" kindref="member">ssh_buffer_unpack</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a0fdb53c794a3173557463030583b2079" kindref="member">in_buffer</ref>,<sp/></highlight><highlight class="stringliteral">&quot;d&quot;</highlight><highlight class="normal">,<sp/>bound_port);</highlight></codeline>
<codeline lineno="2397"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>!=<sp/><ref refid="libssh_8h_1ac1ee1d1e917456d4760a94a18015377d" kindref="member">SSH_OK</ref>)</highlight></codeline>
<codeline lineno="2398"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*bound_port<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="2399"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="2400"><highlight class="normal"></highlight></codeline>
<codeline lineno="2401"><highlight class="normal"><ref refid="proxy_8c_1a11614f44ef4d939bdd984953346a7572" kindref="member">error</ref>:</highlight></codeline>
<codeline lineno="2402"><highlight class="normal"><sp/><sp/><ref refid="libssh_8h_1a8b09f7d6f7066de7ef8dab4ed7494a52" kindref="member">SSH_BUFFER_FREE</ref>(<ref refid="benchmarks_8c_1aff2566f4c366b48d73479bef43ee4d2e" kindref="member">buffer</ref>);</highlight></codeline>
<codeline lineno="2403"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref>;</highlight></codeline>
<codeline lineno="2404"><highlight class="normal">}</highlight></codeline>
<codeline lineno="2405"><highlight class="normal"></highlight></codeline>
<codeline lineno="2406"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>DEPRECATED<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2407" refid="group__libssh__channel_1ga041a495f0230bb017cdf7459e6773664" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="group__libssh__channel_1ga041a495f0230bb017cdf7459e6773664" kindref="member">ssh_forward_listen</ref>(<ref refid="structssh__session__struct" kindref="compound">ssh_session</ref><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*address,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="sshnetcat_8c_1ad723da1801ae1586eb330380e2d9a912" kindref="member">port</ref>,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>*bound_port)<sp/>{</highlight></codeline>
<codeline lineno="2408"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="group__libssh__channel_1ga758cda957227751870c8772df46e5b39" kindref="member">ssh_channel_listen_forward</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>,<sp/>address,<sp/><ref refid="sshnetcat_8c_1ad723da1801ae1586eb330380e2d9a912" kindref="member">port</ref>,<sp/>bound_port);</highlight></codeline>
<codeline lineno="2409"><highlight class="normal">}</highlight></codeline>
<codeline lineno="2410"><highlight class="normal"></highlight></codeline>
<codeline lineno="2411"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>DEPRECATED<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2412" refid="group__libssh__channel_1ga205d5ea76fb140075ebb1c20b8f193d3" refkind="member"><highlight class="normal"><ref refid="structssh__channel__struct" kindref="compound">ssh_channel</ref><sp/><ref refid="group__libssh__channel_1ga205d5ea76fb140075ebb1c20b8f193d3" kindref="member">ssh_forward_accept</ref>(<ref refid="structssh__session__struct" kindref="compound">ssh_session</ref><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>timeout_ms)<sp/>{</highlight></codeline>
<codeline lineno="2413"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="group__libssh__channel_1gac43bae56048b912205d102249b436eec" kindref="member">ssh_channel_accept</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>,<sp/><ref refid="libssh_8h_1acc2732b8c54002b0031fa1e40ee60b24a218aac5de2f3a87265e3bcc8542057ed" kindref="member">SSH_CHANNEL_FORWARDED_TCPIP</ref>,<sp/>timeout_ms,<sp/>NULL);</highlight></codeline>
<codeline lineno="2414"><highlight class="normal">}</highlight></codeline>
<codeline lineno="2415"><highlight class="normal"></highlight></codeline>
<codeline lineno="2428" refid="group__libssh__channel_1ga490e4b0a7adc022507b7f165b336afe4" refkind="member"><highlight class="normal"><ref refid="structssh__channel__struct" kindref="compound">ssh_channel</ref><sp/><ref refid="group__libssh__channel_1ga490e4b0a7adc022507b7f165b336afe4" kindref="member">ssh_channel_accept_forward</ref>(<ref refid="structssh__session__struct" kindref="compound">ssh_session</ref><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>timeout_ms,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal">*<sp/>destination_port)<sp/>{</highlight></codeline>
<codeline lineno="2429"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="group__libssh__channel_1gac43bae56048b912205d102249b436eec" kindref="member">ssh_channel_accept</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>,<sp/><ref refid="libssh_8h_1acc2732b8c54002b0031fa1e40ee60b24a218aac5de2f3a87265e3bcc8542057ed" kindref="member">SSH_CHANNEL_FORWARDED_TCPIP</ref>,<sp/>timeout_ms,<sp/>destination_port);</highlight></codeline>
<codeline lineno="2430"><highlight class="normal">}</highlight></codeline>
<codeline lineno="2431"><highlight class="normal"></highlight></codeline>
<codeline lineno="2447" refid="group__libssh__channel_1ga3bff751afc5ecb5bbf9d6447e4e5370f" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="group__libssh__channel_1ga3bff751afc5ecb5bbf9d6447e4e5370f" kindref="member">ssh_channel_cancel_forward</ref>(<ref refid="structssh__session__struct" kindref="compound">ssh_session</ref><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>,</highlight></codeline>
<codeline lineno="2448"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*address,</highlight></codeline>
<codeline lineno="2449"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="sshnetcat_8c_1ad723da1801ae1586eb330380e2d9a912" kindref="member">port</ref>)</highlight></codeline>
<codeline lineno="2450"><highlight class="normal">{</highlight></codeline>
<codeline lineno="2451"><highlight class="normal"><sp/><sp/><ref refid="structssh__buffer__struct" kindref="compound">ssh_buffer</ref><sp/><ref refid="benchmarks_8c_1aff2566f4c366b48d73479bef43ee4d2e" kindref="member">buffer</ref><sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="2452"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" kindref="member">SSH_ERROR</ref>;</highlight></codeline>
<codeline lineno="2453"><highlight class="normal"></highlight></codeline>
<codeline lineno="2454"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a70a72ecdca89309b5a19e8c887f2ca2c" kindref="member">global_req_state</ref><sp/>!=<sp/><ref refid="channels_8h_1a774597eb1605e8b48cd065965fdc2325a98c7a3dcf02759118261e2bac4d6e421" kindref="member">SSH_CHANNEL_REQ_STATE_NONE</ref>)</highlight></codeline>
<codeline lineno="2455"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">goto</highlight><highlight class="normal"><sp/>pending;</highlight></codeline>
<codeline lineno="2456"><highlight class="normal"></highlight></codeline>
<codeline lineno="2457"><highlight class="normal"><sp/><sp/><ref refid="benchmarks_8c_1aff2566f4c366b48d73479bef43ee4d2e" kindref="member">buffer</ref><sp/>=<sp/><ref refid="group__libssh__buffer_1ga7ecc914104a5bf0da485d3e42f6a7d3b" kindref="member">ssh_buffer_new</ref>();</highlight></codeline>
<codeline lineno="2458"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="benchmarks_8c_1aff2566f4c366b48d73479bef43ee4d2e" kindref="member">buffer</ref><sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="2459"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="priv_8h_1ae280c413c792e04237f000841ac8ce44" kindref="member">ssh_set_error_oom</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>);</highlight></codeline>
<codeline lineno="2460"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">goto</highlight><highlight class="normal"><sp/><ref refid="proxy_8c_1a11614f44ef4d939bdd984953346a7572" kindref="member">error</ref>;</highlight></codeline>
<codeline lineno="2461"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="2462"><highlight class="normal"></highlight></codeline>
<codeline lineno="2463"><highlight class="normal"><sp/><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="buffer_8h_1ae17848a86043f0abfc60c1c4f6126ccd" kindref="member">ssh_buffer_pack</ref>(<ref refid="benchmarks_8c_1aff2566f4c366b48d73479bef43ee4d2e" kindref="member">buffer</ref>,<sp/></highlight><highlight class="stringliteral">&quot;sd&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="2464"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>address<sp/>?<sp/>address<sp/>:<sp/></highlight><highlight class="stringliteral">&quot;&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="2465"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="sshnetcat_8c_1ad723da1801ae1586eb330380e2d9a912" kindref="member">port</ref>);</highlight></codeline>
<codeline lineno="2466"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>!=<sp/><ref refid="libssh_8h_1ac1ee1d1e917456d4760a94a18015377d" kindref="member">SSH_OK</ref>){</highlight></codeline>
<codeline lineno="2467"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="priv_8h_1ae280c413c792e04237f000841ac8ce44" kindref="member">ssh_set_error_oom</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>);</highlight></codeline>
<codeline lineno="2468"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">goto</highlight><highlight class="normal"><sp/><ref refid="proxy_8c_1a11614f44ef4d939bdd984953346a7572" kindref="member">error</ref>;</highlight></codeline>
<codeline lineno="2469"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="2470"><highlight class="normal">pending:</highlight></codeline>
<codeline lineno="2471"><highlight class="normal"><sp/><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="group__libssh__channel_1ga814cf8a82b4098b8994f9029fed572c0" kindref="member">ssh_global_request</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>,<sp/></highlight><highlight class="stringliteral">&quot;cancel-tcpip-forward&quot;</highlight><highlight class="normal">,<sp/><ref refid="benchmarks_8c_1aff2566f4c366b48d73479bef43ee4d2e" kindref="member">buffer</ref>,<sp/>1);</highlight></codeline>
<codeline lineno="2472"><highlight class="normal"></highlight></codeline>
<codeline lineno="2473"><highlight class="normal"><ref refid="proxy_8c_1a11614f44ef4d939bdd984953346a7572" kindref="member">error</ref>:</highlight></codeline>
<codeline lineno="2474"><highlight class="normal"><sp/><sp/><ref refid="libssh_8h_1a8b09f7d6f7066de7ef8dab4ed7494a52" kindref="member">SSH_BUFFER_FREE</ref>(<ref refid="benchmarks_8c_1aff2566f4c366b48d73479bef43ee4d2e" kindref="member">buffer</ref>);</highlight></codeline>
<codeline lineno="2475"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref>;</highlight></codeline>
<codeline lineno="2476"><highlight class="normal">}</highlight></codeline>
<codeline lineno="2477"><highlight class="normal"></highlight></codeline>
<codeline lineno="2478"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>DEPRECATED<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2479" refid="group__libssh__channel_1gac474d071d80e725c8b5633cb1d35c010" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="group__libssh__channel_1gac474d071d80e725c8b5633cb1d35c010" kindref="member">ssh_forward_cancel</ref>(<ref refid="structssh__session__struct" kindref="compound">ssh_session</ref><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*address,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="sshnetcat_8c_1ad723da1801ae1586eb330380e2d9a912" kindref="member">port</ref>)<sp/>{</highlight></codeline>
<codeline lineno="2480"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="group__libssh__channel_1ga3bff751afc5ecb5bbf9d6447e4e5370f" kindref="member">ssh_channel_cancel_forward</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>,<sp/>address,<sp/><ref refid="sshnetcat_8c_1ad723da1801ae1586eb330380e2d9a912" kindref="member">port</ref>);</highlight></codeline>
<codeline lineno="2481"><highlight class="normal">}</highlight></codeline>
<codeline lineno="2482"><highlight class="normal"></highlight></codeline>
<codeline lineno="2498" refid="group__libssh__channel_1ga7aede2f9af4c494ff9e41fc08a4572f1" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="group__libssh__channel_1ga7aede2f9af4c494ff9e41fc08a4572f1" kindref="member">ssh_channel_request_env</ref>(<ref refid="structssh__channel__struct" kindref="compound">ssh_channel</ref><sp/>channel,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*<ref refid="samplesshd-kbdint_8c_1a8f8f80d37794cde9472343e4487ba3eb" kindref="member">name</ref>,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*value)<sp/>{</highlight></codeline>
<codeline lineno="2499"><highlight class="normal"><sp/><sp/><ref refid="structssh__buffer__struct" kindref="compound">ssh_buffer</ref><sp/><ref refid="benchmarks_8c_1aff2566f4c366b48d73479bef43ee4d2e" kindref="member">buffer</ref><sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="2500"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" kindref="member">SSH_ERROR</ref>;</highlight></codeline>
<codeline lineno="2501"><highlight class="normal"></highlight></codeline>
<codeline lineno="2502"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(channel<sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="2503"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" kindref="member">SSH_ERROR</ref>;</highlight></codeline>
<codeline lineno="2504"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="2505"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<ref refid="samplesshd-kbdint_8c_1a8f8f80d37794cde9472343e4487ba3eb" kindref="member">name</ref><sp/>==<sp/>NULL<sp/>||<sp/>value<sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="2506"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="priv_8h_1a351ea86857d33b3ba80b396e05c4517c" kindref="member">ssh_set_error_invalid</ref>(channel-&gt;<ref refid="structssh__channel__struct_1a0832dc830d09accd2f3a8f8349c3faf2" kindref="member">session</ref>);</highlight></codeline>
<codeline lineno="2507"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref>;</highlight></codeline>
<codeline lineno="2508"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="2509"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">switch</highlight><highlight class="normal">(channel-&gt;<ref refid="structssh__channel__struct_1a25a8d874fbdccd50ecfff837ef69bad2" kindref="member">request_state</ref>){</highlight></codeline>
<codeline lineno="2510"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="channels_8h_1a774597eb1605e8b48cd065965fdc2325a98c7a3dcf02759118261e2bac4d6e421" kindref="member">SSH_CHANNEL_REQ_STATE_NONE</ref>:</highlight></codeline>
<codeline lineno="2511"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="2512"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">default</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="2513"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">goto</highlight><highlight class="normal"><sp/>pending;</highlight></codeline>
<codeline lineno="2514"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="2515"><highlight class="normal"><sp/><sp/><ref refid="benchmarks_8c_1aff2566f4c366b48d73479bef43ee4d2e" kindref="member">buffer</ref><sp/>=<sp/><ref refid="group__libssh__buffer_1ga7ecc914104a5bf0da485d3e42f6a7d3b" kindref="member">ssh_buffer_new</ref>();</highlight></codeline>
<codeline lineno="2516"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="benchmarks_8c_1aff2566f4c366b48d73479bef43ee4d2e" kindref="member">buffer</ref><sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="2517"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="priv_8h_1ae280c413c792e04237f000841ac8ce44" kindref="member">ssh_set_error_oom</ref>(channel-&gt;<ref refid="structssh__channel__struct_1a0832dc830d09accd2f3a8f8349c3faf2" kindref="member">session</ref>);</highlight></codeline>
<codeline lineno="2518"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">goto</highlight><highlight class="normal"><sp/><ref refid="proxy_8c_1a11614f44ef4d939bdd984953346a7572" kindref="member">error</ref>;</highlight></codeline>
<codeline lineno="2519"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="2520"><highlight class="normal"></highlight></codeline>
<codeline lineno="2521"><highlight class="normal"><sp/><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="buffer_8h_1ae17848a86043f0abfc60c1c4f6126ccd" kindref="member">ssh_buffer_pack</ref>(<ref refid="benchmarks_8c_1aff2566f4c366b48d73479bef43ee4d2e" kindref="member">buffer</ref>,</highlight></codeline>
<codeline lineno="2522"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;ss&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="2523"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="samplesshd-kbdint_8c_1a8f8f80d37794cde9472343e4487ba3eb" kindref="member">name</ref>,</highlight></codeline>
<codeline lineno="2524"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>value);</highlight></codeline>
<codeline lineno="2525"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>!=<sp/><ref refid="libssh_8h_1ac1ee1d1e917456d4760a94a18015377d" kindref="member">SSH_OK</ref>){</highlight></codeline>
<codeline lineno="2526"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="priv_8h_1ae280c413c792e04237f000841ac8ce44" kindref="member">ssh_set_error_oom</ref>(channel-&gt;<ref refid="structssh__channel__struct_1a0832dc830d09accd2f3a8f8349c3faf2" kindref="member">session</ref>);</highlight></codeline>
<codeline lineno="2527"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">goto</highlight><highlight class="normal"><sp/><ref refid="proxy_8c_1a11614f44ef4d939bdd984953346a7572" kindref="member">error</ref>;</highlight></codeline>
<codeline lineno="2528"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="2529"><highlight class="normal">pending:</highlight></codeline>
<codeline lineno="2530"><highlight class="normal"><sp/><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="group__libssh__channel_1gaee35ccabe6998568d138d35f538765d9" kindref="member">channel_request</ref>(channel,<sp/></highlight><highlight class="stringliteral">&quot;env&quot;</highlight><highlight class="normal">,<sp/><ref refid="benchmarks_8c_1aff2566f4c366b48d73479bef43ee4d2e" kindref="member">buffer</ref>,1);</highlight></codeline>
<codeline lineno="2531"><highlight class="normal"><ref refid="proxy_8c_1a11614f44ef4d939bdd984953346a7572" kindref="member">error</ref>:</highlight></codeline>
<codeline lineno="2532"><highlight class="normal"><sp/><sp/><ref refid="libssh_8h_1a8b09f7d6f7066de7ef8dab4ed7494a52" kindref="member">SSH_BUFFER_FREE</ref>(<ref refid="benchmarks_8c_1aff2566f4c366b48d73479bef43ee4d2e" kindref="member">buffer</ref>);</highlight></codeline>
<codeline lineno="2533"><highlight class="normal"></highlight></codeline>
<codeline lineno="2534"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref>;</highlight></codeline>
<codeline lineno="2535"><highlight class="normal">}</highlight></codeline>
<codeline lineno="2536"><highlight class="normal"></highlight></codeline>
<codeline lineno="2568" refid="group__libssh__channel_1ga567d509183ade0a77190f390e2b5747d" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="group__libssh__channel_1ga567d509183ade0a77190f390e2b5747d" kindref="member">ssh_channel_request_exec</ref>(<ref refid="structssh__channel__struct" kindref="compound">ssh_channel</ref><sp/>channel,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*cmd)<sp/>{</highlight></codeline>
<codeline lineno="2569"><highlight class="normal"><sp/><sp/><ref refid="structssh__buffer__struct" kindref="compound">ssh_buffer</ref><sp/><ref refid="benchmarks_8c_1aff2566f4c366b48d73479bef43ee4d2e" kindref="member">buffer</ref><sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="2570"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" kindref="member">SSH_ERROR</ref>;</highlight></codeline>
<codeline lineno="2571"><highlight class="normal"></highlight></codeline>
<codeline lineno="2572"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(channel<sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="2573"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" kindref="member">SSH_ERROR</ref>;</highlight></codeline>
<codeline lineno="2574"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="2575"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(cmd<sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="2576"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="priv_8h_1a351ea86857d33b3ba80b396e05c4517c" kindref="member">ssh_set_error_invalid</ref>(channel-&gt;<ref refid="structssh__channel__struct_1a0832dc830d09accd2f3a8f8349c3faf2" kindref="member">session</ref>);</highlight></codeline>
<codeline lineno="2577"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref>;</highlight></codeline>
<codeline lineno="2578"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="2579"><highlight class="normal"></highlight></codeline>
<codeline lineno="2580"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">switch</highlight><highlight class="normal">(channel-&gt;<ref refid="structssh__channel__struct_1a25a8d874fbdccd50ecfff837ef69bad2" kindref="member">request_state</ref>){</highlight></codeline>
<codeline lineno="2581"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="channels_8h_1a774597eb1605e8b48cd065965fdc2325a98c7a3dcf02759118261e2bac4d6e421" kindref="member">SSH_CHANNEL_REQ_STATE_NONE</ref>:</highlight></codeline>
<codeline lineno="2582"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="2583"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">default</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="2584"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">goto</highlight><highlight class="normal"><sp/>pending;</highlight></codeline>
<codeline lineno="2585"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="2586"><highlight class="normal"><sp/><sp/><ref refid="benchmarks_8c_1aff2566f4c366b48d73479bef43ee4d2e" kindref="member">buffer</ref><sp/>=<sp/><ref refid="group__libssh__buffer_1ga7ecc914104a5bf0da485d3e42f6a7d3b" kindref="member">ssh_buffer_new</ref>();</highlight></codeline>
<codeline lineno="2587"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="benchmarks_8c_1aff2566f4c366b48d73479bef43ee4d2e" kindref="member">buffer</ref><sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="2588"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="priv_8h_1ae280c413c792e04237f000841ac8ce44" kindref="member">ssh_set_error_oom</ref>(channel-&gt;<ref refid="structssh__channel__struct_1a0832dc830d09accd2f3a8f8349c3faf2" kindref="member">session</ref>);</highlight></codeline>
<codeline lineno="2589"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">goto</highlight><highlight class="normal"><sp/><ref refid="proxy_8c_1a11614f44ef4d939bdd984953346a7572" kindref="member">error</ref>;</highlight></codeline>
<codeline lineno="2590"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="2591"><highlight class="normal"></highlight></codeline>
<codeline lineno="2592"><highlight class="normal"><sp/><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="buffer_8h_1ae17848a86043f0abfc60c1c4f6126ccd" kindref="member">ssh_buffer_pack</ref>(<ref refid="benchmarks_8c_1aff2566f4c366b48d73479bef43ee4d2e" kindref="member">buffer</ref>,<sp/></highlight><highlight class="stringliteral">&quot;s&quot;</highlight><highlight class="normal">,<sp/>cmd);</highlight></codeline>
<codeline lineno="2593"><highlight class="normal"></highlight></codeline>
<codeline lineno="2594"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>!=<sp/><ref refid="libssh_8h_1ac1ee1d1e917456d4760a94a18015377d" kindref="member">SSH_OK</ref>)<sp/>{</highlight></codeline>
<codeline lineno="2595"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="priv_8h_1ae280c413c792e04237f000841ac8ce44" kindref="member">ssh_set_error_oom</ref>(channel-&gt;<ref refid="structssh__channel__struct_1a0832dc830d09accd2f3a8f8349c3faf2" kindref="member">session</ref>);</highlight></codeline>
<codeline lineno="2596"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">goto</highlight><highlight class="normal"><sp/><ref refid="proxy_8c_1a11614f44ef4d939bdd984953346a7572" kindref="member">error</ref>;</highlight></codeline>
<codeline lineno="2597"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="2598"><highlight class="normal">pending:</highlight></codeline>
<codeline lineno="2599"><highlight class="normal"><sp/><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="group__libssh__channel_1gaee35ccabe6998568d138d35f538765d9" kindref="member">channel_request</ref>(channel,<sp/></highlight><highlight class="stringliteral">&quot;exec&quot;</highlight><highlight class="normal">,<sp/><ref refid="benchmarks_8c_1aff2566f4c366b48d73479bef43ee4d2e" kindref="member">buffer</ref>,<sp/>1);</highlight></codeline>
<codeline lineno="2600"><highlight class="normal"><ref refid="proxy_8c_1a11614f44ef4d939bdd984953346a7572" kindref="member">error</ref>:</highlight></codeline>
<codeline lineno="2601"><highlight class="normal"><sp/><sp/><ref refid="libssh_8h_1a8b09f7d6f7066de7ef8dab4ed7494a52" kindref="member">SSH_BUFFER_FREE</ref>(<ref refid="benchmarks_8c_1aff2566f4c366b48d73479bef43ee4d2e" kindref="member">buffer</ref>);</highlight></codeline>
<codeline lineno="2602"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref>;</highlight></codeline>
<codeline lineno="2603"><highlight class="normal">}</highlight></codeline>
<codeline lineno="2604"><highlight class="normal"></highlight></codeline>
<codeline lineno="2605"><highlight class="normal"></highlight></codeline>
<codeline lineno="2638" refid="group__libssh__channel_1gaa98315fca818b561970a6950683f4053" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="group__libssh__channel_1gaa98315fca818b561970a6950683f4053" kindref="member">ssh_channel_request_send_signal</ref>(<ref refid="structssh__channel__struct" kindref="compound">ssh_channel</ref><sp/>channel,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*sig)<sp/>{</highlight></codeline>
<codeline lineno="2639"><highlight class="normal"><sp/><sp/><ref refid="structssh__buffer__struct" kindref="compound">ssh_buffer</ref><sp/><ref refid="benchmarks_8c_1aff2566f4c366b48d73479bef43ee4d2e" kindref="member">buffer</ref><sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="2640"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" kindref="member">SSH_ERROR</ref>;</highlight></codeline>
<codeline lineno="2641"><highlight class="normal"></highlight></codeline>
<codeline lineno="2642"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(channel<sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="2643"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" kindref="member">SSH_ERROR</ref>;</highlight></codeline>
<codeline lineno="2644"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="2645"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(sig<sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="2646"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="priv_8h_1a351ea86857d33b3ba80b396e05c4517c" kindref="member">ssh_set_error_invalid</ref>(channel-&gt;<ref refid="structssh__channel__struct_1a0832dc830d09accd2f3a8f8349c3faf2" kindref="member">session</ref>);</highlight></codeline>
<codeline lineno="2647"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref>;</highlight></codeline>
<codeline lineno="2648"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="2649"><highlight class="normal"></highlight></codeline>
<codeline lineno="2650"><highlight class="normal"><sp/><sp/><ref refid="benchmarks_8c_1aff2566f4c366b48d73479bef43ee4d2e" kindref="member">buffer</ref><sp/>=<sp/><ref refid="group__libssh__buffer_1ga7ecc914104a5bf0da485d3e42f6a7d3b" kindref="member">ssh_buffer_new</ref>();</highlight></codeline>
<codeline lineno="2651"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="benchmarks_8c_1aff2566f4c366b48d73479bef43ee4d2e" kindref="member">buffer</ref><sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="2652"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="priv_8h_1ae280c413c792e04237f000841ac8ce44" kindref="member">ssh_set_error_oom</ref>(channel-&gt;<ref refid="structssh__channel__struct_1a0832dc830d09accd2f3a8f8349c3faf2" kindref="member">session</ref>);</highlight></codeline>
<codeline lineno="2653"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">goto</highlight><highlight class="normal"><sp/><ref refid="proxy_8c_1a11614f44ef4d939bdd984953346a7572" kindref="member">error</ref>;</highlight></codeline>
<codeline lineno="2654"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="2655"><highlight class="normal"></highlight></codeline>
<codeline lineno="2656"><highlight class="normal"><sp/><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="buffer_8h_1ae17848a86043f0abfc60c1c4f6126ccd" kindref="member">ssh_buffer_pack</ref>(<ref refid="benchmarks_8c_1aff2566f4c366b48d73479bef43ee4d2e" kindref="member">buffer</ref>,<sp/></highlight><highlight class="stringliteral">&quot;s&quot;</highlight><highlight class="normal">,<sp/>sig);</highlight></codeline>
<codeline lineno="2657"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>!=<sp/><ref refid="libssh_8h_1ac1ee1d1e917456d4760a94a18015377d" kindref="member">SSH_OK</ref>)<sp/>{</highlight></codeline>
<codeline lineno="2658"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="priv_8h_1ae280c413c792e04237f000841ac8ce44" kindref="member">ssh_set_error_oom</ref>(channel-&gt;<ref refid="structssh__channel__struct_1a0832dc830d09accd2f3a8f8349c3faf2" kindref="member">session</ref>);</highlight></codeline>
<codeline lineno="2659"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">goto</highlight><highlight class="normal"><sp/><ref refid="proxy_8c_1a11614f44ef4d939bdd984953346a7572" kindref="member">error</ref>;</highlight></codeline>
<codeline lineno="2660"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="2661"><highlight class="normal"></highlight></codeline>
<codeline lineno="2662"><highlight class="normal"><sp/><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="group__libssh__channel_1gaee35ccabe6998568d138d35f538765d9" kindref="member">channel_request</ref>(channel,<sp/></highlight><highlight class="stringliteral">&quot;signal&quot;</highlight><highlight class="normal">,<sp/><ref refid="benchmarks_8c_1aff2566f4c366b48d73479bef43ee4d2e" kindref="member">buffer</ref>,<sp/>0);</highlight></codeline>
<codeline lineno="2663"><highlight class="normal"><ref refid="proxy_8c_1a11614f44ef4d939bdd984953346a7572" kindref="member">error</ref>:</highlight></codeline>
<codeline lineno="2664"><highlight class="normal"><sp/><sp/><ref refid="libssh_8h_1a8b09f7d6f7066de7ef8dab4ed7494a52" kindref="member">SSH_BUFFER_FREE</ref>(<ref refid="benchmarks_8c_1aff2566f4c366b48d73479bef43ee4d2e" kindref="member">buffer</ref>);</highlight></codeline>
<codeline lineno="2665"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref>;</highlight></codeline>
<codeline lineno="2666"><highlight class="normal">}</highlight></codeline>
<codeline lineno="2667"><highlight class="normal"></highlight></codeline>
<codeline lineno="2668"><highlight class="normal"></highlight></codeline>
<codeline lineno="2684" refid="group__libssh__channel_1gaef198ad0dcf0968aa2a449c8898d985e" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="group__libssh__channel_1gaef198ad0dcf0968aa2a449c8898d985e" kindref="member">ssh_channel_request_send_break</ref>(<ref refid="structssh__channel__struct" kindref="compound">ssh_channel</ref><sp/>channel,<sp/>uint32_t<sp/>length)<sp/>{</highlight></codeline>
<codeline lineno="2685"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="structssh__buffer__struct" kindref="compound">ssh_buffer</ref><sp/><ref refid="benchmarks_8c_1aff2566f4c366b48d73479bef43ee4d2e" kindref="member">buffer</ref><sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="2686"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" kindref="member">SSH_ERROR</ref>;</highlight></codeline>
<codeline lineno="2687"><highlight class="normal"></highlight></codeline>
<codeline lineno="2688"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(channel<sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="2689"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" kindref="member">SSH_ERROR</ref>;</highlight></codeline>
<codeline lineno="2690"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2691"><highlight class="normal"></highlight></codeline>
<codeline lineno="2692"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="benchmarks_8c_1aff2566f4c366b48d73479bef43ee4d2e" kindref="member">buffer</ref><sp/>=<sp/><ref refid="group__libssh__buffer_1ga7ecc914104a5bf0da485d3e42f6a7d3b" kindref="member">ssh_buffer_new</ref>();</highlight></codeline>
<codeline lineno="2693"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="benchmarks_8c_1aff2566f4c366b48d73479bef43ee4d2e" kindref="member">buffer</ref><sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="2694"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="priv_8h_1ae280c413c792e04237f000841ac8ce44" kindref="member">ssh_set_error_oom</ref>(channel-&gt;<ref refid="structssh__channel__struct_1a0832dc830d09accd2f3a8f8349c3faf2" kindref="member">session</ref>);</highlight></codeline>
<codeline lineno="2695"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">goto</highlight><highlight class="normal"><sp/><ref refid="proxy_8c_1a11614f44ef4d939bdd984953346a7572" kindref="member">error</ref>;</highlight></codeline>
<codeline lineno="2696"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2697"><highlight class="normal"></highlight></codeline>
<codeline lineno="2698"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="buffer_8h_1ae17848a86043f0abfc60c1c4f6126ccd" kindref="member">ssh_buffer_pack</ref>(<ref refid="benchmarks_8c_1aff2566f4c366b48d73479bef43ee4d2e" kindref="member">buffer</ref>,<sp/></highlight><highlight class="stringliteral">&quot;d&quot;</highlight><highlight class="normal">,<sp/>length);</highlight></codeline>
<codeline lineno="2699"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>!=<sp/><ref refid="libssh_8h_1ac1ee1d1e917456d4760a94a18015377d" kindref="member">SSH_OK</ref>)<sp/>{</highlight></codeline>
<codeline lineno="2700"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="priv_8h_1ae280c413c792e04237f000841ac8ce44" kindref="member">ssh_set_error_oom</ref>(channel-&gt;<ref refid="structssh__channel__struct_1a0832dc830d09accd2f3a8f8349c3faf2" kindref="member">session</ref>);</highlight></codeline>
<codeline lineno="2701"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">goto</highlight><highlight class="normal"><sp/><ref refid="proxy_8c_1a11614f44ef4d939bdd984953346a7572" kindref="member">error</ref>;</highlight></codeline>
<codeline lineno="2702"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2703"><highlight class="normal"></highlight></codeline>
<codeline lineno="2704"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="group__libssh__channel_1gaee35ccabe6998568d138d35f538765d9" kindref="member">channel_request</ref>(channel,<sp/></highlight><highlight class="stringliteral">&quot;break&quot;</highlight><highlight class="normal">,<sp/><ref refid="benchmarks_8c_1aff2566f4c366b48d73479bef43ee4d2e" kindref="member">buffer</ref>,<sp/>0);</highlight></codeline>
<codeline lineno="2705"><highlight class="normal"></highlight></codeline>
<codeline lineno="2706"><highlight class="normal"><ref refid="proxy_8c_1a11614f44ef4d939bdd984953346a7572" kindref="member">error</ref>:</highlight></codeline>
<codeline lineno="2707"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="libssh_8h_1a8b09f7d6f7066de7ef8dab4ed7494a52" kindref="member">SSH_BUFFER_FREE</ref>(<ref refid="benchmarks_8c_1aff2566f4c366b48d73479bef43ee4d2e" kindref="member">buffer</ref>);</highlight></codeline>
<codeline lineno="2708"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref>;</highlight></codeline>
<codeline lineno="2709"><highlight class="normal">}</highlight></codeline>
<codeline lineno="2710"><highlight class="normal"></highlight></codeline>
<codeline lineno="2711"><highlight class="normal"></highlight></codeline>
<codeline lineno="2731" refid="group__libssh__channel_1gab391f5c978cb1bc8df3ebd061f38e8c5" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="group__libssh__channel_1gab391f5c978cb1bc8df3ebd061f38e8c5" kindref="member">channel_read_buffer</ref>(<ref refid="structssh__channel__struct" kindref="compound">ssh_channel</ref><sp/>channel,<sp/><ref refid="structssh__buffer__struct" kindref="compound">ssh_buffer</ref><sp/><ref refid="benchmarks_8c_1aff2566f4c366b48d73479bef43ee4d2e" kindref="member">buffer</ref>,<sp/>uint32_t<sp/>count,</highlight></codeline>
<codeline lineno="2732"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>is_stderr)<sp/>{</highlight></codeline>
<codeline lineno="2733"><highlight class="normal"><sp/><sp/><ref refid="structssh__session__struct" kindref="compound">ssh_session</ref><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>;</highlight></codeline>
<codeline lineno="2734"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>buffer_tmp[8192];</highlight></codeline>
<codeline lineno="2735"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>r;</highlight></codeline>
<codeline lineno="2736"><highlight class="normal"><sp/><sp/>uint32_t<sp/>total=0;</highlight></codeline>
<codeline lineno="2737"><highlight class="normal"></highlight></codeline>
<codeline lineno="2738"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(channel<sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="2739"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" kindref="member">SSH_ERROR</ref>;</highlight></codeline>
<codeline lineno="2740"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="2741"><highlight class="normal"><sp/><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref><sp/>=<sp/>channel-&gt;<ref refid="structssh__channel__struct_1a0832dc830d09accd2f3a8f8349c3faf2" kindref="member">session</ref>;</highlight></codeline>
<codeline lineno="2742"><highlight class="normal"></highlight></codeline>
<codeline lineno="2743"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<ref refid="benchmarks_8c_1aff2566f4c366b48d73479bef43ee4d2e" kindref="member">buffer</ref><sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="2744"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="priv_8h_1a351ea86857d33b3ba80b396e05c4517c" kindref="member">ssh_set_error_invalid</ref>(channel-&gt;<ref refid="structssh__channel__struct_1a0832dc830d09accd2f3a8f8349c3faf2" kindref="member">session</ref>);</highlight></codeline>
<codeline lineno="2745"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" kindref="member">SSH_ERROR</ref>;</highlight></codeline>
<codeline lineno="2746"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="2747"><highlight class="normal"></highlight></codeline>
<codeline lineno="2748"><highlight class="normal"><sp/><sp/><ref refid="libssh_8h_1ac8802ff7f5348d0145dab5242623f740" kindref="member">ssh_buffer_reinit</ref>(<ref refid="benchmarks_8c_1aff2566f4c366b48d73479bef43ee4d2e" kindref="member">buffer</ref>);</highlight></codeline>
<codeline lineno="2749"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(count==0){</highlight></codeline>
<codeline lineno="2750"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">do</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="2751"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>r=<ref refid="group__libssh__channel_1ga157f7d1df5de07ec6c6976e2034ba6e2" kindref="member">ssh_channel_poll</ref>(channel,<sp/>is_stderr);</highlight></codeline>
<codeline lineno="2752"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(r<sp/>&lt;<sp/>0){</highlight></codeline>
<codeline lineno="2753"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>r;</highlight></codeline>
<codeline lineno="2754"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2755"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(r<sp/>&gt;<sp/>0){</highlight></codeline>
<codeline lineno="2756"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>r=<ref refid="group__libssh__channel_1gac92381c4c5d4a7eab35f6e84686f033d" kindref="member">ssh_channel_read</ref>(channel,<sp/>buffer_tmp,<sp/>r,<sp/>is_stderr);</highlight></codeline>
<codeline lineno="2757"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(r<sp/>&lt;<sp/>0){</highlight></codeline>
<codeline lineno="2758"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>r;</highlight></codeline>
<codeline lineno="2759"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2760"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<ref refid="libssh_8h_1a92d37237bf129961367accd4a9e0dcfc" kindref="member">ssh_buffer_add_data</ref>(<ref refid="benchmarks_8c_1aff2566f4c366b48d73479bef43ee4d2e" kindref="member">buffer</ref>,buffer_tmp,r)<sp/>&lt;<sp/>0){</highlight></codeline>
<codeline lineno="2761"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="priv_8h_1ae280c413c792e04237f000841ac8ce44" kindref="member">ssh_set_error_oom</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>);</highlight></codeline>
<codeline lineno="2762"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>r<sp/>=<sp/><ref refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" kindref="member">SSH_ERROR</ref>;</highlight></codeline>
<codeline lineno="2763"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2764"><highlight class="normal"></highlight></codeline>
<codeline lineno="2765"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>r;</highlight></codeline>
<codeline lineno="2766"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2767"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<ref refid="group__libssh__channel_1gab535264029443d77214c0615a0788b0a" kindref="member">ssh_channel_is_eof</ref>(channel)){</highlight></codeline>
<codeline lineno="2768"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>0;</highlight></codeline>
<codeline lineno="2769"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2770"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="group__libssh__session_1gaa0e04dc9e24d5112a5ca2b7bd68031d0" kindref="member">ssh_handle_packets</ref>(channel-&gt;<ref refid="structssh__channel__struct_1a0832dc830d09accd2f3a8f8349c3faf2" kindref="member">session</ref>,<sp/><ref refid="session_8h_1ae931fa7865b3e4d87c18b5bd5e44e74e" kindref="member">SSH_TIMEOUT_INFINITE</ref>);</highlight></codeline>
<codeline lineno="2771"><highlight class="normal"><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>(r<sp/>==<sp/>0);</highlight></codeline>
<codeline lineno="2772"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="2773"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal">(total<sp/>&lt;<sp/>count){</highlight></codeline>
<codeline lineno="2774"><highlight class="normal"><sp/><sp/><sp/><sp/>r=<ref refid="group__libssh__channel_1gac92381c4c5d4a7eab35f6e84686f033d" kindref="member">ssh_channel_read</ref>(channel,<sp/>buffer_tmp,<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(buffer_tmp),<sp/>is_stderr);</highlight></codeline>
<codeline lineno="2775"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(r&lt;0){</highlight></codeline>
<codeline lineno="2776"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>r;</highlight></codeline>
<codeline lineno="2777"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2778"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(r==0){</highlight></codeline>
<codeline lineno="2779"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>total;</highlight></codeline>
<codeline lineno="2780"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2781"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="libssh_8h_1a92d37237bf129961367accd4a9e0dcfc" kindref="member">ssh_buffer_add_data</ref>(<ref refid="benchmarks_8c_1aff2566f4c366b48d73479bef43ee4d2e" kindref="member">buffer</ref>,buffer_tmp,r)<sp/>&lt;<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="2782"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="priv_8h_1ae280c413c792e04237f000841ac8ce44" kindref="member">ssh_set_error_oom</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>);</highlight></codeline>
<codeline lineno="2783"><highlight class="normal"></highlight></codeline>
<codeline lineno="2784"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" kindref="member">SSH_ERROR</ref>;</highlight></codeline>
<codeline lineno="2785"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2786"><highlight class="normal"><sp/><sp/><sp/><sp/>total<sp/>+=<sp/>r;</highlight></codeline>
<codeline lineno="2787"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="2788"><highlight class="normal"></highlight></codeline>
<codeline lineno="2789"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>total;</highlight></codeline>
<codeline lineno="2790"><highlight class="normal">}</highlight></codeline>
<codeline lineno="2791"><highlight class="normal"></highlight></codeline>
<codeline lineno="2792" refid="structssh__channel__read__termination__struct" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">struct<sp/></highlight><highlight class="normal"><ref refid="structssh__channel__read__termination__struct" kindref="compound">ssh_channel_read_termination_struct</ref><sp/>{</highlight></codeline>
<codeline lineno="2793" refid="group__libssh__channel_1ga068a064822da15bbc84f0b888b3791e3" refkind="member"><highlight class="normal"><sp/><sp/><ref refid="structssh__channel__struct" kindref="compound">ssh_channel</ref><sp/><ref refid="group__libssh__channel_1ga068a064822da15bbc84f0b888b3791e3" kindref="member">channel</ref>;</highlight></codeline>
<codeline lineno="2794" refid="group__libssh__channel_1ga56d60a9f4b6cd70f239fdc20ebc0d17c" refkind="member"><highlight class="normal"><sp/><sp/>uint32_t<sp/><ref refid="group__libssh__channel_1ga56d60a9f4b6cd70f239fdc20ebc0d17c" kindref="member">count</ref>;</highlight></codeline>
<codeline lineno="2795" refid="group__libssh__channel_1ga08553fc1cb59d4276f5ddd9309cf85d4" refkind="member"><highlight class="normal"><sp/><sp/><ref refid="structssh__buffer__struct" kindref="compound">ssh_buffer</ref><sp/><ref refid="group__libssh__channel_1ga08553fc1cb59d4276f5ddd9309cf85d4" kindref="member">buffer</ref>;</highlight></codeline>
<codeline lineno="2796"><highlight class="normal">};</highlight></codeline>
<codeline lineno="2797"><highlight class="normal"></highlight></codeline>
<codeline lineno="2798" refid="group__libssh__channel_1ga7e90618e682963ae420321a16102d213" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="group__libssh__channel_1ga7e90618e682963ae420321a16102d213" kindref="member">ssh_channel_read_termination</ref>(</highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>*<ref refid="test__socket_8c_1a73991beba1accdcc64730cb00c146fe2" kindref="member">s</ref>){</highlight></codeline>
<codeline lineno="2799"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">struct<sp/></highlight><highlight class="normal"><ref refid="structssh__channel__read__termination__struct" kindref="compound">ssh_channel_read_termination_struct</ref><sp/>*<ref refid="pkd__daemon_8c_1a369ae25f82baa025322b03deb70aa5f3" kindref="member">ctx</ref><sp/>=<sp/><ref refid="test__socket_8c_1a73991beba1accdcc64730cb00c146fe2" kindref="member">s</ref>;</highlight></codeline>
<codeline lineno="2800"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="libssh_8h_1a61400c7267feb254046cd606a3fdfdbc" kindref="member">ssh_buffer_get_len</ref>(<ref refid="pkd__daemon_8c_1a369ae25f82baa025322b03deb70aa5f3" kindref="member">ctx</ref>-&gt;buffer)<sp/>&gt;=<sp/><ref refid="pkd__daemon_8c_1a369ae25f82baa025322b03deb70aa5f3" kindref="member">ctx</ref>-&gt;count<sp/>||</highlight></codeline>
<codeline lineno="2801"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pkd__daemon_8c_1a369ae25f82baa025322b03deb70aa5f3" kindref="member">ctx</ref>-&gt;channel-&gt;remote_eof<sp/>||</highlight></codeline>
<codeline lineno="2802"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pkd__daemon_8c_1a369ae25f82baa025322b03deb70aa5f3" kindref="member">ctx</ref>-&gt;channel-&gt;session-&gt;session_state<sp/>==<sp/><ref refid="session_8h_1a9bbd1d5ae11485e27279be6ad461992ca855474fc84a2fb170fcb72546af8eeb8" kindref="member">SSH_SESSION_STATE_ERROR</ref>)</highlight></codeline>
<codeline lineno="2803"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>1;</highlight></codeline>
<codeline lineno="2804"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2805"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>0;</highlight></codeline>
<codeline lineno="2806"><highlight class="normal">}</highlight></codeline>
<codeline lineno="2807"><highlight class="normal"></highlight></codeline>
<codeline lineno="2808"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>TODO<sp/>FIXME<sp/>Fix<sp/>the<sp/>delayed<sp/>close<sp/>thing<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2809"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>TODO<sp/>FIXME<sp/>Fix<sp/>the<sp/>blocking<sp/>behaviours<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2810"><highlight class="normal"></highlight></codeline>
<codeline lineno="2831" refid="group__libssh__channel_1gac92381c4c5d4a7eab35f6e84686f033d" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="group__libssh__channel_1gac92381c4c5d4a7eab35f6e84686f033d" kindref="member">ssh_channel_read</ref>(<ref refid="structssh__channel__struct" kindref="compound">ssh_channel</ref><sp/><ref refid="group__libssh__channel_1ga068a064822da15bbc84f0b888b3791e3" kindref="member">channel</ref>,<sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>*dest,<sp/>uint32_t<sp/><ref refid="group__libssh__channel_1ga56d60a9f4b6cd70f239fdc20ebc0d17c" kindref="member">count</ref>,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>is_stderr)</highlight></codeline>
<codeline lineno="2832"><highlight class="normal">{</highlight></codeline>
<codeline lineno="2833"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="group__libssh__channel_1ga2f4e02cb3b3adbc30a534623164068fd" kindref="member">ssh_channel_read_timeout</ref>(<ref refid="group__libssh__channel_1ga068a064822da15bbc84f0b888b3791e3" kindref="member">channel</ref>,</highlight></codeline>
<codeline lineno="2834"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dest,</highlight></codeline>
<codeline lineno="2835"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="group__libssh__channel_1ga56d60a9f4b6cd70f239fdc20ebc0d17c" kindref="member">count</ref>,</highlight></codeline>
<codeline lineno="2836"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>is_stderr,</highlight></codeline>
<codeline lineno="2837"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="session_8h_1aa8c8d35c7f83d7b00218ebadfac2254b" kindref="member">SSH_TIMEOUT_DEFAULT</ref>);</highlight></codeline>
<codeline lineno="2838"><highlight class="normal">}</highlight></codeline>
<codeline lineno="2839"><highlight class="normal"></highlight></codeline>
<codeline lineno="2863" refid="group__libssh__channel_1ga2f4e02cb3b3adbc30a534623164068fd" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="group__libssh__channel_1ga2f4e02cb3b3adbc30a534623164068fd" kindref="member">ssh_channel_read_timeout</ref>(<ref refid="structssh__channel__struct" kindref="compound">ssh_channel</ref><sp/><ref refid="group__libssh__channel_1ga068a064822da15bbc84f0b888b3791e3" kindref="member">channel</ref>,</highlight></codeline>
<codeline lineno="2864"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>*dest,</highlight></codeline>
<codeline lineno="2865"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>uint32_t<sp/><ref refid="group__libssh__channel_1ga56d60a9f4b6cd70f239fdc20ebc0d17c" kindref="member">count</ref>,</highlight></codeline>
<codeline lineno="2866"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>is_stderr,</highlight></codeline>
<codeline lineno="2867"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>timeout_ms)</highlight></codeline>
<codeline lineno="2868"><highlight class="normal">{</highlight></codeline>
<codeline lineno="2869"><highlight class="normal"><sp/><sp/><ref refid="structssh__session__struct" kindref="compound">ssh_session</ref><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>;</highlight></codeline>
<codeline lineno="2870"><highlight class="normal"><sp/><sp/><ref refid="structssh__buffer__struct" kindref="compound">ssh_buffer</ref><sp/>stdbuf;</highlight></codeline>
<codeline lineno="2871"><highlight class="normal"><sp/><sp/>uint32_t<sp/>len;</highlight></codeline>
<codeline lineno="2872"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">struct<sp/></highlight><highlight class="normal"><ref refid="structssh__channel__read__termination__struct" kindref="compound">ssh_channel_read_termination_struct</ref><sp/><ref refid="pkd__daemon_8c_1a369ae25f82baa025322b03deb70aa5f3" kindref="member">ctx</ref>;</highlight></codeline>
<codeline lineno="2873"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref>;</highlight></codeline>
<codeline lineno="2874"><highlight class="normal"></highlight></codeline>
<codeline lineno="2875"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<ref refid="group__libssh__channel_1ga068a064822da15bbc84f0b888b3791e3" kindref="member">channel</ref><sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="2876"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" kindref="member">SSH_ERROR</ref>;</highlight></codeline>
<codeline lineno="2877"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="2878"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(dest<sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="2879"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="priv_8h_1a351ea86857d33b3ba80b396e05c4517c" kindref="member">ssh_set_error_invalid</ref>(<ref refid="group__libssh__channel_1ga068a064822da15bbc84f0b888b3791e3" kindref="member">channel</ref>-&gt;<ref refid="structssh__channel__struct_1a0832dc830d09accd2f3a8f8349c3faf2" kindref="member">session</ref>);</highlight></codeline>
<codeline lineno="2880"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" kindref="member">SSH_ERROR</ref>;</highlight></codeline>
<codeline lineno="2881"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="2882"><highlight class="normal"></highlight></codeline>
<codeline lineno="2883"><highlight class="normal"><sp/><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref><sp/>=<sp/><ref refid="group__libssh__channel_1ga068a064822da15bbc84f0b888b3791e3" kindref="member">channel</ref>-&gt;<ref refid="structssh__channel__struct_1a0832dc830d09accd2f3a8f8349c3faf2" kindref="member">session</ref>;</highlight></codeline>
<codeline lineno="2884"><highlight class="normal"><sp/><sp/>stdbuf<sp/>=<sp/><ref refid="group__libssh__channel_1ga068a064822da15bbc84f0b888b3791e3" kindref="member">channel</ref>-&gt;<ref refid="structssh__channel__struct_1a8ae1473aafd716256ce762d0115b2321" kindref="member">stdout_buffer</ref>;</highlight></codeline>
<codeline lineno="2885"><highlight class="normal"></highlight></codeline>
<codeline lineno="2886"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="group__libssh__channel_1ga56d60a9f4b6cd70f239fdc20ebc0d17c" kindref="member">count</ref><sp/>==<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="2887"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>0;</highlight></codeline>
<codeline lineno="2888"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="2889"><highlight class="normal"></highlight></codeline>
<codeline lineno="2890"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(is_stderr)<sp/>{</highlight></codeline>
<codeline lineno="2891"><highlight class="normal"><sp/><sp/><sp/><sp/>stdbuf=<ref refid="group__libssh__channel_1ga068a064822da15bbc84f0b888b3791e3" kindref="member">channel</ref>-&gt;<ref refid="structssh__channel__struct_1a6806319dfa8f417bbad93f6481ad99d4" kindref="member">stderr_buffer</ref>;</highlight></codeline>
<codeline lineno="2892"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="2893"><highlight class="normal"></highlight></codeline>
<codeline lineno="2894"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">/*</highlight></codeline>
<codeline lineno="2895"><highlight class="comment"><sp/><sp/><sp/>*<sp/>We<sp/>may<sp/>have<sp/>problem<sp/>if<sp/>the<sp/>window<sp/>is<sp/>too<sp/>small<sp/>to<sp/>accept<sp/>as<sp/>much<sp/>data</highlight></codeline>
<codeline lineno="2896"><highlight class="comment"><sp/><sp/><sp/>*<sp/>as<sp/>asked</highlight></codeline>
<codeline lineno="2897"><highlight class="comment"><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2898"><highlight class="normal"><sp/><sp/><ref refid="priv_8h_1aa21fd8a7a609329603b7b16da7939fca" kindref="member">SSH_LOG</ref>(<ref refid="group__libssh__log_1ggadf764cbdea00d65edcd07bb9953ad2b7a6445dfe21592d69d9741d319538b6673" kindref="member">SSH_LOG_PACKET</ref>,</highlight></codeline>
<codeline lineno="2899"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Read<sp/>(%d)<sp/>buffered<sp/>:<sp/>%d<sp/>bytes.<sp/>Window:<sp/>%d&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="2900"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="group__libssh__channel_1ga56d60a9f4b6cd70f239fdc20ebc0d17c" kindref="member">count</ref>,</highlight></codeline>
<codeline lineno="2901"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="libssh_8h_1a61400c7267feb254046cd606a3fdfdbc" kindref="member">ssh_buffer_get_len</ref>(stdbuf),</highlight></codeline>
<codeline lineno="2902"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="group__libssh__channel_1ga068a064822da15bbc84f0b888b3791e3" kindref="member">channel</ref>-&gt;<ref refid="structssh__channel__struct_1a7067e2963e961729416849785c1d1bd3" kindref="member">local_window</ref>);</highlight></codeline>
<codeline lineno="2903"><highlight class="normal"></highlight></codeline>
<codeline lineno="2904"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="group__libssh__channel_1ga56d60a9f4b6cd70f239fdc20ebc0d17c" kindref="member">count</ref><sp/>&gt;<sp/><ref refid="libssh_8h_1a61400c7267feb254046cd606a3fdfdbc" kindref="member">ssh_buffer_get_len</ref>(stdbuf)<sp/>+<sp/><ref refid="group__libssh__channel_1ga068a064822da15bbc84f0b888b3791e3" kindref="member">channel</ref>-&gt;<ref refid="structssh__channel__struct_1a7067e2963e961729416849785c1d1bd3" kindref="member">local_window</ref>)<sp/>{</highlight></codeline>
<codeline lineno="2905"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="group__libssh__channel_1gac4fc789667578e8f0e2614f5274c9b5f" kindref="member">grow_window</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>,<sp/><ref refid="group__libssh__channel_1ga068a064822da15bbc84f0b888b3791e3" kindref="member">channel</ref>,<sp/><ref refid="group__libssh__channel_1ga56d60a9f4b6cd70f239fdc20ebc0d17c" kindref="member">count</ref><sp/>-<sp/><ref refid="libssh_8h_1a61400c7267feb254046cd606a3fdfdbc" kindref="member">ssh_buffer_get_len</ref>(stdbuf))<sp/>&lt;<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="2906"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>-1;</highlight></codeline>
<codeline lineno="2907"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2908"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="2909"><highlight class="normal"></highlight></codeline>
<codeline lineno="2910"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">/*<sp/>block<sp/>reading<sp/>until<sp/>at<sp/>least<sp/>one<sp/>byte<sp/>has<sp/>been<sp/>read</highlight></codeline>
<codeline lineno="2911"><highlight class="comment"><sp/><sp/>*<sp/><sp/>and<sp/>ignore<sp/>the<sp/>trivial<sp/>case<sp/>count=0</highlight></codeline>
<codeline lineno="2912"><highlight class="comment"><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2913"><highlight class="normal"><sp/><sp/><ref refid="pkd__daemon_8c_1a369ae25f82baa025322b03deb70aa5f3" kindref="member">ctx</ref>.channel<sp/>=<sp/><ref refid="group__libssh__channel_1ga068a064822da15bbc84f0b888b3791e3" kindref="member">channel</ref>;</highlight></codeline>
<codeline lineno="2914"><highlight class="normal"><sp/><sp/><ref refid="pkd__daemon_8c_1a369ae25f82baa025322b03deb70aa5f3" kindref="member">ctx</ref>.buffer<sp/>=<sp/>stdbuf;</highlight></codeline>
<codeline lineno="2915"><highlight class="normal"><sp/><sp/><ref refid="pkd__daemon_8c_1a369ae25f82baa025322b03deb70aa5f3" kindref="member">ctx</ref>.count<sp/>=<sp/>1;</highlight></codeline>
<codeline lineno="2916"><highlight class="normal"></highlight></codeline>
<codeline lineno="2917"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(timeout_ms<sp/>&lt;<sp/><ref refid="session_8h_1aa8c8d35c7f83d7b00218ebadfac2254b" kindref="member">SSH_TIMEOUT_DEFAULT</ref>)<sp/>{</highlight></codeline>
<codeline lineno="2918"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>timeout_ms<sp/>=<sp/><ref refid="session_8h_1ae931fa7865b3e4d87c18b5bd5e44e74e" kindref="member">SSH_TIMEOUT_INFINITE</ref>;</highlight></codeline>
<codeline lineno="2919"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="2920"><highlight class="normal"></highlight></codeline>
<codeline lineno="2921"><highlight class="normal"><sp/><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="group__libssh__session_1ga4b84e1ae757c0d4007a5eefdf4651694" kindref="member">ssh_handle_packets_termination</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>,</highlight></codeline>
<codeline lineno="2922"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>timeout_ms,</highlight></codeline>
<codeline lineno="2923"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="group__libssh__channel_1ga7e90618e682963ae420321a16102d213" kindref="member">ssh_channel_read_termination</ref>,</highlight></codeline>
<codeline lineno="2924"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&amp;<ref refid="pkd__daemon_8c_1a369ae25f82baa025322b03deb70aa5f3" kindref="member">ctx</ref>);</highlight></codeline>
<codeline lineno="2925"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>==<sp/><ref refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" kindref="member">SSH_ERROR</ref>){</highlight></codeline>
<codeline lineno="2926"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref>;</highlight></codeline>
<codeline lineno="2927"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="2928"><highlight class="normal"></highlight></codeline>
<codeline lineno="2929"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">/*</highlight></codeline>
<codeline lineno="2930"><highlight class="comment"><sp/><sp/><sp/>*<sp/>If<sp/>the<sp/>channel<sp/>is<sp/>closed<sp/>or<sp/>in<sp/>an<sp/>error<sp/>state,<sp/>reading<sp/>from<sp/>it<sp/>is<sp/>an<sp/>error</highlight></codeline>
<codeline lineno="2931"><highlight class="comment"><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2932"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a6f74d1a1eb6ed715b1073b67caa18460" kindref="member">session_state</ref><sp/>==<sp/><ref refid="session_8h_1a9bbd1d5ae11485e27279be6ad461992ca855474fc84a2fb170fcb72546af8eeb8" kindref="member">SSH_SESSION_STATE_ERROR</ref>)<sp/>{</highlight></codeline>
<codeline lineno="2933"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" kindref="member">SSH_ERROR</ref>;</highlight></codeline>
<codeline lineno="2934"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="2935"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="group__libssh__channel_1ga068a064822da15bbc84f0b888b3791e3" kindref="member">channel</ref>-&gt;<ref refid="structssh__channel__struct_1a272b198e279fa672afeaf9f2e610eb04" kindref="member">state</ref><sp/>==<sp/><ref refid="channels_8h_1a5a002159e5db31d156bb2a8ce8a10cd1a96872cd3f6e98f6f040097e3ee6cb900" kindref="member">SSH_CHANNEL_STATE_CLOSED</ref>)<sp/>{</highlight></codeline>
<codeline lineno="2936"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="priv_8h_1a55177b3e8db90ca9adb435c44281963c" kindref="member">ssh_set_error</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>,</highlight></codeline>
<codeline lineno="2937"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="libssh_8h_1a036b2b00fb04337a4d06d719d1b62be1a86ff0b2e8da6ad8628efc556b6ce1887" kindref="member">SSH_FATAL</ref>,</highlight></codeline>
<codeline lineno="2938"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Remote<sp/>channel<sp/>is<sp/>closed.&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="2939"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" kindref="member">SSH_ERROR</ref>;</highlight></codeline>
<codeline lineno="2940"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="2941"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="group__libssh__channel_1ga068a064822da15bbc84f0b888b3791e3" kindref="member">channel</ref>-&gt;<ref refid="structssh__channel__struct_1a01fee161bb195c61e434e9bc7b330187" kindref="member">remote_eof</ref><sp/>&amp;&amp;<sp/><ref refid="libssh_8h_1a61400c7267feb254046cd606a3fdfdbc" kindref="member">ssh_buffer_get_len</ref>(stdbuf)<sp/>==<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="2942"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>0;</highlight></codeline>
<codeline lineno="2943"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="2944"><highlight class="normal"><sp/><sp/>len<sp/>=<sp/><ref refid="libssh_8h_1a61400c7267feb254046cd606a3fdfdbc" kindref="member">ssh_buffer_get_len</ref>(stdbuf);</highlight></codeline>
<codeline lineno="2945"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">/*<sp/>Read<sp/>count<sp/>bytes<sp/>if<sp/>len<sp/>is<sp/>greater,<sp/>everything<sp/>otherwise<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2946"><highlight class="normal"><sp/><sp/>len<sp/>=<sp/>(len<sp/>&gt;<sp/><ref refid="group__libssh__channel_1ga56d60a9f4b6cd70f239fdc20ebc0d17c" kindref="member">count</ref><sp/>?<sp/><ref refid="group__libssh__channel_1ga56d60a9f4b6cd70f239fdc20ebc0d17c" kindref="member">count</ref><sp/>:<sp/>len);</highlight></codeline>
<codeline lineno="2947"><highlight class="normal"><sp/><sp/>memcpy(dest,<sp/><ref refid="libssh_8h_1a240b02fb7c0475fbb5996d1f759221ee" kindref="member">ssh_buffer_get</ref>(stdbuf),<sp/>len);</highlight></codeline>
<codeline lineno="2948"><highlight class="normal"><sp/><sp/><ref refid="buffer_8h_1a226d198c4274fac7c354b6a340049d47" kindref="member">ssh_buffer_pass_bytes</ref>(stdbuf,len);</highlight></codeline>
<codeline lineno="2949"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="group__libssh__channel_1ga068a064822da15bbc84f0b888b3791e3" kindref="member">channel</ref>-&gt;<ref refid="structssh__channel__struct_1ab1beeacd4aff735258cb7488c079c6dc" kindref="member">counter</ref><sp/>!=<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="2950"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="group__libssh__channel_1ga068a064822da15bbc84f0b888b3791e3" kindref="member">channel</ref>-&gt;<ref refid="structssh__channel__struct_1ab1beeacd4aff735258cb7488c079c6dc" kindref="member">counter</ref>-&gt;<ref refid="structssh__counter__struct_1a4fb86ab2536688750c960f58ac414c79" kindref="member">in_bytes</ref><sp/>+=<sp/>len;</highlight></codeline>
<codeline lineno="2951"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="2952"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">/*<sp/>Authorize<sp/>some<sp/>buffering<sp/>while<sp/>userapp<sp/>is<sp/>busy<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2953"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="group__libssh__channel_1ga068a064822da15bbc84f0b888b3791e3" kindref="member">channel</ref>-&gt;<ref refid="structssh__channel__struct_1a7067e2963e961729416849785c1d1bd3" kindref="member">local_window</ref><sp/>&lt;<sp/><ref refid="channels_8c_1aebda54a24a840f266fcc864e4940f749" kindref="member">WINDOWLIMIT</ref>)<sp/>{</highlight></codeline>
<codeline lineno="2954"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="group__libssh__channel_1gac4fc789667578e8f0e2614f5274c9b5f" kindref="member">grow_window</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>,<sp/><ref refid="group__libssh__channel_1ga068a064822da15bbc84f0b888b3791e3" kindref="member">channel</ref>,<sp/>0)<sp/>&lt;<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="2955"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>-1;</highlight></codeline>
<codeline lineno="2956"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2957"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="2958"><highlight class="normal"></highlight></codeline>
<codeline lineno="2959"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>len;</highlight></codeline>
<codeline lineno="2960"><highlight class="normal">}</highlight></codeline>
<codeline lineno="2961"><highlight class="normal"></highlight></codeline>
<codeline lineno="2983" refid="group__libssh__channel_1gaaca5a3fbe9839c3ffb37b746afc35f4c" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="group__libssh__channel_1gaaca5a3fbe9839c3ffb37b746afc35f4c" kindref="member">ssh_channel_read_nonblocking</ref>(<ref refid="structssh__channel__struct" kindref="compound">ssh_channel</ref><sp/><ref refid="group__libssh__channel_1ga068a064822da15bbc84f0b888b3791e3" kindref="member">channel</ref>,</highlight></codeline>
<codeline lineno="2984"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>*dest,</highlight></codeline>
<codeline lineno="2985"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>uint32_t<sp/><ref refid="group__libssh__channel_1ga56d60a9f4b6cd70f239fdc20ebc0d17c" kindref="member">count</ref>,</highlight></codeline>
<codeline lineno="2986"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>is_stderr)</highlight></codeline>
<codeline lineno="2987"><highlight class="normal">{</highlight></codeline>
<codeline lineno="2988"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="structssh__session__struct" kindref="compound">ssh_session</ref><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>;</highlight></codeline>
<codeline lineno="2989"><highlight class="normal"><sp/><sp/><sp/><sp/>ssize_t<sp/>to_read;</highlight></codeline>
<codeline lineno="2990"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref>;</highlight></codeline>
<codeline lineno="2991"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>blocking;</highlight></codeline>
<codeline lineno="2992"><highlight class="normal"></highlight></codeline>
<codeline lineno="2993"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<ref refid="group__libssh__channel_1ga068a064822da15bbc84f0b888b3791e3" kindref="member">channel</ref><sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="2994"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" kindref="member">SSH_ERROR</ref>;</highlight></codeline>
<codeline lineno="2995"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2996"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(dest<sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="2997"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="priv_8h_1a351ea86857d33b3ba80b396e05c4517c" kindref="member">ssh_set_error_invalid</ref>(<ref refid="group__libssh__channel_1ga068a064822da15bbc84f0b888b3791e3" kindref="member">channel</ref>-&gt;<ref refid="structssh__channel__struct_1a0832dc830d09accd2f3a8f8349c3faf2" kindref="member">session</ref>);</highlight></codeline>
<codeline lineno="2998"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" kindref="member">SSH_ERROR</ref>;</highlight></codeline>
<codeline lineno="2999"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="3000"><highlight class="normal"></highlight></codeline>
<codeline lineno="3001"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref><sp/>=<sp/><ref refid="group__libssh__channel_1ga068a064822da15bbc84f0b888b3791e3" kindref="member">channel</ref>-&gt;<ref refid="structssh__channel__struct_1a0832dc830d09accd2f3a8f8349c3faf2" kindref="member">session</ref>;</highlight></codeline>
<codeline lineno="3002"><highlight class="normal"></highlight></codeline>
<codeline lineno="3003"><highlight class="normal"><sp/><sp/><sp/><sp/>to_read<sp/>=<sp/><ref refid="group__libssh__channel_1ga157f7d1df5de07ec6c6976e2034ba6e2" kindref="member">ssh_channel_poll</ref>(<ref refid="group__libssh__channel_1ga068a064822da15bbc84f0b888b3791e3" kindref="member">channel</ref>,<sp/>is_stderr);</highlight></codeline>
<codeline lineno="3004"><highlight class="normal"></highlight></codeline>
<codeline lineno="3005"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(to_read<sp/>&lt;=<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="3006"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a6f74d1a1eb6ed715b1073b67caa18460" kindref="member">session_state</ref><sp/>==<sp/><ref refid="session_8h_1a9bbd1d5ae11485e27279be6ad461992ca855474fc84a2fb170fcb72546af8eeb8" kindref="member">SSH_SESSION_STATE_ERROR</ref>){</highlight></codeline>
<codeline lineno="3007"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" kindref="member">SSH_ERROR</ref>;</highlight></codeline>
<codeline lineno="3008"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="3009"><highlight class="normal"></highlight></codeline>
<codeline lineno="3010"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>to_read;<sp/></highlight><highlight class="comment">/*<sp/>may<sp/>be<sp/>an<sp/>error<sp/>code<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3011"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="3012"><highlight class="normal"></highlight></codeline>
<codeline lineno="3013"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>((</highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal">)to_read<sp/>&gt;<sp/><ref refid="group__libssh__channel_1ga56d60a9f4b6cd70f239fdc20ebc0d17c" kindref="member">count</ref>)<sp/>{</highlight></codeline>
<codeline lineno="3014"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>to_read<sp/>=<sp/>(ssize_t)<ref refid="group__libssh__channel_1ga56d60a9f4b6cd70f239fdc20ebc0d17c" kindref="member">count</ref>;</highlight></codeline>
<codeline lineno="3015"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="3016"><highlight class="normal"><sp/><sp/><sp/><sp/>blocking<sp/>=<sp/><ref refid="group__libssh__session_1ga0c959bde817801ac5de2db1e64b52f26" kindref="member">ssh_is_blocking</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>);</highlight></codeline>
<codeline lineno="3017"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="group__libssh__session_1ga2a29cff08855611be84d050e5bec73bc" kindref="member">ssh_set_blocking</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>,<sp/>0);</highlight></codeline>
<codeline lineno="3018"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="group__libssh__channel_1gac92381c4c5d4a7eab35f6e84686f033d" kindref="member">ssh_channel_read</ref>(<ref refid="group__libssh__channel_1ga068a064822da15bbc84f0b888b3791e3" kindref="member">channel</ref>,<sp/>dest,<sp/>(uint32_t)to_read,<sp/>is_stderr);</highlight></codeline>
<codeline lineno="3019"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="group__libssh__session_1ga2a29cff08855611be84d050e5bec73bc" kindref="member">ssh_set_blocking</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>,blocking);</highlight></codeline>
<codeline lineno="3020"><highlight class="normal"></highlight></codeline>
<codeline lineno="3021"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref>;</highlight></codeline>
<codeline lineno="3022"><highlight class="normal">}</highlight></codeline>
<codeline lineno="3023"><highlight class="normal"></highlight></codeline>
<codeline lineno="3038" refid="group__libssh__channel_1ga157f7d1df5de07ec6c6976e2034ba6e2" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="group__libssh__channel_1ga157f7d1df5de07ec6c6976e2034ba6e2" kindref="member">ssh_channel_poll</ref>(<ref refid="structssh__channel__struct" kindref="compound">ssh_channel</ref><sp/><ref refid="group__libssh__channel_1ga068a064822da15bbc84f0b888b3791e3" kindref="member">channel</ref>,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>is_stderr){</highlight></codeline>
<codeline lineno="3039"><highlight class="normal"><sp/><sp/><ref refid="structssh__buffer__struct" kindref="compound">ssh_buffer</ref><sp/>stdbuf;</highlight></codeline>
<codeline lineno="3040"><highlight class="normal"></highlight></codeline>
<codeline lineno="3041"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<ref refid="group__libssh__channel_1ga068a064822da15bbc84f0b888b3791e3" kindref="member">channel</ref><sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="3042"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" kindref="member">SSH_ERROR</ref>;</highlight></codeline>
<codeline lineno="3043"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="3044"><highlight class="normal"></highlight></codeline>
<codeline lineno="3045"><highlight class="normal"><sp/><sp/>stdbuf<sp/>=<sp/><ref refid="group__libssh__channel_1ga068a064822da15bbc84f0b888b3791e3" kindref="member">channel</ref>-&gt;<ref refid="structssh__channel__struct_1a8ae1473aafd716256ce762d0115b2321" kindref="member">stdout_buffer</ref>;</highlight></codeline>
<codeline lineno="3046"><highlight class="normal"></highlight></codeline>
<codeline lineno="3047"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(is_stderr)<sp/>{</highlight></codeline>
<codeline lineno="3048"><highlight class="normal"><sp/><sp/><sp/><sp/>stdbuf<sp/>=<sp/><ref refid="group__libssh__channel_1ga068a064822da15bbc84f0b888b3791e3" kindref="member">channel</ref>-&gt;<ref refid="structssh__channel__struct_1a6806319dfa8f417bbad93f6481ad99d4" kindref="member">stderr_buffer</ref>;</highlight></codeline>
<codeline lineno="3049"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="3050"><highlight class="normal"></highlight></codeline>
<codeline lineno="3051"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="libssh_8h_1a61400c7267feb254046cd606a3fdfdbc" kindref="member">ssh_buffer_get_len</ref>(stdbuf)<sp/>==<sp/>0<sp/>&amp;&amp;<sp/><ref refid="group__libssh__channel_1ga068a064822da15bbc84f0b888b3791e3" kindref="member">channel</ref>-&gt;<ref refid="structssh__channel__struct_1a01fee161bb195c61e434e9bc7b330187" kindref="member">remote_eof</ref><sp/>==<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="3052"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="group__libssh__channel_1ga068a064822da15bbc84f0b888b3791e3" kindref="member">channel</ref>-&gt;<ref refid="structssh__channel__struct_1a0832dc830d09accd2f3a8f8349c3faf2" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a6f74d1a1eb6ed715b1073b67caa18460" kindref="member">session_state</ref><sp/>==<sp/><ref refid="session_8h_1a9bbd1d5ae11485e27279be6ad461992ca855474fc84a2fb170fcb72546af8eeb8" kindref="member">SSH_SESSION_STATE_ERROR</ref>){</highlight></codeline>
<codeline lineno="3053"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" kindref="member">SSH_ERROR</ref>;</highlight></codeline>
<codeline lineno="3054"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="3055"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="group__libssh__session_1gaa0e04dc9e24d5112a5ca2b7bd68031d0" kindref="member">ssh_handle_packets</ref>(<ref refid="group__libssh__channel_1ga068a064822da15bbc84f0b888b3791e3" kindref="member">channel</ref>-&gt;<ref refid="structssh__channel__struct_1a0832dc830d09accd2f3a8f8349c3faf2" kindref="member">session</ref>,<sp/><ref refid="session_8h_1a5dc7677b987888e7db552768afc9d9c6" kindref="member">SSH_TIMEOUT_NONBLOCKING</ref>)==<ref refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" kindref="member">SSH_ERROR</ref>)<sp/>{</highlight></codeline>
<codeline lineno="3056"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" kindref="member">SSH_ERROR</ref>;</highlight></codeline>
<codeline lineno="3057"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="3058"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="3059"><highlight class="normal"></highlight></codeline>
<codeline lineno="3060"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="libssh_8h_1a61400c7267feb254046cd606a3fdfdbc" kindref="member">ssh_buffer_get_len</ref>(stdbuf)<sp/>&gt;<sp/>0){</highlight></codeline>
<codeline lineno="3061"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="libssh_8h_1a61400c7267feb254046cd606a3fdfdbc" kindref="member">ssh_buffer_get_len</ref>(stdbuf);</highlight></codeline>
<codeline lineno="3062"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="3063"><highlight class="normal"></highlight></codeline>
<codeline lineno="3064"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="group__libssh__channel_1ga068a064822da15bbc84f0b888b3791e3" kindref="member">channel</ref>-&gt;<ref refid="structssh__channel__struct_1a01fee161bb195c61e434e9bc7b330187" kindref="member">remote_eof</ref>)<sp/>{</highlight></codeline>
<codeline lineno="3065"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="libssh_8h_1a8f938067bd84c30bd28b7c2705a37beb" kindref="member">SSH_EOF</ref>;</highlight></codeline>
<codeline lineno="3066"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="3067"><highlight class="normal"></highlight></codeline>
<codeline lineno="3068"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="libssh_8h_1a61400c7267feb254046cd606a3fdfdbc" kindref="member">ssh_buffer_get_len</ref>(stdbuf);</highlight></codeline>
<codeline lineno="3069"><highlight class="normal">}</highlight></codeline>
<codeline lineno="3070"><highlight class="normal"></highlight></codeline>
<codeline lineno="3090" refid="group__libssh__channel_1gab56c7b7959e4c23959f2989468811661" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="group__libssh__channel_1gab56c7b7959e4c23959f2989468811661" kindref="member">ssh_channel_poll_timeout</ref>(<ref refid="structssh__channel__struct" kindref="compound">ssh_channel</ref><sp/><ref refid="group__libssh__channel_1ga068a064822da15bbc84f0b888b3791e3" kindref="member">channel</ref>,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>timeout,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>is_stderr)</highlight></codeline>
<codeline lineno="3091"><highlight class="normal">{</highlight></codeline>
<codeline lineno="3092"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="structssh__session__struct" kindref="compound">ssh_session</ref><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>;</highlight></codeline>
<codeline lineno="3093"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="structssh__buffer__struct" kindref="compound">ssh_buffer</ref><sp/>stdbuf;</highlight></codeline>
<codeline lineno="3094"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">struct<sp/></highlight><highlight class="normal"><ref refid="structssh__channel__read__termination__struct" kindref="compound">ssh_channel_read_termination_struct</ref><sp/><ref refid="pkd__daemon_8c_1a369ae25f82baa025322b03deb70aa5f3" kindref="member">ctx</ref>;</highlight></codeline>
<codeline lineno="3095"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/>len;</highlight></codeline>
<codeline lineno="3096"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref>;</highlight></codeline>
<codeline lineno="3097"><highlight class="normal"></highlight></codeline>
<codeline lineno="3098"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<ref refid="group__libssh__channel_1ga068a064822da15bbc84f0b888b3791e3" kindref="member">channel</ref><sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="3099"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" kindref="member">SSH_ERROR</ref>;</highlight></codeline>
<codeline lineno="3100"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="3101"><highlight class="normal"></highlight></codeline>
<codeline lineno="3102"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref><sp/>=<sp/><ref refid="group__libssh__channel_1ga068a064822da15bbc84f0b888b3791e3" kindref="member">channel</ref>-&gt;<ref refid="structssh__channel__struct_1a0832dc830d09accd2f3a8f8349c3faf2" kindref="member">session</ref>;</highlight></codeline>
<codeline lineno="3103"><highlight class="normal"><sp/><sp/><sp/><sp/>stdbuf<sp/>=<sp/><ref refid="group__libssh__channel_1ga068a064822da15bbc84f0b888b3791e3" kindref="member">channel</ref>-&gt;<ref refid="structssh__channel__struct_1a8ae1473aafd716256ce762d0115b2321" kindref="member">stdout_buffer</ref>;</highlight></codeline>
<codeline lineno="3104"><highlight class="normal"></highlight></codeline>
<codeline lineno="3105"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(is_stderr)<sp/>{</highlight></codeline>
<codeline lineno="3106"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>stdbuf<sp/>=<sp/><ref refid="group__libssh__channel_1ga068a064822da15bbc84f0b888b3791e3" kindref="member">channel</ref>-&gt;<ref refid="structssh__channel__struct_1a6806319dfa8f417bbad93f6481ad99d4" kindref="member">stderr_buffer</ref>;</highlight></codeline>
<codeline lineno="3107"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="3108"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="pkd__daemon_8c_1a369ae25f82baa025322b03deb70aa5f3" kindref="member">ctx</ref>.buffer<sp/>=<sp/>stdbuf;</highlight></codeline>
<codeline lineno="3109"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="pkd__daemon_8c_1a369ae25f82baa025322b03deb70aa5f3" kindref="member">ctx</ref>.channel<sp/>=<sp/><ref refid="group__libssh__channel_1ga068a064822da15bbc84f0b888b3791e3" kindref="member">channel</ref>;</highlight></codeline>
<codeline lineno="3110"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="pkd__daemon_8c_1a369ae25f82baa025322b03deb70aa5f3" kindref="member">ctx</ref>.count<sp/>=<sp/>1;</highlight></codeline>
<codeline lineno="3111"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="group__libssh__session_1ga4b84e1ae757c0d4007a5eefdf4651694" kindref="member">ssh_handle_packets_termination</ref>(<ref refid="group__libssh__channel_1ga068a064822da15bbc84f0b888b3791e3" kindref="member">channel</ref>-&gt;<ref refid="structssh__channel__struct_1a0832dc830d09accd2f3a8f8349c3faf2" kindref="member">session</ref>,</highlight></codeline>
<codeline lineno="3112"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>timeout,</highlight></codeline>
<codeline lineno="3113"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="group__libssh__channel_1ga7e90618e682963ae420321a16102d213" kindref="member">ssh_channel_read_termination</ref>,</highlight></codeline>
<codeline lineno="3114"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&amp;<ref refid="pkd__daemon_8c_1a369ae25f82baa025322b03deb70aa5f3" kindref="member">ctx</ref>);</highlight></codeline>
<codeline lineno="3115"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>==<sp/><ref refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" kindref="member">SSH_ERROR</ref><sp/>||</highlight></codeline>
<codeline lineno="3116"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a6f74d1a1eb6ed715b1073b67caa18460" kindref="member">session_state</ref><sp/>==<sp/><ref refid="session_8h_1a9bbd1d5ae11485e27279be6ad461992ca855474fc84a2fb170fcb72546af8eeb8" kindref="member">SSH_SESSION_STATE_ERROR</ref>)<sp/>{</highlight></codeline>
<codeline lineno="3117"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" kindref="member">SSH_ERROR</ref>;</highlight></codeline>
<codeline lineno="3118"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">goto</highlight><highlight class="normal"><sp/>out;</highlight></codeline>
<codeline lineno="3119"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="3120"><highlight class="normal"><sp/><sp/><sp/><sp/>len<sp/>=<sp/><ref refid="libssh_8h_1a61400c7267feb254046cd606a3fdfdbc" kindref="member">ssh_buffer_get_len</ref>(stdbuf);</highlight></codeline>
<codeline lineno="3121"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(len<sp/>&gt;<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="3122"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(len<sp/>&gt;<sp/>INT_MAX)<sp/>{</highlight></codeline>
<codeline lineno="3123"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" kindref="member">SSH_ERROR</ref>;</highlight></codeline>
<codeline lineno="3124"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="3125"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/>(int)len;</highlight></codeline>
<codeline lineno="3126"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="3127"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">goto</highlight><highlight class="normal"><sp/>out;</highlight></codeline>
<codeline lineno="3128"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="3129"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="group__libssh__channel_1ga068a064822da15bbc84f0b888b3791e3" kindref="member">channel</ref>-&gt;<ref refid="structssh__channel__struct_1a01fee161bb195c61e434e9bc7b330187" kindref="member">remote_eof</ref>)<sp/>{</highlight></codeline>
<codeline lineno="3130"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="libssh_8h_1a8f938067bd84c30bd28b7c2705a37beb" kindref="member">SSH_EOF</ref>;</highlight></codeline>
<codeline lineno="3131"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="3132"><highlight class="normal"></highlight></codeline>
<codeline lineno="3133"><highlight class="normal">out:</highlight></codeline>
<codeline lineno="3134"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref>;</highlight></codeline>
<codeline lineno="3135"><highlight class="normal">}</highlight></codeline>
<codeline lineno="3136"><highlight class="normal"></highlight></codeline>
<codeline lineno="3144" refid="group__libssh__channel_1ga747aa5315575aa7ac9d8367c7372d8dd" refkind="member"><highlight class="normal"><ref refid="structssh__session__struct" kindref="compound">ssh_session</ref><sp/><ref refid="group__libssh__channel_1ga747aa5315575aa7ac9d8367c7372d8dd" kindref="member">ssh_channel_get_session</ref>(<ref refid="structssh__channel__struct" kindref="compound">ssh_channel</ref><sp/><ref refid="group__libssh__channel_1ga068a064822da15bbc84f0b888b3791e3" kindref="member">channel</ref>)<sp/>{</highlight></codeline>
<codeline lineno="3145"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<ref refid="group__libssh__channel_1ga068a064822da15bbc84f0b888b3791e3" kindref="member">channel</ref><sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="3146"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>NULL;</highlight></codeline>
<codeline lineno="3147"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="3148"><highlight class="normal"></highlight></codeline>
<codeline lineno="3149"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="group__libssh__channel_1ga068a064822da15bbc84f0b888b3791e3" kindref="member">channel</ref>-&gt;<ref refid="structssh__channel__struct_1a0832dc830d09accd2f3a8f8349c3faf2" kindref="member">session</ref>;</highlight></codeline>
<codeline lineno="3150"><highlight class="normal">}</highlight></codeline>
<codeline lineno="3151"><highlight class="normal"></highlight></codeline>
<codeline lineno="3152" refid="group__libssh__channel_1gae6aa1eaafbacaa66577600e0c811ffd2" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="group__libssh__channel_1gae6aa1eaafbacaa66577600e0c811ffd2" kindref="member">ssh_channel_exit_status_termination</ref>(</highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>*c){</highlight></codeline>
<codeline lineno="3153"><highlight class="normal"><sp/><sp/><ref refid="structssh__channel__struct" kindref="compound">ssh_channel</ref><sp/><ref refid="group__libssh__channel_1ga068a064822da15bbc84f0b888b3791e3" kindref="member">channel</ref><sp/>=<sp/>c;</highlight></codeline>
<codeline lineno="3154"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<ref refid="group__libssh__channel_1ga068a064822da15bbc84f0b888b3791e3" kindref="member">channel</ref>-&gt;<ref refid="structssh__channel__struct_1a3e9106e477bee737abed43d8c57a7bd6" kindref="member">exit_status</ref><sp/>!=<sp/>-1<sp/>||</highlight></codeline>
<codeline lineno="3155"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>When<sp/>a<sp/>channel<sp/>is<sp/>closed,<sp/>no<sp/>exit<sp/>status<sp/>message<sp/>can</highlight></codeline>
<codeline lineno="3156"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>come<sp/>anymore<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3157"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>(<ref refid="group__libssh__channel_1ga068a064822da15bbc84f0b888b3791e3" kindref="member">channel</ref>-&gt;<ref refid="structssh__channel__struct_1a400dc0c0dc7cd02daaea731825c1a7c4" kindref="member">flags</ref><sp/>&amp;<sp/><ref refid="channels_8h_1ade088105d65a071041027d9215213071" kindref="member">SSH_CHANNEL_FLAG_CLOSED_REMOTE</ref>)<sp/>||</highlight></codeline>
<codeline lineno="3158"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="group__libssh__channel_1ga068a064822da15bbc84f0b888b3791e3" kindref="member">channel</ref>-&gt;<ref refid="structssh__channel__struct_1a0832dc830d09accd2f3a8f8349c3faf2" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a6f74d1a1eb6ed715b1073b67caa18460" kindref="member">session_state</ref><sp/>==<sp/><ref refid="session_8h_1a9bbd1d5ae11485e27279be6ad461992ca855474fc84a2fb170fcb72546af8eeb8" kindref="member">SSH_SESSION_STATE_ERROR</ref>)</highlight></codeline>
<codeline lineno="3159"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>1;</highlight></codeline>
<codeline lineno="3160"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3161"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>0;</highlight></codeline>
<codeline lineno="3162"><highlight class="normal">}</highlight></codeline>
<codeline lineno="3163"><highlight class="normal"></highlight></codeline>
<codeline lineno="3180" refid="group__libssh__channel_1ga9eea019dd0bbaa8a817fff2c762d1a2d" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="group__libssh__channel_1ga9eea019dd0bbaa8a817fff2c762d1a2d" kindref="member">ssh_channel_get_exit_status</ref>(<ref refid="structssh__channel__struct" kindref="compound">ssh_channel</ref><sp/><ref refid="group__libssh__channel_1ga068a064822da15bbc84f0b888b3791e3" kindref="member">channel</ref>)<sp/>{</highlight></codeline>
<codeline lineno="3181"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref>;</highlight></codeline>
<codeline lineno="3182"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<ref refid="group__libssh__channel_1ga068a064822da15bbc84f0b888b3791e3" kindref="member">channel</ref><sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="3183"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" kindref="member">SSH_ERROR</ref>;</highlight></codeline>
<codeline lineno="3184"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="3185"><highlight class="normal"><sp/><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="group__libssh__session_1ga4b84e1ae757c0d4007a5eefdf4651694" kindref="member">ssh_handle_packets_termination</ref>(<ref refid="group__libssh__channel_1ga068a064822da15bbc84f0b888b3791e3" kindref="member">channel</ref>-&gt;<ref refid="structssh__channel__struct_1a0832dc830d09accd2f3a8f8349c3faf2" kindref="member">session</ref>,</highlight></codeline>
<codeline lineno="3186"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="session_8h_1aa8c8d35c7f83d7b00218ebadfac2254b" kindref="member">SSH_TIMEOUT_DEFAULT</ref>,</highlight></codeline>
<codeline lineno="3187"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="group__libssh__channel_1gae6aa1eaafbacaa66577600e0c811ffd2" kindref="member">ssh_channel_exit_status_termination</ref>,</highlight></codeline>
<codeline lineno="3188"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="group__libssh__channel_1ga068a064822da15bbc84f0b888b3791e3" kindref="member">channel</ref>);</highlight></codeline>
<codeline lineno="3189"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>==<sp/><ref refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" kindref="member">SSH_ERROR</ref><sp/>||<sp/><ref refid="group__libssh__channel_1ga068a064822da15bbc84f0b888b3791e3" kindref="member">channel</ref>-&gt;<ref refid="structssh__channel__struct_1a0832dc830d09accd2f3a8f8349c3faf2" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a6f74d1a1eb6ed715b1073b67caa18460" kindref="member">session_state</ref><sp/>==</highlight></codeline>
<codeline lineno="3190"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="session_8h_1a9bbd1d5ae11485e27279be6ad461992ca855474fc84a2fb170fcb72546af8eeb8" kindref="member">SSH_SESSION_STATE_ERROR</ref>)</highlight></codeline>
<codeline lineno="3191"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" kindref="member">SSH_ERROR</ref>;</highlight></codeline>
<codeline lineno="3192"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="group__libssh__channel_1ga068a064822da15bbc84f0b888b3791e3" kindref="member">channel</ref>-&gt;<ref refid="structssh__channel__struct_1a3e9106e477bee737abed43d8c57a7bd6" kindref="member">exit_status</ref>;</highlight></codeline>
<codeline lineno="3193"><highlight class="normal">}</highlight></codeline>
<codeline lineno="3194"><highlight class="normal"></highlight></codeline>
<codeline lineno="3195"><highlight class="normal"></highlight><highlight class="comment">/*</highlight></codeline>
<codeline lineno="3196"><highlight class="comment"><sp/>*<sp/>This<sp/>function<sp/>acts<sp/>as<sp/>a<sp/>meta<sp/>select.</highlight></codeline>
<codeline lineno="3197"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="3198"><highlight class="comment"><sp/>*<sp/>First,<sp/>channels<sp/>are<sp/>analyzed<sp/>to<sp/>seek<sp/>potential<sp/>can-write<sp/>or<sp/>can-read<sp/>ones,</highlight></codeline>
<codeline lineno="3199"><highlight class="comment"><sp/>*<sp/>then<sp/>if<sp/>no<sp/>channel<sp/>has<sp/>been<sp/>elected,<sp/>it<sp/>goes<sp/>in<sp/>a<sp/>loop<sp/>with<sp/>the<sp/>posix</highlight></codeline>
<codeline lineno="3200"><highlight class="comment"><sp/>*<sp/>select(2).</highlight></codeline>
<codeline lineno="3201"><highlight class="comment"><sp/>*<sp/>This<sp/>is<sp/>made<sp/>in<sp/>two<sp/>parts:<sp/>protocol<sp/>select<sp/>and<sp/>network<sp/>select.<sp/>The<sp/>protocol</highlight></codeline>
<codeline lineno="3202"><highlight class="comment"><sp/>*<sp/>select<sp/>does<sp/>not<sp/>use<sp/>the<sp/>network<sp/>functions<sp/>at<sp/>all</highlight></codeline>
<codeline lineno="3203"><highlight class="comment"><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3204" refid="group__libssh__channel_1ga3a106d0c860b8ada098b4ed317c3cce4" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="group__libssh__channel_1ga3a106d0c860b8ada098b4ed317c3cce4" kindref="member">channel_protocol_select</ref>(<ref refid="structssh__channel__struct" kindref="compound">ssh_channel</ref><sp/>*rchans,<sp/><ref refid="structssh__channel__struct" kindref="compound">ssh_channel</ref><sp/>*wchans,</highlight></codeline>
<codeline lineno="3205"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="structssh__channel__struct" kindref="compound">ssh_channel</ref><sp/>*echans,<sp/><ref refid="structssh__channel__struct" kindref="compound">ssh_channel</ref><sp/>*rout,<sp/><ref refid="structssh__channel__struct" kindref="compound">ssh_channel</ref><sp/>*wout,<sp/><ref refid="structssh__channel__struct" kindref="compound">ssh_channel</ref><sp/>*eout)<sp/>{</highlight></codeline>
<codeline lineno="3206"><highlight class="normal"><sp/><sp/><ref refid="structssh__channel__struct" kindref="compound">ssh_channel</ref><sp/><ref refid="proxy_8c_1aadb4b99b6f71c3c49bd7b97096d033fa" kindref="member">chan</ref>;</highlight></codeline>
<codeline lineno="3207"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i;</highlight></codeline>
<codeline lineno="3208"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>j<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="3209"><highlight class="normal"></highlight></codeline>
<codeline lineno="3210"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i<sp/>=<sp/>0;<sp/>rchans[i]<sp/>!=<sp/>NULL;<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="3211"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="proxy_8c_1aadb4b99b6f71c3c49bd7b97096d033fa" kindref="member">chan</ref><sp/>=<sp/>rchans[i];</highlight></codeline>
<codeline lineno="3212"><highlight class="normal"></highlight></codeline>
<codeline lineno="3213"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>(<ref refid="group__libssh__channel_1gaaafcda943c96ddb91e5c28c0bdee7045" kindref="member">ssh_channel_is_open</ref>(<ref refid="proxy_8c_1aadb4b99b6f71c3c49bd7b97096d033fa" kindref="member">chan</ref>)<sp/>&amp;&amp;<sp/><ref refid="socket_8h_1a7b6d96bfb71ce6b9d5a4dc8406874691" kindref="member">ssh_socket_data_available</ref>(<ref refid="proxy_8c_1aadb4b99b6f71c3c49bd7b97096d033fa" kindref="member">chan</ref>-&gt;<ref refid="structssh__channel__struct_1a0832dc830d09accd2f3a8f8349c3faf2" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a3e64318ee32b9880aafbded46fabf81d" kindref="member">socket</ref>))<sp/>{</highlight></codeline>
<codeline lineno="3214"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="group__libssh__session_1gaa0e04dc9e24d5112a5ca2b7bd68031d0" kindref="member">ssh_handle_packets</ref>(<ref refid="proxy_8c_1aadb4b99b6f71c3c49bd7b97096d033fa" kindref="member">chan</ref>-&gt;<ref refid="structssh__channel__struct_1a0832dc830d09accd2f3a8f8349c3faf2" kindref="member">session</ref>,<sp/><ref refid="session_8h_1a5dc7677b987888e7db552768afc9d9c6" kindref="member">SSH_TIMEOUT_NONBLOCKING</ref>);</highlight></codeline>
<codeline lineno="3215"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="3216"><highlight class="normal"></highlight></codeline>
<codeline lineno="3217"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>((<ref refid="proxy_8c_1aadb4b99b6f71c3c49bd7b97096d033fa" kindref="member">chan</ref>-&gt;<ref refid="structssh__channel__struct_1a8ae1473aafd716256ce762d0115b2321" kindref="member">stdout_buffer</ref><sp/>&amp;&amp;<sp/><ref refid="libssh_8h_1a61400c7267feb254046cd606a3fdfdbc" kindref="member">ssh_buffer_get_len</ref>(<ref refid="proxy_8c_1aadb4b99b6f71c3c49bd7b97096d033fa" kindref="member">chan</ref>-&gt;<ref refid="structssh__channel__struct_1a8ae1473aafd716256ce762d0115b2321" kindref="member">stdout_buffer</ref>)<sp/>&gt;<sp/>0)<sp/>||</highlight></codeline>
<codeline lineno="3218"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(<ref refid="proxy_8c_1aadb4b99b6f71c3c49bd7b97096d033fa" kindref="member">chan</ref>-&gt;<ref refid="structssh__channel__struct_1a6806319dfa8f417bbad93f6481ad99d4" kindref="member">stderr_buffer</ref><sp/>&amp;&amp;<sp/><ref refid="libssh_8h_1a61400c7267feb254046cd606a3fdfdbc" kindref="member">ssh_buffer_get_len</ref>(<ref refid="proxy_8c_1aadb4b99b6f71c3c49bd7b97096d033fa" kindref="member">chan</ref>-&gt;<ref refid="structssh__channel__struct_1a6806319dfa8f417bbad93f6481ad99d4" kindref="member">stderr_buffer</ref>)<sp/>&gt;<sp/>0)<sp/>||</highlight></codeline>
<codeline lineno="3219"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="proxy_8c_1aadb4b99b6f71c3c49bd7b97096d033fa" kindref="member">chan</ref>-&gt;<ref refid="structssh__channel__struct_1a01fee161bb195c61e434e9bc7b330187" kindref="member">remote_eof</ref>)<sp/>{</highlight></codeline>
<codeline lineno="3220"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>rout[j]<sp/>=<sp/><ref refid="proxy_8c_1aadb4b99b6f71c3c49bd7b97096d033fa" kindref="member">chan</ref>;</highlight></codeline>
<codeline lineno="3221"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>j++;</highlight></codeline>
<codeline lineno="3222"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="3223"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="3224"><highlight class="normal"><sp/><sp/>rout[j]<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="3225"><highlight class="normal"></highlight></codeline>
<codeline lineno="3226"><highlight class="normal"><sp/><sp/>j<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="3227"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal">(i<sp/>=<sp/>0;<sp/>wchans[i]<sp/>!=<sp/>NULL;<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="3228"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="proxy_8c_1aadb4b99b6f71c3c49bd7b97096d033fa" kindref="member">chan</ref><sp/>=<sp/>wchans[i];</highlight></codeline>
<codeline lineno="3229"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>It&apos;s<sp/>not<sp/>our<sp/>business<sp/>to<sp/>seek<sp/>if<sp/>the<sp/>file<sp/>descriptor<sp/>is<sp/>writable<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3230"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="socket_8h_1ac9d2595a2e7ce42c7319d1dce077260c" kindref="member">ssh_socket_data_writable</ref>(<ref refid="proxy_8c_1aadb4b99b6f71c3c49bd7b97096d033fa" kindref="member">chan</ref>-&gt;<ref refid="structssh__channel__struct_1a0832dc830d09accd2f3a8f8349c3faf2" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a3e64318ee32b9880aafbded46fabf81d" kindref="member">socket</ref>)<sp/>&amp;&amp;</highlight></codeline>
<codeline lineno="3231"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="group__libssh__channel_1gaaafcda943c96ddb91e5c28c0bdee7045" kindref="member">ssh_channel_is_open</ref>(<ref refid="proxy_8c_1aadb4b99b6f71c3c49bd7b97096d033fa" kindref="member">chan</ref>)<sp/>&amp;&amp;<sp/>(<ref refid="proxy_8c_1aadb4b99b6f71c3c49bd7b97096d033fa" kindref="member">chan</ref>-&gt;<ref refid="structssh__channel__struct_1a1b5936420da03e6b64aa8f900eb8ad0c" kindref="member">remote_window</ref><sp/>&gt;<sp/>0))<sp/>{</highlight></codeline>
<codeline lineno="3232"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>wout[j]<sp/>=<sp/><ref refid="proxy_8c_1aadb4b99b6f71c3c49bd7b97096d033fa" kindref="member">chan</ref>;</highlight></codeline>
<codeline lineno="3233"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>j++;</highlight></codeline>
<codeline lineno="3234"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="3235"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="3236"><highlight class="normal"><sp/><sp/>wout[j]<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="3237"><highlight class="normal"></highlight></codeline>
<codeline lineno="3238"><highlight class="normal"><sp/><sp/>j<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="3239"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i<sp/>=<sp/>0;<sp/>echans[i]<sp/>!=<sp/>NULL;<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="3240"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="proxy_8c_1aadb4b99b6f71c3c49bd7b97096d033fa" kindref="member">chan</ref><sp/>=<sp/>echans[i];</highlight></codeline>
<codeline lineno="3241"><highlight class="normal"></highlight></codeline>
<codeline lineno="3242"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!<ref refid="socket_8h_1a29176fb6f348985227454a3f5daec745" kindref="member">ssh_socket_is_open</ref>(<ref refid="proxy_8c_1aadb4b99b6f71c3c49bd7b97096d033fa" kindref="member">chan</ref>-&gt;<ref refid="structssh__channel__struct_1a0832dc830d09accd2f3a8f8349c3faf2" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a3e64318ee32b9880aafbded46fabf81d" kindref="member">socket</ref>)<sp/>||<sp/><ref refid="group__libssh__channel_1gab2720b44cb7f1dfe2b38ffe07c2f45c7" kindref="member">ssh_channel_is_closed</ref>(<ref refid="proxy_8c_1aadb4b99b6f71c3c49bd7b97096d033fa" kindref="member">chan</ref>))<sp/>{</highlight></codeline>
<codeline lineno="3243"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>eout[j]<sp/>=<sp/><ref refid="proxy_8c_1aadb4b99b6f71c3c49bd7b97096d033fa" kindref="member">chan</ref>;</highlight></codeline>
<codeline lineno="3244"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>j++;</highlight></codeline>
<codeline lineno="3245"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="3246"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="3247"><highlight class="normal"><sp/><sp/>eout[j]<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="3248"><highlight class="normal"></highlight></codeline>
<codeline lineno="3249"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>0;</highlight></codeline>
<codeline lineno="3250"><highlight class="normal">}</highlight></codeline>
<codeline lineno="3251"><highlight class="normal"></highlight></codeline>
<codeline lineno="3252"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>Just<sp/>count<sp/>number<sp/>of<sp/>pointers<sp/>in<sp/>the<sp/>array<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3253" refid="group__libssh__channel_1ga5f4fae06645c42c053e28b61ec186435" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/><ref refid="group__libssh__channel_1ga5f4fae06645c42c053e28b61ec186435" kindref="member">count_ptrs</ref>(<ref refid="structssh__channel__struct" kindref="compound">ssh_channel</ref><sp/>*ptrs)</highlight></codeline>
<codeline lineno="3254"><highlight class="normal">{</highlight></codeline>
<codeline lineno="3255"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/>c;</highlight></codeline>
<codeline lineno="3256"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(c<sp/>=<sp/>0;<sp/>ptrs[c]<sp/>!=<sp/>NULL;<sp/>c++)</highlight></codeline>
<codeline lineno="3257"><highlight class="normal"><sp/><sp/><sp/><sp/>;</highlight></codeline>
<codeline lineno="3258"><highlight class="normal"></highlight></codeline>
<codeline lineno="3259"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>c;</highlight></codeline>
<codeline lineno="3260"><highlight class="normal">}</highlight></codeline>
<codeline lineno="3261"><highlight class="normal"></highlight></codeline>
<codeline lineno="3284" refid="group__libssh__channel_1ga1026cfa48ecfc0b4898d4ea443acfc5d" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="group__libssh__channel_1ga1026cfa48ecfc0b4898d4ea443acfc5d" kindref="member">ssh_channel_select</ref>(<ref refid="structssh__channel__struct" kindref="compound">ssh_channel</ref><sp/>*readchans,<sp/><ref refid="structssh__channel__struct" kindref="compound">ssh_channel</ref><sp/>*writechans,</highlight></codeline>
<codeline lineno="3285"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="structssh__channel__struct" kindref="compound">ssh_channel</ref><sp/>*exceptchans,<sp/></highlight><highlight class="keyword">struct</highlight><highlight class="normal"><sp/>timeval<sp/>*<sp/>timeout)<sp/>{</highlight></codeline>
<codeline lineno="3286"><highlight class="normal"><sp/><sp/><ref refid="structssh__channel__struct" kindref="compound">ssh_channel</ref><sp/>*rchans,<sp/>*wchans,<sp/>*echans;</highlight></codeline>
<codeline lineno="3287"><highlight class="normal"><sp/><sp/><ref refid="structssh__channel__struct" kindref="compound">ssh_channel</ref><sp/>dummy<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="3288"><highlight class="normal"><sp/><sp/><ref refid="structssh__event__struct" kindref="compound">ssh_event</ref><sp/></highlight><highlight class="keyword">event</highlight><highlight class="normal"><sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="3289"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref>;</highlight></codeline>
<codeline lineno="3290"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i;</highlight></codeline>
<codeline lineno="3291"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>tm,<sp/>tm_base;</highlight></codeline>
<codeline lineno="3292"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>firstround=1;</highlight></codeline>
<codeline lineno="3293"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">struct<sp/></highlight><highlight class="normal"><ref refid="structssh__timestamp" kindref="compound">ssh_timestamp</ref><sp/>ts;</highlight></codeline>
<codeline lineno="3294"><highlight class="normal"></highlight></codeline>
<codeline lineno="3295"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(timeout<sp/>!=<sp/>NULL)</highlight></codeline>
<codeline lineno="3296"><highlight class="normal"><sp/><sp/><sp/><sp/>tm_base<sp/>=<sp/>timeout-&gt;tv_sec<sp/>*<sp/>1000<sp/>+<sp/>timeout-&gt;tv_usec/1000;</highlight></codeline>
<codeline lineno="3297"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3298"><highlight class="normal"><sp/><sp/><sp/><sp/>tm_base<sp/>=<sp/><ref refid="session_8h_1ae931fa7865b3e4d87c18b5bd5e44e74e" kindref="member">SSH_TIMEOUT_INFINITE</ref>;</highlight></codeline>
<codeline lineno="3299"><highlight class="normal"><sp/><sp/><ref refid="group__libssh__misc_1gaaa0c97f49044d29f2a3b5b3ae82979ff" kindref="member">ssh_timestamp_init</ref>(&amp;ts);</highlight></codeline>
<codeline lineno="3300"><highlight class="normal"><sp/><sp/>tm<sp/>=<sp/>tm_base;</highlight></codeline>
<codeline lineno="3301"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">/*<sp/>don&apos;t<sp/>allow<sp/>NULL<sp/>pointers<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3302"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(readchans<sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="3303"><highlight class="normal"><sp/><sp/><sp/><sp/>readchans<sp/>=<sp/>&amp;dummy;</highlight></codeline>
<codeline lineno="3304"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="3305"><highlight class="normal"></highlight></codeline>
<codeline lineno="3306"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(writechans<sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="3307"><highlight class="normal"><sp/><sp/><sp/><sp/>writechans<sp/>=<sp/>&amp;dummy;</highlight></codeline>
<codeline lineno="3308"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="3309"><highlight class="normal"></highlight></codeline>
<codeline lineno="3310"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(exceptchans<sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="3311"><highlight class="normal"><sp/><sp/><sp/><sp/>exceptchans<sp/>=<sp/>&amp;dummy;</highlight></codeline>
<codeline lineno="3312"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="3313"><highlight class="normal"></highlight></codeline>
<codeline lineno="3314"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(readchans[0]<sp/>==<sp/>NULL<sp/>&amp;&amp;<sp/>writechans[0]<sp/>==<sp/>NULL<sp/>&amp;&amp;<sp/>exceptchans[0]<sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="3315"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>No<sp/>channel<sp/>to<sp/>poll??<sp/>Go<sp/>away!<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3316"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>0;</highlight></codeline>
<codeline lineno="3317"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="3318"><highlight class="normal"></highlight></codeline>
<codeline lineno="3319"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">/*<sp/>Prepare<sp/>the<sp/>outgoing<sp/>temporary<sp/>arrays<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3320"><highlight class="normal"><sp/><sp/>rchans<sp/>=<sp/>calloc(<ref refid="group__libssh__channel_1ga5f4fae06645c42c053e28b61ec186435" kindref="member">count_ptrs</ref>(readchans)<sp/>+<sp/>1,<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(<ref refid="structssh__channel__struct" kindref="compound">ssh_channel</ref>));</highlight></codeline>
<codeline lineno="3321"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(rchans<sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="3322"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" kindref="member">SSH_ERROR</ref>;</highlight></codeline>
<codeline lineno="3323"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="3324"><highlight class="normal"></highlight></codeline>
<codeline lineno="3325"><highlight class="normal"><sp/><sp/>wchans<sp/>=<sp/>calloc(<ref refid="group__libssh__channel_1ga5f4fae06645c42c053e28b61ec186435" kindref="member">count_ptrs</ref>(writechans)<sp/>+<sp/>1,<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(<ref refid="structssh__channel__struct" kindref="compound">ssh_channel</ref>));</highlight></codeline>
<codeline lineno="3326"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(wchans<sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="3327"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="sshd__direct-tcpip_8c_1aed3129b7674034c979192bcca6b0ad8c" kindref="member">SAFE_FREE</ref>(rchans);</highlight></codeline>
<codeline lineno="3328"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" kindref="member">SSH_ERROR</ref>;</highlight></codeline>
<codeline lineno="3329"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="3330"><highlight class="normal"></highlight></codeline>
<codeline lineno="3331"><highlight class="normal"><sp/><sp/>echans<sp/>=<sp/>calloc(<ref refid="group__libssh__channel_1ga5f4fae06645c42c053e28b61ec186435" kindref="member">count_ptrs</ref>(exceptchans)<sp/>+<sp/>1,<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(<ref refid="structssh__channel__struct" kindref="compound">ssh_channel</ref>));</highlight></codeline>
<codeline lineno="3332"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(echans<sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="3333"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="sshd__direct-tcpip_8c_1aed3129b7674034c979192bcca6b0ad8c" kindref="member">SAFE_FREE</ref>(rchans);</highlight></codeline>
<codeline lineno="3334"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="sshd__direct-tcpip_8c_1aed3129b7674034c979192bcca6b0ad8c" kindref="member">SAFE_FREE</ref>(wchans);</highlight></codeline>
<codeline lineno="3335"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" kindref="member">SSH_ERROR</ref>;</highlight></codeline>
<codeline lineno="3336"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="3337"><highlight class="normal"></highlight></codeline>
<codeline lineno="3338"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">/*</highlight></codeline>
<codeline lineno="3339"><highlight class="comment"><sp/><sp/><sp/>*<sp/>First,<sp/>try<sp/>without<sp/>doing<sp/>network<sp/>stuff<sp/>then,<sp/>use<sp/>the<sp/>ssh_poll</highlight></codeline>
<codeline lineno="3340"><highlight class="comment"><sp/><sp/><sp/>*<sp/>infrastructure<sp/>to<sp/>poll<sp/>on<sp/>all<sp/>sessions.</highlight></codeline>
<codeline lineno="3341"><highlight class="comment"><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3342"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">do</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="3343"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="group__libssh__channel_1ga3a106d0c860b8ada098b4ed317c3cce4" kindref="member">channel_protocol_select</ref>(readchans,<sp/>writechans,<sp/>exceptchans,</highlight></codeline>
<codeline lineno="3344"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rchans,<sp/>wchans,<sp/>echans);</highlight></codeline>
<codeline lineno="3345"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(rchans[0]<sp/>!=<sp/>NULL<sp/>||<sp/>wchans[0]<sp/>!=<sp/>NULL<sp/>||<sp/>echans[0]<sp/>!=<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="3346"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>At<sp/>least<sp/>one<sp/>channel<sp/>has<sp/>an<sp/>event<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3347"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="3348"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="3349"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Add<sp/>all<sp/>channels&apos;<sp/>sessions<sp/>right<sp/>into<sp/>an<sp/>event<sp/>object<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3350"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(event<sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="3351"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">event</highlight><highlight class="normal"><sp/>=<sp/><ref refid="group__libssh__poll_1ga406895f99b6b486c4b65536e5399ff96" kindref="member">ssh_event_new</ref>();</highlight></codeline>
<codeline lineno="3352"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(event<sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="3353"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="sshd__direct-tcpip_8c_1aed3129b7674034c979192bcca6b0ad8c" kindref="member">SAFE_FREE</ref>(rchans);</highlight></codeline>
<codeline lineno="3354"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="sshd__direct-tcpip_8c_1aed3129b7674034c979192bcca6b0ad8c" kindref="member">SAFE_FREE</ref>(wchans);</highlight></codeline>
<codeline lineno="3355"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="sshd__direct-tcpip_8c_1aed3129b7674034c979192bcca6b0ad8c" kindref="member">SAFE_FREE</ref>(echans);</highlight></codeline>
<codeline lineno="3356"><highlight class="normal"></highlight></codeline>
<codeline lineno="3357"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" kindref="member">SSH_ERROR</ref>;</highlight></codeline>
<codeline lineno="3358"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="3359"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i<sp/>=<sp/>0;<sp/>readchans[i]<sp/>!=<sp/>NULL;<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="3360"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="group__libssh__poll_1ga8ad007907f642d4aa2c25e5209bf337a" kindref="member">ssh_poll_get_default_ctx</ref>(readchans[i]-&gt;<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>);</highlight></codeline>
<codeline lineno="3361"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="group__libssh__poll_1ga51af38de4cc3adbd5566ec1f1b91983d" kindref="member">ssh_event_add_session</ref>(event,<sp/>readchans[i]-&gt;<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>);</highlight></codeline>
<codeline lineno="3362"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="3363"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i<sp/>=<sp/>0;<sp/>writechans[i]<sp/>!=<sp/>NULL;<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="3364"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="group__libssh__poll_1ga8ad007907f642d4aa2c25e5209bf337a" kindref="member">ssh_poll_get_default_ctx</ref>(writechans[i]-&gt;<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>);</highlight></codeline>
<codeline lineno="3365"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="group__libssh__poll_1ga51af38de4cc3adbd5566ec1f1b91983d" kindref="member">ssh_event_add_session</ref>(event,<sp/>writechans[i]-&gt;<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>);</highlight></codeline>
<codeline lineno="3366"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="3367"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i<sp/>=<sp/>0;<sp/>exceptchans[i]<sp/>!=<sp/>NULL;<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="3368"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="group__libssh__poll_1ga8ad007907f642d4aa2c25e5209bf337a" kindref="member">ssh_poll_get_default_ctx</ref>(exceptchans[i]-&gt;<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>);</highlight></codeline>
<codeline lineno="3369"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="group__libssh__poll_1ga51af38de4cc3adbd5566ec1f1b91983d" kindref="member">ssh_event_add_session</ref>(event,<sp/>exceptchans[i]-&gt;<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>);</highlight></codeline>
<codeline lineno="3370"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="3371"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="3372"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Get<sp/>out<sp/>if<sp/>the<sp/>timeout<sp/>has<sp/>elapsed<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3373"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!firstround<sp/>&amp;&amp;<sp/><ref refid="group__libssh__misc_1ga1a6abbb2da16c6543f7de29b5c98f086" kindref="member">ssh_timeout_elapsed</ref>(&amp;ts,<sp/>tm_base)){</highlight></codeline>
<codeline lineno="3374"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="3375"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="3376"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Here<sp/>we<sp/>go<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3377"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="group__libssh__poll_1gada90c0ca6919271708ba1ea0352632cb" kindref="member">ssh_event_dopoll</ref>(event,tm);</highlight></codeline>
<codeline lineno="3378"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>!=<sp/><ref refid="libssh_8h_1ac1ee1d1e917456d4760a94a18015377d" kindref="member">SSH_OK</ref>){</highlight></codeline>
<codeline lineno="3379"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="sshd__direct-tcpip_8c_1aed3129b7674034c979192bcca6b0ad8c" kindref="member">SAFE_FREE</ref>(rchans);</highlight></codeline>
<codeline lineno="3380"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="sshd__direct-tcpip_8c_1aed3129b7674034c979192bcca6b0ad8c" kindref="member">SAFE_FREE</ref>(wchans);</highlight></codeline>
<codeline lineno="3381"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="sshd__direct-tcpip_8c_1aed3129b7674034c979192bcca6b0ad8c" kindref="member">SAFE_FREE</ref>(echans);</highlight></codeline>
<codeline lineno="3382"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="group__libssh__poll_1ga101388903c74d53ed550574b587449cd" kindref="member">ssh_event_free</ref>(event);</highlight></codeline>
<codeline lineno="3383"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref>;</highlight></codeline>
<codeline lineno="3384"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="3385"><highlight class="normal"><sp/><sp/><sp/><sp/>tm<sp/>=<sp/><ref refid="group__libssh__misc_1gad1c4b29e2421eb8f9ca111d98b0c2976" kindref="member">ssh_timeout_update</ref>(&amp;ts,<sp/>tm_base);</highlight></codeline>
<codeline lineno="3386"><highlight class="normal"><sp/><sp/><sp/><sp/>firstround=0;</highlight></codeline>
<codeline lineno="3387"><highlight class="normal"><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal">(1);</highlight></codeline>
<codeline lineno="3388"><highlight class="normal"></highlight></codeline>
<codeline lineno="3389"><highlight class="normal"><sp/><sp/>memcpy(readchans,<sp/>rchans,<sp/>(<ref refid="group__libssh__channel_1ga5f4fae06645c42c053e28b61ec186435" kindref="member">count_ptrs</ref>(rchans)<sp/>+<sp/>1)<sp/>*<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(<ref refid="structssh__channel__struct" kindref="compound">ssh_channel</ref><sp/>));</highlight></codeline>
<codeline lineno="3390"><highlight class="normal"><sp/><sp/>memcpy(writechans,<sp/>wchans,<sp/>(<ref refid="group__libssh__channel_1ga5f4fae06645c42c053e28b61ec186435" kindref="member">count_ptrs</ref>(wchans)<sp/>+<sp/>1)<sp/>*<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(<ref refid="structssh__channel__struct" kindref="compound">ssh_channel</ref><sp/>));</highlight></codeline>
<codeline lineno="3391"><highlight class="normal"><sp/><sp/>memcpy(exceptchans,<sp/>echans,<sp/>(<ref refid="group__libssh__channel_1ga5f4fae06645c42c053e28b61ec186435" kindref="member">count_ptrs</ref>(echans)<sp/>+<sp/>1)<sp/>*<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(<ref refid="structssh__channel__struct" kindref="compound">ssh_channel</ref><sp/>));</highlight></codeline>
<codeline lineno="3392"><highlight class="normal"><sp/><sp/><ref refid="sshd__direct-tcpip_8c_1aed3129b7674034c979192bcca6b0ad8c" kindref="member">SAFE_FREE</ref>(rchans);</highlight></codeline>
<codeline lineno="3393"><highlight class="normal"><sp/><sp/><ref refid="sshd__direct-tcpip_8c_1aed3129b7674034c979192bcca6b0ad8c" kindref="member">SAFE_FREE</ref>(wchans);</highlight></codeline>
<codeline lineno="3394"><highlight class="normal"><sp/><sp/><ref refid="sshd__direct-tcpip_8c_1aed3129b7674034c979192bcca6b0ad8c" kindref="member">SAFE_FREE</ref>(echans);</highlight></codeline>
<codeline lineno="3395"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(event)</highlight></codeline>
<codeline lineno="3396"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="group__libssh__poll_1ga101388903c74d53ed550574b587449cd" kindref="member">ssh_event_free</ref>(event);</highlight></codeline>
<codeline lineno="3397"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>0;</highlight></codeline>
<codeline lineno="3398"><highlight class="normal">}</highlight></codeline>
<codeline lineno="3399"><highlight class="normal"></highlight></codeline>
<codeline lineno="3418" refid="group__libssh__channel_1gab0649fe21b7a900b4a8e10ecb3401395" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="group__libssh__channel_1gab0649fe21b7a900b4a8e10ecb3401395" kindref="member">ssh_channel_set_counter</ref>(<ref refid="structssh__channel__struct" kindref="compound">ssh_channel</ref><sp/>channel,</highlight></codeline>
<codeline lineno="3419"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structssh__counter__struct" kindref="compound">ssh_counter</ref><sp/>counter)<sp/>{</highlight></codeline>
<codeline lineno="3420"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(channel<sp/>!=<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="3421"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>channel-&gt;<ref refid="structssh__channel__struct_1ab1beeacd4aff735258cb7488c079c6dc" kindref="member">counter</ref><sp/>=<sp/>counter;</highlight></codeline>
<codeline lineno="3422"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="3423"><highlight class="normal">}</highlight></codeline>
<codeline lineno="3424"><highlight class="normal"></highlight></codeline>
<codeline lineno="3438" refid="group__libssh__channel_1ga7ebd0ed490ee4485c6d5feb7d22bc162" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="group__libssh__channel_1ga7ebd0ed490ee4485c6d5feb7d22bc162" kindref="member">ssh_channel_write_stderr</ref>(<ref refid="structssh__channel__struct" kindref="compound">ssh_channel</ref><sp/>channel,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>*data,<sp/>uint32_t<sp/>len)<sp/>{</highlight></codeline>
<codeline lineno="3439"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="group__libssh__channel_1ga918e9bde297309e977a872bc62c0d260" kindref="member">channel_write_common</ref>(channel,<sp/>data,<sp/>len,<sp/>1);</highlight></codeline>
<codeline lineno="3440"><highlight class="normal">}</highlight></codeline>
<codeline lineno="3441"><highlight class="normal"></highlight></codeline>
<codeline lineno="3442"><highlight class="normal"></highlight><highlight class="preprocessor">#if<sp/>WITH_SERVER</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3443"><highlight class="normal"></highlight></codeline>
<codeline lineno="3468"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="group__libssh__server_1gae372d2f97205d23493dd856eedf95f22" kindref="member">ssh_channel_open_reverse_forward</ref>(<ref refid="structssh__channel__struct" kindref="compound">ssh_channel</ref><sp/>channel,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*remotehost,</highlight></codeline>
<codeline lineno="3469"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>remoteport,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*sourcehost,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>localport)<sp/>{</highlight></codeline>
<codeline lineno="3470"><highlight class="normal"><sp/><sp/><ref refid="structssh__session__struct" kindref="compound">ssh_session</ref><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>;</highlight></codeline>
<codeline lineno="3471"><highlight class="normal"><sp/><sp/><ref refid="structssh__buffer__struct" kindref="compound">ssh_buffer</ref><sp/>payload<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="3472"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" kindref="member">SSH_ERROR</ref>;</highlight></codeline>
<codeline lineno="3473"><highlight class="normal"></highlight></codeline>
<codeline lineno="3474"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(channel<sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="3475"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref>;</highlight></codeline>
<codeline lineno="3476"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="3477"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(remotehost<sp/>==<sp/>NULL<sp/>||<sp/>sourcehost<sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="3478"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="priv_8h_1a351ea86857d33b3ba80b396e05c4517c" kindref="member">ssh_set_error_invalid</ref>(channel-&gt;<ref refid="structssh__channel__struct_1a0832dc830d09accd2f3a8f8349c3faf2" kindref="member">session</ref>);</highlight></codeline>
<codeline lineno="3479"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref>;</highlight></codeline>
<codeline lineno="3480"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="3481"><highlight class="normal"></highlight></codeline>
<codeline lineno="3482"><highlight class="normal"><sp/><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref><sp/>=<sp/>channel-&gt;<ref refid="structssh__channel__struct_1a0832dc830d09accd2f3a8f8349c3faf2" kindref="member">session</ref>;</highlight></codeline>
<codeline lineno="3483"><highlight class="normal"></highlight></codeline>
<codeline lineno="3484"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(channel-&gt;<ref refid="structssh__channel__struct_1a272b198e279fa672afeaf9f2e610eb04" kindref="member">state</ref><sp/>!=<sp/><ref refid="channels_8h_1a5a002159e5db31d156bb2a8ce8a10cd1a1c7ade5ea201bca92177fa99becb3a0c" kindref="member">SSH_CHANNEL_STATE_NOT_OPEN</ref>)</highlight></codeline>
<codeline lineno="3485"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">goto</highlight><highlight class="normal"><sp/>pending;</highlight></codeline>
<codeline lineno="3486"><highlight class="normal"><sp/><sp/>payload<sp/>=<sp/><ref refid="group__libssh__buffer_1ga7ecc914104a5bf0da485d3e42f6a7d3b" kindref="member">ssh_buffer_new</ref>();</highlight></codeline>
<codeline lineno="3487"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(payload<sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="3488"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="priv_8h_1ae280c413c792e04237f000841ac8ce44" kindref="member">ssh_set_error_oom</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>);</highlight></codeline>
<codeline lineno="3489"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">goto</highlight><highlight class="normal"><sp/><ref refid="proxy_8c_1a11614f44ef4d939bdd984953346a7572" kindref="member">error</ref>;</highlight></codeline>
<codeline lineno="3490"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="3491"><highlight class="normal"><sp/><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="buffer_8h_1ae17848a86043f0abfc60c1c4f6126ccd" kindref="member">ssh_buffer_pack</ref>(payload,</highlight></codeline>
<codeline lineno="3492"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;sdsd&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="3493"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>remotehost,</highlight></codeline>
<codeline lineno="3494"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>remoteport,</highlight></codeline>
<codeline lineno="3495"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sourcehost,</highlight></codeline>
<codeline lineno="3496"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>localport);</highlight></codeline>
<codeline lineno="3497"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>!=<sp/><ref refid="libssh_8h_1ac1ee1d1e917456d4760a94a18015377d" kindref="member">SSH_OK</ref>){</highlight></codeline>
<codeline lineno="3498"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="priv_8h_1ae280c413c792e04237f000841ac8ce44" kindref="member">ssh_set_error_oom</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>);</highlight></codeline>
<codeline lineno="3499"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">goto</highlight><highlight class="normal"><sp/><ref refid="proxy_8c_1a11614f44ef4d939bdd984953346a7572" kindref="member">error</ref>;</highlight></codeline>
<codeline lineno="3500"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="3501"><highlight class="normal">pending:</highlight></codeline>
<codeline lineno="3502"><highlight class="normal"><sp/><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="group__libssh__channel_1gaa3d6d7d4ab8191f8b8eb14464b0f0e1e" kindref="member">channel_open</ref>(channel,</highlight></codeline>
<codeline lineno="3503"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;forwarded-tcpip&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="3504"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="channels_8c_1a6d5398350fc6c52561ed2674154161dc" kindref="member">CHANNEL_INITIAL_WINDOW</ref>,</highlight></codeline>
<codeline lineno="3505"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="channels_8c_1a2ab57c8b0eeaa7b8ef3733493a00bf55" kindref="member">CHANNEL_MAX_PACKET</ref>,</highlight></codeline>
<codeline lineno="3506"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>payload);</highlight></codeline>
<codeline lineno="3507"><highlight class="normal"></highlight></codeline>
<codeline lineno="3508"><highlight class="normal"><ref refid="proxy_8c_1a11614f44ef4d939bdd984953346a7572" kindref="member">error</ref>:</highlight></codeline>
<codeline lineno="3509"><highlight class="normal"><sp/><sp/><ref refid="libssh_8h_1a8b09f7d6f7066de7ef8dab4ed7494a52" kindref="member">SSH_BUFFER_FREE</ref>(payload);</highlight></codeline>
<codeline lineno="3510"><highlight class="normal"></highlight></codeline>
<codeline lineno="3511"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref>;</highlight></codeline>
<codeline lineno="3512"><highlight class="normal">}</highlight></codeline>
<codeline lineno="3513"><highlight class="normal"></highlight></codeline>
<codeline lineno="3531"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="libssh_8h_1ab3688d962a1865ae2d0df9eb1f83c8fb" kindref="member">ssh_channel_open_x11</ref>(<ref refid="structssh__channel__struct" kindref="compound">ssh_channel</ref><sp/>channel,<sp/></highlight></codeline>
<codeline lineno="3532"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*orig_addr,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>orig_port)<sp/>{</highlight></codeline>
<codeline lineno="3533"><highlight class="normal"><sp/><sp/><ref refid="structssh__session__struct" kindref="compound">ssh_session</ref><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>;</highlight></codeline>
<codeline lineno="3534"><highlight class="normal"><sp/><sp/><ref refid="structssh__buffer__struct" kindref="compound">ssh_buffer</ref><sp/>payload<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="3535"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" kindref="member">SSH_ERROR</ref>;</highlight></codeline>
<codeline lineno="3536"><highlight class="normal"></highlight></codeline>
<codeline lineno="3537"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(channel<sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="3538"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref>;</highlight></codeline>
<codeline lineno="3539"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="3540"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(orig_addr<sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="3541"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="priv_8h_1a351ea86857d33b3ba80b396e05c4517c" kindref="member">ssh_set_error_invalid</ref>(channel-&gt;<ref refid="structssh__channel__struct_1a0832dc830d09accd2f3a8f8349c3faf2" kindref="member">session</ref>);</highlight></codeline>
<codeline lineno="3542"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref>;</highlight></codeline>
<codeline lineno="3543"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="3544"><highlight class="normal"><sp/><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref><sp/>=<sp/>channel-&gt;<ref refid="structssh__channel__struct_1a0832dc830d09accd2f3a8f8349c3faf2" kindref="member">session</ref>;</highlight></codeline>
<codeline lineno="3545"><highlight class="normal"></highlight></codeline>
<codeline lineno="3546"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(channel-&gt;<ref refid="structssh__channel__struct_1a272b198e279fa672afeaf9f2e610eb04" kindref="member">state</ref><sp/>!=<sp/><ref refid="channels_8h_1a5a002159e5db31d156bb2a8ce8a10cd1a1c7ade5ea201bca92177fa99becb3a0c" kindref="member">SSH_CHANNEL_STATE_NOT_OPEN</ref>)</highlight></codeline>
<codeline lineno="3547"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">goto</highlight><highlight class="normal"><sp/>pending;</highlight></codeline>
<codeline lineno="3548"><highlight class="normal"></highlight></codeline>
<codeline lineno="3549"><highlight class="normal"><sp/><sp/>payload<sp/>=<sp/><ref refid="group__libssh__buffer_1ga7ecc914104a5bf0da485d3e42f6a7d3b" kindref="member">ssh_buffer_new</ref>();</highlight></codeline>
<codeline lineno="3550"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(payload<sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="3551"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="priv_8h_1ae280c413c792e04237f000841ac8ce44" kindref="member">ssh_set_error_oom</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>);</highlight></codeline>
<codeline lineno="3552"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">goto</highlight><highlight class="normal"><sp/><ref refid="proxy_8c_1a11614f44ef4d939bdd984953346a7572" kindref="member">error</ref>;</highlight></codeline>
<codeline lineno="3553"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="3554"><highlight class="normal"></highlight></codeline>
<codeline lineno="3555"><highlight class="normal"><sp/><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="buffer_8h_1ae17848a86043f0abfc60c1c4f6126ccd" kindref="member">ssh_buffer_pack</ref>(payload,</highlight></codeline>
<codeline lineno="3556"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;sd&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="3557"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>orig_addr,</highlight></codeline>
<codeline lineno="3558"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>orig_port);</highlight></codeline>
<codeline lineno="3559"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>!=<sp/><ref refid="libssh_8h_1ac1ee1d1e917456d4760a94a18015377d" kindref="member">SSH_OK</ref>)<sp/>{</highlight></codeline>
<codeline lineno="3560"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="priv_8h_1ae280c413c792e04237f000841ac8ce44" kindref="member">ssh_set_error_oom</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>);</highlight></codeline>
<codeline lineno="3561"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">goto</highlight><highlight class="normal"><sp/><ref refid="proxy_8c_1a11614f44ef4d939bdd984953346a7572" kindref="member">error</ref>;</highlight></codeline>
<codeline lineno="3562"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="3563"><highlight class="normal">pending:</highlight></codeline>
<codeline lineno="3564"><highlight class="normal"><sp/><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="group__libssh__channel_1gaa3d6d7d4ab8191f8b8eb14464b0f0e1e" kindref="member">channel_open</ref>(channel,</highlight></codeline>
<codeline lineno="3565"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;x11&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="3566"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="channels_8c_1a6d5398350fc6c52561ed2674154161dc" kindref="member">CHANNEL_INITIAL_WINDOW</ref>,</highlight></codeline>
<codeline lineno="3567"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="channels_8c_1a2ab57c8b0eeaa7b8ef3733493a00bf55" kindref="member">CHANNEL_MAX_PACKET</ref>,</highlight></codeline>
<codeline lineno="3568"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>payload);</highlight></codeline>
<codeline lineno="3569"><highlight class="normal"></highlight></codeline>
<codeline lineno="3570"><highlight class="normal"><ref refid="proxy_8c_1a11614f44ef4d939bdd984953346a7572" kindref="member">error</ref>:</highlight></codeline>
<codeline lineno="3571"><highlight class="normal"><sp/><sp/><ref refid="libssh_8h_1a8b09f7d6f7066de7ef8dab4ed7494a52" kindref="member">SSH_BUFFER_FREE</ref>(payload);</highlight></codeline>
<codeline lineno="3572"><highlight class="normal"></highlight></codeline>
<codeline lineno="3573"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref>;</highlight></codeline>
<codeline lineno="3574"><highlight class="normal">}</highlight></codeline>
<codeline lineno="3575"><highlight class="normal"></highlight></codeline>
<codeline lineno="3590"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="group__libssh__server_1ga7325dd7617635e99f6e62921cb4e0406" kindref="member">ssh_channel_request_send_exit_status</ref>(<ref refid="structssh__channel__struct" kindref="compound">ssh_channel</ref><sp/>channel,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>exit_status)<sp/>{</highlight></codeline>
<codeline lineno="3591"><highlight class="normal"><sp/><sp/><ref refid="structssh__buffer__struct" kindref="compound">ssh_buffer</ref><sp/><ref refid="benchmarks_8c_1aff2566f4c366b48d73479bef43ee4d2e" kindref="member">buffer</ref><sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="3592"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" kindref="member">SSH_ERROR</ref>;</highlight></codeline>
<codeline lineno="3593"><highlight class="normal"></highlight></codeline>
<codeline lineno="3594"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(channel<sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="3595"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" kindref="member">SSH_ERROR</ref>;</highlight></codeline>
<codeline lineno="3596"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="3597"><highlight class="normal"></highlight></codeline>
<codeline lineno="3598"><highlight class="normal"><sp/><sp/><ref refid="benchmarks_8c_1aff2566f4c366b48d73479bef43ee4d2e" kindref="member">buffer</ref><sp/>=<sp/><ref refid="group__libssh__buffer_1ga7ecc914104a5bf0da485d3e42f6a7d3b" kindref="member">ssh_buffer_new</ref>();</highlight></codeline>
<codeline lineno="3599"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="benchmarks_8c_1aff2566f4c366b48d73479bef43ee4d2e" kindref="member">buffer</ref><sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="3600"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="priv_8h_1ae280c413c792e04237f000841ac8ce44" kindref="member">ssh_set_error_oom</ref>(channel-&gt;<ref refid="structssh__channel__struct_1a0832dc830d09accd2f3a8f8349c3faf2" kindref="member">session</ref>);</highlight></codeline>
<codeline lineno="3601"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">goto</highlight><highlight class="normal"><sp/><ref refid="proxy_8c_1a11614f44ef4d939bdd984953346a7572" kindref="member">error</ref>;</highlight></codeline>
<codeline lineno="3602"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="3603"><highlight class="normal"></highlight></codeline>
<codeline lineno="3604"><highlight class="normal"><sp/><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="buffer_8h_1ae17848a86043f0abfc60c1c4f6126ccd" kindref="member">ssh_buffer_pack</ref>(<ref refid="benchmarks_8c_1aff2566f4c366b48d73479bef43ee4d2e" kindref="member">buffer</ref>,<sp/></highlight><highlight class="stringliteral">&quot;d&quot;</highlight><highlight class="normal">,<sp/>exit_status);</highlight></codeline>
<codeline lineno="3605"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>!=<sp/><ref refid="libssh_8h_1ac1ee1d1e917456d4760a94a18015377d" kindref="member">SSH_OK</ref>)<sp/>{</highlight></codeline>
<codeline lineno="3606"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="priv_8h_1ae280c413c792e04237f000841ac8ce44" kindref="member">ssh_set_error_oom</ref>(channel-&gt;<ref refid="structssh__channel__struct_1a0832dc830d09accd2f3a8f8349c3faf2" kindref="member">session</ref>);</highlight></codeline>
<codeline lineno="3607"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">goto</highlight><highlight class="normal"><sp/><ref refid="proxy_8c_1a11614f44ef4d939bdd984953346a7572" kindref="member">error</ref>;</highlight></codeline>
<codeline lineno="3608"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="3609"><highlight class="normal"></highlight></codeline>
<codeline lineno="3610"><highlight class="normal"><sp/><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="group__libssh__channel_1gaee35ccabe6998568d138d35f538765d9" kindref="member">channel_request</ref>(channel,<sp/></highlight><highlight class="stringliteral">&quot;exit-status&quot;</highlight><highlight class="normal">,<sp/><ref refid="benchmarks_8c_1aff2566f4c366b48d73479bef43ee4d2e" kindref="member">buffer</ref>,<sp/>0);</highlight></codeline>
<codeline lineno="3611"><highlight class="normal"><ref refid="proxy_8c_1a11614f44ef4d939bdd984953346a7572" kindref="member">error</ref>:</highlight></codeline>
<codeline lineno="3612"><highlight class="normal"><sp/><sp/><ref refid="libssh_8h_1a8b09f7d6f7066de7ef8dab4ed7494a52" kindref="member">SSH_BUFFER_FREE</ref>(<ref refid="benchmarks_8c_1aff2566f4c366b48d73479bef43ee4d2e" kindref="member">buffer</ref>);</highlight></codeline>
<codeline lineno="3613"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref>;</highlight></codeline>
<codeline lineno="3614"><highlight class="normal">}</highlight></codeline>
<codeline lineno="3615"><highlight class="normal"></highlight></codeline>
<codeline lineno="3635"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="group__libssh__server_1gaca9d5a6b5d8d82496b46267337088a51" kindref="member">ssh_channel_request_send_exit_signal</ref>(<ref refid="structssh__channel__struct" kindref="compound">ssh_channel</ref><sp/>channel,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*sig,</highlight></codeline>
<codeline lineno="3636"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>core,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*errmsg,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*lang)<sp/>{</highlight></codeline>
<codeline lineno="3637"><highlight class="normal"><sp/><sp/><ref refid="structssh__buffer__struct" kindref="compound">ssh_buffer</ref><sp/><ref refid="benchmarks_8c_1aff2566f4c366b48d73479bef43ee4d2e" kindref="member">buffer</ref><sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="3638"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" kindref="member">SSH_ERROR</ref>;</highlight></codeline>
<codeline lineno="3639"><highlight class="normal"></highlight></codeline>
<codeline lineno="3640"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(channel<sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="3641"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref>;</highlight></codeline>
<codeline lineno="3642"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="3643"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(sig<sp/>==<sp/>NULL<sp/>||<sp/>errmsg<sp/>==<sp/>NULL<sp/>||<sp/>lang<sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="3644"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="priv_8h_1a351ea86857d33b3ba80b396e05c4517c" kindref="member">ssh_set_error_invalid</ref>(channel-&gt;<ref refid="structssh__channel__struct_1a0832dc830d09accd2f3a8f8349c3faf2" kindref="member">session</ref>);</highlight></codeline>
<codeline lineno="3645"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref>;</highlight></codeline>
<codeline lineno="3646"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="3647"><highlight class="normal"></highlight></codeline>
<codeline lineno="3648"><highlight class="normal"><sp/><sp/><ref refid="benchmarks_8c_1aff2566f4c366b48d73479bef43ee4d2e" kindref="member">buffer</ref><sp/>=<sp/><ref refid="group__libssh__buffer_1ga7ecc914104a5bf0da485d3e42f6a7d3b" kindref="member">ssh_buffer_new</ref>();</highlight></codeline>
<codeline lineno="3649"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="benchmarks_8c_1aff2566f4c366b48d73479bef43ee4d2e" kindref="member">buffer</ref><sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="3650"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="priv_8h_1ae280c413c792e04237f000841ac8ce44" kindref="member">ssh_set_error_oom</ref>(channel-&gt;<ref refid="structssh__channel__struct_1a0832dc830d09accd2f3a8f8349c3faf2" kindref="member">session</ref>);</highlight></codeline>
<codeline lineno="3651"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">goto</highlight><highlight class="normal"><sp/><ref refid="proxy_8c_1a11614f44ef4d939bdd984953346a7572" kindref="member">error</ref>;</highlight></codeline>
<codeline lineno="3652"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="3653"><highlight class="normal"></highlight></codeline>
<codeline lineno="3654"><highlight class="normal"><sp/><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="buffer_8h_1ae17848a86043f0abfc60c1c4f6126ccd" kindref="member">ssh_buffer_pack</ref>(<ref refid="benchmarks_8c_1aff2566f4c366b48d73479bef43ee4d2e" kindref="member">buffer</ref>,</highlight></codeline>
<codeline lineno="3655"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;sbss&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="3656"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sig,</highlight></codeline>
<codeline lineno="3657"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>core<sp/>?<sp/>1<sp/>:<sp/>0,</highlight></codeline>
<codeline lineno="3658"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>errmsg,</highlight></codeline>
<codeline lineno="3659"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>lang);</highlight></codeline>
<codeline lineno="3660"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>!=<sp/><ref refid="libssh_8h_1ac1ee1d1e917456d4760a94a18015377d" kindref="member">SSH_OK</ref>)<sp/>{</highlight></codeline>
<codeline lineno="3661"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="priv_8h_1ae280c413c792e04237f000841ac8ce44" kindref="member">ssh_set_error_oom</ref>(channel-&gt;<ref refid="structssh__channel__struct_1a0832dc830d09accd2f3a8f8349c3faf2" kindref="member">session</ref>);</highlight></codeline>
<codeline lineno="3662"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">goto</highlight><highlight class="normal"><sp/><ref refid="proxy_8c_1a11614f44ef4d939bdd984953346a7572" kindref="member">error</ref>;</highlight></codeline>
<codeline lineno="3663"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="3664"><highlight class="normal"></highlight></codeline>
<codeline lineno="3665"><highlight class="normal"><sp/><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="group__libssh__channel_1gaee35ccabe6998568d138d35f538765d9" kindref="member">channel_request</ref>(channel,<sp/></highlight><highlight class="stringliteral">&quot;exit-signal&quot;</highlight><highlight class="normal">,<sp/><ref refid="benchmarks_8c_1aff2566f4c366b48d73479bef43ee4d2e" kindref="member">buffer</ref>,<sp/>0);</highlight></codeline>
<codeline lineno="3666"><highlight class="normal"><ref refid="proxy_8c_1a11614f44ef4d939bdd984953346a7572" kindref="member">error</ref>:</highlight></codeline>
<codeline lineno="3667"><highlight class="normal"><sp/><sp/><ref refid="libssh_8h_1a8b09f7d6f7066de7ef8dab4ed7494a52" kindref="member">SSH_BUFFER_FREE</ref>(<ref refid="benchmarks_8c_1aff2566f4c366b48d73479bef43ee4d2e" kindref="member">buffer</ref>);</highlight></codeline>
<codeline lineno="3668"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref>;</highlight></codeline>
<codeline lineno="3669"><highlight class="normal">}</highlight></codeline>
<codeline lineno="3670"><highlight class="normal"></highlight></codeline>
<codeline lineno="3671"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3672"><highlight class="normal"></highlight></codeline>
<codeline lineno="3673"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>@}<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
    </programlisting>
    <location file="src/channels.c"/>
  </compounddef>
</doxygen>
