<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<doxygen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="compound.xsd" version="1.9.1" xml:lang="en-US">
  <compounddef id="server_8c" kind="file" language="C++">
    <compoundname>server.c</compoundname>
    <includes refid="config_8h" local="yes">config.h</includes>
    <includes local="no">errno.h</includes>
    <includes local="no">fcntl.h</includes>
    <includes local="no">stdio.h</includes>
    <includes refid="string_8h" local="no">string.h</includes>
    <includes local="no">stdlib.h</includes>
    <includes local="no">netinet/in.h</includes>
    <includes refid="priv_8h" local="yes">libssh/priv.h</includes>
    <includes refid="libssh_8h" local="yes">libssh/libssh.h</includes>
    <includes refid="server_8h" local="yes">libssh/server.h</includes>
    <includes refid="ssh2_8h" local="yes">libssh/ssh2.h</includes>
    <includes refid="buffer_8h" local="yes">libssh/buffer.h</includes>
    <includes refid="packet_8h" local="yes">libssh/packet.h</includes>
    <includes refid="socket_8h" local="yes">libssh/socket.h</includes>
    <includes refid="session_8h" local="yes">libssh/session.h</includes>
    <includes refid="kex_8h" local="yes">libssh/kex.h</includes>
    <includes refid="misc_8h" local="yes">libssh/misc.h</includes>
    <includes refid="pki_8h" local="yes">libssh/pki.h</includes>
    <includes refid="dh_8h" local="yes">libssh/dh.h</includes>
    <includes refid="messages_8h" local="yes">libssh/messages.h</includes>
    <includes refid="options_8h" local="yes">libssh/options.h</includes>
    <includes refid="curve25519_8h" local="yes">libssh/curve25519.h</includes>
    <includes refid="token_8h" local="yes">libssh/token.h</includes>
    <incdepgraph>
      <node id="23">
        <label>libssh/packet.h</label>
        <link refid="packet_8h"/>
        <childnode refid="24" relation="include">
        </childnode>
      </node>
      <node id="25">
        <label>stdbool.h</label>
      </node>
      <node id="22">
        <label>stdarg.h</label>
      </node>
      <node id="14">
        <label>sys/select.h</label>
      </node>
      <node id="18">
        <label>netinet/in.h</label>
      </node>
      <node id="37">
        <label>libssh/pki.h</label>
        <link refid="pki_8h"/>
        <childnode refid="8" relation="include">
        </childnode>
        <childnode refid="7" relation="include">
        </childnode>
        <childnode refid="38" relation="include">
        </childnode>
        <childnode refid="42" relation="include">
        </childnode>
      </node>
      <node id="45">
        <label>libssh/token.h</label>
        <link refid="token_8h"/>
      </node>
      <node id="7">
        <label>libssh/priv.h</label>
        <link refid="priv_8h"/>
        <childnode refid="8" relation="include">
        </childnode>
        <childnode refid="9" relation="include">
        </childnode>
        <childnode refid="6" relation="include">
        </childnode>
        <childnode refid="10" relation="include">
        </childnode>
        <childnode refid="11" relation="include">
        </childnode>
        <childnode refid="17" relation="include">
        </childnode>
      </node>
      <node id="16">
        <label>libssh/legacy.h</label>
        <link refid="legacy_8h"/>
      </node>
      <node id="6">
        <label>string.h</label>
        <link refid="string_8h"/>
        <childnode refid="7" relation="include">
        </childnode>
      </node>
      <node id="8">
        <label>stdint.h</label>
      </node>
      <node id="9">
        <label>stdlib.h</label>
      </node>
      <node id="36">
        <label>libssh/misc.h</label>
        <link refid="misc_8h"/>
      </node>
      <node id="3">
        <label>errno.h</label>
      </node>
      <node id="29">
        <label>libssh/socket.h</label>
        <link refid="socket_8h"/>
        <childnode refid="17" relation="include">
        </childnode>
      </node>
      <node id="4">
        <label>fcntl.h</label>
      </node>
      <node id="39">
        <label>libssh/dh.h</label>
        <link refid="dh_8h"/>
        <childnode refid="2" relation="include">
        </childnode>
        <childnode refid="38" relation="include">
        </childnode>
      </node>
      <node id="21">
        <label>libssh/buffer.h</label>
        <link refid="buffer_8h"/>
        <childnode refid="22" relation="include">
        </childnode>
        <childnode refid="11" relation="include">
        </childnode>
      </node>
      <node id="26">
        <label>libssh/libcrypto.h</label>
        <link refid="libcrypto_8h"/>
        <childnode refid="2" relation="include">
        </childnode>
      </node>
      <node id="17">
        <label>libssh/callbacks.h</label>
        <link refid="callbacks_8h"/>
        <childnode refid="11" relation="include">
        </childnode>
        <childnode refid="6" relation="include">
        </childnode>
      </node>
      <node id="15">
        <label>netdb.h</label>
      </node>
      <node id="40">
        <label>libssh/ecdh.h</label>
        <link refid="ecdh_8h"/>
        <childnode refid="2" relation="include">
        </childnode>
        <childnode refid="17" relation="include">
        </childnode>
      </node>
      <node id="31">
        <label>libssh/kex.h</label>
        <link refid="kex_8h"/>
        <childnode refid="7" relation="include">
        </childnode>
        <childnode refid="17" relation="include">
        </childnode>
      </node>
      <node id="32">
        <label>libssh/pcap.h</label>
        <link refid="pcap_8h"/>
        <childnode refid="2" relation="include">
        </childnode>
        <childnode refid="11" relation="include">
        </childnode>
      </node>
      <node id="28">
        <label>libssh/libmbedcrypto.h</label>
        <link refid="libmbedcrypto_8h"/>
        <childnode refid="2" relation="include">
        </childnode>
      </node>
      <node id="34">
        <label>libssh/channels.h</label>
        <link refid="channels_8h"/>
        <childnode refid="7" relation="include">
        </childnode>
      </node>
      <node id="44">
        <label>libssh/options.h</label>
        <link refid="options_8h"/>
      </node>
      <node id="13">
        <label>sys/types.h</label>
      </node>
      <node id="1">
        <label>src/server.c</label>
        <link refid="server_8c"/>
        <childnode refid="2" relation="include">
        </childnode>
        <childnode refid="3" relation="include">
        </childnode>
        <childnode refid="4" relation="include">
        </childnode>
        <childnode refid="5" relation="include">
        </childnode>
        <childnode refid="6" relation="include">
        </childnode>
        <childnode refid="9" relation="include">
        </childnode>
        <childnode refid="18" relation="include">
        </childnode>
        <childnode refid="7" relation="include">
        </childnode>
        <childnode refid="11" relation="include">
        </childnode>
        <childnode refid="19" relation="include">
        </childnode>
        <childnode refid="20" relation="include">
        </childnode>
        <childnode refid="21" relation="include">
        </childnode>
        <childnode refid="23" relation="include">
        </childnode>
        <childnode refid="29" relation="include">
        </childnode>
        <childnode refid="30" relation="include">
        </childnode>
        <childnode refid="31" relation="include">
        </childnode>
        <childnode refid="36" relation="include">
        </childnode>
        <childnode refid="37" relation="include">
        </childnode>
        <childnode refid="39" relation="include">
        </childnode>
        <childnode refid="43" relation="include">
        </childnode>
        <childnode refid="44" relation="include">
        </childnode>
        <childnode refid="41" relation="include">
        </childnode>
        <childnode refid="45" relation="include">
        </childnode>
      </node>
      <node id="27">
        <label>libssh/libgcrypt.h</label>
        <link refid="libgcrypt_8h"/>
        <childnode refid="2" relation="include">
        </childnode>
      </node>
      <node id="10">
        <label>unistd.h</label>
      </node>
      <node id="38">
        <label>libssh/crypto.h</label>
        <link refid="crypto_8h"/>
        <childnode refid="25" relation="include">
        </childnode>
        <childnode refid="2" relation="include">
        </childnode>
        <childnode refid="24" relation="include">
        </childnode>
        <childnode refid="39" relation="include">
        </childnode>
        <childnode refid="40" relation="include">
        </childnode>
        <childnode refid="31" relation="include">
        </childnode>
        <childnode refid="41" relation="include">
        </childnode>
      </node>
      <node id="35">
        <label>libssh/poll.h</label>
        <link refid="poll_8h"/>
        <childnode refid="2" relation="include">
        </childnode>
      </node>
      <node id="19">
        <label>libssh/server.h</label>
        <link refid="server_8h"/>
        <childnode refid="11" relation="include">
        </childnode>
      </node>
      <node id="42">
        <label>libssh/ed25519.h</label>
        <link refid="ed25519_8h"/>
        <childnode refid="7" relation="include">
        </childnode>
      </node>
      <node id="11">
        <label>libssh/libssh.h</label>
        <link refid="libssh_8h"/>
        <childnode refid="10" relation="include">
        </childnode>
        <childnode refid="12" relation="include">
        </childnode>
        <childnode refid="13" relation="include">
        </childnode>
        <childnode refid="14" relation="include">
        </childnode>
        <childnode refid="15" relation="include">
        </childnode>
        <childnode refid="16" relation="include">
        </childnode>
      </node>
      <node id="41">
        <label>libssh/curve25519.h</label>
        <link refid="curve25519_8h"/>
        <childnode refid="2" relation="include">
        </childnode>
        <childnode refid="11" relation="include">
        </childnode>
      </node>
      <node id="24">
        <label>libssh/wrapper.h</label>
        <link refid="wrapper_8h"/>
        <childnode refid="25" relation="include">
        </childnode>
        <childnode refid="2" relation="include">
        </childnode>
        <childnode refid="11" relation="include">
        </childnode>
        <childnode refid="26" relation="include">
        </childnode>
        <childnode refid="27" relation="include">
        </childnode>
        <childnode refid="28" relation="include">
        </childnode>
      </node>
      <node id="2">
        <label>config.h</label>
        <link refid="config_8h"/>
      </node>
      <node id="20">
        <label>libssh/ssh2.h</label>
        <link refid="ssh2_8h"/>
      </node>
      <node id="33">
        <label>libssh/auth.h</label>
        <link refid="auth_8h"/>
        <childnode refid="2" relation="include">
        </childnode>
        <childnode refid="17" relation="include">
        </childnode>
      </node>
      <node id="43">
        <label>libssh/messages.h</label>
        <link refid="messages_8h"/>
        <childnode refid="2" relation="include">
        </childnode>
      </node>
      <node id="5">
        <label>stdio.h</label>
      </node>
      <node id="30">
        <label>libssh/session.h</label>
        <link refid="session_8h"/>
        <childnode refid="25" relation="include">
        </childnode>
        <childnode refid="7" relation="include">
        </childnode>
        <childnode refid="31" relation="include">
        </childnode>
        <childnode refid="23" relation="include">
        </childnode>
        <childnode refid="32" relation="include">
        </childnode>
        <childnode refid="33" relation="include">
        </childnode>
        <childnode refid="34" relation="include">
        </childnode>
        <childnode refid="35" relation="include">
        </childnode>
        <childnode refid="2" relation="include">
        </childnode>
        <childnode refid="36" relation="include">
        </childnode>
      </node>
      <node id="12">
        <label>inttypes.h</label>
      </node>
    </incdepgraph>
      <sectiondef kind="define">
      <memberdef kind="define" id="server_8c_1ae999fe5d95dd5d737af376462d2c59c5" prot="public" static="no">
        <name>set_status</name>
        <param><defname>session</defname></param>
        <param><defname>status</defname></param>
        <initializer>        do {\
        <ref refid="tests_2unittests_2CMakeLists_8txt_1adf4c50373758bd4d27d88bebdc10840e" kindref="member">if</ref> (<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="test__socket_8c_1a6f7c6c5b8dbd2f4417bf5cdf04c253f9" kindref="member">common.callbacks</ref> &amp;&amp; <ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="test__socket_8c_1a6f7c6c5b8dbd2f4417bf5cdf04c253f9" kindref="member">common.callbacks</ref>-&gt;connect_status_function) \
            <ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="test__socket_8c_1a6f7c6c5b8dbd2f4417bf5cdf04c253f9" kindref="member">common.callbacks</ref>-&gt;connect_status_function(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="test__socket_8c_1a6f7c6c5b8dbd2f4417bf5cdf04c253f9" kindref="member">common.callbacks</ref>-&gt;userdata, status); \
    } while (0)</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/server.c" line="64" column="9" bodyfile="src/server.c" bodystart="64" bodyend="-1"/>
      </memberdef>
      </sectiondef>
      <sectiondef kind="func">
      <memberdef kind="function" id="group__libssh__server_1gac8dda51f6f008e42e60d824e2ef2e453" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>int server_set_kex</definition>
        <argsstring>(ssh_session session)</argsstring>
        <name>server_set_kex</name>
        <param>
          <type><ref refid="libssh_8h_1a02d3754de040612632cdd499c20f92f6" kindref="member">ssh_session</ref></type>
          <declname>session</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/server.c" line="84" column="5" bodyfile="src/server.c" bodystart="84" bodyend="195"/>
        <references refid="structssh__kex__struct_1a3c982f0a27422694879c0282a102ffa4" compoundref="kex_8h" startline="30">ssh_kex_struct::cookie</references>
        <references refid="structssh__session__struct_1ab0acf948f6ee2e2ce6b44d3b5b874cbb" compoundref="session_8h" startline="186">ssh_session_struct::dsa_key</references>
        <references refid="structssh__session__struct_1a01bbd4eb1e8f7979872485ca348d3972" compoundref="session_8h" startline="187">ssh_session_struct::ecdsa_key</references>
        <references refid="structssh__session__struct_1a566490fe8eed8f1f5cede88af2a17b6d" compoundref="session_8h" startline="188">ssh_session_struct::ed25519_key</references>
        <references refid="structssh__kex__struct_1a5a8b3f27866bcbfde98a9d66793ae389" compoundref="kex_8h" startline="31">ssh_kex_struct::methods</references>
        <references refid="structssh__session__struct_1a4ea5e4ae5383c6cdb5db9f08bbbfa019" compoundref="session_8h" startline="173">ssh_session_struct::next_crypto</references>
        <references refid="structssh__session__struct_1a1c29cf990c1d0df6e1b0971d4f3d1f3e">ssh_session_struct::opts</references>
        <references refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" compoundref="pkd__daemon_8c" startline="62">rc</references>
        <references refid="structssh__session__struct_1ab5f06090005e380e8b32468e2b2a9ffb" compoundref="session_8h" startline="185">ssh_session_struct::rsa_key</references>
        <references refid="sshd__direct-tcpip_8c_1aed3129b7674034c979192bcca6b0ad8c" compoundref="sshd__direct-tcpip_8c" startline="36">SAFE_FREE</references>
        <references refid="structssh__crypto__struct_1ac78255bf9406137ac4d400644c348a82" compoundref="crypto_8h" startline="149">ssh_crypto_struct::server_kex</references>
        <references refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" compoundref="torture__session__keys_8c" startline="61">session</references>
        <references refid="structssh__session__struct_1a6f50dd2453f70016845c90e9a0e7e641">ssh_session_struct::srv</references>
        <references refid="libssh_8h_1a036b2b00fb04337a4d06d719d1b62be1a86ff0b2e8da6ad8628efc556b6ce1887" compoundref="libssh_8h" startline="286">SSH_FATAL</references>
        <references refid="token_8h_1a650915f2f817e8ed7e5a151dee467d5e" compoundref="token_8c" startline="206" endline="263">ssh_find_all_matching</references>
        <references refid="libssh_8h_1aa04e01bdb1b607b705233a5d3587ae11">ssh_get_random</references>
        <references refid="libssh_8h_1a3af3a0324900b0fa3848b9b77cb6b02fa642dda9838782d3808b70c6e943c7a57" compoundref="libssh_8h" startline="145">SSH_HOSTKEYS</references>
        <references refid="kex_8h_1af53e5cd7c8b0e15ccc0726314f52b460" compoundref="kex_8c" startline="256" endline="263">ssh_kex_get_default_methods</references>
        <references refid="kex_8h_1a01bf8c637ec80611bc03a1fd3a991d0f" compoundref="kex_8c" startline="282" endline="288">ssh_kex_get_fips_methods</references>
        <references refid="kex_8h_1a0aac49551fe045f9a556155c3d8a02a5" compoundref="kex_8h" startline="27">SSH_KEX_METHODS</references>
        <references refid="group__libssh__pki_1ga9cb4a857f8e510f80cfc38e46c476490" compoundref="pki_8c" startline="223" endline="228">ssh_key_type</references>
        <references refid="group__libssh__pki_1ga302919f046a4af504e5a2a9924b031c1" compoundref="pki_8c" startline="283" endline="326">ssh_key_type_to_char</references>
        <references refid="group__libssh__session_1gab88261ef1a07c42d7e2759d7af164047" compoundref="options_8c" startline="220" endline="243">ssh_options_set_algo</references>
        <references refid="priv_8h_1a55177b3e8db90ca9adb435c44281963c" compoundref="priv_8h" startline="258">ssh_set_error</references>
        <references refid="structssh__key__struct_1af198ae6d0eee951e7d46b8dacbf3c412" compoundref="pki_8h" startline="57">ssh_key_struct::type_c</references>
        <references refid="structssh__session__struct_1a6023ca7ba47bbed4837f72bf9dde5948" compoundref="session_8h" startline="216">ssh_session_struct::wanted_methods</references>
        <references refid="priv_8h_1a65e0a55b6af58e00b0a584d665af60ab" compoundref="priv_8h" startline="320">ZERO_STRUCTP</references>
        <referencedby refid="group__libssh__server_1gab60c37350653eb3b65a99ac089c55830" compoundref="server_8c" startline="528" endline="563">ssh_handle_key_exchange</referencedby>
        <referencedby refid="kex_8h_1afc99d352c1a9c57936a7d13c4304e6e7" compoundref="kex_8c" startline="867" endline="912">ssh_send_rekex</referencedby>
        <referencedby refid="group__libssh__server_1ga6b0057a0346a87ddd9b57bfbbc580d4d" compoundref="server_8c" startline="338" endline="449">ssh_server_connection_callback</referencedby>
        <referencedby refid="group__libssh__server_1ga2594833b600c8461fbe26d16e99a211b" compoundref="server_8c" startline="197" endline="210">ssh_server_init_kex</referencedby>
      </memberdef>
      <memberdef kind="function" id="group__libssh__server_1ga2594833b600c8461fbe26d16e99a211b" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="libssh_8h_1a2ba7f29ac0f2b5ef7134243d24888ac5" kindref="member">LIBSSH_API</ref> int</type>
        <definition>int ssh_server_init_kex</definition>
        <argsstring>(ssh_session session)</argsstring>
        <name>ssh_server_init_kex</name>
        <param>
          <type><ref refid="libssh_8h_1a02d3754de040612632cdd499c20f92f6" kindref="member">ssh_session</ref></type>
          <declname>session</declname>
        </param>
        <briefdescription>
<para>Initialize the set of key exchange, hostkey, ciphers, MACs, and compression algorithms for the given ssh_session. </para>
        </briefdescription>
        <detaileddescription>
<para>The selection of algorithms and keys used are determined by the options that are currently set in the given ssh_session structure. May only be called before the initial key exchange has begun.</para>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>session</parametername>
</parameternamelist>
<parameterdescription>
<para>The session structure to initialize.</para>
</parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="see"><para><ref refid="group__libssh__server_1gab60c37350653eb3b65a99ac089c55830" kindref="member">ssh_handle_key_exchange</ref> </para>
</simplesect>
<simplesect kind="see"><para><ref refid="group__libssh__session_1ga7a801b85800baa3f4e16f5b47db0a73d" kindref="member">ssh_options_set</ref></para>
</simplesect>
<simplesect kind="return"><para>SSH_OK if initialization succeeds. </para>
</simplesect>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/server.c" line="197" column="5" bodyfile="src/server.c" bodystart="197" bodyend="210" declfile="include/libssh/server.h" declline="218" declcolumn="16"/>
        <references refid="structssh__kex__struct_1a5a8b3f27866bcbfde98a9d66793ae389" compoundref="kex_8h" startline="31">ssh_kex_struct::methods</references>
        <references refid="structssh__session__struct_1a4ea5e4ae5383c6cdb5db9f08bbbfa019" compoundref="session_8h" startline="173">ssh_session_struct::next_crypto</references>
        <references refid="sshd__direct-tcpip_8c_1aed3129b7674034c979192bcca6b0ad8c" compoundref="sshd__direct-tcpip_8c" startline="36">SAFE_FREE</references>
        <references refid="structssh__crypto__struct_1ac78255bf9406137ac4d400644c348a82" compoundref="crypto_8h" startline="149">ssh_crypto_struct::server_kex</references>
        <references refid="group__libssh__server_1gac8dda51f6f008e42e60d824e2ef2e453" compoundref="server_8c" startline="84" endline="195">server_set_kex</references>
        <references refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" compoundref="torture__session__keys_8c" startline="61">session</references>
        <references refid="structssh__session__struct_1a6f74d1a1eb6ed715b1073b67caa18460" compoundref="session_8h" startline="147">ssh_session_struct::session_state</references>
        <references refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" compoundref="libssh_8h" startline="330">SSH_ERROR</references>
        <references refid="kex_8h_1a0aac49551fe045f9a556155c3d8a02a5" compoundref="kex_8h" startline="27">SSH_KEX_METHODS</references>
        <references refid="session_8h_1a9bbd1d5ae11485e27279be6ad461992caa688177b6c71d2eaf7af6b9e3b3dea5b" compoundref="session_8h" startline="40">SSH_SESSION_STATE_BANNER_RECEIVED</references>
      </memberdef>
      <memberdef kind="function" id="group__libssh__server_1ga3d13039ae1fd46aa8c028401b62bd0af" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>static int ssh_server_send_extensions</definition>
        <argsstring>(ssh_session session)</argsstring>
        <name>ssh_server_send_extensions</name>
        <param>
          <type><ref refid="libssh_8h_1a02d3754de040612632cdd499c20f92f6" kindref="member">ssh_session</ref></type>
          <declname>session</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/server.c" line="212" column="12" bodyfile="src/server.c" bodystart="212" bodyend="248"/>
        <references refid="proxy_8c_1a11614f44ef4d939bdd984953346a7572" compoundref="proxy_8c" startline="33">error</references>
        <references refid="structssh__session__struct_1a1c29cf990c1d0df6e1b0971d4f3d1f3e">ssh_session_struct::opts</references>
        <references refid="structssh__session__struct_1af0aed60c1e529bbfdcb483fd80bf98a0" compoundref="session_8h" startline="140">ssh_session_struct::out_buffer</references>
        <references refid="structssh__session__struct_1a41e181fed08e20b58360cb429cf8689f" compoundref="session_8h" startline="217">ssh_session_struct::pubkey_accepted_types</references>
        <references refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" compoundref="pkd__daemon_8c" startline="62">rc</references>
        <references refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" compoundref="torture__session__keys_8c" startline="61">session</references>
        <references refid="ssh2_8h_1a12aba493ba1609e4fb1ece10f8fd537e" compoundref="ssh2_8h" startline="10">SSH2_MSG_EXT_INFO</references>
        <references refid="buffer_8h_1ae17848a86043f0abfc60c1c4f6126ccd" compoundref="buffer_8h" startline="49">ssh_buffer_pack</references>
        <references refid="libssh_8h_1ac8802ff7f5348d0145dab5242623f740">ssh_buffer_reinit</references>
        <references refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" compoundref="libssh_8h" startline="330">SSH_ERROR</references>
        <references refid="libssh_8h_1a3af3a0324900b0fa3848b9b77cb6b02fa642dda9838782d3808b70c6e943c7a57" compoundref="libssh_8h" startline="145">SSH_HOSTKEYS</references>
        <references refid="kex_8h_1af53e5cd7c8b0e15ccc0726314f52b460" compoundref="kex_8c" startline="256" endline="263">ssh_kex_get_default_methods</references>
        <references refid="kex_8h_1a01bf8c637ec80611bc03a1fd3a991d0f" compoundref="kex_8c" startline="282" endline="288">ssh_kex_get_fips_methods</references>
        <references refid="priv_8h_1aa21fd8a7a609329603b7b16da7939fca" compoundref="priv_8h" startline="240">SSH_LOG</references>
        <references refid="group__libssh__log_1ggadf764cbdea00d65edcd07bb9953ad2b7a6445dfe21592d69d9741d319538b6673" compoundref="libssh_8h" startline="352">SSH_LOG_PACKET</references>
        <references refid="libssh_8h_1ac1ee1d1e917456d4760a94a18015377d" compoundref="libssh_8h" startline="329">SSH_OK</references>
        <references refid="packet_8h_1a7e6c7ed74c23ace432476aa8a6841140" compoundref="packet_8c" startline="1761" endline="1843">ssh_packet_send</references>
        <referencedby refid="group__libssh__server_1ga6b0057a0346a87ddd9b57bfbbc580d4d" compoundref="server_8c" startline="338" endline="449">ssh_server_connection_callback</referencedby>
      </memberdef>
      <memberdef kind="function" id="group__libssh__server_1ga872620a8d0aa300fe01626f1aea153cd" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type></type>
        <definition>SSH_PACKET_CALLBACK</definition>
        <argsstring>(ssh_packet_kexdh_init)</argsstring>
        <name>SSH_PACKET_CALLBACK</name>
        <param>
          <type>ssh_packet_kexdh_init</type>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/server.c" line="250" column="1" bodyfile="src/server.c" bodystart="250" bodyend="272"/>
        <references refid="structssh__session__struct_1a6a94fa11eb06ca18d3c0ac22a153f97f" compoundref="session_8h" startline="149">ssh_session_struct::dh_handshake_state</references>
        <references refid="session_8h_1a52a640f6094e9b3d1a88c7da7d08c802a90a6f45fd750c65a3cb58157b89150c9" compoundref="session_8h" startline="51">DH_STATE_INIT</references>
        <references refid="structssh__session__struct_1aa5bd72290c07e7ae0b888272c9aa9be3" compoundref="session_8h" startline="168">ssh_session_struct::first_kex_follows_guess_wrong</references>
        <references refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" compoundref="torture__session__keys_8c" startline="61">session</references>
        <references refid="structssh__session__struct_1a6f74d1a1eb6ed715b1073b67caa18460" compoundref="session_8h" startline="147">ssh_session_struct::session_state</references>
        <references refid="priv_8h_1aa21fd8a7a609329603b7b16da7939fca" compoundref="priv_8h" startline="240">SSH_LOG</references>
        <references refid="libssh_8h_1a5e4247396f11fdc228d356a408c81715" compoundref="libssh_8h" startline="374">SSH_LOG_DEBUG</references>
        <references refid="group__libssh__log_1ggadf764cbdea00d65edcd07bb9953ad2b7a6445dfe21592d69d9741d319538b6673" compoundref="libssh_8h" startline="352">SSH_LOG_PACKET</references>
        <references refid="libssh_8h_1a1c08cc9177a5598e0675abfb833d2993" compoundref="libssh_8h" startline="358">SSH_LOG_RARE</references>
        <references refid="group__libssh__callbacks_1ga4766917128a12b646a8aee7ebc019f8c" compoundref="callbacks_8h" startline="520">SSH_PACKET_NOT_USED</references>
        <references refid="group__libssh__callbacks_1gac29df803aa1295d6a498c1b081f3b494" compoundref="callbacks_8h" startline="517">SSH_PACKET_USED</references>
        <references refid="session_8h_1a9bbd1d5ae11485e27279be6ad461992ca855474fc84a2fb170fcb72546af8eeb8" compoundref="session_8h" startline="46">SSH_SESSION_STATE_ERROR</references>
        <references refid="ssh__client_8c_1a14871705f45ccdc5bb9f4549efd8e119" compoundref="ssh__client_8c" startline="48">user</references>
      </memberdef>
      <memberdef kind="function" id="group__libssh__server_1gad7dc7022c232731badd57c92ca04f1d6" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>int ssh_get_key_params</definition>
        <argsstring>(ssh_session session, ssh_key *privkey, enum ssh_digest_e *digest)</argsstring>
        <name>ssh_get_key_params</name>
        <param>
          <type><ref refid="libssh_8h_1a02d3754de040612632cdd499c20f92f6" kindref="member">ssh_session</ref></type>
          <declname>session</declname>
        </param>
        <param>
          <type><ref refid="libssh_8h_1a7e8a3aee44db4899c088577a8db5dcfa" kindref="member">ssh_key</ref> *</type>
          <declname>privkey</declname>
        </param>
        <param>
          <type>enum <ref refid="priv_8h_1a776ae60987846ddc64c85308d5b6a441" kindref="member">ssh_digest_e</ref> *</type>
          <declname>digest</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/server.c" line="275" column="1" bodyfile="src/server.c" bodystart="275" bodyend="330"/>
        <references refid="structssh__session__struct_1ab0acf948f6ee2e2ce6b44d3b5b874cbb" compoundref="session_8h" startline="186">ssh_session_struct::dsa_key</references>
        <references refid="structssh__session__struct_1a01bbd4eb1e8f7979872485ca348d3972" compoundref="session_8h" startline="187">ssh_session_struct::ecdsa_key</references>
        <references refid="structssh__session__struct_1a566490fe8eed8f1f5cede88af2a17b6d" compoundref="session_8h" startline="188">ssh_session_struct::ed25519_key</references>
        <references refid="structssh__session__struct_1a196c23b5496291f952d3c73bf1edeb76" compoundref="session_8h" startline="190">ssh_session_struct::hostkey</references>
        <references refid="structssh__session__struct_1a58f7536afa99eb6edee32abbfa29bf8e" compoundref="session_8h" startline="191">ssh_session_struct::hostkey_digest</references>
        <references refid="curve25519-sha256_0dlibssh_8org_8txt_1a5d18fd02a76effa0a15b1decb554cc12" compoundref="curve25519-sha256_0dlibssh_8org_8txt" startline="96">privkey</references>
        <references refid="curve25519-sha256_0dlibssh_8org_8txt_1a555595207a1407936ebb264ebdbf434c" compoundref="curve25519-sha256_0dlibssh_8org_8txt" startline="93">pubkey</references>
        <references refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" compoundref="pkd__daemon_8c" startline="62">rc</references>
        <references refid="structssh__session__struct_1ab5f06090005e380e8b32468e2b2a9ffb" compoundref="session_8h" startline="185">ssh_session_struct::rsa_key</references>
        <references refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" compoundref="torture__session__keys_8c" startline="61">session</references>
        <references refid="structssh__session__struct_1a6f50dd2453f70016845c90e9a0e7e641">ssh_session_struct::srv</references>
        <references refid="dh_8h_1a0d46abbfee369e9fb75f930e5f6a993a" compoundref="dh_8c" startline="287" endline="292">ssh_dh_import_next_pubkey_blob</references>
        <references refid="libssh_8h_1a036b2b00fb04337a4d06d719d1b62be1a86ff0b2e8da6ad8628efc556b6ce1887" compoundref="libssh_8h" startline="286">SSH_FATAL</references>
        <references refid="group__libssh__pki_1ga08808beb83a42ccd6f1c710ddeb1b4c2" compoundref="pki_8c" startline="205" endline="210">ssh_key_free</references>
        <references refid="libssh_8h_1a244b017e5993fde29fe9e9b1f04a7bcea1adda9da237bf26cb1b46a9e3b9fd99f" compoundref="libssh_8h" startline="293">SSH_KEYTYPE_DSS</references>
        <references refid="libssh_8h_1a244b017e5993fde29fe9e9b1f04a7bcea1f244a10b34e2f9dd3627edbef5166ed" compoundref="libssh_8h" startline="300">SSH_KEYTYPE_ECDSA_P256</references>
        <references refid="libssh_8h_1a244b017e5993fde29fe9e9b1f04a7bceaeb5f376b9746eadb0210e4b1e797a226" compoundref="libssh_8h" startline="301">SSH_KEYTYPE_ECDSA_P384</references>
        <references refid="libssh_8h_1a244b017e5993fde29fe9e9b1f04a7bcea60f4b5533fda0045bbbb4e18bfd6580d" compoundref="libssh_8h" startline="302">SSH_KEYTYPE_ECDSA_P521</references>
        <references refid="libssh_8h_1a244b017e5993fde29fe9e9b1f04a7bcea237671d46fa2c7f139963e154d5430bf" compoundref="libssh_8h" startline="297">SSH_KEYTYPE_ED25519</references>
        <references refid="libssh_8h_1a244b017e5993fde29fe9e9b1f04a7bcea94ea687ea48d0e1eceef97f1c1745683" compoundref="libssh_8h" startline="294">SSH_KEYTYPE_RSA</references>
        <references refid="libssh_8h_1a244b017e5993fde29fe9e9b1f04a7bceac654b6d0625420374941826e33ce8f7e" compoundref="libssh_8h" startline="295">SSH_KEYTYPE_RSA1</references>
        <references refid="libssh_8h_1a244b017e5993fde29fe9e9b1f04a7bceafefc5ac8dd22ec75f84a6ad5ee2d591b" compoundref="libssh_8h" startline="292">SSH_KEYTYPE_UNKNOWN</references>
        <references refid="libssh_8h_1ac1ee1d1e917456d4760a94a18015377d" compoundref="libssh_8h" startline="329">SSH_OK</references>
        <references refid="group__libssh__pki_1ga5777bc537da6a447b2a9aa9eceff9877" compoundref="pki_8c" startline="1992" endline="2008">ssh_pki_export_privkey_to_pubkey</references>
        <references refid="group__libssh__pki_1gaadeaf6dc35e99214de0af82c3c431649" compoundref="pki_8c" startline="2030" endline="2046">ssh_pki_export_pubkey_blob</references>
        <references refid="priv_8h_1a55177b3e8db90ca9adb435c44281963c" compoundref="priv_8h" startline="258">ssh_set_error</references>
        <references refid="priv_8h_1ae280c413c792e04237f000841ac8ce44" compoundref="priv_8h" startline="265">ssh_set_error_oom</references>
        <references refid="libssh_8h_1a5bc8710c8633117ff449d15489fca051" compoundref="libssh_8h" startline="790">SSH_STRING_FREE</references>
      </memberdef>
      <memberdef kind="function" id="group__libssh__server_1ga6b0057a0346a87ddd9b57bfbbc580d4d" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>static void ssh_server_connection_callback</definition>
        <argsstring>(ssh_session session)</argsstring>
        <name>ssh_server_connection_callback</name>
        <param>
          <type><ref refid="libssh_8h_1a02d3754de040612632cdd499c20f92f6" kindref="member">ssh_session</ref></type>
          <declname>session</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/server.c" line="338" column="13" bodyfile="src/server.c" bodystart="338" bodyend="449"/>
        <references refid="structssh__session__struct_1a729d3c7f6ae20cb5a00ac7cd28a630f7" compoundref="session_8h" startline="124">ssh_session_struct::alive</references>
        <references refid="structssh__crypto__struct_1a0fa9919df32b44ccafc551d220fe609b" compoundref="crypto_8h" startline="150">ssh_crypto_struct::client_kex</references>
        <references refid="structssh__session__struct_1aff7925f04070fc20dc3d9366d7f2f748" compoundref="session_8h" startline="113">ssh_session_struct::clientbanner</references>
        <references refid="structssh__session__struct_1a70c6a6c0e1a409047afd7608b5aa40c3" compoundref="session_8h" startline="122">ssh_session_struct::connected</references>
        <references refid="wrapper_8h_1a0d1d5ba8b1aa92198d65aa7a173dd758">crypt_set_algorithms_server</references>
        <references refid="structssh__socket__callbacks__struct_1a73d09c1b2ae438da96c4b3bbfb99c9ad" compoundref="callbacks_8h" startline="390">ssh_socket_callbacks_struct::data</references>
        <references refid="structssh__session__struct_1a6a94fa11eb06ca18d3c0ac22a153f97f" compoundref="session_8h" startline="149">ssh_session_struct::dh_handshake_state</references>
        <references refid="session_8h_1a52a640f6094e9b3d1a88c7da7d08c802a01abdeced4b17007ee1ffdb54f5d70e2" compoundref="session_8h" startline="56">DH_STATE_FINISHED</references>
        <references refid="proxy_8c_1a11614f44ef4d939bdd984953346a7572" compoundref="proxy_8c" startline="33">error</references>
        <references refid="structssh__session__struct_1a2881b30666809faf781755e3ba827418" compoundref="session_8h" startline="132">ssh_session_struct::extensions</references>
        <references refid="structssh__session__struct_1a997060832a3419d8fe884d3da855ef4c" compoundref="session_8h" startline="129">ssh_session_struct::flags</references>
        <references refid="structssh__kex__struct_1a5a8b3f27866bcbfde98a9d66793ae389" compoundref="kex_8h" startline="31">ssh_kex_struct::methods</references>
        <references refid="structssh__session__struct_1a4ea5e4ae5383c6cdb5db9f08bbbfa019" compoundref="session_8h" startline="173">ssh_session_struct::next_crypto</references>
        <references refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" compoundref="pkd__daemon_8c" startline="62">rc</references>
        <references refid="structssh__crypto__struct_1ac78255bf9406137ac4d400644c348a82" compoundref="crypto_8h" startline="149">ssh_crypto_struct::server_kex</references>
        <references refid="group__libssh__server_1gac8dda51f6f008e42e60d824e2ef2e453" compoundref="server_8c" startline="84" endline="195">server_set_kex</references>
        <references refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" compoundref="torture__session__keys_8c" startline="61">session</references>
        <references refid="structssh__session__struct_1a6f74d1a1eb6ed715b1073b67caa18460" compoundref="session_8h" startline="147">ssh_session_struct::session_state</references>
        <references refid="server_8c_1ae999fe5d95dd5d737af376462d2c59c5" compoundref="server_8c" startline="64">set_status</references>
        <references refid="structssh__session__struct_1a3e64318ee32b9880aafbded46fabf81d" compoundref="session_8h" startline="111">ssh_session_struct::socket</references>
        <references refid="structssh__session__struct_1a77c2c8292416988963f37b9723d2f55f" compoundref="session_8h" startline="202">ssh_session_struct::socket_callbacks</references>
        <references refid="group__libssh__misc_1gae795e33139e9c0ad1611fc4fdf476fbe" compoundref="misc_8c" startline="1221" endline="1310">ssh_analyze_banner</references>
        <references refid="wrapper_8h_1a9ebe789b5f29a369c7799ec6ce17f1a9a86b8de4a56d77c10ee93f4cb0ab82d71" compoundref="wrapper_8h" startline="60">SSH_DIRECTION_IN</references>
        <references refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" compoundref="libssh_8h" startline="330">SSH_ERROR</references>
        <references refid="session_8h_1a9bd3f2ee7d4c57e1b5157c22da5daee0" compoundref="session_8h" startline="97">SSH_EXT_NEGOTIATION</references>
        <references refid="libssh_8h_1a036b2b00fb04337a4d06d719d1b62be1a86ff0b2e8da6ad8628efc556b6ce1887" compoundref="libssh_8h" startline="286">SSH_FATAL</references>
        <references refid="kex_8h_1a10fc6e5cb4678972e355e69bfe8e35e4" compoundref="kex_8c" startline="739" endline="801">ssh_kex_select_methods</references>
        <references refid="kex_8h_1a0e79dc09bff165cdc194d729c96d4e0d" compoundref="kex_8c" startline="545" endline="559">ssh_list_kex</references>
        <references refid="priv_8h_1aa21fd8a7a609329603b7b16da7939fca" compoundref="priv_8h" startline="240">SSH_LOG</references>
        <references refid="group__libssh__log_1ggadf764cbdea00d65edcd07bb9953ad2b7a75fa79e63947b66462db977d9b5ae27c" compoundref="libssh_8h" startline="349">SSH_LOG_PROTOCOL</references>
        <references refid="libssh_8h_1ac1ee1d1e917456d4760a94a18015377d" compoundref="libssh_8h" startline="329">SSH_OK</references>
        <references refid="packet_8h_1aca955bacc5c633c212bdb61e1b43a1a2">ssh_packet_register_socket_callback</references>
        <references refid="packet_8h_1a2e88eac5d0547fdb7f03830adce9c4d2" compoundref="packet_8c" startline="1449" endline="1455">ssh_packet_set_default_callbacks</references>
        <references refid="packet_8h_1ab8efa43ad331ae38c5a72bea6b5f6a14" compoundref="packet_8c" startline="1877" endline="1994">ssh_packet_set_newkeys</references>
        <references refid="packet_8h_1af53b16a51c1fb0b3cd7c15baba882ed8" compoundref="packet_8c" startline="1059" endline="1389">ssh_packet_socket_callback</references>
        <references refid="kex_8h_1a6c4425f4b80fc393d0c71ef488c240ba" compoundref="kex_8c" startline="805" endline="861">ssh_send_kex</references>
        <references refid="group__libssh__server_1ga3d13039ae1fd46aa8c028401b62bd0af" compoundref="server_8c" startline="212" endline="248">ssh_server_send_extensions</references>
        <references refid="session_8h_1ae54e87f0565e24b25aed1372b3493a2b" compoundref="session_8h" startline="76">SSH_SESSION_FLAG_AUTHENTICATED</references>
        <references refid="session_8h_1a9bbd1d5ae11485e27279be6ad461992caced7c62fd9f24fe8f6672d50b8219f60" compoundref="session_8h" startline="45">SSH_SESSION_STATE_AUTHENTICATED</references>
        <references refid="session_8h_1a9bbd1d5ae11485e27279be6ad461992ca0bf582a8796f77262a1161fabc9a587b" compoundref="session_8h" startline="44">SSH_SESSION_STATE_AUTHENTICATING</references>
        <references refid="session_8h_1a9bbd1d5ae11485e27279be6ad461992caa688177b6c71d2eaf7af6b9e3b3dea5b" compoundref="session_8h" startline="40">SSH_SESSION_STATE_BANNER_RECEIVED</references>
        <references refid="session_8h_1a9bbd1d5ae11485e27279be6ad461992cad7664a3923c57a333c0c5ff14f5d6c1e" compoundref="session_8h" startline="38">SSH_SESSION_STATE_CONNECTING</references>
        <references refid="session_8h_1a9bbd1d5ae11485e27279be6ad461992ca1dcace0fedd97312d6829ecc526d3606" compoundref="session_8h" startline="43">SSH_SESSION_STATE_DH</references>
        <references refid="session_8h_1a9bbd1d5ae11485e27279be6ad461992ca855474fc84a2fb170fcb72546af8eeb8" compoundref="session_8h" startline="46">SSH_SESSION_STATE_ERROR</references>
        <references refid="session_8h_1a9bbd1d5ae11485e27279be6ad461992ca64f98e48c54ec9ae09070b92c1f47659" compoundref="session_8h" startline="41">SSH_SESSION_STATE_INITIAL_KEX</references>
        <references refid="session_8h_1a9bbd1d5ae11485e27279be6ad461992ca336024640ab057d21d87ded010687dc7" compoundref="session_8h" startline="42">SSH_SESSION_STATE_KEXINIT_RECEIVED</references>
        <references refid="session_8h_1a9bbd1d5ae11485e27279be6ad461992ca6e96b3ae323d058e27297e97c01c1d7f" compoundref="session_8h" startline="37">SSH_SESSION_STATE_NONE</references>
        <references refid="session_8h_1a9bbd1d5ae11485e27279be6ad461992ca82652ed2dc1cdfd2c8cdb12a3ab6b703" compoundref="session_8h" startline="39">SSH_SESSION_STATE_SOCKET_CONNECTED</references>
        <references refid="priv_8h_1a55177b3e8db90ca9adb435c44281963c" compoundref="priv_8h" startline="258">ssh_set_error</references>
        <references refid="socket_8h_1aaf4853539d6ed1c3508cca5a45d557d6" compoundref="socket_8c" startline="447" endline="487">ssh_socket_close</references>
        <referencedby refid="group__libssh__server_1gab60c37350653eb3b65a99ac089c55830" compoundref="server_8c" startline="528" endline="563">ssh_handle_key_exchange</referencedby>
      </memberdef>
      <memberdef kind="function" id="group__libssh__server_1ga4c4c9ace93a9791515090ebc197dd736" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>static int callback_receive_banner</definition>
        <argsstring>(const void *data, size_t len, void *user)</argsstring>
        <name>callback_receive_banner</name>
        <param>
          <type>const void *</type>
          <declname>data</declname>
        </param>
        <param>
          <type>size_t</type>
          <declname>len</declname>
        </param>
        <param>
          <type>void *</type>
          <declname>user</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/server.c" line="462" column="12" bodyfile="src/server.c" bodystart="462" bodyend="507"/>
        <references refid="benchmarks_8c_1aff2566f4c366b48d73479bef43ee4d2e" compoundref="benchmarks_8c" startline="347">buffer</references>
        <references refid="structssh__session__struct_1aff7925f04070fc20dc3d9366d7f2f748" compoundref="session_8h" startline="113">ssh_session_struct::clientbanner</references>
        <references refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" compoundref="torture__session__keys_8c" startline="61">session</references>
        <references refid="structssh__session__struct_1a6f74d1a1eb6ed715b1073b67caa18460" compoundref="session_8h" startline="147">ssh_session_struct::session_state</references>
        <references refid="structssh__session__struct_1a4fdde3f498bcf3e0f118335278a8ec5a" compoundref="session_8h" startline="199">ssh_session_struct::ssh_connection_callback</references>
        <references refid="libssh_8h_1a036b2b00fb04337a4d06d719d1b62be1a86ff0b2e8da6ad8628efc556b6ce1887" compoundref="libssh_8h" startline="286">SSH_FATAL</references>
        <references refid="priv_8h_1aa21fd8a7a609329603b7b16da7939fca" compoundref="priv_8h" startline="240">SSH_LOG</references>
        <references refid="group__libssh__log_1ggadf764cbdea00d65edcd07bb9953ad2b7a6445dfe21592d69d9741d319538b6673" compoundref="libssh_8h" startline="352">SSH_LOG_PACKET</references>
        <references refid="session_8h_1a9bbd1d5ae11485e27279be6ad461992caa688177b6c71d2eaf7af6b9e3b3dea5b" compoundref="session_8h" startline="40">SSH_SESSION_STATE_BANNER_RECEIVED</references>
        <references refid="session_8h_1a9bbd1d5ae11485e27279be6ad461992ca855474fc84a2fb170fcb72546af8eeb8" compoundref="session_8h" startline="46">SSH_SESSION_STATE_ERROR</references>
        <references refid="priv_8h_1a55177b3e8db90ca9adb435c44281963c" compoundref="priv_8h" startline="258">ssh_set_error</references>
        <references refid="ssh__client_8c_1a14871705f45ccdc5bb9f4549efd8e119" compoundref="ssh__client_8c" startline="48">user</references>
        <referencedby refid="group__libssh__server_1gab60c37350653eb3b65a99ac089c55830" compoundref="server_8c" startline="528" endline="563">ssh_handle_key_exchange</referencedby>
      </memberdef>
      <memberdef kind="function" id="group__libssh__server_1gaa18bae911e9533e48b33f63ac0c24cb6" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>static int ssh_server_kex_termination</definition>
        <argsstring>(void *s)</argsstring>
        <name>ssh_server_kex_termination</name>
        <param>
          <type>void *</type>
          <declname>s</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/server.c" line="510" column="12" bodyfile="src/server.c" bodystart="510" bodyend="518"/>
        <references refid="test__socket_8c_1a73991beba1accdcc64730cb00c146fe2" compoundref="test__socket_8c" startline="34">s</references>
        <references refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" compoundref="torture__session__keys_8c" startline="61">session</references>
        <references refid="structssh__session__struct_1a6f74d1a1eb6ed715b1073b67caa18460" compoundref="session_8h" startline="147">ssh_session_struct::session_state</references>
        <references refid="session_8h_1a9bbd1d5ae11485e27279be6ad461992ca0bf582a8796f77262a1161fabc9a587b" compoundref="session_8h" startline="44">SSH_SESSION_STATE_AUTHENTICATING</references>
        <references refid="session_8h_1a9bbd1d5ae11485e27279be6ad461992ca05407079ea8dd73449ac6f9ddbf58084" compoundref="session_8h" startline="47">SSH_SESSION_STATE_DISCONNECTED</references>
        <references refid="session_8h_1a9bbd1d5ae11485e27279be6ad461992ca855474fc84a2fb170fcb72546af8eeb8" compoundref="session_8h" startline="46">SSH_SESSION_STATE_ERROR</references>
        <referencedby refid="group__libssh__server_1gab60c37350653eb3b65a99ac089c55830" compoundref="server_8c" startline="528" endline="563">ssh_handle_key_exchange</referencedby>
      </memberdef>
      <memberdef kind="function" id="group__libssh__server_1gabbfb96c938e33a8dddebaff29f25e0c6" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="libssh_8h_1a2ba7f29ac0f2b5ef7134243d24888ac5" kindref="member">LIBSSH_API</ref> void</type>
        <definition>void ssh_set_auth_methods</definition>
        <argsstring>(ssh_session session, int auth_methods)</argsstring>
        <name>ssh_set_auth_methods</name>
        <param>
          <type><ref refid="libssh_8h_1a02d3754de040612632cdd499c20f92f6" kindref="member">ssh_session</ref></type>
          <declname>session</declname>
        </param>
        <param>
          <type>int</type>
          <declname>auth_methods</declname>
        </param>
        <briefdescription>
<para>Set the acceptable authentication methods to be sent to the client. </para>
        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername direction="in">session</parametername>
</parameternamelist>
<parameterdescription>
<para>The server session</para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">auth_methods</parametername>
</parameternamelist>
<parameterdescription>
<para>The authentication methods we will support, which can be bitwise-or&apos;d.</para>
</parameterdescription>
</parameteritem>
</parameterlist>
Supported methods are:</para>
<para>SSH_AUTH_METHOD_PASSWORD SSH_AUTH_METHOD_PUBLICKEY SSH_AUTH_METHOD_HOSTBASED SSH_AUTH_METHOD_INTERACTIVE SSH_AUTH_METHOD_GSSAPI_MIC </para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/server.c" line="521" column="6" bodyfile="src/server.c" bodystart="521" bodyend="525" declfile="include/libssh/server.h" declline="244" declcolumn="17"/>
        <references refid="structssh__session__struct_1a3d57e01582c0c9099f7f319513321fe8">ssh_session_struct::auth</references>
        <references refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" compoundref="torture__session__keys_8c" startline="61">session</references>
        <references refid="structssh__session__struct_1a3e967ac3134cae87dae1f6a794424073" compoundref="session_8h" startline="157">ssh_session_struct::supported_methods</references>
        <referencedby refid="default__cb_8c_1a1c4ec691e0189bd2ff9c7acd3399895b" compoundref="default__cb_8c" startline="783" endline="995">default_handle_session_cb</referencedby>
        <referencedby refid="torture__server__auth__kbdint_8c_1a845bb2d262ac6cb3c7acfaeb394641ee" compoundref="torture__server__auth__kbdint_8c" startline="333" endline="515">handle_kbdint_session_cb</referencedby>
        <referencedby refid="ssh__server__fork_8c_1a2094e558ae17a16e444d40f575063102" compoundref="ssh__server__fork_8c" startline="536" endline="679">handle_session</referencedby>
        <referencedby refid="ssh__server__fuzzer_8cpp_1a91ce7c16e9840492202299da2b451e60" compoundref="ssh__server__fuzzer_8cpp" startline="118" endline="199">LLVMFuzzerTestOneInput</referencedby>
        <referencedby refid="proxy_8c_1a3c04138a5bfe5d72780bb7e82a18e627" compoundref="proxy_8c" startline="215" endline="346">main</referencedby>
        <referencedby refid="pkd__daemon_8c_1abe87875a523cecd013d848c7c9c5ba22" compoundref="pkd__daemon_8c" startline="238" endline="475">pkd_exec_hello</referencedby>
      </memberdef>
      <memberdef kind="function" id="group__libssh__server_1gab60c37350653eb3b65a99ac089c55830" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="libssh_8h_1a2ba7f29ac0f2b5ef7134243d24888ac5" kindref="member">LIBSSH_API</ref> int</type>
        <definition>int ssh_handle_key_exchange</definition>
        <argsstring>(ssh_session session)</argsstring>
        <name>ssh_handle_key_exchange</name>
        <param>
          <type><ref refid="libssh_8h_1a02d3754de040612632cdd499c20f92f6" kindref="member">ssh_session</ref></type>
          <declname>session</declname>
        </param>
        <briefdescription>
<para>Handles the key exchange and set up encryption. </para>
        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>session</parametername>
</parameternamelist>
<parameterdescription>
<para>A connected ssh session </para>
</parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="see"><para><ref refid="group__libssh__server_1ga6609243446f1650243101e0a779dc822" kindref="member">ssh_bind_accept</ref> </para>
</simplesect>
<simplesect kind="return"><para>SSH_OK if the key exchange was successful </para>
</simplesect>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/server.c" line="528" column="5" bodyfile="src/server.c" bodystart="528" bodyend="563" declfile="include/libssh/server.h" declline="200" declcolumn="16"/>
        <references refid="structssh__session__struct_1a729d3c7f6ae20cb5a00ac7cd28a630f7" compoundref="session_8h" startline="124">ssh_session_struct::alive</references>
        <references refid="group__libssh__server_1ga4c4c9ace93a9791515090ebc197dd736" compoundref="server_8c" startline="462" endline="507">callback_receive_banner</references>
        <references refid="structssh__socket__callbacks__struct_1a73d09c1b2ae438da96c4b3bbfb99c9ad" compoundref="callbacks_8h" startline="390">ssh_socket_callbacks_struct::data</references>
        <references refid="structssh__socket__callbacks__struct_1ae642ee58e72973ee0802820e46cb777b" compoundref="callbacks_8h" startline="398">ssh_socket_callbacks_struct::exception</references>
        <references refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" compoundref="pkd__daemon_8c" startline="62">rc</references>
        <references refid="group__libssh__server_1gac8dda51f6f008e42e60d824e2ef2e453" compoundref="server_8c" startline="84" endline="195">server_set_kex</references>
        <references refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" compoundref="torture__session__keys_8c" startline="61">session</references>
        <references refid="structssh__session__struct_1a6f74d1a1eb6ed715b1073b67caa18460" compoundref="session_8h" startline="147">ssh_session_struct::session_state</references>
        <references refid="structssh__session__struct_1a3e64318ee32b9880aafbded46fabf81d" compoundref="session_8h" startline="111">ssh_session_struct::socket</references>
        <references refid="structssh__session__struct_1a77c2c8292416988963f37b9723d2f55f" compoundref="session_8h" startline="202">ssh_session_struct::socket_callbacks</references>
        <references refid="structssh__session__struct_1a4fdde3f498bcf3e0f118335278a8ec5a" compoundref="session_8h" startline="199">ssh_session_struct::ssh_connection_callback</references>
        <references refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" compoundref="libssh_8h" startline="330">SSH_ERROR</references>
        <references refid="group__libssh__session_1ga4b84e1ae757c0d4007a5eefdf4651694" compoundref="session_8c" startline="692" endline="740">ssh_handle_packets_termination</references>
        <references refid="priv_8h_1aa21fd8a7a609329603b7b16da7939fca" compoundref="priv_8h" startline="240">SSH_LOG</references>
        <references refid="group__libssh__log_1ggadf764cbdea00d65edcd07bb9953ad2b7a6445dfe21592d69d9741d319538b6673" compoundref="libssh_8h" startline="352">SSH_LOG_PACKET</references>
        <references refid="libssh_8h_1ac1ee1d1e917456d4760a94a18015377d" compoundref="libssh_8h" startline="329">SSH_OK</references>
        <references refid="priv_8h_1aacb791f6b4bb44f93327dee7ab138717" compoundref="client_8c" startline="175" endline="237">ssh_send_banner</references>
        <references refid="group__libssh__server_1ga6b0057a0346a87ddd9b57bfbbc580d4d" compoundref="server_8c" startline="338" endline="449">ssh_server_connection_callback</references>
        <references refid="group__libssh__server_1gaa18bae911e9533e48b33f63ac0c24cb6" compoundref="server_8c" startline="510" endline="518">ssh_server_kex_termination</references>
        <references refid="session_8h_1a9bbd1d5ae11485e27279be6ad461992ca05407079ea8dd73449ac6f9ddbf58084" compoundref="session_8h" startline="47">SSH_SESSION_STATE_DISCONNECTED</references>
        <references refid="session_8h_1a9bbd1d5ae11485e27279be6ad461992ca855474fc84a2fb170fcb72546af8eeb8" compoundref="session_8h" startline="46">SSH_SESSION_STATE_ERROR</references>
        <references refid="session_8h_1a9bbd1d5ae11485e27279be6ad461992ca6e96b3ae323d058e27297e97c01c1d7f" compoundref="session_8h" startline="37">SSH_SESSION_STATE_NONE</references>
        <references refid="session_8h_1a9bbd1d5ae11485e27279be6ad461992ca82652ed2dc1cdfd2c8cdb12a3ab6b703" compoundref="session_8h" startline="39">SSH_SESSION_STATE_SOCKET_CONNECTED</references>
        <references refid="group__libssh__session_1ga2635562d4c0bb8507e9a9f7274ff4729" compoundref="session_8c" startline="848" endline="860">ssh_socket_exception_callback</references>
        <references refid="socket_8h_1a15a69b474244317cc9401a9a404e7bcc" compoundref="socket_8c" startline="212" endline="215">ssh_socket_set_callbacks</references>
        <references refid="session_8h_1a1d6b747c5003e24c3461096c76580b15" compoundref="session_8h" startline="82">SSH_TIMEOUT_USER</references>
        <references refid="structssh__socket__callbacks__struct_1a21680bc94721a1507e1382e06f731aef" compoundref="callbacks_8h" startline="385">ssh_socket_callbacks_struct::userdata</references>
        <referencedby refid="default__cb_8c_1a1c4ec691e0189bd2ff9c7acd3399895b" compoundref="default__cb_8c" startline="783" endline="995">default_handle_session_cb</referencedby>
        <referencedby refid="torture__server__auth__kbdint_8c_1a845bb2d262ac6cb3c7acfaeb394641ee" compoundref="torture__server__auth__kbdint_8c" startline="333" endline="515">handle_kbdint_session_cb</referencedby>
        <referencedby refid="ssh__server__fork_8c_1a2094e558ae17a16e444d40f575063102" compoundref="ssh__server__fork_8c" startline="536" endline="679">handle_session</referencedby>
        <referencedby refid="ssh__server__fuzzer_8cpp_1a91ce7c16e9840492202299da2b451e60" compoundref="ssh__server__fuzzer_8cpp" startline="118" endline="199">LLVMFuzzerTestOneInput</referencedby>
        <referencedby refid="proxy_8c_1a3c04138a5bfe5d72780bb7e82a18e627" compoundref="proxy_8c" startline="215" endline="346">main</referencedby>
        <referencedby refid="pkd__daemon_8c_1abe87875a523cecd013d848c7c9c5ba22" compoundref="pkd__daemon_8c" startline="238" endline="475">pkd_exec_hello</referencedby>
        <referencedby refid="test__ssh__bind__accept__fd_8c_1a475e25b488e6aa630501e0ac49d64f8a" compoundref="test__ssh__bind__accept__fd_8c" startline="62" endline="103">ssh_server</referencedby>
        <referencedby refid="torture__server__x11_8c_1af793ec1fe611ecefae9f68db4f588c82" compoundref="torture__server__x11_8c" startline="154" endline="221">test_ssh_channel_request_x11</referencedby>
      </memberdef>
      <memberdef kind="function" id="group__libssh__server_1gaa8a38b0ea0e5ee2bce17eab77dfc850c" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>int ssh_auth_reply_default</definition>
        <argsstring>(ssh_session session, int partial)</argsstring>
        <name>ssh_auth_reply_default</name>
        <param>
          <type><ref refid="libssh_8h_1a02d3754de040612632cdd499c20f92f6" kindref="member">ssh_session</ref></type>
          <declname>session</declname>
        </param>
        <param>
          <type>int</type>
          <declname>partial</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/server.c" line="570" column="5" bodyfile="src/server.c" bodystart="570" bodyend="620"/>
        <references refid="structssh__session__struct_1a3d57e01582c0c9099f7f319513321fe8">ssh_session_struct::auth</references>
        <references refid="structssh__session__struct_1af0aed60c1e529bbfdcb483fd80bf98a0" compoundref="session_8h" startline="140">ssh_session_struct::out_buffer</references>
        <references refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" compoundref="pkd__daemon_8c" startline="62">rc</references>
        <references refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" compoundref="torture__session__keys_8c" startline="61">session</references>
        <references refid="ssh2_8h_1a59f13bc349811a5beda02b13b2b3cd48" compoundref="ssh2_8h" startline="28">SSH2_MSG_USERAUTH_FAILURE</references>
        <references refid="libssh_8h_1aa17667dad32ec77112a201b1b4b858e8" compoundref="libssh_8h" startline="177">SSH_AUTH_METHOD_GSSAPI_MIC</references>
        <references refid="libssh_8h_1a47af3117d9ab19c61afeebfbfac8cfc4" compoundref="libssh_8h" startline="175">SSH_AUTH_METHOD_HOSTBASED</references>
        <references refid="libssh_8h_1a4c64484fdce4756309799d0e2a4e926a" compoundref="libssh_8h" startline="176">SSH_AUTH_METHOD_INTERACTIVE</references>
        <references refid="libssh_8h_1ad10dd2f5826e2d92a30bd8af3404574d" compoundref="libssh_8h" startline="173">SSH_AUTH_METHOD_PASSWORD</references>
        <references refid="libssh_8h_1aff27d66c1f5ba3871e72b5a61573f44a" compoundref="libssh_8h" startline="174">SSH_AUTH_METHOD_PUBLICKEY</references>
        <references refid="buffer_8h_1ae17848a86043f0abfc60c1c4f6126ccd" compoundref="buffer_8h" startline="49">ssh_buffer_pack</references>
        <references refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" compoundref="libssh_8h" startline="330">SSH_ERROR</references>
        <references refid="priv_8h_1aa21fd8a7a609329603b7b16da7939fca" compoundref="priv_8h" startline="240">SSH_LOG</references>
        <references refid="group__libssh__log_1ggadf764cbdea00d65edcd07bb9953ad2b7a6445dfe21592d69d9741d319538b6673" compoundref="libssh_8h" startline="352">SSH_LOG_PACKET</references>
        <references refid="libssh_8h_1ac1ee1d1e917456d4760a94a18015377d" compoundref="libssh_8h" startline="329">SSH_OK</references>
        <references refid="packet_8h_1a7e6c7ed74c23ace432476aa8a6841140" compoundref="packet_8c" startline="1761" endline="1843">ssh_packet_send</references>
        <references refid="priv_8h_1ae280c413c792e04237f000841ac8ce44" compoundref="priv_8h" startline="265">ssh_set_error_oom</references>
        <references refid="structssh__session__struct_1a3e967ac3134cae87dae1f6a794424073" compoundref="session_8h" startline="157">ssh_session_struct::supported_methods</references>
        <referencedby refid="group__libssh__server_1gace0de62d8bdae327069fd81fdb1861d5" compoundref="server_8c" startline="953" endline="994">ssh_auth_reply_success</referencedby>
        <referencedby refid="group__libssh__server_1ga6e78c8f369333289d245931deed92573" compoundref="server_8c" startline="751" endline="775">ssh_message_reply_default</referencedby>
      </memberdef>
      <memberdef kind="function" id="group__libssh__server_1gaf7984c469e61e9d5f05c80d967970a1c" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>static int ssh_message_channel_request_open_reply_default</definition>
        <argsstring>(ssh_message msg)</argsstring>
        <name>ssh_message_channel_request_open_reply_default</name>
        <param>
          <type><ref refid="libssh_8h_1aee0e83a574ad7c842ae73ae2aa449d07" kindref="member">ssh_message</ref></type>
          <declname>msg</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/server.c" line="622" column="12" bodyfile="src/server.c" bodystart="622" bodyend="641"/>
        <references refid="structssh__message__struct_1a7579d1e2cd4136f2e152985d0018777f" compoundref="messages_8h" startline="88">ssh_message_struct::channel_request_open</references>
        <references refid="structssh__session__struct_1af0aed60c1e529bbfdcb483fd80bf98a0" compoundref="session_8h" startline="140">ssh_session_struct::out_buffer</references>
        <references refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" compoundref="pkd__daemon_8c" startline="62">rc</references>
        <references refid="structssh__channel__request__open_1a2ac8ee1b20572c9b13d3ccd3007d364d" compoundref="messages_8h" startline="37">ssh_channel_request_open::sender</references>
        <references refid="structssh__message__struct_1aceb641c0b1e8eaaa91965f3bf5025ad3" compoundref="messages_8h" startline="85">ssh_message_struct::session</references>
        <references refid="ssh2_8h_1ac045176d5273382c572e625584afdef0" compoundref="ssh2_8h" startline="47">SSH2_MSG_CHANNEL_OPEN_FAILURE</references>
        <references refid="ssh2_8h_1ab9d4094d3bba6175cdcc312fc4867e3b" compoundref="ssh2_8h" startline="74">SSH2_OPEN_ADMINISTRATIVELY_PROHIBITED</references>
        <references refid="buffer_8h_1ae17848a86043f0abfc60c1c4f6126ccd" compoundref="buffer_8h" startline="49">ssh_buffer_pack</references>
        <references refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" compoundref="libssh_8h" startline="330">SSH_ERROR</references>
        <references refid="priv_8h_1aa21fd8a7a609329603b7b16da7939fca" compoundref="priv_8h" startline="240">SSH_LOG</references>
        <references refid="group__libssh__log_1ggadf764cbdea00d65edcd07bb9953ad2b7a926c933f61d1afa64003c1cc66f6a01c" compoundref="libssh_8h" startline="355">SSH_LOG_FUNCTIONS</references>
        <references refid="libssh_8h_1ac1ee1d1e917456d4760a94a18015377d" compoundref="libssh_8h" startline="329">SSH_OK</references>
        <references refid="packet_8h_1a7e6c7ed74c23ace432476aa8a6841140" compoundref="packet_8c" startline="1761" endline="1843">ssh_packet_send</references>
        <references refid="priv_8h_1ae280c413c792e04237f000841ac8ce44" compoundref="priv_8h" startline="265">ssh_set_error_oom</references>
        <referencedby refid="group__libssh__server_1ga6e78c8f369333289d245931deed92573" compoundref="server_8c" startline="751" endline="775">ssh_message_reply_default</referencedby>
      </memberdef>
      <memberdef kind="function" id="group__libssh__server_1ga79d82cfe686f9389bc74b95533f976d7" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>static int ssh_message_channel_request_reply_default</definition>
        <argsstring>(ssh_message msg)</argsstring>
        <name>ssh_message_channel_request_reply_default</name>
        <param>
          <type><ref refid="libssh_8h_1aee0e83a574ad7c842ae73ae2aa449d07" kindref="member">ssh_message</ref></type>
          <declname>msg</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/server.c" line="643" column="12" bodyfile="src/server.c" bodystart="643" bodyend="668"/>
        <references refid="structssh__channel__request_1a916ad8e5354e27dbeebdd53303afac4b" compoundref="messages_8h" startline="59">ssh_channel_request::channel</references>
        <references refid="structssh__message__struct_1a988570288e6e64eca3bbb18c1733dd75" compoundref="messages_8h" startline="89">ssh_message_struct::channel_request</references>
        <references refid="structssh__session__struct_1af0aed60c1e529bbfdcb483fd80bf98a0" compoundref="session_8h" startline="140">ssh_session_struct::out_buffer</references>
        <references refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" compoundref="pkd__daemon_8c" startline="62">rc</references>
        <references refid="structssh__channel__struct_1aa553acf6d12fffb1ae18b11196c2c0e9" compoundref="channels_8h" startline="69">ssh_channel_struct::remote_channel</references>
        <references refid="structssh__message__struct_1aceb641c0b1e8eaaa91965f3bf5025ad3" compoundref="messages_8h" startline="85">ssh_message_struct::session</references>
        <references refid="ssh2_8h_1a2b23fd7211615f33319a267d1728c785" compoundref="ssh2_8h" startline="55">SSH2_MSG_CHANNEL_FAILURE</references>
        <references refid="buffer_8h_1ae17848a86043f0abfc60c1c4f6126ccd" compoundref="buffer_8h" startline="49">ssh_buffer_pack</references>
        <references refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" compoundref="libssh_8h" startline="330">SSH_ERROR</references>
        <references refid="priv_8h_1aa21fd8a7a609329603b7b16da7939fca" compoundref="priv_8h" startline="240">SSH_LOG</references>
        <references refid="group__libssh__log_1ggadf764cbdea00d65edcd07bb9953ad2b7a6445dfe21592d69d9741d319538b6673" compoundref="libssh_8h" startline="352">SSH_LOG_PACKET</references>
        <references refid="libssh_8h_1ac1ee1d1e917456d4760a94a18015377d" compoundref="libssh_8h" startline="329">SSH_OK</references>
        <references refid="packet_8h_1a7e6c7ed74c23ace432476aa8a6841140" compoundref="packet_8c" startline="1761" endline="1843">ssh_packet_send</references>
        <references refid="priv_8h_1ae280c413c792e04237f000841ac8ce44" compoundref="priv_8h" startline="265">ssh_set_error_oom</references>
        <references refid="structssh__channel__request_1a886d76c450019899f0d07a52cca48716" compoundref="messages_8h" startline="60">ssh_channel_request::want_reply</references>
        <referencedby refid="group__libssh__server_1ga6e78c8f369333289d245931deed92573" compoundref="server_8c" startline="751" endline="775">ssh_message_reply_default</referencedby>
      </memberdef>
      <memberdef kind="function" id="group__libssh__server_1ga6e63796d916bcc9a259e9863b2424cce" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>static int ssh_message_service_request_reply_default</definition>
        <argsstring>(ssh_message msg)</argsstring>
        <name>ssh_message_service_request_reply_default</name>
        <param>
          <type><ref refid="libssh_8h_1aee0e83a574ad7c842ae73ae2aa449d07" kindref="member">ssh_message</ref></type>
          <declname>msg</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/server.c" line="670" column="12" bodyfile="src/server.c" bodystart="670" bodyend="673"/>
        <references refid="group__libssh__server_1gad0bd348b84300149f017f5abbaff38f5" compoundref="server_8c" startline="675" endline="697">ssh_message_service_reply_success</references>
        <referencedby refid="group__libssh__server_1ga6e78c8f369333289d245931deed92573" compoundref="server_8c" startline="751" endline="775">ssh_message_reply_default</referencedby>
      </memberdef>
      <memberdef kind="function" id="group__libssh__server_1gad0bd348b84300149f017f5abbaff38f5" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="libssh_8h_1a2ba7f29ac0f2b5ef7134243d24888ac5" kindref="member">LIBSSH_API</ref> int</type>
        <definition>int ssh_message_service_reply_success</definition>
        <argsstring>(ssh_message msg)</argsstring>
        <name>ssh_message_service_reply_success</name>
        <param>
          <type><ref refid="libssh_8h_1aee0e83a574ad7c842ae73ae2aa449d07" kindref="member">ssh_message</ref></type>
          <declname>msg</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/server.c" line="675" column="5" bodyfile="src/server.c" bodystart="675" bodyend="697" declfile="include/libssh/server.h" declline="316" declcolumn="16"/>
        <references refid="structssh__session__struct_1af0aed60c1e529bbfdcb483fd80bf98a0" compoundref="session_8h" startline="140">ssh_session_struct::out_buffer</references>
        <references refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" compoundref="pkd__daemon_8c" startline="62">rc</references>
        <references refid="structssh__service__request_1a86553bc161bc0e98d52d51ad47ef36db" compoundref="messages_8h" startline="47">ssh_service_request::service</references>
        <references refid="structssh__message__struct_1ad604523f1d9456b8de05bdd34f2184d2" compoundref="messages_8h" startline="90">ssh_message_struct::service_request</references>
        <references refid="structssh__message__struct_1aceb641c0b1e8eaaa91965f3bf5025ad3" compoundref="messages_8h" startline="85">ssh_message_struct::session</references>
        <references refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" compoundref="torture__session__keys_8c" startline="61">session</references>
        <references refid="ssh2_8h_1a1b2cfc651c2bf6096c55f5113f3e7cdd" compoundref="ssh2_8h" startline="9">SSH2_MSG_SERVICE_ACCEPT</references>
        <references refid="buffer_8h_1ae17848a86043f0abfc60c1c4f6126ccd" compoundref="buffer_8h" startline="49">ssh_buffer_pack</references>
        <references refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" compoundref="libssh_8h" startline="330">SSH_ERROR</references>
        <references refid="priv_8h_1aa21fd8a7a609329603b7b16da7939fca" compoundref="priv_8h" startline="240">SSH_LOG</references>
        <references refid="group__libssh__log_1ggadf764cbdea00d65edcd07bb9953ad2b7a6445dfe21592d69d9741d319538b6673" compoundref="libssh_8h" startline="352">SSH_LOG_PACKET</references>
        <references refid="libssh_8h_1ac1ee1d1e917456d4760a94a18015377d" compoundref="libssh_8h" startline="329">SSH_OK</references>
        <references refid="packet_8h_1a7e6c7ed74c23ace432476aa8a6841140" compoundref="packet_8c" startline="1761" endline="1843">ssh_packet_send</references>
        <references refid="priv_8h_1ae280c413c792e04237f000841ac8ce44" compoundref="priv_8h" startline="265">ssh_set_error_oom</references>
        <referencedby refid="group__libssh__server_1ga6e63796d916bcc9a259e9863b2424cce" compoundref="server_8c" startline="670" endline="673">ssh_message_service_request_reply_default</referencedby>
      </memberdef>
      <memberdef kind="function" id="group__libssh__server_1ga9c09466e299aff371b2fba996054a6a2" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="libssh_8h_1a2ba7f29ac0f2b5ef7134243d24888ac5" kindref="member">LIBSSH_API</ref> int</type>
        <definition>int ssh_message_global_request_reply_success</definition>
        <argsstring>(ssh_message msg, uint16_t bound_port)</argsstring>
        <name>ssh_message_global_request_reply_success</name>
        <param>
          <type><ref refid="libssh_8h_1aee0e83a574ad7c842ae73ae2aa449d07" kindref="member">ssh_message</ref></type>
          <declname>msg</declname>
        </param>
        <param>
          <type>uint16_t</type>
          <declname>bound_port</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/server.c" line="699" column="5" bodyfile="src/server.c" bodystart="699" bodyend="731" declfile="include/libssh/server.h" declline="319" declcolumn="16"/>
        <references refid="structssh__global__request_1a599709a2aca163c961c8d224292a13b5" compoundref="messages_8h" startline="54">ssh_global_request::bind_port</references>
        <references refid="proxy_8c_1a11614f44ef4d939bdd984953346a7572" compoundref="proxy_8c" startline="33">error</references>
        <references refid="structssh__message__struct_1a76853b41d044d79fac0269c051507995" compoundref="messages_8h" startline="91">ssh_message_struct::global_request</references>
        <references refid="structssh__session__struct_1af0aed60c1e529bbfdcb483fd80bf98a0" compoundref="session_8h" startline="140">ssh_session_struct::out_buffer</references>
        <references refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" compoundref="pkd__daemon_8c" startline="62">rc</references>
        <references refid="structssh__message__struct_1aceb641c0b1e8eaaa91965f3bf5025ad3" compoundref="messages_8h" startline="85">ssh_message_struct::session</references>
        <references refid="ssh2_8h_1a6832b00e0e100b77a86a55f91c513441" compoundref="ssh2_8h" startline="43">SSH2_MSG_REQUEST_SUCCESS</references>
        <references refid="buffer_8h_1a25dc9ca6178465fb850de52b30e2add6">ssh_buffer_add_u8</references>
        <references refid="buffer_8h_1ae17848a86043f0abfc60c1c4f6126ccd" compoundref="buffer_8h" startline="49">ssh_buffer_pack</references>
        <references refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" compoundref="libssh_8h" startline="330">SSH_ERROR</references>
        <references refid="libssh_8h_1a7b5a4b48ef3802d694bea0a5eae4d7e4ac06ca985ccb40b3d3d365b36ef4f8142" compoundref="libssh_8h" startline="210">SSH_GLOBAL_REQUEST_TCPIP_FORWARD</references>
        <references refid="priv_8h_1aa21fd8a7a609329603b7b16da7939fca" compoundref="priv_8h" startline="240">SSH_LOG</references>
        <references refid="group__libssh__log_1ggadf764cbdea00d65edcd07bb9953ad2b7a926c933f61d1afa64003c1cc66f6a01c" compoundref="libssh_8h" startline="355">SSH_LOG_FUNCTIONS</references>
        <references refid="group__libssh__log_1ggadf764cbdea00d65edcd07bb9953ad2b7a6445dfe21592d69d9741d319538b6673" compoundref="libssh_8h" startline="352">SSH_LOG_PACKET</references>
        <references refid="libssh_8h_1ac1ee1d1e917456d4760a94a18015377d" compoundref="libssh_8h" startline="329">SSH_OK</references>
        <references refid="packet_8h_1a7e6c7ed74c23ace432476aa8a6841140" compoundref="packet_8c" startline="1761" endline="1843">ssh_packet_send</references>
        <references refid="priv_8h_1ae280c413c792e04237f000841ac8ce44" compoundref="priv_8h" startline="265">ssh_set_error_oom</references>
        <references refid="structssh__global__request_1a8eddd04a65fd218bac1e40488091b7fd" compoundref="messages_8h" startline="51">ssh_global_request::type</references>
        <references refid="structssh__global__request_1ac649e9fb0003f8161f6ea366c2b320a2" compoundref="messages_8h" startline="52">ssh_global_request::want_reply</references>
      </memberdef>
      <memberdef kind="function" id="group__libssh__server_1ga518a6b12d13cb2f4d74e261e43fc0129" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>static int ssh_message_global_request_reply_default</definition>
        <argsstring>(ssh_message msg)</argsstring>
        <name>ssh_message_global_request_reply_default</name>
        <param>
          <type><ref refid="libssh_8h_1aee0e83a574ad7c842ae73ae2aa449d07" kindref="member">ssh_message</ref></type>
          <declname>msg</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/server.c" line="733" column="12" bodyfile="src/server.c" bodystart="733" bodyend="749"/>
        <references refid="proxy_8c_1a11614f44ef4d939bdd984953346a7572" compoundref="proxy_8c" startline="33">error</references>
        <references refid="structssh__message__struct_1a76853b41d044d79fac0269c051507995" compoundref="messages_8h" startline="91">ssh_message_struct::global_request</references>
        <references refid="structssh__session__struct_1af0aed60c1e529bbfdcb483fd80bf98a0" compoundref="session_8h" startline="140">ssh_session_struct::out_buffer</references>
        <references refid="structssh__message__struct_1aceb641c0b1e8eaaa91965f3bf5025ad3" compoundref="messages_8h" startline="85">ssh_message_struct::session</references>
        <references refid="ssh2_8h_1a2bcaf3f5c36b9f657520dca8376ca02b" compoundref="ssh2_8h" startline="44">SSH2_MSG_REQUEST_FAILURE</references>
        <references refid="buffer_8h_1a25dc9ca6178465fb850de52b30e2add6">ssh_buffer_add_u8</references>
        <references refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" compoundref="libssh_8h" startline="330">SSH_ERROR</references>
        <references refid="priv_8h_1aa21fd8a7a609329603b7b16da7939fca" compoundref="priv_8h" startline="240">SSH_LOG</references>
        <references refid="group__libssh__log_1ggadf764cbdea00d65edcd07bb9953ad2b7a926c933f61d1afa64003c1cc66f6a01c" compoundref="libssh_8h" startline="355">SSH_LOG_FUNCTIONS</references>
        <references refid="group__libssh__log_1ggadf764cbdea00d65edcd07bb9953ad2b7a6445dfe21592d69d9741d319538b6673" compoundref="libssh_8h" startline="352">SSH_LOG_PACKET</references>
        <references refid="libssh_8h_1ac1ee1d1e917456d4760a94a18015377d" compoundref="libssh_8h" startline="329">SSH_OK</references>
        <references refid="packet_8h_1a7e6c7ed74c23ace432476aa8a6841140" compoundref="packet_8c" startline="1761" endline="1843">ssh_packet_send</references>
        <references refid="structssh__global__request_1ac649e9fb0003f8161f6ea366c2b320a2" compoundref="messages_8h" startline="52">ssh_global_request::want_reply</references>
        <referencedby refid="group__libssh__server_1ga6e78c8f369333289d245931deed92573" compoundref="server_8c" startline="751" endline="775">ssh_message_reply_default</referencedby>
      </memberdef>
      <memberdef kind="function" id="group__libssh__server_1ga6e78c8f369333289d245931deed92573" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="libssh_8h_1a2ba7f29ac0f2b5ef7134243d24888ac5" kindref="member">LIBSSH_API</ref> int</type>
        <definition>int ssh_message_reply_default</definition>
        <argsstring>(ssh_message msg)</argsstring>
        <name>ssh_message_reply_default</name>
        <param>
          <type><ref refid="libssh_8h_1aee0e83a574ad7c842ae73ae2aa449d07" kindref="member">ssh_message</ref></type>
          <declname>msg</declname>
        </param>
        <briefdescription>
<para>Reply with a standard reject message. </para>
        </briefdescription>
        <detaileddescription>
<para>Use this function if you don&apos;t know what to respond or if you want to reject a request.</para>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername direction="in">msg</parametername>
</parameternamelist>
<parameterdescription>
<para>The message to use for the reply.</para>
</parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>0 on success, -1 on error.</para>
</simplesect>
<simplesect kind="see"><para><ref refid="group__libssh__messages_1ga8e536b6f1c824b7ca43d0e8f954b3bd4" kindref="member">ssh_message_get()</ref> </para>
</simplesect>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/server.c" line="751" column="5" bodyfile="src/server.c" bodystart="751" bodyend="775" declfile="include/libssh/server.h" declline="262" declcolumn="16"/>
        <references refid="structssh__message__struct_1aceb641c0b1e8eaaa91965f3bf5025ad3" compoundref="messages_8h" startline="85">ssh_message_struct::session</references>
        <references refid="group__libssh__server_1gaa8a38b0ea0e5ee2bce17eab77dfc850c" compoundref="server_8c" startline="570" endline="620">ssh_auth_reply_default</references>
        <references refid="priv_8h_1aa21fd8a7a609329603b7b16da7939fca" compoundref="priv_8h" startline="240">SSH_LOG</references>
        <references refid="group__libssh__log_1ggadf764cbdea00d65edcd07bb9953ad2b7a6445dfe21592d69d9741d319538b6673" compoundref="libssh_8h" startline="352">SSH_LOG_PACKET</references>
        <references refid="group__libssh__server_1gaf7984c469e61e9d5f05c80d967970a1c" compoundref="server_8c" startline="622" endline="641">ssh_message_channel_request_open_reply_default</references>
        <references refid="group__libssh__server_1ga79d82cfe686f9389bc74b95533f976d7" compoundref="server_8c" startline="643" endline="668">ssh_message_channel_request_reply_default</references>
        <references refid="group__libssh__server_1ga518a6b12d13cb2f4d74e261e43fc0129" compoundref="server_8c" startline="733" endline="749">ssh_message_global_request_reply_default</references>
        <references refid="group__libssh__server_1ga6e63796d916bcc9a259e9863b2424cce" compoundref="server_8c" startline="670" endline="673">ssh_message_service_request_reply_default</references>
        <references refid="libssh_8h_1a9484ca6b9fd0460e31a80fb8d0e81da6a1c090b9498aea8b24934ba291be6fa78" compoundref="libssh_8h" startline="181">SSH_REQUEST_AUTH</references>
        <references refid="libssh_8h_1a9484ca6b9fd0460e31a80fb8d0e81da6afe34a2aeab2f735c3590510fa9db0261" compoundref="libssh_8h" startline="183">SSH_REQUEST_CHANNEL</references>
        <references refid="libssh_8h_1a9484ca6b9fd0460e31a80fb8d0e81da6a55349816be9b38f7187447782dcd8d06" compoundref="libssh_8h" startline="182">SSH_REQUEST_CHANNEL_OPEN</references>
        <references refid="libssh_8h_1a9484ca6b9fd0460e31a80fb8d0e81da6a7f406af946bb752fc97dc7f801b0d085" compoundref="libssh_8h" startline="185">SSH_REQUEST_GLOBAL</references>
        <references refid="libssh_8h_1a9484ca6b9fd0460e31a80fb8d0e81da6a427a659a7cd20a5cd4a4edf103322fe3" compoundref="libssh_8h" startline="184">SSH_REQUEST_SERVICE</references>
        <references refid="structssh__message__struct_1a38c048b3819ac803f267ccdaa7b214f0" compoundref="messages_8h" startline="86">ssh_message_struct::type</references>
        <referencedby refid="samplesshd-kbdint_8c_1a14ddec7b35f889adcbfb0ab1f5976d38" compoundref="samplesshd-kbdint_8c" startline="218" endline="289">authenticate</referencedby>
        <referencedby refid="samplesshd-kbdint_8c_1a3c04138a5bfe5d72780bb7e82a18e627" compoundref="samplesshd-kbdint_8c" startline="291" endline="424">main</referencedby>
        <referencedby refid="group__libssh__server_1gac5c9893e27dad15af4bd2dd8abc4760c" compoundref="server_8c" startline="1143" endline="1171">ssh_execute_message_callbacks</referencedby>
      </memberdef>
      <memberdef kind="function" id="group__libssh__server_1ga9f9dedae252c1b786b1213c84ac90baa" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="libssh_8h_1a2ba7f29ac0f2b5ef7134243d24888ac5" kindref="member">LIBSSH_API</ref> const char *</type>
        <definition>const char * ssh_message_service_service</definition>
        <argsstring>(ssh_message msg)</argsstring>
        <name>ssh_message_service_service</name>
        <param>
          <type><ref refid="libssh_8h_1aee0e83a574ad7c842ae73ae2aa449d07" kindref="member">ssh_message</ref></type>
          <declname>msg</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/server.c" line="777" column="12" bodyfile="src/server.c" bodystart="777" bodyend="782" declfile="include/libssh/server.h" declline="317" declcolumn="23"/>
        <references refid="structssh__service__request_1a86553bc161bc0e98d52d51ad47ef36db" compoundref="messages_8h" startline="47">ssh_service_request::service</references>
        <references refid="structssh__message__struct_1ad604523f1d9456b8de05bdd34f2184d2" compoundref="messages_8h" startline="90">ssh_message_struct::service_request</references>
      </memberdef>
      <memberdef kind="function" id="group__libssh__server_1gad05353966b70d7f04a3b7aed07a817cc" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="libssh_8h_1a2ba7f29ac0f2b5ef7134243d24888ac5" kindref="member">LIBSSH_API</ref> const char *</type>
        <definition>const char * ssh_message_auth_user</definition>
        <argsstring>(ssh_message msg)</argsstring>
        <name>ssh_message_auth_user</name>
        <param>
          <type><ref refid="libssh_8h_1aee0e83a574ad7c842ae73ae2aa449d07" kindref="member">ssh_message</ref></type>
          <declname>msg</declname>
        </param>
        <briefdescription>
<para>Get the name of the authenticated user. </para>
        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername direction="in">msg</parametername>
</parameternamelist>
<parameterdescription>
<para>The message to get the username from.</para>
</parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>The username or NULL if an error occured.</para>
</simplesect>
<simplesect kind="see"><para><ref refid="group__libssh__messages_1ga8e536b6f1c824b7ca43d0e8f954b3bd4" kindref="member">ssh_message_get()</ref> </para>
</simplesect>
<simplesect kind="see"><para><ref refid="group__libssh__messages_1ga20fc6e536f170b98c7d62ce3675d8cdb" kindref="member">ssh_message_type()</ref> </para>
</simplesect>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/server.c" line="784" column="12" bodyfile="src/server.c" bodystart="784" bodyend="790" declfile="include/libssh/server.h" declline="274" declcolumn="23"/>
        <references refid="structssh__message__struct_1ada5e7918deb9baad950d3672960d46e2" compoundref="messages_8h" startline="87">ssh_message_struct::auth_request</references>
        <references refid="structssh__auth__request_1a88f26343b22a9fdb9e0d7a8313363ccf" compoundref="messages_8h" startline="27">ssh_auth_request::username</references>
        <referencedby refid="samplesshd-kbdint_8c_1a14ddec7b35f889adcbfb0ab1f5976d38" compoundref="samplesshd-kbdint_8c" startline="218" endline="289">authenticate</referencedby>
      </memberdef>
      <memberdef kind="function" id="group__libssh__server_1gab434b45d3f542ab24735bba6432de85d" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="libssh_8h_1a2ba7f29ac0f2b5ef7134243d24888ac5" kindref="member">LIBSSH_API</ref> const char *</type>
        <definition>const char * ssh_message_auth_password</definition>
        <argsstring>(ssh_message msg)</argsstring>
        <name>ssh_message_auth_password</name>
        <param>
          <type><ref refid="libssh_8h_1aee0e83a574ad7c842ae73ae2aa449d07" kindref="member">ssh_message</ref></type>
          <declname>msg</declname>
        </param>
        <briefdescription>
<para>Get the password of the authenticated user. </para>
        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername direction="in">msg</parametername>
</parameternamelist>
<parameterdescription>
<para>The message to get the password from.</para>
</parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>The username or NULL if an error occured.</para>
</simplesect>
<simplesect kind="see"><para><ref refid="group__libssh__messages_1ga8e536b6f1c824b7ca43d0e8f954b3bd4" kindref="member">ssh_message_get()</ref> </para>
</simplesect>
<simplesect kind="see"><para><ref refid="group__libssh__messages_1ga20fc6e536f170b98c7d62ce3675d8cdb" kindref="member">ssh_message_type()</ref> </para>
</simplesect>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/server.c" line="792" column="12" bodyfile="src/server.c" bodystart="792" bodyend="798" declfile="include/libssh/server.h" declline="286" declcolumn="23"/>
        <references refid="structssh__message__struct_1ada5e7918deb9baad950d3672960d46e2" compoundref="messages_8h" startline="87">ssh_message_struct::auth_request</references>
        <references refid="structssh__auth__request_1adadadbbbcb2a1d4788b197f57f76aab8" compoundref="messages_8h" startline="29">ssh_auth_request::password</references>
        <referencedby refid="samplesshd-kbdint_8c_1a14ddec7b35f889adcbfb0ab1f5976d38" compoundref="samplesshd-kbdint_8c" startline="218" endline="289">authenticate</referencedby>
      </memberdef>
      <memberdef kind="function" id="group__libssh__server_1ga97e909b1d89b4c4747eb5b80ac9fd215" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="libssh_8h_1a2ba7f29ac0f2b5ef7134243d24888ac5" kindref="member">LIBSSH_API</ref> <ref refid="libssh_8h_1a7e8a3aee44db4899c088577a8db5dcfa" kindref="member">ssh_key</ref></type>
        <definition>ssh_key ssh_message_auth_pubkey</definition>
        <argsstring>(ssh_message msg)</argsstring>
        <name>ssh_message_auth_pubkey</name>
        <param>
          <type><ref refid="libssh_8h_1aee0e83a574ad7c842ae73ae2aa449d07" kindref="member">ssh_message</ref></type>
          <declname>msg</declname>
        </param>
        <briefdescription>
<para>Get the publickey of the authenticated user. </para>
        </briefdescription>
        <detaileddescription>
<para>If you need the key for later user you should duplicate it.</para>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername direction="in">msg</parametername>
</parameternamelist>
<parameterdescription>
<para>The message to get the public key from.</para>
</parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>The public key or NULL.</para>
</simplesect>
<simplesect kind="see"><para><ref refid="group__libssh__pki_1gae0944d085d1a63c73b7eaf78924ddca8" kindref="member">ssh_key_dup()</ref> </para>
</simplesect>
<simplesect kind="see"><para><ref refid="group__libssh__pki_1ga4dc33945294c2bbd671365a9d3db8e2f" kindref="member">ssh_key_cmp()</ref> </para>
</simplesect>
<simplesect kind="see"><para><ref refid="group__libssh__messages_1ga8e536b6f1c824b7ca43d0e8f954b3bd4" kindref="member">ssh_message_get()</ref> </para>
</simplesect>
<simplesect kind="see"><para><ref refid="group__libssh__messages_1ga20fc6e536f170b98c7d62ce3675d8cdb" kindref="member">ssh_message_type()</ref> </para>
</simplesect>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/server.c" line="800" column="9" bodyfile="src/server.c" bodystart="800" bodyend="806" declfile="include/libssh/server.h" declline="302" declcolumn="20"/>
        <references refid="structssh__message__struct_1ada5e7918deb9baad950d3672960d46e2" compoundref="messages_8h" startline="87">ssh_message_struct::auth_request</references>
        <references refid="structssh__auth__request_1ad3aa33442fa6e79892921ac1aa95427b" compoundref="messages_8h" startline="30">ssh_auth_request::pubkey</references>
      </memberdef>
      <memberdef kind="function" id="group__libssh__server_1gaa5e80a5891527b2207dcb53efece1203" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="legacy_8h_1a5720dd2559600d96da21266e7fd09ab4" kindref="member">ssh_public_key</ref></type>
        <definition>ssh_public_key ssh_message_auth_publickey</definition>
        <argsstring>(ssh_message msg)</argsstring>
        <name>ssh_message_auth_publickey</name>
        <param>
          <type><ref refid="libssh_8h_1aee0e83a574ad7c842ae73ae2aa449d07" kindref="member">ssh_message</ref></type>
          <declname>msg</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/server.c" line="809" column="16" bodyfile="src/server.c" bodystart="809" bodyend="815"/>
        <references refid="structssh__message__struct_1ada5e7918deb9baad950d3672960d46e2" compoundref="messages_8h" startline="87">ssh_message_struct::auth_request</references>
        <references refid="structssh__auth__request_1ad3aa33442fa6e79892921ac1aa95427b" compoundref="messages_8h" startline="30">ssh_auth_request::pubkey</references>
        <references refid="group__libssh__pki_1ga2fb166991a033adb5540b66f407e2db4" compoundref="pki_8c" startline="1051" endline="1082">ssh_pki_convert_key_to_publickey</references>
      </memberdef>
      <memberdef kind="function" id="group__libssh__server_1gafcb928250ef8169f4823dadab217b4fe" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="libssh_8h_1a2ba7f29ac0f2b5ef7134243d24888ac5" kindref="member">LIBSSH_API</ref> enum <ref refid="libssh_8h_1a678ab8f3594510db5765fc626ed91e0e" kindref="member">ssh_publickey_state_e</ref></type>
        <definition>enum ssh_publickey_state_e ssh_message_auth_publickey_state</definition>
        <argsstring>(ssh_message msg)</argsstring>
        <name>ssh_message_auth_publickey_state</name>
        <param>
          <type><ref refid="libssh_8h_1aee0e83a574ad7c842ae73ae2aa449d07" kindref="member">ssh_message</ref></type>
          <declname>msg</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/server.c" line="809" column="16" bodyfile="src/server.c" bodystart="817" bodyend="822" declfile="include/libssh/server.h" declline="305" declcolumn="1"/>
      </memberdef>
      <memberdef kind="function" id="group__libssh__server_1ga5132c82c49de985e9e10f51f393e52a4" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="libssh_8h_1a2ba7f29ac0f2b5ef7134243d24888ac5" kindref="member">LIBSSH_API</ref> int</type>
        <definition>int ssh_message_auth_kbdint_is_response</definition>
        <argsstring>(ssh_message msg)</argsstring>
        <name>ssh_message_auth_kbdint_is_response</name>
        <param>
          <type><ref refid="libssh_8h_1aee0e83a574ad7c842ae73ae2aa449d07" kindref="member">ssh_message</ref></type>
          <declname>msg</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/server.c" line="824" column="5" bodyfile="src/server.c" bodystart="824" bodyend="830" declfile="include/libssh/server.h" declline="304" declcolumn="16"/>
        <references refid="structssh__message__struct_1ada5e7918deb9baad950d3672960d46e2" compoundref="messages_8h" startline="87">ssh_message_struct::auth_request</references>
        <references refid="structssh__auth__request_1a7924bd37da6fd9fbd0157eadc0203c5c" compoundref="messages_8h" startline="32">ssh_auth_request::kbdint_response</references>
        <referencedby refid="samplesshd-kbdint_8c_1a14ddec7b35f889adcbfb0ab1f5976d38" compoundref="samplesshd-kbdint_8c" startline="218" endline="289">authenticate</referencedby>
      </memberdef>
      <memberdef kind="function" id="group__libssh__server_1gab993157d98e5b4b3399d216c9243effc" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="libssh_8h_1a2ba7f29ac0f2b5ef7134243d24888ac5" kindref="member">LIBSSH_API</ref> int</type>
        <definition>int ssh_message_auth_set_methods</definition>
        <argsstring>(ssh_message msg, int methods)</argsstring>
        <name>ssh_message_auth_set_methods</name>
        <param>
          <type><ref refid="libssh_8h_1aee0e83a574ad7c842ae73ae2aa449d07" kindref="member">ssh_message</ref></type>
          <declname>msg</declname>
        </param>
        <param>
          <type>int</type>
          <declname>methods</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/server.c" line="833" column="5" bodyfile="src/server.c" bodystart="833" bodyend="845" declfile="include/libssh/server.h" declline="310" declcolumn="16"/>
        <references refid="structssh__session__struct_1a3d57e01582c0c9099f7f319513321fe8">ssh_session_struct::auth</references>
        <references refid="structssh__kex__struct_1a5a8b3f27866bcbfde98a9d66793ae389" compoundref="kex_8h" startline="31">ssh_kex_struct::methods</references>
        <references refid="structssh__message__struct_1aceb641c0b1e8eaaa91965f3bf5025ad3" compoundref="messages_8h" startline="85">ssh_message_struct::session</references>
        <references refid="structssh__session__struct_1a3e967ac3134cae87dae1f6a794424073" compoundref="session_8h" startline="157">ssh_session_struct::supported_methods</references>
        <referencedby refid="samplesshd-kbdint_8c_1a14ddec7b35f889adcbfb0ab1f5976d38" compoundref="samplesshd-kbdint_8c" startline="218" endline="289">authenticate</referencedby>
        <referencedby refid="torture__server__auth__kbdint_8c_1acd3ed9c9d7adfe289fe257456451ae97" compoundref="torture__server__auth__kbdint_8c" startline="273" endline="331">authenticate_callback</referencedby>
      </memberdef>
      <memberdef kind="function" id="group__libssh__server_1gaacbc31ce3b39ac93061164feec822c77" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="libssh_8h_1a2ba7f29ac0f2b5ef7134243d24888ac5" kindref="member">LIBSSH_API</ref> int</type>
        <definition>int ssh_message_auth_interactive_request</definition>
        <argsstring>(ssh_message msg, const char *name, const char *instruction, unsigned int num_prompts, const char **prompts, char *echo)</argsstring>
        <name>ssh_message_auth_interactive_request</name>
        <param>
          <type><ref refid="libssh_8h_1aee0e83a574ad7c842ae73ae2aa449d07" kindref="member">ssh_message</ref></type>
          <declname>msg</declname>
        </param>
        <param>
          <type>const char *</type>
          <declname>name</declname>
        </param>
        <param>
          <type>const char *</type>
          <declname>instruction</declname>
        </param>
        <param>
          <type>unsigned int</type>
          <declname>num_prompts</declname>
        </param>
        <param>
          <type>const char **</type>
          <declname>prompts</declname>
        </param>
        <param>
          <type>char *</type>
          <declname>echo</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/server.c" line="847" column="5" bodyfile="src/server.c" bodystart="847" bodyend="951" declfile="include/libssh/server.h" declline="312" declcolumn="16"/>
        <references refid="structssh__session__struct_1a3d57e01582c0c9099f7f319513321fe8">ssh_session_struct::auth</references>
        <references refid="samplesshd-kbdint_8c_1aed50069385b2de326e5bbed79b19affd" compoundref="samplesshd-kbdint_8c" startline="189">echo</references>
        <references refid="structssh__kbdint__struct_1a53c38b9a2468c1d79954408e9b7bc7aa" compoundref="auth_8h" startline="43">ssh_kbdint_struct::echo</references>
        <references refid="samplesshd-kbdint_8c_1a329f390332999ec7445d61fd6ac2679a" compoundref="samplesshd-kbdint_8c" startline="187">instruction</references>
        <references refid="structssh__kbdint__struct_1a22c149b9323116ac704fabc4c6a5caa6" compoundref="auth_8h" startline="41">ssh_kbdint_struct::instruction</references>
        <references refid="structssh__session__struct_1a9cba44c19f35693037bc9bb1e0651d17" compoundref="session_8h" startline="180">ssh_session_struct::kbdint</references>
        <references refid="samplesshd-kbdint_8c_1a8f8f80d37794cde9472343e4487ba3eb" compoundref="samplesshd-kbdint_8c" startline="186">name</references>
        <references refid="structssh__kbdint__struct_1a8c7f5532d4b52ab7f81bacdf8394c51c" compoundref="auth_8h" startline="40">ssh_kbdint_struct::name</references>
        <references refid="structssh__kbdint__struct_1a316bac1f096accc10024c7e787e0e3d6" compoundref="auth_8h" startline="38">ssh_kbdint_struct::nprompts</references>
        <references refid="structssh__session__struct_1af0aed60c1e529bbfdcb483fd80bf98a0" compoundref="session_8h" startline="140">ssh_session_struct::out_buffer</references>
        <references refid="samplesshd-kbdint_8c_1acb7181144078f54b11e41ee4a6f84390" compoundref="samplesshd-kbdint_8c" startline="188">prompts</references>
        <references refid="structssh__kbdint__struct_1a3b528280ac48b0713c1f963ee9f3574b" compoundref="auth_8h" startline="42">ssh_kbdint_struct::prompts</references>
        <references refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" compoundref="pkd__daemon_8c" startline="62">rc</references>
        <references refid="structssh__message__struct_1aceb641c0b1e8eaaa91965f3bf5025ad3" compoundref="messages_8h" startline="85">ssh_message_struct::session</references>
        <references refid="ssh2_8h_1a52cc2cc5ee818654cdc8b5e3bf2a54be" compoundref="ssh2_8h" startline="33">SSH2_MSG_USERAUTH_INFO_REQUEST</references>
        <references refid="auth_8h_1a0d3114986a741a14dc3ac03f7d8eafefa97ddb5eeec18ad7d054ec5795e6e16d6" compoundref="auth_8h" startline="68">SSH_AUTH_STATE_INFO</references>
        <references refid="buffer_8h_1ae17848a86043f0abfc60c1c4f6126ccd" compoundref="buffer_8h" startline="49">ssh_buffer_pack</references>
        <references refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" compoundref="libssh_8h" startline="330">SSH_ERROR</references>
        <references refid="group__libssh__auth_1gac042e71960b1aa80d8245125feeb249a" compoundref="auth_8c" startline="1387" endline="1419">ssh_kbdint_clean</references>
        <references refid="group__libssh__auth_1ga43266010b4cc11e277658c4c6c4a5500" compoundref="auth_8c" startline="1351" endline="1385">ssh_kbdint_free</references>
        <references refid="group__libssh__auth_1gac17384e2e1723b50cd041d775c0175a8" compoundref="auth_8c" startline="1339" endline="1348">ssh_kbdint_new</references>
        <references refid="priv_8h_1aa21fd8a7a609329603b7b16da7939fca" compoundref="priv_8h" startline="240">SSH_LOG</references>
        <references refid="group__libssh__log_1ggadf764cbdea00d65edcd07bb9953ad2b7a75fa79e63947b66462db977d9b5ae27c" compoundref="libssh_8h" startline="349">SSH_LOG_PROTOCOL</references>
        <references refid="libssh_8h_1ac1ee1d1e917456d4760a94a18015377d" compoundref="libssh_8h" startline="329">SSH_OK</references>
        <references refid="packet_8h_1a7e6c7ed74c23ace432476aa8a6841140" compoundref="packet_8c" startline="1761" endline="1843">ssh_packet_send</references>
        <references refid="group__libssh__callbacks_1gac29df803aa1295d6a498c1b081f3b494" compoundref="callbacks_8h" startline="517">SSH_PACKET_USED</references>
        <references refid="priv_8h_1ae280c413c792e04237f000841ac8ce44" compoundref="priv_8h" startline="265">ssh_set_error_oom</references>
        <references refid="structssh__session__struct_1af0805877d21d43e81423ead52345c64b" compoundref="session_8h" startline="156">ssh_session_struct::state</references>
        <referencedby refid="samplesshd-kbdint_8c_1a14ddec7b35f889adcbfb0ab1f5976d38" compoundref="samplesshd-kbdint_8c" startline="218" endline="289">authenticate</referencedby>
        <referencedby refid="torture__server__auth__kbdint_8c_1a2394b159eca756f868d4334fc65e3579" compoundref="torture__server__auth__kbdint_8c" startline="140" endline="271">authenticate_kbdint</referencedby>
      </memberdef>
      <memberdef kind="function" id="group__libssh__server_1gace0de62d8bdae327069fd81fdb1861d5" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>int ssh_auth_reply_success</definition>
        <argsstring>(ssh_session session, int partial)</argsstring>
        <name>ssh_auth_reply_success</name>
        <param>
          <type><ref refid="libssh_8h_1a02d3754de040612632cdd499c20f92f6" kindref="member">ssh_session</ref></type>
          <declname>session</declname>
        </param>
        <param>
          <type>int</type>
          <declname>partial</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/server.c" line="953" column="5" bodyfile="src/server.c" bodystart="953" bodyend="994"/>
        <references refid="structssh__crypto__struct_1a264a702f7930c64683183b9334fa19d0" compoundref="crypto_8h" startline="144">ssh_crypto_struct::delayed_compress_in</references>
        <references refid="structssh__crypto__struct_1a180198c8214743d490536a6855244355" compoundref="crypto_8h" startline="145">ssh_crypto_struct::delayed_compress_out</references>
        <references refid="structssh__crypto__struct_1a9322f181b21f808d19918940335ecf40" compoundref="crypto_8h" startline="143">ssh_crypto_struct::do_compress_in</references>
        <references refid="structssh__crypto__struct_1a2d1c6e8bd0458906a8dffa7ea982fa2d" compoundref="crypto_8h" startline="142">ssh_crypto_struct::do_compress_out</references>
        <references refid="structssh__session__struct_1a997060832a3419d8fe884d3da855ef4c" compoundref="session_8h" startline="129">ssh_session_struct::flags</references>
        <references refid="structssh__session__struct_1af0aed60c1e529bbfdcb483fd80bf98a0" compoundref="session_8h" startline="140">ssh_session_struct::out_buffer</references>
        <references refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" compoundref="torture__session__keys_8c" startline="61">session</references>
        <references refid="structssh__session__struct_1a6f74d1a1eb6ed715b1073b67caa18460" compoundref="session_8h" startline="147">ssh_session_struct::session_state</references>
        <references refid="ssh2_8h_1a8a775020d2d17f962efef15a4be9927d" compoundref="ssh2_8h" startline="29">SSH2_MSG_USERAUTH_SUCCESS</references>
        <references refid="group__libssh__server_1gaa8a38b0ea0e5ee2bce17eab77dfc850c" compoundref="server_8c" startline="570" endline="620">ssh_auth_reply_default</references>
        <references refid="buffer_8h_1a25dc9ca6178465fb850de52b30e2add6">ssh_buffer_add_u8</references>
        <references refid="wrapper_8h_1a9ebe789b5f29a369c7799ec6ce17f1a9a86b8de4a56d77c10ee93f4cb0ab82d71" compoundref="wrapper_8h" startline="60">SSH_DIRECTION_IN</references>
        <references refid="wrapper_8h_1a9ebe789b5f29a369c7799ec6ce17f1a9a4a51e00d57fa481f88149a9d7cd83c91" compoundref="wrapper_8h" startline="61">SSH_DIRECTION_OUT</references>
        <references refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" compoundref="libssh_8h" startline="330">SSH_ERROR</references>
        <references refid="priv_8h_1aa21fd8a7a609329603b7b16da7939fca" compoundref="priv_8h" startline="240">SSH_LOG</references>
        <references refid="group__libssh__log_1ggadf764cbdea00d65edcd07bb9953ad2b7a75fa79e63947b66462db977d9b5ae27c" compoundref="libssh_8h" startline="349">SSH_LOG_PROTOCOL</references>
        <references refid="packet_8h_1af36b281d11b6c0affbc0faaf1ec52fbe" compoundref="packet_8c" startline="939" endline="977">ssh_packet_get_current_crypto</references>
        <references refid="packet_8h_1a7e6c7ed74c23ace432476aa8a6841140" compoundref="packet_8c" startline="1761" endline="1843">ssh_packet_send</references>
        <references refid="session_8h_1ae54e87f0565e24b25aed1372b3493a2b" compoundref="session_8h" startline="76">SSH_SESSION_FLAG_AUTHENTICATED</references>
        <references refid="session_8h_1a9bbd1d5ae11485e27279be6ad461992caced7c62fd9f24fe8f6672d50b8219f60" compoundref="session_8h" startline="45">SSH_SESSION_STATE_AUTHENTICATED</references>
        <referencedby refid="group__libssh__server_1gac338ce3b49e097a6b9b75b92666cac96" compoundref="server_8c" startline="996" endline="1000">ssh_message_auth_reply_success</referencedby>
      </memberdef>
      <memberdef kind="function" id="group__libssh__server_1gac338ce3b49e097a6b9b75b92666cac96" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="libssh_8h_1a2ba7f29ac0f2b5ef7134243d24888ac5" kindref="member">LIBSSH_API</ref> int</type>
        <definition>int ssh_message_auth_reply_success</definition>
        <argsstring>(ssh_message msg, int partial)</argsstring>
        <name>ssh_message_auth_reply_success</name>
        <param>
          <type><ref refid="libssh_8h_1aee0e83a574ad7c842ae73ae2aa449d07" kindref="member">ssh_message</ref></type>
          <declname>msg</declname>
        </param>
        <param>
          <type>int</type>
          <declname>partial</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/server.c" line="996" column="5" bodyfile="src/server.c" bodystart="996" bodyend="1000" declfile="include/libssh/server.h" declline="306" declcolumn="16"/>
        <references refid="structssh__message__struct_1aceb641c0b1e8eaaa91965f3bf5025ad3" compoundref="messages_8h" startline="85">ssh_message_struct::session</references>
        <references refid="group__libssh__server_1gace0de62d8bdae327069fd81fdb1861d5" compoundref="server_8c" startline="953" endline="994">ssh_auth_reply_success</references>
        <references refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" compoundref="libssh_8h" startline="330">SSH_ERROR</references>
        <referencedby refid="samplesshd-kbdint_8c_1a14ddec7b35f889adcbfb0ab1f5976d38" compoundref="samplesshd-kbdint_8c" startline="218" endline="289">authenticate</referencedby>
        <referencedby refid="torture__server__auth__kbdint_8c_1acd3ed9c9d7adfe289fe257456451ae97" compoundref="torture__server__auth__kbdint_8c" startline="273" endline="331">authenticate_callback</referencedby>
      </memberdef>
      <memberdef kind="function" id="group__libssh__server_1ga2ce88786e073b36991fc96c8f6b58c09" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="libssh_8h_1a2ba7f29ac0f2b5ef7134243d24888ac5" kindref="member">LIBSSH_API</ref> int</type>
        <definition>int ssh_message_auth_reply_pk_ok</definition>
        <argsstring>(ssh_message msg, ssh_string algo, ssh_string pubkey)</argsstring>
        <name>ssh_message_auth_reply_pk_ok</name>
        <param>
          <type><ref refid="libssh_8h_1aee0e83a574ad7c842ae73ae2aa449d07" kindref="member">ssh_message</ref></type>
          <declname>msg</declname>
        </param>
        <param>
          <type><ref refid="libssh_8h_1a27e04455dbb0a80b6fed70b30772717b" kindref="member">ssh_string</ref></type>
          <declname>algo</declname>
        </param>
        <param>
          <type><ref refid="libssh_8h_1a27e04455dbb0a80b6fed70b30772717b" kindref="member">ssh_string</ref></type>
          <declname>pubkey</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/server.c" line="1003" column="5" bodyfile="src/server.c" bodystart="1003" bodyend="1021" declfile="include/libssh/server.h" declline="307" declcolumn="16"/>
        <references refid="structssh__session__struct_1af0aed60c1e529bbfdcb483fd80bf98a0" compoundref="session_8h" startline="140">ssh_session_struct::out_buffer</references>
        <references refid="curve25519-sha256_0dlibssh_8org_8txt_1a555595207a1407936ebb264ebdbf434c" compoundref="curve25519-sha256_0dlibssh_8org_8txt" startline="93">pubkey</references>
        <references refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" compoundref="pkd__daemon_8c" startline="62">rc</references>
        <references refid="structssh__message__struct_1aceb641c0b1e8eaaa91965f3bf5025ad3" compoundref="messages_8h" startline="85">ssh_message_struct::session</references>
        <references refid="ssh2_8h_1a82832514bac0e92e0619393cacd0e5a5" compoundref="ssh2_8h" startline="31">SSH2_MSG_USERAUTH_PK_OK</references>
        <references refid="buffer_8h_1ae17848a86043f0abfc60c1c4f6126ccd" compoundref="buffer_8h" startline="49">ssh_buffer_pack</references>
        <references refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" compoundref="libssh_8h" startline="330">SSH_ERROR</references>
        <references refid="libssh_8h_1ac1ee1d1e917456d4760a94a18015377d" compoundref="libssh_8h" startline="329">SSH_OK</references>
        <references refid="packet_8h_1a7e6c7ed74c23ace432476aa8a6841140" compoundref="packet_8c" startline="1761" endline="1843">ssh_packet_send</references>
        <references refid="priv_8h_1ae280c413c792e04237f000841ac8ce44" compoundref="priv_8h" startline="265">ssh_set_error_oom</references>
        <referencedby refid="group__libssh__server_1ga98321ead09cda145a08603d481a62a9e" compoundref="server_8c" startline="1023" endline="1045">ssh_message_auth_reply_pk_ok_simple</referencedby>
      </memberdef>
      <memberdef kind="function" id="group__libssh__server_1ga98321ead09cda145a08603d481a62a9e" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="libssh_8h_1a2ba7f29ac0f2b5ef7134243d24888ac5" kindref="member">LIBSSH_API</ref> int</type>
        <definition>int ssh_message_auth_reply_pk_ok_simple</definition>
        <argsstring>(ssh_message msg)</argsstring>
        <name>ssh_message_auth_reply_pk_ok_simple</name>
        <param>
          <type><ref refid="libssh_8h_1aee0e83a574ad7c842ae73ae2aa449d07" kindref="member">ssh_message</ref></type>
          <declname>msg</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/server.c" line="1023" column="5" bodyfile="src/server.c" bodystart="1023" bodyend="1045" declfile="include/libssh/server.h" declline="308" declcolumn="16"/>
        <references refid="structssh__message__struct_1ada5e7918deb9baad950d3672960d46e2" compoundref="messages_8h" startline="87">ssh_message_struct::auth_request</references>
        <references refid="structssh__auth__request_1ad3aa33442fa6e79892921ac1aa95427b" compoundref="messages_8h" startline="30">ssh_auth_request::pubkey</references>
        <references refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" compoundref="libssh_8h" startline="330">SSH_ERROR</references>
        <references refid="group__libssh__server_1ga2ce88786e073b36991fc96c8f6b58c09" compoundref="server_8c" startline="1003" endline="1021">ssh_message_auth_reply_pk_ok</references>
        <references refid="group__libssh__pki_1gaadeaf6dc35e99214de0af82c3c431649" compoundref="pki_8c" startline="2030" endline="2046">ssh_pki_export_pubkey_blob</references>
        <references refid="libssh_8h_1a5bc8710c8633117ff449d15489fca051" compoundref="libssh_8h" startline="790">SSH_STRING_FREE</references>
        <references refid="group__libssh__string_1ga4154ea16ba2dc5bd5dcb2579686aaac2" compoundref="string_8c" startline="108" endline="127">ssh_string_from_char</references>
        <references refid="structssh__key__struct_1af198ae6d0eee951e7d46b8dacbf3c412" compoundref="pki_8h" startline="57">ssh_key_struct::type_c</references>
      </memberdef>
      <memberdef kind="function" id="group__libssh__server_1ga0df64acc64787532205f6e85e5fbc4fe" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="libssh_8h_1a2ba7f29ac0f2b5ef7134243d24888ac5" kindref="member">LIBSSH_API</ref> const char *</type>
        <definition>const char * ssh_message_channel_request_open_originator</definition>
        <argsstring>(ssh_message msg)</argsstring>
        <name>ssh_message_channel_request_open_originator</name>
        <param>
          <type><ref refid="libssh_8h_1aee0e83a574ad7c842ae73ae2aa449d07" kindref="member">ssh_message</ref></type>
          <declname>msg</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/server.c" line="1048" column="12" bodyfile="src/server.c" bodystart="1048" bodyend="1050" declfile="include/libssh/server.h" declline="327" declcolumn="23"/>
        <references refid="structssh__message__struct_1a7579d1e2cd4136f2e152985d0018777f" compoundref="messages_8h" startline="88">ssh_message_struct::channel_request_open</references>
        <references refid="structssh__channel__request__open_1af98380c43eb905a05c172510a3f26c72" compoundref="messages_8h" startline="40">ssh_channel_request_open::originator</references>
      </memberdef>
      <memberdef kind="function" id="group__libssh__server_1gaf24d0f28aca42d1b26e5a08fe4abc9fd" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="libssh_8h_1a2ba7f29ac0f2b5ef7134243d24888ac5" kindref="member">LIBSSH_API</ref> int</type>
        <definition>int ssh_message_channel_request_open_originator_port</definition>
        <argsstring>(ssh_message msg)</argsstring>
        <name>ssh_message_channel_request_open_originator_port</name>
        <param>
          <type><ref refid="libssh_8h_1aee0e83a574ad7c842ae73ae2aa449d07" kindref="member">ssh_message</ref></type>
          <declname>msg</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/server.c" line="1052" column="5" bodyfile="src/server.c" bodystart="1052" bodyend="1054" declfile="include/libssh/server.h" declline="328" declcolumn="16"/>
        <references refid="structssh__message__struct_1a7579d1e2cd4136f2e152985d0018777f" compoundref="messages_8h" startline="88">ssh_message_struct::channel_request_open</references>
        <references refid="structssh__channel__request__open_1ad5e4f2672dcdf76b544d7a414af57a73" compoundref="messages_8h" startline="41">ssh_channel_request_open::originator_port</references>
      </memberdef>
      <memberdef kind="function" id="group__libssh__server_1ga42f8b0980f73c9af36a0b5e4e3ba7a04" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="libssh_8h_1a2ba7f29ac0f2b5ef7134243d24888ac5" kindref="member">LIBSSH_API</ref> const char *</type>
        <definition>const char * ssh_message_channel_request_open_destination</definition>
        <argsstring>(ssh_message msg)</argsstring>
        <name>ssh_message_channel_request_open_destination</name>
        <param>
          <type><ref refid="libssh_8h_1aee0e83a574ad7c842ae73ae2aa449d07" kindref="member">ssh_message</ref></type>
          <declname>msg</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/server.c" line="1056" column="12" bodyfile="src/server.c" bodystart="1056" bodyend="1058" declfile="include/libssh/server.h" declline="329" declcolumn="23"/>
        <references refid="structssh__message__struct_1a7579d1e2cd4136f2e152985d0018777f" compoundref="messages_8h" startline="88">ssh_message_struct::channel_request_open</references>
        <references refid="structssh__channel__request__open_1a5d418a8cb36e803cb46ecf44d29a85a3" compoundref="messages_8h" startline="42">ssh_channel_request_open::destination</references>
        <referencedby refid="sshd__direct-tcpip_8c_1af849eda558f35e50c507ec3f2a08cb6f" compoundref="sshd__direct-tcpip_8c" startline="390" endline="429">open_tcp_socket</referencedby>
      </memberdef>
      <memberdef kind="function" id="group__libssh__server_1gaf8b7350f50918f37f331efe2099ffa8b" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="libssh_8h_1a2ba7f29ac0f2b5ef7134243d24888ac5" kindref="member">LIBSSH_API</ref> int</type>
        <definition>int ssh_message_channel_request_open_destination_port</definition>
        <argsstring>(ssh_message msg)</argsstring>
        <name>ssh_message_channel_request_open_destination_port</name>
        <param>
          <type><ref refid="libssh_8h_1aee0e83a574ad7c842ae73ae2aa449d07" kindref="member">ssh_message</ref></type>
          <declname>msg</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/server.c" line="1060" column="5" bodyfile="src/server.c" bodystart="1060" bodyend="1062" declfile="include/libssh/server.h" declline="330" declcolumn="16"/>
        <references refid="structssh__message__struct_1a7579d1e2cd4136f2e152985d0018777f" compoundref="messages_8h" startline="88">ssh_message_struct::channel_request_open</references>
        <references refid="structssh__channel__request__open_1a855a0ab9192961301638a007eed1a2ba" compoundref="messages_8h" startline="43">ssh_channel_request_open::destination_port</references>
        <referencedby refid="sshd__direct-tcpip_8c_1af849eda558f35e50c507ec3f2a08cb6f" compoundref="sshd__direct-tcpip_8c" startline="390" endline="429">open_tcp_socket</referencedby>
      </memberdef>
      <memberdef kind="function" id="group__libssh__server_1ga813cf45163230416cd179cd1dadc4118" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="libssh_8h_1a2ba7f29ac0f2b5ef7134243d24888ac5" kindref="member">LIBSSH_API</ref> <ref refid="libssh_8h_1aca32be8db7c865697a3de381dc7e9fc3" kindref="member">ssh_channel</ref></type>
        <definition>ssh_channel ssh_message_channel_request_channel</definition>
        <argsstring>(ssh_message msg)</argsstring>
        <name>ssh_message_channel_request_channel</name>
        <param>
          <type><ref refid="libssh_8h_1aee0e83a574ad7c842ae73ae2aa449d07" kindref="member">ssh_message</ref></type>
          <declname>msg</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/server.c" line="1064" column="13" bodyfile="src/server.c" bodystart="1064" bodyend="1066" declfile="include/libssh/server.h" declline="332" declcolumn="24"/>
        <references refid="structssh__channel__request_1a916ad8e5354e27dbeebdd53303afac4b" compoundref="messages_8h" startline="59">ssh_channel_request::channel</references>
        <references refid="structssh__message__struct_1a988570288e6e64eca3bbb18c1733dd75" compoundref="messages_8h" startline="89">ssh_message_struct::channel_request</references>
      </memberdef>
      <memberdef kind="function" id="group__libssh__server_1ga06f1578033ad6f3741f1c3b8e2322d2d" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="libssh_8h_1a2ba7f29ac0f2b5ef7134243d24888ac5" kindref="member">LIBSSH_API</ref> const char *</type>
        <definition>const char * ssh_message_channel_request_pty_term</definition>
        <argsstring>(ssh_message msg)</argsstring>
        <name>ssh_message_channel_request_pty_term</name>
        <param>
          <type><ref refid="libssh_8h_1aee0e83a574ad7c842ae73ae2aa449d07" kindref="member">ssh_message</ref></type>
          <declname>msg</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/server.c" line="1068" column="12" bodyfile="src/server.c" bodystart="1068" bodyend="1070" declfile="include/libssh/server.h" declline="334" declcolumn="23"/>
        <references refid="structssh__message__struct_1a988570288e6e64eca3bbb18c1733dd75" compoundref="messages_8h" startline="89">ssh_message_struct::channel_request</references>
        <references refid="structssh__channel__request_1a8c3589f8ccc416fb333a7055caccac60" compoundref="messages_8h" startline="62">ssh_channel_request::TERM</references>
      </memberdef>
      <memberdef kind="function" id="group__libssh__server_1ga6f96b1cee5ae05dabea404c5d40b50e7" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="libssh_8h_1a2ba7f29ac0f2b5ef7134243d24888ac5" kindref="member">LIBSSH_API</ref> int</type>
        <definition>int ssh_message_channel_request_pty_width</definition>
        <argsstring>(ssh_message msg)</argsstring>
        <name>ssh_message_channel_request_pty_width</name>
        <param>
          <type><ref refid="libssh_8h_1aee0e83a574ad7c842ae73ae2aa449d07" kindref="member">ssh_message</ref></type>
          <declname>msg</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/server.c" line="1072" column="5" bodyfile="src/server.c" bodystart="1072" bodyend="1074" declfile="include/libssh/server.h" declline="335" declcolumn="16"/>
        <references refid="structssh__message__struct_1a988570288e6e64eca3bbb18c1733dd75" compoundref="messages_8h" startline="89">ssh_message_struct::channel_request</references>
        <references refid="structssh__channel__request_1a8c8268c77b186cf54edd8629c517a97f" compoundref="messages_8h" startline="63">ssh_channel_request::width</references>
      </memberdef>
      <memberdef kind="function" id="group__libssh__server_1gac793c0d76e4b5856f15ad0ed0afaa1d5" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="libssh_8h_1a2ba7f29ac0f2b5ef7134243d24888ac5" kindref="member">LIBSSH_API</ref> int</type>
        <definition>int ssh_message_channel_request_pty_height</definition>
        <argsstring>(ssh_message msg)</argsstring>
        <name>ssh_message_channel_request_pty_height</name>
        <param>
          <type><ref refid="libssh_8h_1aee0e83a574ad7c842ae73ae2aa449d07" kindref="member">ssh_message</ref></type>
          <declname>msg</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/server.c" line="1076" column="5" bodyfile="src/server.c" bodystart="1076" bodyend="1078" declfile="include/libssh/server.h" declline="336" declcolumn="16"/>
        <references refid="structssh__message__struct_1a988570288e6e64eca3bbb18c1733dd75" compoundref="messages_8h" startline="89">ssh_message_struct::channel_request</references>
        <references refid="structssh__channel__request_1a6a7b89f676a893a3e6e8707900d5cb25" compoundref="messages_8h" startline="64">ssh_channel_request::height</references>
      </memberdef>
      <memberdef kind="function" id="group__libssh__server_1ga9fe9493be6347da72ec3d55d6d58b9c6" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="libssh_8h_1a2ba7f29ac0f2b5ef7134243d24888ac5" kindref="member">LIBSSH_API</ref> int</type>
        <definition>int ssh_message_channel_request_pty_pxwidth</definition>
        <argsstring>(ssh_message msg)</argsstring>
        <name>ssh_message_channel_request_pty_pxwidth</name>
        <param>
          <type><ref refid="libssh_8h_1aee0e83a574ad7c842ae73ae2aa449d07" kindref="member">ssh_message</ref></type>
          <declname>msg</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/server.c" line="1080" column="5" bodyfile="src/server.c" bodystart="1080" bodyend="1082" declfile="include/libssh/server.h" declline="337" declcolumn="16"/>
        <references refid="structssh__message__struct_1a988570288e6e64eca3bbb18c1733dd75" compoundref="messages_8h" startline="89">ssh_message_struct::channel_request</references>
        <references refid="structssh__channel__request_1ad9f4a5954a143d468e8df13dddb10bf2" compoundref="messages_8h" startline="65">ssh_channel_request::pxwidth</references>
      </memberdef>
      <memberdef kind="function" id="group__libssh__server_1gacc10bc19a556898628ca239fb013d3b2" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="libssh_8h_1a2ba7f29ac0f2b5ef7134243d24888ac5" kindref="member">LIBSSH_API</ref> int</type>
        <definition>int ssh_message_channel_request_pty_pxheight</definition>
        <argsstring>(ssh_message msg)</argsstring>
        <name>ssh_message_channel_request_pty_pxheight</name>
        <param>
          <type><ref refid="libssh_8h_1aee0e83a574ad7c842ae73ae2aa449d07" kindref="member">ssh_message</ref></type>
          <declname>msg</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/server.c" line="1084" column="5" bodyfile="src/server.c" bodystart="1084" bodyend="1086" declfile="include/libssh/server.h" declline="338" declcolumn="16"/>
        <references refid="structssh__message__struct_1a988570288e6e64eca3bbb18c1733dd75" compoundref="messages_8h" startline="89">ssh_message_struct::channel_request</references>
        <references refid="structssh__channel__request_1a6835a75f16b64ff896311cd5a4b74b2e" compoundref="messages_8h" startline="66">ssh_channel_request::pxheight</references>
      </memberdef>
      <memberdef kind="function" id="group__libssh__server_1gaa42c1e6e4224ca04ee34d9be1296ff44" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="libssh_8h_1a2ba7f29ac0f2b5ef7134243d24888ac5" kindref="member">LIBSSH_API</ref> const char *</type>
        <definition>const char * ssh_message_channel_request_env_name</definition>
        <argsstring>(ssh_message msg)</argsstring>
        <name>ssh_message_channel_request_env_name</name>
        <param>
          <type><ref refid="libssh_8h_1aee0e83a574ad7c842ae73ae2aa449d07" kindref="member">ssh_message</ref></type>
          <declname>msg</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/server.c" line="1088" column="12" bodyfile="src/server.c" bodystart="1088" bodyend="1090" declfile="include/libssh/server.h" declline="340" declcolumn="23"/>
        <references refid="structssh__message__struct_1a988570288e6e64eca3bbb18c1733dd75" compoundref="messages_8h" startline="89">ssh_message_struct::channel_request</references>
        <references refid="structssh__channel__request_1a7cd92e2217ef3afccc362193cd282c8c" compoundref="messages_8h" startline="70">ssh_channel_request::var_name</references>
      </memberdef>
      <memberdef kind="function" id="group__libssh__server_1ga88cd6877143ea23c371b19eed3b94474" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="libssh_8h_1a2ba7f29ac0f2b5ef7134243d24888ac5" kindref="member">LIBSSH_API</ref> const char *</type>
        <definition>const char * ssh_message_channel_request_env_value</definition>
        <argsstring>(ssh_message msg)</argsstring>
        <name>ssh_message_channel_request_env_value</name>
        <param>
          <type><ref refid="libssh_8h_1aee0e83a574ad7c842ae73ae2aa449d07" kindref="member">ssh_message</ref></type>
          <declname>msg</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/server.c" line="1092" column="12" bodyfile="src/server.c" bodystart="1092" bodyend="1094" declfile="include/libssh/server.h" declline="341" declcolumn="23"/>
        <references refid="structssh__message__struct_1a988570288e6e64eca3bbb18c1733dd75" compoundref="messages_8h" startline="89">ssh_message_struct::channel_request</references>
        <references refid="structssh__channel__request_1a50f314a0f5f15250ca5e891a5fe3e2be" compoundref="messages_8h" startline="71">ssh_channel_request::var_value</references>
      </memberdef>
      <memberdef kind="function" id="group__libssh__server_1ga9042b6943d0b34efb8a7deb82a275c55" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="libssh_8h_1a2ba7f29ac0f2b5ef7134243d24888ac5" kindref="member">LIBSSH_API</ref> const char *</type>
        <definition>const char * ssh_message_channel_request_command</definition>
        <argsstring>(ssh_message msg)</argsstring>
        <name>ssh_message_channel_request_command</name>
        <param>
          <type><ref refid="libssh_8h_1aee0e83a574ad7c842ae73ae2aa449d07" kindref="member">ssh_message</ref></type>
          <declname>msg</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/server.c" line="1096" column="12" bodyfile="src/server.c" bodystart="1096" bodyend="1098" declfile="include/libssh/server.h" declline="343" declcolumn="23"/>
        <references refid="structssh__message__struct_1a988570288e6e64eca3bbb18c1733dd75" compoundref="messages_8h" startline="89">ssh_message_struct::channel_request</references>
        <references refid="structssh__channel__request_1adce75fd369c57fcef7e17f472d4fe92f" compoundref="messages_8h" startline="73">ssh_channel_request::command</references>
      </memberdef>
      <memberdef kind="function" id="group__libssh__server_1gaf0f6570120b742f303b974f4fca3288a" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="libssh_8h_1a2ba7f29ac0f2b5ef7134243d24888ac5" kindref="member">LIBSSH_API</ref> const char *</type>
        <definition>const char * ssh_message_channel_request_subsystem</definition>
        <argsstring>(ssh_message msg)</argsstring>
        <name>ssh_message_channel_request_subsystem</name>
        <param>
          <type><ref refid="libssh_8h_1aee0e83a574ad7c842ae73ae2aa449d07" kindref="member">ssh_message</ref></type>
          <declname>msg</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/server.c" line="1100" column="12" bodyfile="src/server.c" bodystart="1100" bodyend="1102" declfile="include/libssh/server.h" declline="345" declcolumn="23"/>
        <references refid="structssh__message__struct_1a988570288e6e64eca3bbb18c1733dd75" compoundref="messages_8h" startline="89">ssh_message_struct::channel_request</references>
        <references refid="structssh__channel__request_1a50c3f962b3e9e293052df5f0be4e7725" compoundref="messages_8h" startline="75">ssh_channel_request::subsystem</references>
      </memberdef>
      <memberdef kind="function" id="group__libssh__server_1gaa0e03d4be51727ff7341efb48d0e3f98" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="libssh_8h_1a2ba7f29ac0f2b5ef7134243d24888ac5" kindref="member">LIBSSH_API</ref> int</type>
        <definition>int ssh_message_channel_request_x11_single_connection</definition>
        <argsstring>(ssh_message msg)</argsstring>
        <name>ssh_message_channel_request_x11_single_connection</name>
        <param>
          <type><ref refid="libssh_8h_1aee0e83a574ad7c842ae73ae2aa449d07" kindref="member">ssh_message</ref></type>
          <declname>msg</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/server.c" line="1104" column="5" bodyfile="src/server.c" bodystart="1104" bodyend="1106" declfile="include/libssh/server.h" declline="347" declcolumn="16"/>
        <references refid="structssh__message__struct_1a988570288e6e64eca3bbb18c1733dd75" compoundref="messages_8h" startline="89">ssh_message_struct::channel_request</references>
        <references refid="structssh__channel__request_1a3a5549df387696690a4abca7161cb424" compoundref="messages_8h" startline="78">ssh_channel_request::x11_single_connection</references>
      </memberdef>
      <memberdef kind="function" id="group__libssh__server_1gaca48ee1e17dea412e136659f82051ef0" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="libssh_8h_1a2ba7f29ac0f2b5ef7134243d24888ac5" kindref="member">LIBSSH_API</ref> const char *</type>
        <definition>const char * ssh_message_channel_request_x11_auth_protocol</definition>
        <argsstring>(ssh_message msg)</argsstring>
        <name>ssh_message_channel_request_x11_auth_protocol</name>
        <param>
          <type><ref refid="libssh_8h_1aee0e83a574ad7c842ae73ae2aa449d07" kindref="member">ssh_message</ref></type>
          <declname>msg</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/server.c" line="1108" column="12" bodyfile="src/server.c" bodystart="1108" bodyend="1110" declfile="include/libssh/server.h" declline="348" declcolumn="23"/>
        <references refid="structssh__message__struct_1a988570288e6e64eca3bbb18c1733dd75" compoundref="messages_8h" startline="89">ssh_message_struct::channel_request</references>
        <references refid="structssh__channel__request_1a05e399bf4429fbf7310f74167f66ff95" compoundref="messages_8h" startline="79">ssh_channel_request::x11_auth_protocol</references>
      </memberdef>
      <memberdef kind="function" id="group__libssh__server_1ga2b0f472aaa4ac8ed8562c167505e2534" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="libssh_8h_1a2ba7f29ac0f2b5ef7134243d24888ac5" kindref="member">LIBSSH_API</ref> const char *</type>
        <definition>const char * ssh_message_channel_request_x11_auth_cookie</definition>
        <argsstring>(ssh_message msg)</argsstring>
        <name>ssh_message_channel_request_x11_auth_cookie</name>
        <param>
          <type><ref refid="libssh_8h_1aee0e83a574ad7c842ae73ae2aa449d07" kindref="member">ssh_message</ref></type>
          <declname>msg</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/server.c" line="1112" column="12" bodyfile="src/server.c" bodystart="1112" bodyend="1114" declfile="include/libssh/server.h" declline="349" declcolumn="23"/>
        <references refid="structssh__message__struct_1a988570288e6e64eca3bbb18c1733dd75" compoundref="messages_8h" startline="89">ssh_message_struct::channel_request</references>
        <references refid="structssh__channel__request_1abb1371e97a8c2f8748fe8d054ca5676b" compoundref="messages_8h" startline="80">ssh_channel_request::x11_auth_cookie</references>
      </memberdef>
      <memberdef kind="function" id="group__libssh__server_1gaf802b2a7e21e1026cc50c13133a33344" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="libssh_8h_1a2ba7f29ac0f2b5ef7134243d24888ac5" kindref="member">LIBSSH_API</ref> int</type>
        <definition>int ssh_message_channel_request_x11_screen_number</definition>
        <argsstring>(ssh_message msg)</argsstring>
        <name>ssh_message_channel_request_x11_screen_number</name>
        <param>
          <type><ref refid="libssh_8h_1aee0e83a574ad7c842ae73ae2aa449d07" kindref="member">ssh_message</ref></type>
          <declname>msg</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/server.c" line="1116" column="5" bodyfile="src/server.c" bodystart="1116" bodyend="1118" declfile="include/libssh/server.h" declline="350" declcolumn="16"/>
        <references refid="structssh__message__struct_1a988570288e6e64eca3bbb18c1733dd75" compoundref="messages_8h" startline="89">ssh_message_struct::channel_request</references>
        <references refid="structssh__channel__request_1ae4a291eda389653de928f184ac281e71" compoundref="messages_8h" startline="81">ssh_channel_request::x11_screen_number</references>
      </memberdef>
      <memberdef kind="function" id="group__libssh__server_1ga4b06e2be400a34f8b99e913fffc6b994" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="libssh_8h_1a2ba7f29ac0f2b5ef7134243d24888ac5" kindref="member">LIBSSH_API</ref> const char *</type>
        <definition>const char * ssh_message_global_request_address</definition>
        <argsstring>(ssh_message msg)</argsstring>
        <name>ssh_message_global_request_address</name>
        <param>
          <type><ref refid="libssh_8h_1aee0e83a574ad7c842ae73ae2aa449d07" kindref="member">ssh_message</ref></type>
          <declname>msg</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/server.c" line="1120" column="12" bodyfile="src/server.c" bodystart="1120" bodyend="1122" declfile="include/libssh/server.h" declline="352" declcolumn="23"/>
        <references refid="structssh__global__request_1a668bc0814fc7a3035172a4ce3b36c769" compoundref="messages_8h" startline="53">ssh_global_request::bind_address</references>
        <references refid="structssh__message__struct_1a76853b41d044d79fac0269c051507995" compoundref="messages_8h" startline="91">ssh_message_struct::global_request</references>
      </memberdef>
      <memberdef kind="function" id="group__libssh__server_1ga2df15146bcf25bbf9e97bdd4b1728e40" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="libssh_8h_1a2ba7f29ac0f2b5ef7134243d24888ac5" kindref="member">LIBSSH_API</ref> int</type>
        <definition>int ssh_message_global_request_port</definition>
        <argsstring>(ssh_message msg)</argsstring>
        <name>ssh_message_global_request_port</name>
        <param>
          <type><ref refid="libssh_8h_1aee0e83a574ad7c842ae73ae2aa449d07" kindref="member">ssh_message</ref></type>
          <declname>msg</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/server.c" line="1124" column="5" bodyfile="src/server.c" bodystart="1124" bodyend="1126" declfile="include/libssh/server.h" declline="353" declcolumn="16"/>
        <references refid="structssh__global__request_1a599709a2aca163c961c8d224292a13b5" compoundref="messages_8h" startline="54">ssh_global_request::bind_port</references>
        <references refid="structssh__message__struct_1a76853b41d044d79fac0269c051507995" compoundref="messages_8h" startline="91">ssh_message_struct::global_request</references>
      </memberdef>
      <memberdef kind="function" id="group__libssh__server_1gaccad877b20fca2d4a7eda5bebc1f5af1" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="libssh_8h_1a2ba7f29ac0f2b5ef7134243d24888ac5" kindref="member">LIBSSH_API</ref> void</type>
        <definition>void ssh_set_message_callback</definition>
        <argsstring>(ssh_session session, int(*ssh_bind_message_callback)(ssh_session session, ssh_message msg, void *data), void *data)</argsstring>
        <name>ssh_set_message_callback</name>
        <param>
          <type><ref refid="libssh_8h_1a02d3754de040612632cdd499c20f92f6" kindref="member">ssh_session</ref></type>
          <declname>session</declname>
        </param>
        <param>
          <type>int(*)(<ref refid="libssh_8h_1a02d3754de040612632cdd499c20f92f6" kindref="member">ssh_session</ref> <ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>, <ref refid="libssh_8h_1aee0e83a574ad7c842ae73ae2aa449d07" kindref="member">ssh_message</ref> msg, void *data)</type>
          <declname>ssh_bind_message_callback</declname>
        </param>
        <param>
          <type>void *</type>
          <declname>data</declname>
        </param>
        <briefdescription>
<para>defines the ssh_message callback </para>
        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>session</parametername>
</parameternamelist>
<parameterdescription>
<para>the current ssh session </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">ssh_bind_message_callback</parametername>
</parameternamelist>
<parameterdescription>
<para>a function pointer to a callback taking the current ssh session and received message as parameters. the function returns 0 if the message has been parsed and treated successfully, 1 otherwise (libssh must take care of the response). </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">data</parametername>
</parameternamelist>
<parameterdescription>
<para>void pointer to be passed to callback functions </para>
</parameterdescription>
</parameteritem>
</parameterlist>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/server.c" line="1136" column="6" bodyfile="src/server.c" bodystart="1136" bodyend="1141" declfile="include/libssh/server.h" declline="322" declcolumn="17"/>
        <references refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" compoundref="torture__session__keys_8c" startline="61">session</references>
        <references refid="structssh__session__struct_1af8adf747eee07c696dc877ad13f14c42" compoundref="session_8h" startline="196">ssh_session_struct::ssh_message_callback</references>
        <references refid="structssh__session__struct_1a4bf74fdc5b687ca9e51cd71462c30c44" compoundref="session_8h" startline="197">ssh_session_struct::ssh_message_callback_data</references>
        <referencedby refid="torture__server__auth__kbdint_8c_1a845bb2d262ac6cb3c7acfaeb394641ee" compoundref="torture__server__auth__kbdint_8c" startline="333" endline="515">handle_kbdint_session_cb</referencedby>
        <referencedby refid="sshd__direct-tcpip_8c_1a3c04138a5bfe5d72780bb7e82a18e627" compoundref="sshd__direct-tcpip_8c" startline="591" endline="681">main</referencedby>
      </memberdef>
      <memberdef kind="function" id="group__libssh__server_1gac5c9893e27dad15af4bd2dd8abc4760c" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="libssh_8h_1a2ba7f29ac0f2b5ef7134243d24888ac5" kindref="member">LIBSSH_API</ref> int</type>
        <definition>int ssh_execute_message_callbacks</definition>
        <argsstring>(ssh_session session)</argsstring>
        <name>ssh_execute_message_callbacks</name>
        <param>
          <type><ref refid="libssh_8h_1a02d3754de040612632cdd499c20f92f6" kindref="member">ssh_session</ref></type>
          <declname>session</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/server.c" line="1143" column="5" bodyfile="src/server.c" bodystart="1143" bodyend="1171" declfile="include/libssh/server.h" declline="325" declcolumn="16"/>
        <references refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" compoundref="torture__session__keys_8c" startline="61">session</references>
        <references refid="group__libssh__session_1gaa0e04dc9e24d5112a5ca2b7bd68031d0" compoundref="session_8c" startline="633" endline="665">ssh_handle_packets</references>
        <references refid="structssh__session__struct_1af8adf747eee07c696dc877ad13f14c42" compoundref="session_8h" startline="196">ssh_session_struct::ssh_message_callback</references>
        <references refid="structssh__session__struct_1a4bf74fdc5b687ca9e51cd71462c30c44" compoundref="session_8h" startline="197">ssh_session_struct::ssh_message_callback_data</references>
        <references refid="group__libssh__messages_1ga9d1b1d2279c6be3539f2b630960759c3" compoundref="messages_8c" startline="582" endline="637">ssh_message_free</references>
        <references refid="structssh__session__struct_1ac18fe9d39a3b73274e03ca0e2ae55db2" compoundref="session_8h" startline="195">ssh_session_struct::ssh_message_list</references>
        <references refid="group__libssh__messages_1gad2854ea69cec390707b167fa66864152" compoundref="messages_8c" startline="480" endline="491">ssh_message_pop_head</references>
        <references refid="group__libssh__server_1ga6e78c8f369333289d245931deed92573" compoundref="server_8c" startline="751" endline="775">ssh_message_reply_default</references>
        <references refid="libssh_8h_1ac1ee1d1e917456d4760a94a18015377d" compoundref="libssh_8h" startline="329">SSH_OK</references>
        <references refid="session_8h_1a5dc7677b987888e7db552768afc9d9c6" compoundref="session_8h" startline="86">SSH_TIMEOUT_NONBLOCKING</references>
      </memberdef>
      <memberdef kind="function" id="group__libssh__server_1gaa1ac2e1b7fdc23fd7e253aa9f0a47e7a" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="libssh_8h_1a2ba7f29ac0f2b5ef7134243d24888ac5" kindref="member">LIBSSH_API</ref> int</type>
        <definition>int ssh_send_keepalive</definition>
        <argsstring>(ssh_session session)</argsstring>
        <name>ssh_send_keepalive</name>
        <param>
          <type><ref refid="libssh_8h_1a02d3754de040612632cdd499c20f92f6" kindref="member">ssh_session</ref></type>
          <declname>session</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/server.c" line="1173" column="5" bodyfile="src/server.c" bodystart="1173" bodyend="1179" declfile="include/libssh/server.h" declline="368" declcolumn="16"/>
        <references refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" compoundref="torture__session__keys_8c" startline="61">session</references>
        <references refid="group__libssh__channel_1ga814cf8a82b4098b8994f9029fed572c0" compoundref="channels_8c" startline="2256" endline="2341">ssh_global_request</references>
        <references refid="libssh_8h_1ac1ee1d1e917456d4760a94a18015377d" compoundref="libssh_8h" startline="329">SSH_OK</references>
      </memberdef>
      </sectiondef>
    <briefdescription>
    </briefdescription>
    <detaileddescription>
    </detaileddescription>
    <programlisting>
<codeline lineno="1"><highlight class="comment">/*</highlight></codeline>
<codeline lineno="2"><highlight class="comment"><sp/>*<sp/>server.c<sp/>-<sp/>functions<sp/>for<sp/>creating<sp/>a<sp/>SSH<sp/>server</highlight></codeline>
<codeline lineno="3"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="4"><highlight class="comment"><sp/>*<sp/>This<sp/>file<sp/>is<sp/>part<sp/>of<sp/>the<sp/>SSH<sp/>Library</highlight></codeline>
<codeline lineno="5"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="6"><highlight class="comment"><sp/>*<sp/>Copyright<sp/>(c)<sp/>2004-2013<sp/>by<sp/>Aris<sp/>Adamantiadis</highlight></codeline>
<codeline lineno="7"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="8"><highlight class="comment"><sp/>*<sp/>The<sp/>SSH<sp/>Library<sp/>is<sp/>free<sp/>software;<sp/>you<sp/>can<sp/>redistribute<sp/>it<sp/>and/or<sp/>modify</highlight></codeline>
<codeline lineno="9"><highlight class="comment"><sp/>*<sp/>it<sp/>under<sp/>the<sp/>terms<sp/>of<sp/>the<sp/>GNU<sp/>Lesser<sp/>General<sp/>Public<sp/>License<sp/>as<sp/>published<sp/>by</highlight></codeline>
<codeline lineno="10"><highlight class="comment"><sp/>*<sp/>the<sp/>Free<sp/>Software<sp/>Foundation;<sp/>either<sp/>version<sp/>2.1<sp/>of<sp/>the<sp/>License,<sp/>or<sp/>(at<sp/>your</highlight></codeline>
<codeline lineno="11"><highlight class="comment"><sp/>*<sp/>option)<sp/>any<sp/>later<sp/>version.</highlight></codeline>
<codeline lineno="12"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="13"><highlight class="comment"><sp/>*<sp/>The<sp/>SSH<sp/>Library<sp/>is<sp/>distributed<sp/>in<sp/>the<sp/>hope<sp/>that<sp/>it<sp/>will<sp/>be<sp/>useful,<sp/>but</highlight></codeline>
<codeline lineno="14"><highlight class="comment"><sp/>*<sp/>WITHOUT<sp/>ANY<sp/>WARRANTY;<sp/>without<sp/>even<sp/>the<sp/>implied<sp/>warranty<sp/>of<sp/>MERCHANTABILITY</highlight></codeline>
<codeline lineno="15"><highlight class="comment"><sp/>*<sp/>or<sp/>FITNESS<sp/>FOR<sp/>A<sp/>PARTICULAR<sp/>PURPOSE.<sp/><sp/>See<sp/>the<sp/>GNU<sp/>Lesser<sp/>General<sp/>Public</highlight></codeline>
<codeline lineno="16"><highlight class="comment"><sp/>*<sp/>License<sp/>for<sp/>more<sp/>details.</highlight></codeline>
<codeline lineno="17"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="18"><highlight class="comment"><sp/>*<sp/>You<sp/>should<sp/>have<sp/>received<sp/>a<sp/>copy<sp/>of<sp/>the<sp/>GNU<sp/>Lesser<sp/>General<sp/>Public<sp/>License</highlight></codeline>
<codeline lineno="19"><highlight class="comment"><sp/>*<sp/>along<sp/>with<sp/>the<sp/>SSH<sp/>Library;<sp/>see<sp/>the<sp/>file<sp/>COPYING.<sp/><sp/>If<sp/>not,<sp/>write<sp/>to</highlight></codeline>
<codeline lineno="20"><highlight class="comment"><sp/>*<sp/>the<sp/>Free<sp/>Software<sp/>Foundation,<sp/>Inc.,<sp/>59<sp/>Temple<sp/>Place<sp/>-<sp/>Suite<sp/>330,<sp/>Boston,</highlight></codeline>
<codeline lineno="21"><highlight class="comment"><sp/>*<sp/>MA<sp/>02111-1307,<sp/>USA.</highlight></codeline>
<codeline lineno="22"><highlight class="comment"><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="23"><highlight class="normal"></highlight></codeline>
<codeline lineno="24"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="config_8h" kindref="compound">config.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="25"><highlight class="normal"></highlight></codeline>
<codeline lineno="26"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;errno.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="27"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;fcntl.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="28"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;stdio.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="29"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;<ref refid="string_8h" kindref="compound">string.h</ref>&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="30"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;stdlib.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="31"><highlight class="normal"></highlight></codeline>
<codeline lineno="32"><highlight class="normal"></highlight><highlight class="preprocessor">#ifdef<sp/>_WIN32</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="33"><highlight class="normal"></highlight><highlight class="preprocessor">#<sp/>include<sp/>&lt;winsock2.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="34"><highlight class="normal"></highlight><highlight class="preprocessor">#<sp/>include<sp/>&lt;ws2tcpip.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="35"><highlight class="normal"></highlight></codeline>
<codeline lineno="36"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">/*</highlight></codeline>
<codeline lineno="37"><highlight class="comment"><sp/><sp/><sp/>*<sp/>&lt;wspiapi.h&gt;<sp/>is<sp/>necessary<sp/>for<sp/>getaddrinfo<sp/>before<sp/>Windows<sp/>XP,<sp/>but<sp/>it<sp/>isn&apos;t</highlight></codeline>
<codeline lineno="38"><highlight class="comment"><sp/><sp/><sp/>*<sp/>available<sp/>on<sp/>some<sp/>platforms<sp/>like<sp/>MinGW.</highlight></codeline>
<codeline lineno="39"><highlight class="comment"><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="40"><highlight class="normal"></highlight><highlight class="preprocessor">#<sp/>ifdef<sp/>HAVE_WSPIAPI_H</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="41"><highlight class="normal"></highlight><highlight class="preprocessor">#<sp/><sp/>include<sp/>&lt;wspiapi.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="42"><highlight class="normal"></highlight><highlight class="preprocessor">#<sp/>endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="43"><highlight class="normal"></highlight><highlight class="preprocessor">#else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="44"><highlight class="normal"></highlight><highlight class="preprocessor">#<sp/>include<sp/>&lt;netinet/in.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="45"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="46"><highlight class="normal"></highlight></codeline>
<codeline lineno="47"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="priv_8h" kindref="compound">libssh/priv.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="48"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="libssh_8h" kindref="compound">libssh/libssh.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="49"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="server_8h" kindref="compound">libssh/server.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="50"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="ssh2_8h" kindref="compound">libssh/ssh2.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="51"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="buffer_8h" kindref="compound">libssh/buffer.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="52"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="packet_8h" kindref="compound">libssh/packet.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="53"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="socket_8h" kindref="compound">libssh/socket.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="54"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="session_8h" kindref="compound">libssh/session.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="55"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="kex_8h" kindref="compound">libssh/kex.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="56"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="misc_8h" kindref="compound">libssh/misc.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="57"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="pki_8h" kindref="compound">libssh/pki.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="58"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="dh_8h" kindref="compound">libssh/dh.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="59"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="messages_8h" kindref="compound">libssh/messages.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="60"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="options_8h" kindref="compound">libssh/options.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="61"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="curve25519_8h" kindref="compound">libssh/curve25519.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="62"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="token_8h" kindref="compound">libssh/token.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="63"><highlight class="normal"></highlight></codeline>
<codeline lineno="64" refid="server_8c_1ae999fe5d95dd5d737af376462d2c59c5" refkind="member"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>set_status(session,<sp/>status)<sp/>do<sp/>{\</highlight></codeline>
<codeline lineno="65"><highlight class="preprocessor"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>(session-&gt;common.callbacks<sp/>&amp;&amp;<sp/>session-&gt;common.callbacks-&gt;connect_status_function)<sp/>\</highlight></codeline>
<codeline lineno="66"><highlight class="preprocessor"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>session-&gt;common.callbacks-&gt;connect_status_function(session-&gt;common.callbacks-&gt;userdata,<sp/>status);<sp/>\</highlight></codeline>
<codeline lineno="67"><highlight class="preprocessor"><sp/><sp/><sp/><sp/>}<sp/>while<sp/>(0)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="68"><highlight class="normal"></highlight></codeline>
<codeline lineno="84" refid="group__libssh__server_1gac8dda51f6f008e42e60d824e2ef2e453" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="group__libssh__server_1gac8dda51f6f008e42e60d824e2ef2e453" kindref="member">server_set_kex</ref>(<ref refid="structssh__session__struct" kindref="compound">ssh_session</ref><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>)</highlight></codeline>
<codeline lineno="85"><highlight class="normal">{</highlight></codeline>
<codeline lineno="86"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">struct<sp/></highlight><highlight class="normal"><ref refid="structssh__kex__struct" kindref="compound">ssh_kex_struct</ref><sp/>*server<sp/>=<sp/>&amp;<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a4ea5e4ae5383c6cdb5db9f08bbbfa019" kindref="member">next_crypto</ref>-&gt;<ref refid="structssh__crypto__struct_1ac78255bf9406137ac4d400644c348a82" kindref="member">server_kex</ref>;</highlight></codeline>
<codeline lineno="87"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i,<sp/>j,<sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref>;</highlight></codeline>
<codeline lineno="88"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*wanted,<sp/>*allowed;</highlight></codeline>
<codeline lineno="89"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*kept;</highlight></codeline>
<codeline lineno="90"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>hostkeys[128]<sp/>=<sp/>{0};</highlight></codeline>
<codeline lineno="91"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">enum</highlight><highlight class="normal"><sp/><ref refid="libssh_8h_1a244b017e5993fde29fe9e9b1f04a7bce" kindref="member">ssh_keytypes_e</ref><sp/>keytype;</highlight></codeline>
<codeline lineno="92"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/>len;</highlight></codeline>
<codeline lineno="93"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>ok;</highlight></codeline>
<codeline lineno="94"><highlight class="normal"></highlight></codeline>
<codeline lineno="95"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="priv_8h_1a65e0a55b6af58e00b0a584d665af60ab" kindref="member">ZERO_STRUCTP</ref>(server);</highlight></codeline>
<codeline lineno="96"><highlight class="normal"></highlight></codeline>
<codeline lineno="97"><highlight class="normal"><sp/><sp/><sp/><sp/>ok<sp/>=<sp/><ref refid="libssh_8h_1aa04e01bdb1b607b705233a5d3587ae11" kindref="member">ssh_get_random</ref>(server-&gt;<ref refid="structssh__kex__struct_1a3c982f0a27422694879c0282a102ffa4" kindref="member">cookie</ref>,<sp/>16,<sp/>0);</highlight></codeline>
<codeline lineno="98"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!ok)<sp/>{</highlight></codeline>
<codeline lineno="99"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="priv_8h_1a55177b3e8db90ca9adb435c44281963c" kindref="member">ssh_set_error</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>,<sp/><ref refid="libssh_8h_1a036b2b00fb04337a4d06d719d1b62be1a86ff0b2e8da6ad8628efc556b6ce1887" kindref="member">SSH_FATAL</ref>,<sp/></highlight><highlight class="stringliteral">&quot;PRNG<sp/>error&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="100"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>-1;</highlight></codeline>
<codeline lineno="101"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="102"><highlight class="normal"></highlight></codeline>
<codeline lineno="103"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a6f50dd2453f70016845c90e9a0e7e641" kindref="member">srv</ref>.<ref refid="structssh__session__struct_1a566490fe8eed8f1f5cede88af2a17b6d" kindref="member">ed25519_key</ref><sp/>!=<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="104"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>snprintf(hostkeys,</highlight></codeline>
<codeline lineno="105"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(hostkeys),</highlight></codeline>
<codeline lineno="106"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;%s&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="107"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="group__libssh__pki_1ga302919f046a4af504e5a2a9924b031c1" kindref="member">ssh_key_type_to_char</ref>(<ref refid="group__libssh__pki_1ga9cb4a857f8e510f80cfc38e46c476490" kindref="member">ssh_key_type</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a6f50dd2453f70016845c90e9a0e7e641" kindref="member">srv</ref>.<ref refid="structssh__session__struct_1a566490fe8eed8f1f5cede88af2a17b6d" kindref="member">ed25519_key</ref>)));</highlight></codeline>
<codeline lineno="108"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="109"><highlight class="normal"></highlight><highlight class="preprocessor">#ifdef<sp/>HAVE_ECC</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="110"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a6f50dd2453f70016845c90e9a0e7e641" kindref="member">srv</ref>.<ref refid="structssh__session__struct_1a01bbd4eb1e8f7979872485ca348d3972" kindref="member">ecdsa_key</ref><sp/>!=<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="111"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>len<sp/>=<sp/>strlen(hostkeys);</highlight></codeline>
<codeline lineno="112"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>snprintf(hostkeys<sp/>+<sp/>len,<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(hostkeys)<sp/>-<sp/>len,</highlight></codeline>
<codeline lineno="113"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;,%s&quot;</highlight><highlight class="normal">,<sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a6f50dd2453f70016845c90e9a0e7e641" kindref="member">srv</ref>.<ref refid="structssh__session__struct_1a01bbd4eb1e8f7979872485ca348d3972" kindref="member">ecdsa_key</ref>-&gt;<ref refid="structssh__key__struct_1af198ae6d0eee951e7d46b8dacbf3c412" kindref="member">type_c</ref>);</highlight></codeline>
<codeline lineno="114"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="115"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="116"><highlight class="normal"></highlight><highlight class="preprocessor">#ifdef<sp/>HAVE_DSA</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="117"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a6f50dd2453f70016845c90e9a0e7e641" kindref="member">srv</ref>.<ref refid="structssh__session__struct_1ab0acf948f6ee2e2ce6b44d3b5b874cbb" kindref="member">dsa_key</ref><sp/>!=<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="118"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>len<sp/>=<sp/>strlen(hostkeys);</highlight></codeline>
<codeline lineno="119"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>keytype<sp/>=<sp/><ref refid="group__libssh__pki_1ga9cb4a857f8e510f80cfc38e46c476490" kindref="member">ssh_key_type</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a6f50dd2453f70016845c90e9a0e7e641" kindref="member">srv</ref>.<ref refid="structssh__session__struct_1ab0acf948f6ee2e2ce6b44d3b5b874cbb" kindref="member">dsa_key</ref>);</highlight></codeline>
<codeline lineno="120"><highlight class="normal"></highlight></codeline>
<codeline lineno="121"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>snprintf(hostkeys<sp/>+<sp/>len,<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(hostkeys)<sp/>-<sp/>len,</highlight></codeline>
<codeline lineno="122"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;,%s&quot;</highlight><highlight class="normal">,<sp/><ref refid="group__libssh__pki_1ga302919f046a4af504e5a2a9924b031c1" kindref="member">ssh_key_type_to_char</ref>(keytype));</highlight></codeline>
<codeline lineno="123"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="124"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="125"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a6f50dd2453f70016845c90e9a0e7e641" kindref="member">srv</ref>.<ref refid="structssh__session__struct_1ab5f06090005e380e8b32468e2b2a9ffb" kindref="member">rsa_key</ref><sp/>!=<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="126"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>We<sp/>support<sp/>also<sp/>the<sp/>SHA2<sp/>variants<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="127"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>len<sp/>=<sp/>strlen(hostkeys);</highlight></codeline>
<codeline lineno="128"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>snprintf(hostkeys<sp/>+<sp/>len,<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(hostkeys)<sp/>-<sp/>len,</highlight></codeline>
<codeline lineno="129"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;,rsa-sha2-512,rsa-sha2-256&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="130"><highlight class="normal"></highlight></codeline>
<codeline lineno="131"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>len<sp/>=<sp/>strlen(hostkeys);</highlight></codeline>
<codeline lineno="132"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>keytype<sp/>=<sp/><ref refid="group__libssh__pki_1ga9cb4a857f8e510f80cfc38e46c476490" kindref="member">ssh_key_type</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a6f50dd2453f70016845c90e9a0e7e641" kindref="member">srv</ref>.<ref refid="structssh__session__struct_1ab5f06090005e380e8b32468e2b2a9ffb" kindref="member">rsa_key</ref>);</highlight></codeline>
<codeline lineno="133"><highlight class="normal"></highlight></codeline>
<codeline lineno="134"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>snprintf(hostkeys<sp/>+<sp/>len,<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(hostkeys)<sp/>-<sp/>len,</highlight></codeline>
<codeline lineno="135"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;,%s&quot;</highlight><highlight class="normal">,<sp/><ref refid="group__libssh__pki_1ga302919f046a4af504e5a2a9924b031c1" kindref="member">ssh_key_type_to_char</ref>(keytype));</highlight></codeline>
<codeline lineno="136"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="137"><highlight class="normal"></highlight></codeline>
<codeline lineno="138"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(strlen(hostkeys)<sp/>==<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="139"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>-1;</highlight></codeline>
<codeline lineno="140"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="141"><highlight class="normal"></highlight></codeline>
<codeline lineno="142"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a1c29cf990c1d0df6e1b0971d4f3d1f3e" kindref="member">opts</ref>.<ref refid="structssh__session__struct_1a6023ca7ba47bbed4837f72bf9dde5948" kindref="member">wanted_methods</ref>[<ref refid="libssh_8h_1a3af3a0324900b0fa3848b9b77cb6b02fa642dda9838782d3808b70c6e943c7a57" kindref="member">SSH_HOSTKEYS</ref>])<sp/>{</highlight></codeline>
<codeline lineno="143"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>allowed<sp/>=<sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a1c29cf990c1d0df6e1b0971d4f3d1f3e" kindref="member">opts</ref>.<ref refid="structssh__session__struct_1a6023ca7ba47bbed4837f72bf9dde5948" kindref="member">wanted_methods</ref>[<ref refid="libssh_8h_1a3af3a0324900b0fa3848b9b77cb6b02fa642dda9838782d3808b70c6e943c7a57" kindref="member">SSH_HOSTKEYS</ref>];</highlight></codeline>
<codeline lineno="144"><highlight class="normal"><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="145"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(ssh_fips_mode())<sp/>{</highlight></codeline>
<codeline lineno="146"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>allowed<sp/>=<sp/><ref refid="kex_8h_1a01bf8c637ec80611bc03a1fd3a991d0f" kindref="member">ssh_kex_get_fips_methods</ref>(<ref refid="libssh_8h_1a3af3a0324900b0fa3848b9b77cb6b02fa642dda9838782d3808b70c6e943c7a57" kindref="member">SSH_HOSTKEYS</ref>);</highlight></codeline>
<codeline lineno="147"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="148"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>allowed<sp/>=<sp/><ref refid="kex_8h_1af53e5cd7c8b0e15ccc0726314f52b460" kindref="member">ssh_kex_get_default_methods</ref>(<ref refid="libssh_8h_1a3af3a0324900b0fa3848b9b77cb6b02fa642dda9838782d3808b70c6e943c7a57" kindref="member">SSH_HOSTKEYS</ref>);</highlight></codeline>
<codeline lineno="149"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="150"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="151"><highlight class="normal"></highlight></codeline>
<codeline lineno="152"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>It<sp/>is<sp/>expected<sp/>for<sp/>the<sp/>list<sp/>of<sp/>allowed<sp/>hostkeys<sp/>to<sp/>be<sp/>ordered<sp/>by</highlight></codeline>
<codeline lineno="153"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/>*<sp/>preference<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="154"><highlight class="normal"><sp/><sp/><sp/><sp/>kept<sp/>=<sp/><ref refid="token_8h_1a650915f2f817e8ed7e5a151dee467d5e" kindref="member">ssh_find_all_matching</ref>(hostkeys[0]<sp/>==<sp/></highlight><highlight class="charliteral">&apos;,&apos;</highlight><highlight class="normal"><sp/>?<sp/>hostkeys<sp/>+<sp/>1<sp/>:<sp/>hostkeys,</highlight></codeline>
<codeline lineno="155"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>allowed);</highlight></codeline>
<codeline lineno="156"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(kept<sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="157"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Nothing<sp/>was<sp/>allowed<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="158"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>-1;</highlight></codeline>
<codeline lineno="159"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="160"><highlight class="normal"></highlight></codeline>
<codeline lineno="161"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="group__libssh__session_1gab88261ef1a07c42d7e2759d7af164047" kindref="member">ssh_options_set_algo</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>,</highlight></codeline>
<codeline lineno="162"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="libssh_8h_1a3af3a0324900b0fa3848b9b77cb6b02fa642dda9838782d3808b70c6e943c7a57" kindref="member">SSH_HOSTKEYS</ref>,</highlight></codeline>
<codeline lineno="163"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>kept);</highlight></codeline>
<codeline lineno="164"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="sshd__direct-tcpip_8c_1aed3129b7674034c979192bcca6b0ad8c" kindref="member">SAFE_FREE</ref>(kept);</highlight></codeline>
<codeline lineno="165"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>&lt;<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="166"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>-1;</highlight></codeline>
<codeline lineno="167"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="168"><highlight class="normal"></highlight></codeline>
<codeline lineno="169"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/><ref refid="kex_8h_1a0aac49551fe045f9a556155c3d8a02a5" kindref="member">SSH_KEX_METHODS</ref>;<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="170"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>wanted<sp/>=<sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a1c29cf990c1d0df6e1b0971d4f3d1f3e" kindref="member">opts</ref>.<ref refid="structssh__session__struct_1a6023ca7ba47bbed4837f72bf9dde5948" kindref="member">wanted_methods</ref>[i];</highlight></codeline>
<codeline lineno="171"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(wanted<sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="172"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(ssh_fips_mode())<sp/>{</highlight></codeline>
<codeline lineno="173"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>wanted<sp/>=<sp/><ref refid="kex_8h_1a01bf8c637ec80611bc03a1fd3a991d0f" kindref="member">ssh_kex_get_fips_methods</ref>(i);</highlight></codeline>
<codeline lineno="174"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="175"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>wanted<sp/>=<sp/><ref refid="kex_8h_1af53e5cd7c8b0e15ccc0726314f52b460" kindref="member">ssh_kex_get_default_methods</ref>(i);</highlight></codeline>
<codeline lineno="176"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="177"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="178"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(wanted<sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="179"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(j<sp/>=<sp/>0;<sp/>j<sp/>&lt;<sp/>i;<sp/>j++)<sp/>{</highlight></codeline>
<codeline lineno="180"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="sshd__direct-tcpip_8c_1aed3129b7674034c979192bcca6b0ad8c" kindref="member">SAFE_FREE</ref>(server-&gt;<ref refid="structssh__kex__struct_1a5a8b3f27866bcbfde98a9d66793ae389" kindref="member">methods</ref>[j]);</highlight></codeline>
<codeline lineno="181"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="182"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>-1;</highlight></codeline>
<codeline lineno="183"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="184"><highlight class="normal"></highlight></codeline>
<codeline lineno="185"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>server-&gt;<ref refid="structssh__kex__struct_1a5a8b3f27866bcbfde98a9d66793ae389" kindref="member">methods</ref>[i]<sp/>=<sp/>strdup(wanted);</highlight></codeline>
<codeline lineno="186"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(server-&gt;<ref refid="structssh__kex__struct_1a5a8b3f27866bcbfde98a9d66793ae389" kindref="member">methods</ref>[i]<sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="187"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(j<sp/>=<sp/>0;<sp/>j<sp/>&lt;<sp/>i;<sp/>j++)<sp/>{</highlight></codeline>
<codeline lineno="188"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="sshd__direct-tcpip_8c_1aed3129b7674034c979192bcca6b0ad8c" kindref="member">SAFE_FREE</ref>(server-&gt;<ref refid="structssh__kex__struct_1a5a8b3f27866bcbfde98a9d66793ae389" kindref="member">methods</ref>[j]);</highlight></codeline>
<codeline lineno="189"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="190"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>-1;</highlight></codeline>
<codeline lineno="191"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="192"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="193"><highlight class="normal"></highlight></codeline>
<codeline lineno="194"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>0;</highlight></codeline>
<codeline lineno="195"><highlight class="normal">}</highlight></codeline>
<codeline lineno="196"><highlight class="normal"></highlight></codeline>
<codeline lineno="197" refid="group__libssh__server_1ga2594833b600c8461fbe26d16e99a211b" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="group__libssh__server_1ga2594833b600c8461fbe26d16e99a211b" kindref="member">ssh_server_init_kex</ref>(<ref refid="structssh__session__struct" kindref="compound">ssh_session</ref><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>)<sp/>{</highlight></codeline>
<codeline lineno="198"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i;</highlight></codeline>
<codeline lineno="199"><highlight class="normal"></highlight></codeline>
<codeline lineno="200"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a6f74d1a1eb6ed715b1073b67caa18460" kindref="member">session_state</ref><sp/>&gt;<sp/><ref refid="session_8h_1a9bbd1d5ae11485e27279be6ad461992caa688177b6c71d2eaf7af6b9e3b3dea5b" kindref="member">SSH_SESSION_STATE_BANNER_RECEIVED</ref>)<sp/>{</highlight></codeline>
<codeline lineno="201"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" kindref="member">SSH_ERROR</ref>;</highlight></codeline>
<codeline lineno="202"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="203"><highlight class="normal"></highlight></codeline>
<codeline lineno="204"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>free<sp/>any<sp/>currently-set<sp/>methods:<sp/>server_set_kex<sp/>will<sp/>allocate<sp/>new<sp/>ones<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="205"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/><ref refid="kex_8h_1a0aac49551fe045f9a556155c3d8a02a5" kindref="member">SSH_KEX_METHODS</ref>;<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="206"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="sshd__direct-tcpip_8c_1aed3129b7674034c979192bcca6b0ad8c" kindref="member">SAFE_FREE</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a4ea5e4ae5383c6cdb5db9f08bbbfa019" kindref="member">next_crypto</ref>-&gt;<ref refid="structssh__crypto__struct_1ac78255bf9406137ac4d400644c348a82" kindref="member">server_kex</ref>.<ref refid="structssh__kex__struct_1a5a8b3f27866bcbfde98a9d66793ae389" kindref="member">methods</ref>[i]);</highlight></codeline>
<codeline lineno="207"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="208"><highlight class="normal"></highlight></codeline>
<codeline lineno="209"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="group__libssh__server_1gac8dda51f6f008e42e60d824e2ef2e453" kindref="member">server_set_kex</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>);</highlight></codeline>
<codeline lineno="210"><highlight class="normal">}</highlight></codeline>
<codeline lineno="211"><highlight class="normal"></highlight></codeline>
<codeline lineno="212" refid="group__libssh__server_1ga3d13039ae1fd46aa8c028401b62bd0af" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="group__libssh__server_1ga3d13039ae1fd46aa8c028401b62bd0af" kindref="member">ssh_server_send_extensions</ref>(<ref refid="structssh__session__struct" kindref="compound">ssh_session</ref><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>)<sp/>{</highlight></codeline>
<codeline lineno="213"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref>;</highlight></codeline>
<codeline lineno="214"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*hostkey_algorithms;</highlight></codeline>
<codeline lineno="215"><highlight class="normal"></highlight></codeline>
<codeline lineno="216"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="priv_8h_1aa21fd8a7a609329603b7b16da7939fca" kindref="member">SSH_LOG</ref>(<ref refid="group__libssh__log_1ggadf764cbdea00d65edcd07bb9953ad2b7a6445dfe21592d69d9741d319538b6673" kindref="member">SSH_LOG_PACKET</ref>,<sp/></highlight><highlight class="stringliteral">&quot;Sending<sp/>SSH_MSG_EXT_INFO&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="217"><highlight class="normal"></highlight></codeline>
<codeline lineno="218"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a1c29cf990c1d0df6e1b0971d4f3d1f3e" kindref="member">opts</ref>.<ref refid="structssh__session__struct_1a41e181fed08e20b58360cb429cf8689f" kindref="member">pubkey_accepted_types</ref>)<sp/>{</highlight></codeline>
<codeline lineno="219"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>hostkey_algorithms<sp/>=<sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a1c29cf990c1d0df6e1b0971d4f3d1f3e" kindref="member">opts</ref>.<ref refid="structssh__session__struct_1a41e181fed08e20b58360cb429cf8689f" kindref="member">pubkey_accepted_types</ref>;</highlight></codeline>
<codeline lineno="220"><highlight class="normal"><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="221"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(ssh_fips_mode())<sp/>{</highlight></codeline>
<codeline lineno="222"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>hostkey_algorithms<sp/>=<sp/><ref refid="kex_8h_1a01bf8c637ec80611bc03a1fd3a991d0f" kindref="member">ssh_kex_get_fips_methods</ref>(<ref refid="libssh_8h_1a3af3a0324900b0fa3848b9b77cb6b02fa642dda9838782d3808b70c6e943c7a57" kindref="member">SSH_HOSTKEYS</ref>);</highlight></codeline>
<codeline lineno="223"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="224"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>There<sp/>are<sp/>no<sp/>restrictions<sp/>to<sp/>the<sp/>accepted<sp/>public<sp/>keys<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="225"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>hostkey_algorithms<sp/>=<sp/><ref refid="kex_8h_1af53e5cd7c8b0e15ccc0726314f52b460" kindref="member">ssh_kex_get_default_methods</ref>(<ref refid="libssh_8h_1a3af3a0324900b0fa3848b9b77cb6b02fa642dda9838782d3808b70c6e943c7a57" kindref="member">SSH_HOSTKEYS</ref>);</highlight></codeline>
<codeline lineno="226"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="227"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="228"><highlight class="normal"></highlight></codeline>
<codeline lineno="229"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="buffer_8h_1ae17848a86043f0abfc60c1c4f6126ccd" kindref="member">ssh_buffer_pack</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1af0aed60c1e529bbfdcb483fd80bf98a0" kindref="member">out_buffer</ref>,</highlight></codeline>
<codeline lineno="230"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;bdss&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="231"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ssh2_8h_1a12aba493ba1609e4fb1ece10f8fd537e" kindref="member">SSH2_MSG_EXT_INFO</ref>,</highlight></codeline>
<codeline lineno="232"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>1,<sp/></highlight><highlight class="comment">/*<sp/>nr.<sp/>of<sp/>extensions<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="233"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;server-sig-algs&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="234"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>hostkey_algorithms);</highlight></codeline>
<codeline lineno="235"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>!=<sp/><ref refid="libssh_8h_1ac1ee1d1e917456d4760a94a18015377d" kindref="member">SSH_OK</ref>)<sp/>{</highlight></codeline>
<codeline lineno="236"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">goto</highlight><highlight class="normal"><sp/><ref refid="proxy_8c_1a11614f44ef4d939bdd984953346a7572" kindref="member">error</ref>;</highlight></codeline>
<codeline lineno="237"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="238"><highlight class="normal"></highlight></codeline>
<codeline lineno="239"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="packet_8h_1a7e6c7ed74c23ace432476aa8a6841140" kindref="member">ssh_packet_send</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>)<sp/>==<sp/><ref refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" kindref="member">SSH_ERROR</ref>)<sp/>{</highlight></codeline>
<codeline lineno="240"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">goto</highlight><highlight class="normal"><sp/><ref refid="proxy_8c_1a11614f44ef4d939bdd984953346a7572" kindref="member">error</ref>;</highlight></codeline>
<codeline lineno="241"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="242"><highlight class="normal"></highlight></codeline>
<codeline lineno="243"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>0;</highlight></codeline>
<codeline lineno="244"><highlight class="normal"><ref refid="proxy_8c_1a11614f44ef4d939bdd984953346a7572" kindref="member">error</ref>:</highlight></codeline>
<codeline lineno="245"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="libssh_8h_1ac8802ff7f5348d0145dab5242623f740" kindref="member">ssh_buffer_reinit</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1af0aed60c1e529bbfdcb483fd80bf98a0" kindref="member">out_buffer</ref>);</highlight></codeline>
<codeline lineno="246"><highlight class="normal"></highlight></codeline>
<codeline lineno="247"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>-1;</highlight></codeline>
<codeline lineno="248"><highlight class="normal">}</highlight></codeline>
<codeline lineno="249"><highlight class="normal"></highlight></codeline>
<codeline lineno="250" refid="group__libssh__server_1ga872620a8d0aa300fe01626f1aea153cd" refkind="member"><highlight class="normal"><ref refid="group__libssh__server_1ga872620a8d0aa300fe01626f1aea153cd" kindref="member">SSH_PACKET_CALLBACK</ref>(ssh_packet_kexdh_init){</highlight></codeline>
<codeline lineno="251"><highlight class="normal"><sp/><sp/>(void)packet;</highlight></codeline>
<codeline lineno="252"><highlight class="normal"><sp/><sp/>(void)type;</highlight></codeline>
<codeline lineno="253"><highlight class="normal"><sp/><sp/>(void)<ref refid="ssh__client_8c_1a14871705f45ccdc5bb9f4549efd8e119" kindref="member">user</ref>;</highlight></codeline>
<codeline lineno="254"><highlight class="normal"></highlight></codeline>
<codeline lineno="255"><highlight class="normal"><sp/><sp/><ref refid="priv_8h_1aa21fd8a7a609329603b7b16da7939fca" kindref="member">SSH_LOG</ref>(<ref refid="group__libssh__log_1ggadf764cbdea00d65edcd07bb9953ad2b7a6445dfe21592d69d9741d319538b6673" kindref="member">SSH_LOG_PACKET</ref>,</highlight><highlight class="stringliteral">&quot;Received<sp/>SSH_MSG_KEXDH_INIT&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="256"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a6a94fa11eb06ca18d3c0ac22a153f97f" kindref="member">dh_handshake_state</ref><sp/>!=<sp/><ref refid="session_8h_1a52a640f6094e9b3d1a88c7da7d08c802a90a6f45fd750c65a3cb58157b89150c9" kindref="member">DH_STATE_INIT</ref>){</highlight></codeline>
<codeline lineno="257"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="priv_8h_1aa21fd8a7a609329603b7b16da7939fca" kindref="member">SSH_LOG</ref>(<ref refid="libssh_8h_1a1c08cc9177a5598e0675abfb833d2993" kindref="member">SSH_LOG_RARE</ref>,</highlight><highlight class="stringliteral">&quot;Invalid<sp/>state<sp/>for<sp/>SSH_MSG_KEXDH_INIT&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="258"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a6f74d1a1eb6ed715b1073b67caa18460" kindref="member">session_state</ref><sp/>=<sp/><ref refid="session_8h_1a9bbd1d5ae11485e27279be6ad461992ca855474fc84a2fb170fcb72546af8eeb8" kindref="member">SSH_SESSION_STATE_ERROR</ref>;</highlight></codeline>
<codeline lineno="259"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="group__libssh__callbacks_1gac29df803aa1295d6a498c1b081f3b494" kindref="member">SSH_PACKET_USED</ref>;</highlight></codeline>
<codeline lineno="260"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="261"><highlight class="normal"></highlight></codeline>
<codeline lineno="262"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">/*<sp/>If<sp/>first_kex_packet_follows<sp/>guess<sp/>was<sp/>wrong,<sp/>ignore<sp/>this<sp/>message.<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="263"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1aa5bd72290c07e7ae0b888272c9aa9be3" kindref="member">first_kex_follows_guess_wrong</ref><sp/>!=<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="264"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="priv_8h_1aa21fd8a7a609329603b7b16da7939fca" kindref="member">SSH_LOG</ref>(<ref refid="libssh_8h_1a1c08cc9177a5598e0675abfb833d2993" kindref="member">SSH_LOG_RARE</ref>,<sp/></highlight><highlight class="stringliteral">&quot;first_kex_packet_follows<sp/>guess<sp/>was<sp/>wrong,<sp/>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="265"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;ignoring<sp/>first<sp/>SSH_MSG_KEXDH_INIT<sp/>message&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="266"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1aa5bd72290c07e7ae0b888272c9aa9be3" kindref="member">first_kex_follows_guess_wrong</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="267"><highlight class="normal"></highlight></codeline>
<codeline lineno="268"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="group__libssh__callbacks_1gac29df803aa1295d6a498c1b081f3b494" kindref="member">SSH_PACKET_USED</ref>;</highlight></codeline>
<codeline lineno="269"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="270"><highlight class="normal"><sp/><sp/><ref refid="priv_8h_1aa21fd8a7a609329603b7b16da7939fca" kindref="member">SSH_LOG</ref>(<ref refid="libssh_8h_1a5e4247396f11fdc228d356a408c81715" kindref="member">SSH_LOG_DEBUG</ref>,<sp/></highlight><highlight class="stringliteral">&quot;Calling<sp/>next<sp/>KEXDH<sp/>handler&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="271"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="group__libssh__callbacks_1ga4766917128a12b646a8aee7ebc019f8c" kindref="member">SSH_PACKET_NOT_USED</ref>;</highlight></codeline>
<codeline lineno="272"><highlight class="normal">}</highlight></codeline>
<codeline lineno="273"><highlight class="normal"></highlight></codeline>
<codeline lineno="274"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="275" refid="group__libssh__server_1gad7dc7022c232731badd57c92ca04f1d6" refkind="member"><highlight class="normal"><ref refid="group__libssh__server_1gad7dc7022c232731badd57c92ca04f1d6" kindref="member">ssh_get_key_params</ref>(<ref refid="structssh__session__struct" kindref="compound">ssh_session</ref><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>,</highlight></codeline>
<codeline lineno="276"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structssh__key__struct" kindref="compound">ssh_key</ref><sp/>*<ref refid="curve25519-sha256_0dlibssh_8org_8txt_1a5d18fd02a76effa0a15b1decb554cc12" kindref="member">privkey</ref>,</highlight></codeline>
<codeline lineno="277"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">enum</highlight><highlight class="normal"><sp/><ref refid="priv_8h_1a776ae60987846ddc64c85308d5b6a441" kindref="member">ssh_digest_e</ref><sp/>*digest)</highlight></codeline>
<codeline lineno="278"><highlight class="normal">{</highlight></codeline>
<codeline lineno="279"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="structssh__key__struct" kindref="compound">ssh_key</ref><sp/><ref refid="curve25519-sha256_0dlibssh_8org_8txt_1a555595207a1407936ebb264ebdbf434c" kindref="member">pubkey</ref>;</highlight></codeline>
<codeline lineno="280"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="structssh__string__struct" kindref="compound">ssh_string</ref><sp/>pubkey_blob;</highlight></codeline>
<codeline lineno="281"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref>;</highlight></codeline>
<codeline lineno="282"><highlight class="normal"></highlight></codeline>
<codeline lineno="283"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">switch</highlight><highlight class="normal">(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a6f50dd2453f70016845c90e9a0e7e641" kindref="member">srv</ref>.<ref refid="structssh__session__struct_1a196c23b5496291f952d3c73bf1edeb76" kindref="member">hostkey</ref>)<sp/>{</highlight></codeline>
<codeline lineno="284"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="libssh_8h_1a244b017e5993fde29fe9e9b1f04a7bcea1adda9da237bf26cb1b46a9e3b9fd99f" kindref="member">SSH_KEYTYPE_DSS</ref>:</highlight></codeline>
<codeline lineno="285"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<ref refid="curve25519-sha256_0dlibssh_8org_8txt_1a5d18fd02a76effa0a15b1decb554cc12" kindref="member">privkey</ref><sp/>=<sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a6f50dd2453f70016845c90e9a0e7e641" kindref="member">srv</ref>.<ref refid="structssh__session__struct_1ab0acf948f6ee2e2ce6b44d3b5b874cbb" kindref="member">dsa_key</ref>;</highlight></codeline>
<codeline lineno="286"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="287"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="libssh_8h_1a244b017e5993fde29fe9e9b1f04a7bcea94ea687ea48d0e1eceef97f1c1745683" kindref="member">SSH_KEYTYPE_RSA</ref>:</highlight></codeline>
<codeline lineno="288"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<ref refid="curve25519-sha256_0dlibssh_8org_8txt_1a5d18fd02a76effa0a15b1decb554cc12" kindref="member">privkey</ref><sp/>=<sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a6f50dd2453f70016845c90e9a0e7e641" kindref="member">srv</ref>.<ref refid="structssh__session__struct_1ab5f06090005e380e8b32468e2b2a9ffb" kindref="member">rsa_key</ref>;</highlight></codeline>
<codeline lineno="289"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="290"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="libssh_8h_1a244b017e5993fde29fe9e9b1f04a7bcea1f244a10b34e2f9dd3627edbef5166ed" kindref="member">SSH_KEYTYPE_ECDSA_P256</ref>:</highlight></codeline>
<codeline lineno="291"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="libssh_8h_1a244b017e5993fde29fe9e9b1f04a7bceaeb5f376b9746eadb0210e4b1e797a226" kindref="member">SSH_KEYTYPE_ECDSA_P384</ref>:</highlight></codeline>
<codeline lineno="292"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="libssh_8h_1a244b017e5993fde29fe9e9b1f04a7bcea60f4b5533fda0045bbbb4e18bfd6580d" kindref="member">SSH_KEYTYPE_ECDSA_P521</ref>:</highlight></codeline>
<codeline lineno="293"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<ref refid="curve25519-sha256_0dlibssh_8org_8txt_1a5d18fd02a76effa0a15b1decb554cc12" kindref="member">privkey</ref><sp/>=<sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a6f50dd2453f70016845c90e9a0e7e641" kindref="member">srv</ref>.<ref refid="structssh__session__struct_1a01bbd4eb1e8f7979872485ca348d3972" kindref="member">ecdsa_key</ref>;</highlight></codeline>
<codeline lineno="294"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="295"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="libssh_8h_1a244b017e5993fde29fe9e9b1f04a7bcea237671d46fa2c7f139963e154d5430bf" kindref="member">SSH_KEYTYPE_ED25519</ref>:</highlight></codeline>
<codeline lineno="296"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<ref refid="curve25519-sha256_0dlibssh_8org_8txt_1a5d18fd02a76effa0a15b1decb554cc12" kindref="member">privkey</ref><sp/>=<sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a6f50dd2453f70016845c90e9a0e7e641" kindref="member">srv</ref>.<ref refid="structssh__session__struct_1a566490fe8eed8f1f5cede88af2a17b6d" kindref="member">ed25519_key</ref>;</highlight></codeline>
<codeline lineno="297"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="298"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="libssh_8h_1a244b017e5993fde29fe9e9b1f04a7bceac654b6d0625420374941826e33ce8f7e" kindref="member">SSH_KEYTYPE_RSA1</ref>:</highlight></codeline>
<codeline lineno="299"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="libssh_8h_1a244b017e5993fde29fe9e9b1f04a7bceafefc5ac8dd22ec75f84a6ad5ee2d591b" kindref="member">SSH_KEYTYPE_UNKNOWN</ref>:</highlight></codeline>
<codeline lineno="300"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">default</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="301"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<ref refid="curve25519-sha256_0dlibssh_8org_8txt_1a5d18fd02a76effa0a15b1decb554cc12" kindref="member">privkey</ref><sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="302"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="303"><highlight class="normal"></highlight></codeline>
<codeline lineno="304"><highlight class="normal"><sp/><sp/><sp/><sp/>*digest<sp/>=<sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a6f50dd2453f70016845c90e9a0e7e641" kindref="member">srv</ref>.<ref refid="structssh__session__struct_1a58f7536afa99eb6edee32abbfa29bf8e" kindref="member">hostkey_digest</ref>;</highlight></codeline>
<codeline lineno="305"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="group__libssh__pki_1ga5777bc537da6a447b2a9aa9eceff9877" kindref="member">ssh_pki_export_privkey_to_pubkey</ref>(*<ref refid="curve25519-sha256_0dlibssh_8org_8txt_1a5d18fd02a76effa0a15b1decb554cc12" kindref="member">privkey</ref>,<sp/>&amp;<ref refid="curve25519-sha256_0dlibssh_8org_8txt_1a555595207a1407936ebb264ebdbf434c" kindref="member">pubkey</ref>);</highlight></codeline>
<codeline lineno="306"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>&lt;<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="307"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="priv_8h_1a55177b3e8db90ca9adb435c44281963c" kindref="member">ssh_set_error</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>,<sp/><ref refid="libssh_8h_1a036b2b00fb04337a4d06d719d1b62be1a86ff0b2e8da6ad8628efc556b6ce1887" kindref="member">SSH_FATAL</ref>,</highlight></codeline>
<codeline lineno="308"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Could<sp/>not<sp/>get<sp/>the<sp/>public<sp/>key<sp/>from<sp/>the<sp/>private<sp/>key&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="309"><highlight class="normal"></highlight></codeline>
<codeline lineno="310"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>-1;</highlight></codeline>
<codeline lineno="311"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="312"><highlight class="normal"></highlight></codeline>
<codeline lineno="313"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="group__libssh__pki_1gaadeaf6dc35e99214de0af82c3c431649" kindref="member">ssh_pki_export_pubkey_blob</ref>(<ref refid="curve25519-sha256_0dlibssh_8org_8txt_1a555595207a1407936ebb264ebdbf434c" kindref="member">pubkey</ref>,<sp/>&amp;pubkey_blob);</highlight></codeline>
<codeline lineno="314"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="group__libssh__pki_1ga08808beb83a42ccd6f1c710ddeb1b4c2" kindref="member">ssh_key_free</ref>(<ref refid="curve25519-sha256_0dlibssh_8org_8txt_1a555595207a1407936ebb264ebdbf434c" kindref="member">pubkey</ref>);</highlight></codeline>
<codeline lineno="315"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>&lt;<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="316"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="priv_8h_1ae280c413c792e04237f000841ac8ce44" kindref="member">ssh_set_error_oom</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>);</highlight></codeline>
<codeline lineno="317"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>-1;</highlight></codeline>
<codeline lineno="318"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="319"><highlight class="normal"></highlight></codeline>
<codeline lineno="320"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="dh_8h_1a0d46abbfee369e9fb75f930e5f6a993a" kindref="member">ssh_dh_import_next_pubkey_blob</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>,<sp/>pubkey_blob);</highlight></codeline>
<codeline lineno="321"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="libssh_8h_1a5bc8710c8633117ff449d15489fca051" kindref="member">SSH_STRING_FREE</ref>(pubkey_blob);</highlight></codeline>
<codeline lineno="322"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>!=<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="323"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="priv_8h_1a55177b3e8db90ca9adb435c44281963c" kindref="member">ssh_set_error</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>,</highlight></codeline>
<codeline lineno="324"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="libssh_8h_1a036b2b00fb04337a4d06d719d1b62be1a86ff0b2e8da6ad8628efc556b6ce1887" kindref="member">SSH_FATAL</ref>,</highlight></codeline>
<codeline lineno="325"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Could<sp/>not<sp/>import<sp/>server<sp/>public<sp/>key&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="326"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>-1;</highlight></codeline>
<codeline lineno="327"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="328"><highlight class="normal"></highlight></codeline>
<codeline lineno="329"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="libssh_8h_1ac1ee1d1e917456d4760a94a18015377d" kindref="member">SSH_OK</ref>;</highlight></codeline>
<codeline lineno="330"><highlight class="normal">}</highlight></codeline>
<codeline lineno="331"><highlight class="normal"></highlight></codeline>
<codeline lineno="338" refid="group__libssh__server_1ga6b0057a0346a87ddd9b57bfbbc580d4d" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="group__libssh__server_1ga6b0057a0346a87ddd9b57bfbbc580d4d" kindref="member">ssh_server_connection_callback</ref>(<ref refid="structssh__session__struct" kindref="compound">ssh_session</ref><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>){</highlight></codeline>
<codeline lineno="339"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref>;</highlight></codeline>
<codeline lineno="340"><highlight class="normal"></highlight></codeline>
<codeline lineno="341"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">switch</highlight><highlight class="normal">(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a6f74d1a1eb6ed715b1073b67caa18460" kindref="member">session_state</ref>){</highlight></codeline>
<codeline lineno="342"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="session_8h_1a9bbd1d5ae11485e27279be6ad461992ca6e96b3ae323d058e27297e97c01c1d7f" kindref="member">SSH_SESSION_STATE_NONE</ref>:</highlight></codeline>
<codeline lineno="343"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="session_8h_1a9bbd1d5ae11485e27279be6ad461992cad7664a3923c57a333c0c5ff14f5d6c1e" kindref="member">SSH_SESSION_STATE_CONNECTING</ref>:</highlight></codeline>
<codeline lineno="344"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="session_8h_1a9bbd1d5ae11485e27279be6ad461992ca82652ed2dc1cdfd2c8cdb12a3ab6b703" kindref="member">SSH_SESSION_STATE_SOCKET_CONNECTED</ref>:</highlight></codeline>
<codeline lineno="345"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="346"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="session_8h_1a9bbd1d5ae11485e27279be6ad461992caa688177b6c71d2eaf7af6b9e3b3dea5b" kindref="member">SSH_SESSION_STATE_BANNER_RECEIVED</ref>:</highlight></codeline>
<codeline lineno="347"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1aff7925f04070fc20dc3d9366d7f2f748" kindref="member">clientbanner</ref><sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="348"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">goto</highlight><highlight class="normal"><sp/><ref refid="proxy_8c_1a11614f44ef4d939bdd984953346a7572" kindref="member">error</ref>;</highlight></codeline>
<codeline lineno="349"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="350"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="server_8c_1ae999fe5d95dd5d737af376462d2c59c5" kindref="member">set_status</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>,<sp/>0.4f);</highlight></codeline>
<codeline lineno="351"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="priv_8h_1aa21fd8a7a609329603b7b16da7939fca" kindref="member">SSH_LOG</ref>(<ref refid="group__libssh__log_1ggadf764cbdea00d65edcd07bb9953ad2b7a75fa79e63947b66462db977d9b5ae27c" kindref="member">SSH_LOG_PROTOCOL</ref>,</highlight></codeline>
<codeline lineno="352"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;SSH<sp/>client<sp/>banner:<sp/>%s&quot;</highlight><highlight class="normal">,<sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1aff7925f04070fc20dc3d9366d7f2f748" kindref="member">clientbanner</ref>);</highlight></codeline>
<codeline lineno="353"><highlight class="normal"></highlight></codeline>
<codeline lineno="354"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Here<sp/>we<sp/>analyze<sp/>the<sp/>different<sp/>protocols<sp/>the<sp/>server<sp/>allows.<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="355"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="group__libssh__misc_1gae795e33139e9c0ad1611fc4fdf476fbe" kindref="member">ssh_analyze_banner</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>,<sp/>1);</highlight></codeline>
<codeline lineno="356"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>&lt;<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="357"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="priv_8h_1a55177b3e8db90ca9adb435c44281963c" kindref="member">ssh_set_error</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>,<sp/><ref refid="libssh_8h_1a036b2b00fb04337a4d06d719d1b62be1a86ff0b2e8da6ad8628efc556b6ce1887" kindref="member">SSH_FATAL</ref>,</highlight></codeline>
<codeline lineno="358"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;No<sp/>version<sp/>of<sp/>SSH<sp/>protocol<sp/>usable<sp/>(banner:<sp/>%s)&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="359"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1aff7925f04070fc20dc3d9366d7f2f748" kindref="member">clientbanner</ref>);</highlight></codeline>
<codeline lineno="360"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">goto</highlight><highlight class="normal"><sp/><ref refid="proxy_8c_1a11614f44ef4d939bdd984953346a7572" kindref="member">error</ref>;</highlight></codeline>
<codeline lineno="361"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="362"><highlight class="normal"></highlight></codeline>
<codeline lineno="363"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>from<sp/>now,<sp/>the<sp/>packet<sp/>layer<sp/>is<sp/>handling<sp/>incoming<sp/>packets<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="364"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a77c2c8292416988963f37b9723d2f55f" kindref="member">socket_callbacks</ref>.<ref refid="structssh__socket__callbacks__struct_1a73d09c1b2ae438da96c4b3bbfb99c9ad" kindref="member">data</ref>=<ref refid="packet_8h_1af53b16a51c1fb0b3cd7c15baba882ed8" kindref="member">ssh_packet_socket_callback</ref>;</highlight></codeline>
<codeline lineno="365"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="packet_8h_1aca955bacc5c633c212bdb61e1b43a1a2" kindref="member">ssh_packet_register_socket_callback</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>,<sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a3e64318ee32b9880aafbded46fabf81d" kindref="member">socket</ref>);</highlight></codeline>
<codeline lineno="366"><highlight class="normal"></highlight></codeline>
<codeline lineno="367"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="packet_8h_1a2e88eac5d0547fdb7f03830adce9c4d2" kindref="member">ssh_packet_set_default_callbacks</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>);</highlight></codeline>
<codeline lineno="368"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="server_8c_1ae999fe5d95dd5d737af376462d2c59c5" kindref="member">set_status</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>,<sp/>0.5f);</highlight></codeline>
<codeline lineno="369"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a6f74d1a1eb6ed715b1073b67caa18460" kindref="member">session_state</ref>=<ref refid="session_8h_1a9bbd1d5ae11485e27279be6ad461992ca64f98e48c54ec9ae09070b92c1f47659" kindref="member">SSH_SESSION_STATE_INITIAL_KEX</ref>;</highlight></codeline>
<codeline lineno="370"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="kex_8h_1a6c4425f4b80fc393d0c71ef488c240ba" kindref="member">ssh_send_kex</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>,<sp/>1)<sp/>&lt;<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="371"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">goto</highlight><highlight class="normal"><sp/><ref refid="proxy_8c_1a11614f44ef4d939bdd984953346a7572" kindref="member">error</ref>;</highlight></codeline>
<codeline lineno="372"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="373"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="374"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="session_8h_1a9bbd1d5ae11485e27279be6ad461992ca64f98e48c54ec9ae09070b92c1f47659" kindref="member">SSH_SESSION_STATE_INITIAL_KEX</ref>:</highlight></codeline>
<codeline lineno="375"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>TODO:<sp/>This<sp/>state<sp/>should<sp/>disappear<sp/>in<sp/>favor<sp/>of<sp/>get_key<sp/>handle<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="376"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="377"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="session_8h_1a9bbd1d5ae11485e27279be6ad461992ca336024640ab057d21d87ded010687dc7" kindref="member">SSH_SESSION_STATE_KEXINIT_RECEIVED</ref>:</highlight></codeline>
<codeline lineno="378"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="server_8c_1ae999fe5d95dd5d737af376462d2c59c5" kindref="member">set_status</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>,0.6f);</highlight></codeline>
<codeline lineno="379"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a4ea5e4ae5383c6cdb5db9f08bbbfa019" kindref="member">next_crypto</ref>-&gt;<ref refid="structssh__crypto__struct_1ac78255bf9406137ac4d400644c348a82" kindref="member">server_kex</ref>.<ref refid="structssh__kex__struct_1a5a8b3f27866bcbfde98a9d66793ae389" kindref="member">methods</ref>[0]==NULL){</highlight></codeline>
<codeline lineno="380"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<ref refid="group__libssh__server_1gac8dda51f6f008e42e60d824e2ef2e453" kindref="member">server_set_kex</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>)<sp/>==<sp/><ref refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" kindref="member">SSH_ERROR</ref>)</highlight></codeline>
<codeline lineno="381"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">goto</highlight><highlight class="normal"><sp/><ref refid="proxy_8c_1a11614f44ef4d939bdd984953346a7572" kindref="member">error</ref>;</highlight></codeline>
<codeline lineno="382"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>We<sp/>are<sp/>in<sp/>a<sp/>rekeying,<sp/>so<sp/>we<sp/>need<sp/>to<sp/>send<sp/>the<sp/>server<sp/>kex<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="383"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<ref refid="kex_8h_1a6c4425f4b80fc393d0c71ef488c240ba" kindref="member">ssh_send_kex</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>,<sp/>1)<sp/>&lt;<sp/>0)</highlight></codeline>
<codeline lineno="384"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">goto</highlight><highlight class="normal"><sp/><ref refid="proxy_8c_1a11614f44ef4d939bdd984953346a7572" kindref="member">error</ref>;</highlight></codeline>
<codeline lineno="385"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="386"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="kex_8h_1a0e79dc09bff165cdc194d729c96d4e0d" kindref="member">ssh_list_kex</ref>(&amp;<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a4ea5e4ae5383c6cdb5db9f08bbbfa019" kindref="member">next_crypto</ref>-&gt;<ref refid="structssh__crypto__struct_1a0fa9919df32b44ccafc551d220fe609b" kindref="member">client_kex</ref>);<sp/></highlight><highlight class="comment">//<sp/>log<sp/>client<sp/>kex</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="387"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="kex_8h_1a10fc6e5cb4678972e355e69bfe8e35e4" kindref="member">ssh_kex_select_methods</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>)<sp/>&lt;<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="388"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">goto</highlight><highlight class="normal"><sp/><ref refid="proxy_8c_1a11614f44ef4d939bdd984953346a7572" kindref="member">error</ref>;</highlight></codeline>
<codeline lineno="389"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="390"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="wrapper_8h_1a0d1d5ba8b1aa92198d65aa7a173dd758" kindref="member">crypt_set_algorithms_server</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>)<sp/>==<sp/><ref refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" kindref="member">SSH_ERROR</ref>)</highlight></codeline>
<codeline lineno="391"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">goto</highlight><highlight class="normal"><sp/><ref refid="proxy_8c_1a11614f44ef4d939bdd984953346a7572" kindref="member">error</ref>;</highlight></codeline>
<codeline lineno="392"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="server_8c_1ae999fe5d95dd5d737af376462d2c59c5" kindref="member">set_status</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>,0.8f);</highlight></codeline>
<codeline lineno="393"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a6f74d1a1eb6ed715b1073b67caa18460" kindref="member">session_state</ref>=<ref refid="session_8h_1a9bbd1d5ae11485e27279be6ad461992ca1dcace0fedd97312d6829ecc526d3606" kindref="member">SSH_SESSION_STATE_DH</ref>;</highlight></codeline>
<codeline lineno="394"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="395"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="session_8h_1a9bbd1d5ae11485e27279be6ad461992ca1dcace0fedd97312d6829ecc526d3606" kindref="member">SSH_SESSION_STATE_DH</ref>:</highlight></codeline>
<codeline lineno="396"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a6a94fa11eb06ca18d3c0ac22a153f97f" kindref="member">dh_handshake_state</ref>==<ref refid="session_8h_1a52a640f6094e9b3d1a88c7da7d08c802a01abdeced4b17007ee1ffdb54f5d70e2" kindref="member">DH_STATE_FINISHED</ref>){</highlight></codeline>
<codeline lineno="397"><highlight class="normal"></highlight></codeline>
<codeline lineno="398"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="packet_8h_1ab8efa43ad331ae38c5a72bea6b5f6a14" kindref="member">ssh_packet_set_newkeys</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>,<sp/><ref refid="wrapper_8h_1a9ebe789b5f29a369c7799ec6ce17f1a9a86b8de4a56d77c10ee93f4cb0ab82d71" kindref="member">SSH_DIRECTION_IN</ref>);</highlight></codeline>
<codeline lineno="399"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>!=<sp/><ref refid="libssh_8h_1ac1ee1d1e917456d4760a94a18015377d" kindref="member">SSH_OK</ref>)<sp/>{</highlight></codeline>
<codeline lineno="400"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">goto</highlight><highlight class="normal"><sp/><ref refid="proxy_8c_1a11614f44ef4d939bdd984953346a7572" kindref="member">error</ref>;</highlight></codeline>
<codeline lineno="401"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="402"><highlight class="normal"></highlight></codeline>
<codeline lineno="403"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*</highlight></codeline>
<codeline lineno="404"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>If<sp/>the<sp/>client<sp/>supports<sp/>extension<sp/>negotiation,<sp/>we<sp/>will<sp/>send</highlight></codeline>
<codeline lineno="405"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>our<sp/>supported<sp/>extensions<sp/>now.<sp/>This<sp/>is<sp/>the<sp/>first<sp/>message<sp/>after</highlight></codeline>
<codeline lineno="406"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>sending<sp/>NEWKEYS<sp/>message<sp/>and<sp/>after<sp/>turning<sp/>on<sp/>crypto.</highlight></codeline>
<codeline lineno="407"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="408"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a2881b30666809faf781755e3ba827418" kindref="member">extensions</ref><sp/>&amp;<sp/><ref refid="session_8h_1a9bd3f2ee7d4c57e1b5157c22da5daee0" kindref="member">SSH_EXT_NEGOTIATION</ref><sp/>&amp;&amp;</highlight></codeline>
<codeline lineno="409"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a6f74d1a1eb6ed715b1073b67caa18460" kindref="member">session_state</ref><sp/>!=<sp/><ref refid="session_8h_1a9bbd1d5ae11485e27279be6ad461992caced7c62fd9f24fe8f6672d50b8219f60" kindref="member">SSH_SESSION_STATE_AUTHENTICATED</ref>)<sp/>{</highlight></codeline>
<codeline lineno="410"><highlight class="normal"></highlight></codeline>
<codeline lineno="411"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*</highlight></codeline>
<codeline lineno="412"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>Only<sp/>send<sp/>an<sp/>SSH_MSG_EXT_INFO<sp/>message<sp/>the<sp/>first<sp/>time<sp/>the<sp/>client</highlight></codeline>
<codeline lineno="413"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>undergoes<sp/>NEWKEYS.<sp/><sp/>It<sp/>is<sp/>unexpected<sp/>for<sp/>this<sp/>message<sp/>to<sp/>be<sp/>sent</highlight></codeline>
<codeline lineno="414"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>upon<sp/>rekey,<sp/>and<sp/>may<sp/>cause<sp/>clients<sp/>to<sp/>log<sp/>error<sp/>messages.</highlight></codeline>
<codeline lineno="415"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*</highlight></codeline>
<codeline lineno="416"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>The<sp/>session_state<sp/>can<sp/>not<sp/>be<sp/>used<sp/>for<sp/>this<sp/>purpose<sp/>because<sp/>it<sp/>is</highlight></codeline>
<codeline lineno="417"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>re-set<sp/>to<sp/>SSH_SESSION_STATE_KEXINIT_RECEIVED<sp/>during<sp/>rekey.<sp/><sp/>So,</highlight></codeline>
<codeline lineno="418"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>use<sp/>the<sp/>connected<sp/>flag<sp/>which<sp/>transitions<sp/>from<sp/>non-zero<sp/>below.</highlight></codeline>
<codeline lineno="419"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*</highlight></codeline>
<codeline lineno="420"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>See<sp/>also:</highlight></codeline>
<codeline lineno="421"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>-<sp/>https://bugzilla.mindrot.org/show_bug.cgi?id=2929</highlight></codeline>
<codeline lineno="422"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="423"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a70c6a6c0e1a409047afd7608b5aa40c3" kindref="member">connected</ref><sp/>==<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="424"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="group__libssh__server_1ga3d13039ae1fd46aa8c028401b62bd0af" kindref="member">ssh_server_send_extensions</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>);</highlight></codeline>
<codeline lineno="425"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="426"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="427"><highlight class="normal"></highlight></codeline>
<codeline lineno="428"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="server_8c_1ae999fe5d95dd5d737af376462d2c59c5" kindref="member">set_status</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>,1.0f);</highlight></codeline>
<codeline lineno="429"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a70c6a6c0e1a409047afd7608b5aa40c3" kindref="member">connected</ref><sp/>=<sp/>1;</highlight></codeline>
<codeline lineno="430"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a6f74d1a1eb6ed715b1073b67caa18460" kindref="member">session_state</ref>=<ref refid="session_8h_1a9bbd1d5ae11485e27279be6ad461992ca0bf582a8796f77262a1161fabc9a587b" kindref="member">SSH_SESSION_STATE_AUTHENTICATING</ref>;</highlight></codeline>
<codeline lineno="431"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a997060832a3419d8fe884d3da855ef4c" kindref="member">flags</ref><sp/>&amp;<sp/><ref refid="session_8h_1ae54e87f0565e24b25aed1372b3493a2b" kindref="member">SSH_SESSION_FLAG_AUTHENTICATED</ref>)</highlight></codeline>
<codeline lineno="432"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a6f74d1a1eb6ed715b1073b67caa18460" kindref="member">session_state</ref><sp/>=<sp/><ref refid="session_8h_1a9bbd1d5ae11485e27279be6ad461992caced7c62fd9f24fe8f6672d50b8219f60" kindref="member">SSH_SESSION_STATE_AUTHENTICATED</ref>;</highlight></codeline>
<codeline lineno="433"><highlight class="normal"></highlight></codeline>
<codeline lineno="434"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="435"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="436"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="session_8h_1a9bbd1d5ae11485e27279be6ad461992ca0bf582a8796f77262a1161fabc9a587b" kindref="member">SSH_SESSION_STATE_AUTHENTICATING</ref>:</highlight></codeline>
<codeline lineno="437"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="438"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="session_8h_1a9bbd1d5ae11485e27279be6ad461992ca855474fc84a2fb170fcb72546af8eeb8" kindref="member">SSH_SESSION_STATE_ERROR</ref>:</highlight></codeline>
<codeline lineno="439"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">goto</highlight><highlight class="normal"><sp/><ref refid="proxy_8c_1a11614f44ef4d939bdd984953346a7572" kindref="member">error</ref>;</highlight></codeline>
<codeline lineno="440"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">default</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="441"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="priv_8h_1a55177b3e8db90ca9adb435c44281963c" kindref="member">ssh_set_error</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>,<ref refid="libssh_8h_1a036b2b00fb04337a4d06d719d1b62be1a86ff0b2e8da6ad8628efc556b6ce1887" kindref="member">SSH_FATAL</ref>,</highlight><highlight class="stringliteral">&quot;Invalid<sp/>state<sp/>%d&quot;</highlight><highlight class="normal">,<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a6f74d1a1eb6ed715b1073b67caa18460" kindref="member">session_state</ref>);</highlight></codeline>
<codeline lineno="442"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="443"><highlight class="normal"></highlight></codeline>
<codeline lineno="444"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="445"><highlight class="normal"><ref refid="proxy_8c_1a11614f44ef4d939bdd984953346a7572" kindref="member">error</ref>:</highlight></codeline>
<codeline lineno="446"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="socket_8h_1aaf4853539d6ed1c3508cca5a45d557d6" kindref="member">ssh_socket_close</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a3e64318ee32b9880aafbded46fabf81d" kindref="member">socket</ref>);</highlight></codeline>
<codeline lineno="447"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a729d3c7f6ae20cb5a00ac7cd28a630f7" kindref="member">alive</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="448"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a6f74d1a1eb6ed715b1073b67caa18460" kindref="member">session_state</ref>=<ref refid="session_8h_1a9bbd1d5ae11485e27279be6ad461992ca855474fc84a2fb170fcb72546af8eeb8" kindref="member">SSH_SESSION_STATE_ERROR</ref>;</highlight></codeline>
<codeline lineno="449"><highlight class="normal">}</highlight></codeline>
<codeline lineno="450"><highlight class="normal"></highlight></codeline>
<codeline lineno="462" refid="group__libssh__server_1ga4c4c9ace93a9791515090ebc197dd736" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="group__libssh__server_1ga4c4c9ace93a9791515090ebc197dd736" kindref="member">callback_receive_banner</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>*data,<sp/></highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/>len,<sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>*<ref refid="ssh__client_8c_1a14871705f45ccdc5bb9f4549efd8e119" kindref="member">user</ref>)<sp/>{</highlight></codeline>
<codeline lineno="463"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*<ref refid="benchmarks_8c_1aff2566f4c366b48d73479bef43ee4d2e" kindref="member">buffer</ref><sp/>=<sp/>(</highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*)<sp/>data;</highlight></codeline>
<codeline lineno="464"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="structssh__session__struct" kindref="compound">ssh_session</ref><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref><sp/>=<sp/>(<ref refid="libssh_8h_1a02d3754de040612632cdd499c20f92f6" kindref="member">ssh_session</ref>)<sp/><ref refid="ssh__client_8c_1a14871705f45ccdc5bb9f4549efd8e119" kindref="member">user</ref>;</highlight></codeline>
<codeline lineno="465"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*str<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="466"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/>i;</highlight></codeline>
<codeline lineno="467"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>ret=0;</highlight></codeline>
<codeline lineno="468"><highlight class="normal"></highlight></codeline>
<codeline lineno="469"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/>len;<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="470"><highlight class="normal"></highlight><highlight class="preprocessor">#ifdef<sp/>WITH_PCAP</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="471"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;pcap_ctx<sp/>&amp;&amp;<sp/><ref refid="benchmarks_8c_1aff2566f4c366b48d73479bef43ee4d2e" kindref="member">buffer</ref>[i]<sp/>==<sp/></highlight><highlight class="charliteral">&apos;\n&apos;</highlight><highlight class="normal">)<sp/>{</highlight></codeline>
<codeline lineno="472"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ssh_pcap_context_write(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;pcap_ctx,</highlight></codeline>
<codeline lineno="473"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>SSH_PCAP_DIR_IN,</highlight></codeline>
<codeline lineno="474"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="benchmarks_8c_1aff2566f4c366b48d73479bef43ee4d2e" kindref="member">buffer</ref>,</highlight></codeline>
<codeline lineno="475"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>i<sp/>+<sp/>1,</highlight></codeline>
<codeline lineno="476"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>i<sp/>+<sp/>1);</highlight></codeline>
<codeline lineno="477"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="478"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="479"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="benchmarks_8c_1aff2566f4c366b48d73479bef43ee4d2e" kindref="member">buffer</ref>[i]<sp/>==<sp/></highlight><highlight class="charliteral">&apos;\r&apos;</highlight><highlight class="normal">)<sp/>{</highlight></codeline>
<codeline lineno="480"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="benchmarks_8c_1aff2566f4c366b48d73479bef43ee4d2e" kindref="member">buffer</ref>[i]=</highlight><highlight class="charliteral">&apos;\0&apos;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="481"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="482"><highlight class="normal"></highlight></codeline>
<codeline lineno="483"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="benchmarks_8c_1aff2566f4c366b48d73479bef43ee4d2e" kindref="member">buffer</ref>[i]<sp/>==<sp/></highlight><highlight class="charliteral">&apos;\n&apos;</highlight><highlight class="normal">)<sp/>{</highlight></codeline>
<codeline lineno="484"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="benchmarks_8c_1aff2566f4c366b48d73479bef43ee4d2e" kindref="member">buffer</ref>[i]=</highlight><highlight class="charliteral">&apos;\0&apos;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="485"><highlight class="normal"></highlight></codeline>
<codeline lineno="486"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>str<sp/>=<sp/>strdup(<ref refid="benchmarks_8c_1aff2566f4c366b48d73479bef43ee4d2e" kindref="member">buffer</ref>);</highlight></codeline>
<codeline lineno="487"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>number<sp/>of<sp/>bytes<sp/>read<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="488"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ret<sp/>=<sp/>i<sp/>+<sp/>1;</highlight></codeline>
<codeline lineno="489"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1aff7925f04070fc20dc3d9366d7f2f748" kindref="member">clientbanner</ref><sp/>=<sp/>str;</highlight></codeline>
<codeline lineno="490"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a6f74d1a1eb6ed715b1073b67caa18460" kindref="member">session_state</ref><sp/>=<sp/><ref refid="session_8h_1a9bbd1d5ae11485e27279be6ad461992caa688177b6c71d2eaf7af6b9e3b3dea5b" kindref="member">SSH_SESSION_STATE_BANNER_RECEIVED</ref>;</highlight></codeline>
<codeline lineno="491"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="priv_8h_1aa21fd8a7a609329603b7b16da7939fca" kindref="member">SSH_LOG</ref>(<ref refid="group__libssh__log_1ggadf764cbdea00d65edcd07bb9953ad2b7a6445dfe21592d69d9741d319538b6673" kindref="member">SSH_LOG_PACKET</ref>,<sp/></highlight><highlight class="stringliteral">&quot;Received<sp/>banner:<sp/>%s&quot;</highlight><highlight class="normal">,<sp/>str);</highlight></codeline>
<codeline lineno="492"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a4fdde3f498bcf3e0f118335278a8ec5a" kindref="member">ssh_connection_callback</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>);</highlight></codeline>
<codeline lineno="493"><highlight class="normal"></highlight></codeline>
<codeline lineno="494"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>ret;</highlight></codeline>
<codeline lineno="495"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="496"><highlight class="normal"></highlight></codeline>
<codeline lineno="497"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(i<sp/>&gt;<sp/>127)<sp/>{</highlight></codeline>
<codeline lineno="498"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Too<sp/>big<sp/>banner<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="499"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a6f74d1a1eb6ed715b1073b67caa18460" kindref="member">session_state</ref><sp/>=<sp/><ref refid="session_8h_1a9bbd1d5ae11485e27279be6ad461992ca855474fc84a2fb170fcb72546af8eeb8" kindref="member">SSH_SESSION_STATE_ERROR</ref>;</highlight></codeline>
<codeline lineno="500"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="priv_8h_1a55177b3e8db90ca9adb435c44281963c" kindref="member">ssh_set_error</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>,<sp/><ref refid="libssh_8h_1a036b2b00fb04337a4d06d719d1b62be1a86ff0b2e8da6ad8628efc556b6ce1887" kindref="member">SSH_FATAL</ref>,<sp/></highlight><highlight class="stringliteral">&quot;Receiving<sp/>banner:<sp/>too<sp/>large<sp/>banner&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="501"><highlight class="normal"></highlight></codeline>
<codeline lineno="502"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>0;</highlight></codeline>
<codeline lineno="503"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="504"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="505"><highlight class="normal"></highlight></codeline>
<codeline lineno="506"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>ret;</highlight></codeline>
<codeline lineno="507"><highlight class="normal">}</highlight></codeline>
<codeline lineno="508"><highlight class="normal"></highlight></codeline>
<codeline lineno="509"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>returns<sp/>0<sp/>until<sp/>the<sp/>key<sp/>exchange<sp/>is<sp/>not<sp/>finished<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="510" refid="group__libssh__server_1gaa18bae911e9533e48b33f63ac0c24cb6" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="group__libssh__server_1gaa18bae911e9533e48b33f63ac0c24cb6" kindref="member">ssh_server_kex_termination</ref>(</highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>*<ref refid="test__socket_8c_1a73991beba1accdcc64730cb00c146fe2" kindref="member">s</ref>){</highlight></codeline>
<codeline lineno="511"><highlight class="normal"><sp/><sp/><ref refid="structssh__session__struct" kindref="compound">ssh_session</ref><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref><sp/>=<sp/><ref refid="test__socket_8c_1a73991beba1accdcc64730cb00c146fe2" kindref="member">s</ref>;</highlight></codeline>
<codeline lineno="512"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a6f74d1a1eb6ed715b1073b67caa18460" kindref="member">session_state</ref><sp/>!=<sp/><ref refid="session_8h_1a9bbd1d5ae11485e27279be6ad461992ca855474fc84a2fb170fcb72546af8eeb8" kindref="member">SSH_SESSION_STATE_ERROR</ref><sp/>&amp;&amp;</highlight></codeline>
<codeline lineno="513"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a6f74d1a1eb6ed715b1073b67caa18460" kindref="member">session_state</ref><sp/>!=<sp/><ref refid="session_8h_1a9bbd1d5ae11485e27279be6ad461992ca0bf582a8796f77262a1161fabc9a587b" kindref="member">SSH_SESSION_STATE_AUTHENTICATING</ref><sp/>&amp;&amp;</highlight></codeline>
<codeline lineno="514"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a6f74d1a1eb6ed715b1073b67caa18460" kindref="member">session_state</ref><sp/>!=<sp/><ref refid="session_8h_1a9bbd1d5ae11485e27279be6ad461992ca05407079ea8dd73449ac6f9ddbf58084" kindref="member">SSH_SESSION_STATE_DISCONNECTED</ref>)</highlight></codeline>
<codeline lineno="515"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>0;</highlight></codeline>
<codeline lineno="516"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="517"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>1;</highlight></codeline>
<codeline lineno="518"><highlight class="normal">}</highlight></codeline>
<codeline lineno="519"><highlight class="normal"></highlight></codeline>
<codeline lineno="520"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>FIXME:<sp/>auth_methods<sp/>should<sp/>be<sp/>unsigned<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="521" refid="group__libssh__server_1gabbfb96c938e33a8dddebaff29f25e0c6" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="group__libssh__server_1gabbfb96c938e33a8dddebaff29f25e0c6" kindref="member">ssh_set_auth_methods</ref>(<ref refid="structssh__session__struct" kindref="compound">ssh_session</ref><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>auth_methods)</highlight></codeline>
<codeline lineno="522"><highlight class="normal">{</highlight></codeline>
<codeline lineno="523"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>accept<sp/>only<sp/>methods<sp/>in<sp/>range<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="524"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a3d57e01582c0c9099f7f319513321fe8" kindref="member">auth</ref>.<ref refid="structssh__session__struct_1a3e967ac3134cae87dae1f6a794424073" kindref="member">supported_methods</ref><sp/>=<sp/>(uint32_t)auth_methods<sp/>&amp;<sp/>0x3fU;</highlight></codeline>
<codeline lineno="525"><highlight class="normal">}</highlight></codeline>
<codeline lineno="526"><highlight class="normal"></highlight></codeline>
<codeline lineno="527"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>Do<sp/>the<sp/>banner<sp/>and<sp/>key<sp/>exchange<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="528" refid="group__libssh__server_1gab60c37350653eb3b65a99ac089c55830" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="group__libssh__server_1gab60c37350653eb3b65a99ac089c55830" kindref="member">ssh_handle_key_exchange</ref>(<ref refid="structssh__session__struct" kindref="compound">ssh_session</ref><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>)<sp/>{</highlight></codeline>
<codeline lineno="529"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref>;</highlight></codeline>
<codeline lineno="530"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a6f74d1a1eb6ed715b1073b67caa18460" kindref="member">session_state</ref><sp/>!=<sp/><ref refid="session_8h_1a9bbd1d5ae11485e27279be6ad461992ca6e96b3ae323d058e27297e97c01c1d7f" kindref="member">SSH_SESSION_STATE_NONE</ref>)</highlight></codeline>
<codeline lineno="531"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">goto</highlight><highlight class="normal"><sp/>pending;</highlight></codeline>
<codeline lineno="532"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="priv_8h_1aacb791f6b4bb44f93327dee7ab138717" kindref="member">ssh_send_banner</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>,<sp/>1);</highlight></codeline>
<codeline lineno="533"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>&lt;<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="534"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" kindref="member">SSH_ERROR</ref>;</highlight></codeline>
<codeline lineno="535"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="536"><highlight class="normal"></highlight></codeline>
<codeline lineno="537"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a729d3c7f6ae20cb5a00ac7cd28a630f7" kindref="member">alive</ref><sp/>=<sp/>1;</highlight></codeline>
<codeline lineno="538"><highlight class="normal"></highlight></codeline>
<codeline lineno="539"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a4fdde3f498bcf3e0f118335278a8ec5a" kindref="member">ssh_connection_callback</ref><sp/>=<sp/><ref refid="group__libssh__server_1ga6b0057a0346a87ddd9b57bfbbc580d4d" kindref="member">ssh_server_connection_callback</ref>;</highlight></codeline>
<codeline lineno="540"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a6f74d1a1eb6ed715b1073b67caa18460" kindref="member">session_state</ref><sp/>=<sp/><ref refid="session_8h_1a9bbd1d5ae11485e27279be6ad461992ca82652ed2dc1cdfd2c8cdb12a3ab6b703" kindref="member">SSH_SESSION_STATE_SOCKET_CONNECTED</ref>;</highlight></codeline>
<codeline lineno="541"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="socket_8h_1a15a69b474244317cc9401a9a404e7bcc" kindref="member">ssh_socket_set_callbacks</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a3e64318ee32b9880aafbded46fabf81d" kindref="member">socket</ref>,&amp;<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a77c2c8292416988963f37b9723d2f55f" kindref="member">socket_callbacks</ref>);</highlight></codeline>
<codeline lineno="542"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a77c2c8292416988963f37b9723d2f55f" kindref="member">socket_callbacks</ref>.<ref refid="structssh__socket__callbacks__struct_1a73d09c1b2ae438da96c4b3bbfb99c9ad" kindref="member">data</ref>=<ref refid="group__libssh__server_1ga4c4c9ace93a9791515090ebc197dd736" kindref="member">callback_receive_banner</ref>;</highlight></codeline>
<codeline lineno="543"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a77c2c8292416988963f37b9723d2f55f" kindref="member">socket_callbacks</ref>.<ref refid="structssh__socket__callbacks__struct_1ae642ee58e72973ee0802820e46cb777b" kindref="member">exception</ref>=<ref refid="group__libssh__session_1ga2635562d4c0bb8507e9a9f7274ff4729" kindref="member">ssh_socket_exception_callback</ref>;</highlight></codeline>
<codeline lineno="544"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a77c2c8292416988963f37b9723d2f55f" kindref="member">socket_callbacks</ref>.<ref refid="structssh__socket__callbacks__struct_1a21680bc94721a1507e1382e06f731aef" kindref="member">userdata</ref>=<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>;</highlight></codeline>
<codeline lineno="545"><highlight class="normal"></highlight></codeline>
<codeline lineno="546"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="group__libssh__server_1gac8dda51f6f008e42e60d824e2ef2e453" kindref="member">server_set_kex</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>);</highlight></codeline>
<codeline lineno="547"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>&lt;<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="548"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" kindref="member">SSH_ERROR</ref>;</highlight></codeline>
<codeline lineno="549"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="550"><highlight class="normal"><sp/><sp/><sp/><sp/>pending:</highlight></codeline>
<codeline lineno="551"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="group__libssh__session_1ga4b84e1ae757c0d4007a5eefdf4651694" kindref="member">ssh_handle_packets_termination</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>,<sp/><ref refid="session_8h_1a1d6b747c5003e24c3461096c76580b15" kindref="member">SSH_TIMEOUT_USER</ref>,</highlight></codeline>
<codeline lineno="552"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="group__libssh__server_1gaa18bae911e9533e48b33f63ac0c24cb6" kindref="member">ssh_server_kex_termination</ref>,<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>);</highlight></codeline>
<codeline lineno="553"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="priv_8h_1aa21fd8a7a609329603b7b16da7939fca" kindref="member">SSH_LOG</ref>(<ref refid="group__libssh__log_1ggadf764cbdea00d65edcd07bb9953ad2b7a6445dfe21592d69d9741d319538b6673" kindref="member">SSH_LOG_PACKET</ref>,<sp/></highlight><highlight class="stringliteral">&quot;ssh_handle_key_exchange:<sp/>current<sp/>state<sp/>:<sp/>%d&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="554"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a6f74d1a1eb6ed715b1073b67caa18460" kindref="member">session_state</ref>);</highlight></codeline>
<codeline lineno="555"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>!=<sp/><ref refid="libssh_8h_1ac1ee1d1e917456d4760a94a18015377d" kindref="member">SSH_OK</ref>)</highlight></codeline>
<codeline lineno="556"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref>;</highlight></codeline>
<codeline lineno="557"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a6f74d1a1eb6ed715b1073b67caa18460" kindref="member">session_state</ref><sp/>==<sp/><ref refid="session_8h_1a9bbd1d5ae11485e27279be6ad461992ca855474fc84a2fb170fcb72546af8eeb8" kindref="member">SSH_SESSION_STATE_ERROR</ref><sp/>||</highlight></codeline>
<codeline lineno="558"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a6f74d1a1eb6ed715b1073b67caa18460" kindref="member">session_state</ref><sp/>==<sp/><ref refid="session_8h_1a9bbd1d5ae11485e27279be6ad461992ca05407079ea8dd73449ac6f9ddbf58084" kindref="member">SSH_SESSION_STATE_DISCONNECTED</ref>)<sp/>{</highlight></codeline>
<codeline lineno="559"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" kindref="member">SSH_ERROR</ref>;</highlight></codeline>
<codeline lineno="560"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="561"><highlight class="normal"></highlight></codeline>
<codeline lineno="562"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="libssh_8h_1ac1ee1d1e917456d4760a94a18015377d" kindref="member">SSH_OK</ref>;</highlight></codeline>
<codeline lineno="563"><highlight class="normal">}</highlight></codeline>
<codeline lineno="564"><highlight class="normal"></highlight></codeline>
<codeline lineno="565"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>messages<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="566"><highlight class="normal"></highlight></codeline>
<codeline lineno="570" refid="group__libssh__server_1gaa8a38b0ea0e5ee2bce17eab77dfc850c" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="group__libssh__server_1gaa8a38b0ea0e5ee2bce17eab77dfc850c" kindref="member">ssh_auth_reply_default</ref>(<ref refid="structssh__session__struct" kindref="compound">ssh_session</ref><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>,</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>partial)<sp/>{</highlight></codeline>
<codeline lineno="571"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>methods_c[128]<sp/>=<sp/>{0};</highlight></codeline>
<codeline lineno="572"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" kindref="member">SSH_ERROR</ref>;</highlight></codeline>
<codeline lineno="573"><highlight class="normal"></highlight></codeline>
<codeline lineno="574"><highlight class="normal"></highlight></codeline>
<codeline lineno="575"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a3d57e01582c0c9099f7f319513321fe8" kindref="member">auth</ref>.<ref refid="structssh__session__struct_1a3e967ac3134cae87dae1f6a794424073" kindref="member">supported_methods</ref><sp/>==<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="576"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a3d57e01582c0c9099f7f319513321fe8" kindref="member">auth</ref>.<ref refid="structssh__session__struct_1a3e967ac3134cae87dae1f6a794424073" kindref="member">supported_methods</ref><sp/>=<sp/><ref refid="libssh_8h_1aff27d66c1f5ba3871e72b5a61573f44a" kindref="member">SSH_AUTH_METHOD_PUBLICKEY</ref><sp/>|<sp/><ref refid="libssh_8h_1ad10dd2f5826e2d92a30bd8af3404574d" kindref="member">SSH_AUTH_METHOD_PASSWORD</ref>;</highlight></codeline>
<codeline lineno="577"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="578"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a3d57e01582c0c9099f7f319513321fe8" kindref="member">auth</ref>.<ref refid="structssh__session__struct_1a3e967ac3134cae87dae1f6a794424073" kindref="member">supported_methods</ref><sp/>&amp;<sp/><ref refid="libssh_8h_1aff27d66c1f5ba3871e72b5a61573f44a" kindref="member">SSH_AUTH_METHOD_PUBLICKEY</ref>)<sp/>{</highlight></codeline>
<codeline lineno="579"><highlight class="normal"><sp/><sp/><sp/><sp/>strncat(methods_c,<sp/></highlight><highlight class="stringliteral">&quot;publickey,&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="580"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(methods_c)<sp/>-<sp/>strlen(methods_c)<sp/>-<sp/>1);</highlight></codeline>
<codeline lineno="581"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="582"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a3d57e01582c0c9099f7f319513321fe8" kindref="member">auth</ref>.<ref refid="structssh__session__struct_1a3e967ac3134cae87dae1f6a794424073" kindref="member">supported_methods</ref><sp/>&amp;<sp/><ref refid="libssh_8h_1aa17667dad32ec77112a201b1b4b858e8" kindref="member">SSH_AUTH_METHOD_GSSAPI_MIC</ref>){</highlight></codeline>
<codeline lineno="583"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>strncat(methods_c,</highlight><highlight class="stringliteral">&quot;gssapi-with-mic,&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="584"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(methods_c)<sp/>-<sp/>strlen(methods_c)<sp/>-<sp/>1);</highlight></codeline>
<codeline lineno="585"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="586"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a3d57e01582c0c9099f7f319513321fe8" kindref="member">auth</ref>.<ref refid="structssh__session__struct_1a3e967ac3134cae87dae1f6a794424073" kindref="member">supported_methods</ref><sp/>&amp;<sp/><ref refid="libssh_8h_1a4c64484fdce4756309799d0e2a4e926a" kindref="member">SSH_AUTH_METHOD_INTERACTIVE</ref>)<sp/>{</highlight></codeline>
<codeline lineno="587"><highlight class="normal"><sp/><sp/><sp/><sp/>strncat(methods_c,<sp/></highlight><highlight class="stringliteral">&quot;keyboard-interactive,&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="588"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(methods_c)<sp/>-<sp/>strlen(methods_c)<sp/>-<sp/>1);</highlight></codeline>
<codeline lineno="589"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="590"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a3d57e01582c0c9099f7f319513321fe8" kindref="member">auth</ref>.<ref refid="structssh__session__struct_1a3e967ac3134cae87dae1f6a794424073" kindref="member">supported_methods</ref><sp/>&amp;<sp/><ref refid="libssh_8h_1ad10dd2f5826e2d92a30bd8af3404574d" kindref="member">SSH_AUTH_METHOD_PASSWORD</ref>)<sp/>{</highlight></codeline>
<codeline lineno="591"><highlight class="normal"><sp/><sp/><sp/><sp/>strncat(methods_c,<sp/></highlight><highlight class="stringliteral">&quot;password,&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="592"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(methods_c)<sp/>-<sp/>strlen(methods_c)<sp/>-<sp/>1);</highlight></codeline>
<codeline lineno="593"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="594"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a3d57e01582c0c9099f7f319513321fe8" kindref="member">auth</ref>.<ref refid="structssh__session__struct_1a3e967ac3134cae87dae1f6a794424073" kindref="member">supported_methods</ref><sp/>&amp;<sp/><ref refid="libssh_8h_1a47af3117d9ab19c61afeebfbfac8cfc4" kindref="member">SSH_AUTH_METHOD_HOSTBASED</ref>)<sp/>{</highlight></codeline>
<codeline lineno="595"><highlight class="normal"><sp/><sp/><sp/><sp/>strncat(methods_c,<sp/></highlight><highlight class="stringliteral">&quot;hostbased,&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="596"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(methods_c)<sp/>-<sp/>strlen(methods_c)<sp/>-<sp/>1);</highlight></codeline>
<codeline lineno="597"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="598"><highlight class="normal"></highlight></codeline>
<codeline lineno="599"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(methods_c[0]<sp/>==<sp/></highlight><highlight class="charliteral">&apos;\0&apos;</highlight><highlight class="normal"><sp/>||<sp/>methods_c[strlen(methods_c)-1]<sp/>!=<sp/></highlight><highlight class="charliteral">&apos;,&apos;</highlight><highlight class="normal">)<sp/>{</highlight></codeline>
<codeline lineno="600"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" kindref="member">SSH_ERROR</ref>;</highlight></codeline>
<codeline lineno="601"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="602"><highlight class="normal"></highlight></codeline>
<codeline lineno="603"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">/*<sp/>Strip<sp/>the<sp/>comma.<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="604"><highlight class="normal"><sp/><sp/>methods_c[strlen(methods_c)<sp/>-<sp/>1]<sp/>=<sp/></highlight><highlight class="charliteral">&apos;\0&apos;</highlight><highlight class="normal">;<sp/></highlight><highlight class="comment">//<sp/>strip<sp/>the<sp/>comma.<sp/>We<sp/>are<sp/>sure<sp/>there<sp/>is<sp/>at</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="605"><highlight class="normal"></highlight></codeline>
<codeline lineno="606"><highlight class="normal"><sp/><sp/><ref refid="priv_8h_1aa21fd8a7a609329603b7b16da7939fca" kindref="member">SSH_LOG</ref>(<ref refid="group__libssh__log_1ggadf764cbdea00d65edcd07bb9953ad2b7a6445dfe21592d69d9741d319538b6673" kindref="member">SSH_LOG_PACKET</ref>,</highlight></codeline>
<codeline lineno="607"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Sending<sp/>a<sp/>auth<sp/>failure.<sp/>methods<sp/>that<sp/>can<sp/>continue:<sp/>%s&quot;</highlight><highlight class="normal">,<sp/>methods_c);</highlight></codeline>
<codeline lineno="608"><highlight class="normal"></highlight></codeline>
<codeline lineno="609"><highlight class="normal"><sp/><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="buffer_8h_1ae17848a86043f0abfc60c1c4f6126ccd" kindref="member">ssh_buffer_pack</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1af0aed60c1e529bbfdcb483fd80bf98a0" kindref="member">out_buffer</ref>,</highlight></codeline>
<codeline lineno="610"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;bsb&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="611"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ssh2_8h_1a59f13bc349811a5beda02b13b2b3cd48" kindref="member">SSH2_MSG_USERAUTH_FAILURE</ref>,</highlight></codeline>
<codeline lineno="612"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>methods_c,</highlight></codeline>
<codeline lineno="613"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>partial<sp/>?<sp/>1<sp/>:<sp/>0);</highlight></codeline>
<codeline lineno="614"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>!=<sp/><ref refid="libssh_8h_1ac1ee1d1e917456d4760a94a18015377d" kindref="member">SSH_OK</ref>){</highlight></codeline>
<codeline lineno="615"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="priv_8h_1ae280c413c792e04237f000841ac8ce44" kindref="member">ssh_set_error_oom</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>);</highlight></codeline>
<codeline lineno="616"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" kindref="member">SSH_ERROR</ref>;</highlight></codeline>
<codeline lineno="617"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="618"><highlight class="normal"><sp/><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="packet_8h_1a7e6c7ed74c23ace432476aa8a6841140" kindref="member">ssh_packet_send</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>);</highlight></codeline>
<codeline lineno="619"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref>;</highlight></codeline>
<codeline lineno="620"><highlight class="normal">}</highlight></codeline>
<codeline lineno="621"><highlight class="normal"></highlight></codeline>
<codeline lineno="622" refid="group__libssh__server_1gaf7984c469e61e9d5f05c80d967970a1c" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="group__libssh__server_1gaf7984c469e61e9d5f05c80d967970a1c" kindref="member">ssh_message_channel_request_open_reply_default</ref>(<ref refid="structssh__message__struct" kindref="compound">ssh_message</ref><sp/>msg)<sp/>{</highlight></codeline>
<codeline lineno="623"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref>;</highlight></codeline>
<codeline lineno="624"><highlight class="normal"></highlight></codeline>
<codeline lineno="625"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="priv_8h_1aa21fd8a7a609329603b7b16da7939fca" kindref="member">SSH_LOG</ref>(<ref refid="group__libssh__log_1ggadf764cbdea00d65edcd07bb9953ad2b7a926c933f61d1afa64003c1cc66f6a01c" kindref="member">SSH_LOG_FUNCTIONS</ref>,<sp/></highlight><highlight class="stringliteral">&quot;Refusing<sp/>a<sp/>channel&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="626"><highlight class="normal"></highlight></codeline>
<codeline lineno="627"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="buffer_8h_1ae17848a86043f0abfc60c1c4f6126ccd" kindref="member">ssh_buffer_pack</ref>(msg-&gt;<ref refid="structssh__message__struct_1aceb641c0b1e8eaaa91965f3bf5025ad3" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1af0aed60c1e529bbfdcb483fd80bf98a0" kindref="member">out_buffer</ref>,</highlight></codeline>
<codeline lineno="628"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;bdddd&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="629"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ssh2_8h_1ac045176d5273382c572e625584afdef0" kindref="member">SSH2_MSG_CHANNEL_OPEN_FAILURE</ref>,</highlight></codeline>
<codeline lineno="630"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>msg-&gt;<ref refid="structssh__message__struct_1a7579d1e2cd4136f2e152985d0018777f" kindref="member">channel_request_open</ref>.<ref refid="structssh__channel__request__open_1a2ac8ee1b20572c9b13d3ccd3007d364d" kindref="member">sender</ref>,</highlight></codeline>
<codeline lineno="631"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ssh2_8h_1ab9d4094d3bba6175cdcc312fc4867e3b" kindref="member">SSH2_OPEN_ADMINISTRATIVELY_PROHIBITED</ref>,</highlight></codeline>
<codeline lineno="632"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0,<sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>reason<sp/>is<sp/>empty<sp/>string<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="633"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0);<sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>language<sp/>string<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="634"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>!=<sp/><ref refid="libssh_8h_1ac1ee1d1e917456d4760a94a18015377d" kindref="member">SSH_OK</ref>){</highlight></codeline>
<codeline lineno="635"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="priv_8h_1ae280c413c792e04237f000841ac8ce44" kindref="member">ssh_set_error_oom</ref>(msg-&gt;<ref refid="structssh__message__struct_1aceb641c0b1e8eaaa91965f3bf5025ad3" kindref="member">session</ref>);</highlight></codeline>
<codeline lineno="636"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" kindref="member">SSH_ERROR</ref>;</highlight></codeline>
<codeline lineno="637"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="638"><highlight class="normal"></highlight></codeline>
<codeline lineno="639"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="packet_8h_1a7e6c7ed74c23ace432476aa8a6841140" kindref="member">ssh_packet_send</ref>(msg-&gt;<ref refid="structssh__message__struct_1aceb641c0b1e8eaaa91965f3bf5025ad3" kindref="member">session</ref>);</highlight></codeline>
<codeline lineno="640"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref>;</highlight></codeline>
<codeline lineno="641"><highlight class="normal">}</highlight></codeline>
<codeline lineno="642"><highlight class="normal"></highlight></codeline>
<codeline lineno="643" refid="group__libssh__server_1ga79d82cfe686f9389bc74b95533f976d7" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="group__libssh__server_1ga79d82cfe686f9389bc74b95533f976d7" kindref="member">ssh_message_channel_request_reply_default</ref>(<ref refid="structssh__message__struct" kindref="compound">ssh_message</ref><sp/>msg)<sp/>{</highlight></codeline>
<codeline lineno="644"><highlight class="normal"><sp/><sp/>uint32_t<sp/>channel;</highlight></codeline>
<codeline lineno="645"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref>;</highlight></codeline>
<codeline lineno="646"><highlight class="normal"></highlight></codeline>
<codeline lineno="647"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(msg-&gt;<ref refid="structssh__message__struct_1a988570288e6e64eca3bbb18c1733dd75" kindref="member">channel_request</ref>.<ref refid="structssh__channel__request_1a886d76c450019899f0d07a52cca48716" kindref="member">want_reply</ref>)<sp/>{</highlight></codeline>
<codeline lineno="648"><highlight class="normal"><sp/><sp/><sp/><sp/>channel<sp/>=<sp/>msg-&gt;<ref refid="structssh__message__struct_1a988570288e6e64eca3bbb18c1733dd75" kindref="member">channel_request</ref>.<ref refid="structssh__channel__request_1a916ad8e5354e27dbeebdd53303afac4b" kindref="member">channel</ref>-&gt;<ref refid="structssh__channel__struct_1aa553acf6d12fffb1ae18b11196c2c0e9" kindref="member">remote_channel</ref>;</highlight></codeline>
<codeline lineno="649"><highlight class="normal"></highlight></codeline>
<codeline lineno="650"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="priv_8h_1aa21fd8a7a609329603b7b16da7939fca" kindref="member">SSH_LOG</ref>(<ref refid="group__libssh__log_1ggadf764cbdea00d65edcd07bb9953ad2b7a6445dfe21592d69d9741d319538b6673" kindref="member">SSH_LOG_PACKET</ref>,</highlight></codeline>
<codeline lineno="651"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Sending<sp/>a<sp/>default<sp/>channel_request<sp/>denied<sp/>to<sp/>channel<sp/>%d&quot;</highlight><highlight class="normal">,<sp/>channel);</highlight></codeline>
<codeline lineno="652"><highlight class="normal"></highlight></codeline>
<codeline lineno="653"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="buffer_8h_1ae17848a86043f0abfc60c1c4f6126ccd" kindref="member">ssh_buffer_pack</ref>(msg-&gt;<ref refid="structssh__message__struct_1aceb641c0b1e8eaaa91965f3bf5025ad3" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1af0aed60c1e529bbfdcb483fd80bf98a0" kindref="member">out_buffer</ref>,</highlight></codeline>
<codeline lineno="654"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;bd&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="655"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ssh2_8h_1a2b23fd7211615f33319a267d1728c785" kindref="member">SSH2_MSG_CHANNEL_FAILURE</ref>,</highlight></codeline>
<codeline lineno="656"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>channel);</highlight></codeline>
<codeline lineno="657"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>!=<sp/><ref refid="libssh_8h_1ac1ee1d1e917456d4760a94a18015377d" kindref="member">SSH_OK</ref>){</highlight></codeline>
<codeline lineno="658"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="priv_8h_1ae280c413c792e04237f000841ac8ce44" kindref="member">ssh_set_error_oom</ref>(msg-&gt;<ref refid="structssh__message__struct_1aceb641c0b1e8eaaa91965f3bf5025ad3" kindref="member">session</ref>);</highlight></codeline>
<codeline lineno="659"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" kindref="member">SSH_ERROR</ref>;</highlight></codeline>
<codeline lineno="660"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="661"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="packet_8h_1a7e6c7ed74c23ace432476aa8a6841140" kindref="member">ssh_packet_send</ref>(msg-&gt;<ref refid="structssh__message__struct_1aceb641c0b1e8eaaa91965f3bf5025ad3" kindref="member">session</ref>);</highlight></codeline>
<codeline lineno="662"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="663"><highlight class="normal"></highlight></codeline>
<codeline lineno="664"><highlight class="normal"><sp/><sp/><ref refid="priv_8h_1aa21fd8a7a609329603b7b16da7939fca" kindref="member">SSH_LOG</ref>(<ref refid="group__libssh__log_1ggadf764cbdea00d65edcd07bb9953ad2b7a6445dfe21592d69d9741d319538b6673" kindref="member">SSH_LOG_PACKET</ref>,</highlight></codeline>
<codeline lineno="665"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;The<sp/>client<sp/>doesn&apos;t<sp/>want<sp/>to<sp/>know<sp/>the<sp/>request<sp/>failed!&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="666"><highlight class="normal"></highlight></codeline>
<codeline lineno="667"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="libssh_8h_1ac1ee1d1e917456d4760a94a18015377d" kindref="member">SSH_OK</ref>;</highlight></codeline>
<codeline lineno="668"><highlight class="normal">}</highlight></codeline>
<codeline lineno="669"><highlight class="normal"></highlight></codeline>
<codeline lineno="670" refid="group__libssh__server_1ga6e63796d916bcc9a259e9863b2424cce" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="group__libssh__server_1ga6e63796d916bcc9a259e9863b2424cce" kindref="member">ssh_message_service_request_reply_default</ref>(<ref refid="structssh__message__struct" kindref="compound">ssh_message</ref><sp/>msg)<sp/>{</highlight></codeline>
<codeline lineno="671"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">/*<sp/>The<sp/>only<sp/>return<sp/>code<sp/>accepted<sp/>by<sp/>specifications<sp/>are<sp/>success<sp/>or<sp/>disconnect<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="672"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="group__libssh__server_1gad0bd348b84300149f017f5abbaff38f5" kindref="member">ssh_message_service_reply_success</ref>(msg);</highlight></codeline>
<codeline lineno="673"><highlight class="normal">}</highlight></codeline>
<codeline lineno="674"><highlight class="normal"></highlight></codeline>
<codeline lineno="675" refid="group__libssh__server_1gad0bd348b84300149f017f5abbaff38f5" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="group__libssh__server_1gad0bd348b84300149f017f5abbaff38f5" kindref="member">ssh_message_service_reply_success</ref>(<ref refid="structssh__message__struct" kindref="compound">ssh_message</ref><sp/>msg)<sp/>{</highlight></codeline>
<codeline lineno="676"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="structssh__session__struct" kindref="compound">ssh_session</ref><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>;</highlight></codeline>
<codeline lineno="677"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref>;</highlight></codeline>
<codeline lineno="678"><highlight class="normal"></highlight></codeline>
<codeline lineno="679"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(msg<sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="680"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" kindref="member">SSH_ERROR</ref>;</highlight></codeline>
<codeline lineno="681"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="682"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref><sp/>=<sp/>msg-&gt;<ref refid="structssh__message__struct_1aceb641c0b1e8eaaa91965f3bf5025ad3" kindref="member">session</ref>;</highlight></codeline>
<codeline lineno="683"><highlight class="normal"></highlight></codeline>
<codeline lineno="684"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="priv_8h_1aa21fd8a7a609329603b7b16da7939fca" kindref="member">SSH_LOG</ref>(<ref refid="group__libssh__log_1ggadf764cbdea00d65edcd07bb9953ad2b7a6445dfe21592d69d9741d319538b6673" kindref="member">SSH_LOG_PACKET</ref>,</highlight></codeline>
<codeline lineno="685"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Sending<sp/>a<sp/>SERVICE_ACCEPT<sp/>for<sp/>service<sp/>%s&quot;</highlight><highlight class="normal">,<sp/>msg-&gt;<ref refid="structssh__message__struct_1ad604523f1d9456b8de05bdd34f2184d2" kindref="member">service_request</ref>.<ref refid="structssh__service__request_1a86553bc161bc0e98d52d51ad47ef36db" kindref="member">service</ref>);</highlight></codeline>
<codeline lineno="686"><highlight class="normal"></highlight></codeline>
<codeline lineno="687"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="buffer_8h_1ae17848a86043f0abfc60c1c4f6126ccd" kindref="member">ssh_buffer_pack</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1af0aed60c1e529bbfdcb483fd80bf98a0" kindref="member">out_buffer</ref>,</highlight></codeline>
<codeline lineno="688"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;bs&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="689"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ssh2_8h_1a1b2cfc651c2bf6096c55f5113f3e7cdd" kindref="member">SSH2_MSG_SERVICE_ACCEPT</ref>,</highlight></codeline>
<codeline lineno="690"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>msg-&gt;<ref refid="structssh__message__struct_1ad604523f1d9456b8de05bdd34f2184d2" kindref="member">service_request</ref>.<ref refid="structssh__service__request_1a86553bc161bc0e98d52d51ad47ef36db" kindref="member">service</ref>);</highlight></codeline>
<codeline lineno="691"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>!=<sp/><ref refid="libssh_8h_1ac1ee1d1e917456d4760a94a18015377d" kindref="member">SSH_OK</ref>){</highlight></codeline>
<codeline lineno="692"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="priv_8h_1ae280c413c792e04237f000841ac8ce44" kindref="member">ssh_set_error_oom</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>);</highlight></codeline>
<codeline lineno="693"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" kindref="member">SSH_ERROR</ref>;</highlight></codeline>
<codeline lineno="694"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="695"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="packet_8h_1a7e6c7ed74c23ace432476aa8a6841140" kindref="member">ssh_packet_send</ref>(msg-&gt;<ref refid="structssh__message__struct_1aceb641c0b1e8eaaa91965f3bf5025ad3" kindref="member">session</ref>);</highlight></codeline>
<codeline lineno="696"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref>;</highlight></codeline>
<codeline lineno="697"><highlight class="normal">}</highlight></codeline>
<codeline lineno="698"><highlight class="normal"></highlight></codeline>
<codeline lineno="699" refid="group__libssh__server_1ga9c09466e299aff371b2fba996054a6a2" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="group__libssh__server_1ga9c09466e299aff371b2fba996054a6a2" kindref="member">ssh_message_global_request_reply_success</ref>(<ref refid="structssh__message__struct" kindref="compound">ssh_message</ref><sp/>msg,<sp/>uint16_t<sp/>bound_port)<sp/>{</highlight></codeline>
<codeline lineno="700"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref>;</highlight></codeline>
<codeline lineno="701"><highlight class="normal"></highlight></codeline>
<codeline lineno="702"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="priv_8h_1aa21fd8a7a609329603b7b16da7939fca" kindref="member">SSH_LOG</ref>(<ref refid="group__libssh__log_1ggadf764cbdea00d65edcd07bb9953ad2b7a926c933f61d1afa64003c1cc66f6a01c" kindref="member">SSH_LOG_FUNCTIONS</ref>,<sp/></highlight><highlight class="stringliteral">&quot;Accepting<sp/>a<sp/>global<sp/>request&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="703"><highlight class="normal"></highlight></codeline>
<codeline lineno="704"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(msg-&gt;<ref refid="structssh__message__struct_1a76853b41d044d79fac0269c051507995" kindref="member">global_request</ref>.<ref refid="structssh__global__request_1ac649e9fb0003f8161f6ea366c2b320a2" kindref="member">want_reply</ref>)<sp/>{</highlight></codeline>
<codeline lineno="705"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="buffer_8h_1a25dc9ca6178465fb850de52b30e2add6" kindref="member">ssh_buffer_add_u8</ref>(msg-&gt;<ref refid="structssh__message__struct_1aceb641c0b1e8eaaa91965f3bf5025ad3" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1af0aed60c1e529bbfdcb483fd80bf98a0" kindref="member">out_buffer</ref></highlight></codeline>
<codeline lineno="706"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>,<sp/><ref refid="ssh2_8h_1a6832b00e0e100b77a86a55f91c513441" kindref="member">SSH2_MSG_REQUEST_SUCCESS</ref>)<sp/>&lt;<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="707"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">goto</highlight><highlight class="normal"><sp/><ref refid="proxy_8c_1a11614f44ef4d939bdd984953346a7572" kindref="member">error</ref>;</highlight></codeline>
<codeline lineno="708"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="709"><highlight class="normal"></highlight></codeline>
<codeline lineno="710"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(msg-&gt;<ref refid="structssh__message__struct_1a76853b41d044d79fac0269c051507995" kindref="member">global_request</ref>.<ref refid="structssh__global__request_1a8eddd04a65fd218bac1e40488091b7fd" kindref="member">type</ref><sp/>==<sp/><ref refid="libssh_8h_1a7b5a4b48ef3802d694bea0a5eae4d7e4ac06ca985ccb40b3d3d365b36ef4f8142" kindref="member">SSH_GLOBAL_REQUEST_TCPIP_FORWARD</ref><sp/></highlight></codeline>
<codeline lineno="711"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&amp;&amp;<sp/>msg-&gt;<ref refid="structssh__message__struct_1a76853b41d044d79fac0269c051507995" kindref="member">global_request</ref>.<ref refid="structssh__global__request_1a599709a2aca163c961c8d224292a13b5" kindref="member">bind_port</ref><sp/>==<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="712"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="buffer_8h_1ae17848a86043f0abfc60c1c4f6126ccd" kindref="member">ssh_buffer_pack</ref>(msg-&gt;<ref refid="structssh__message__struct_1aceb641c0b1e8eaaa91965f3bf5025ad3" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1af0aed60c1e529bbfdcb483fd80bf98a0" kindref="member">out_buffer</ref>,<sp/></highlight><highlight class="stringliteral">&quot;d&quot;</highlight><highlight class="normal">,<sp/>bound_port);</highlight></codeline>
<codeline lineno="713"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>!=<sp/><ref refid="libssh_8h_1ac1ee1d1e917456d4760a94a18015377d" kindref="member">SSH_OK</ref>)<sp/>{</highlight></codeline>
<codeline lineno="714"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="priv_8h_1ae280c413c792e04237f000841ac8ce44" kindref="member">ssh_set_error_oom</ref>(msg-&gt;<ref refid="structssh__message__struct_1aceb641c0b1e8eaaa91965f3bf5025ad3" kindref="member">session</ref>);</highlight></codeline>
<codeline lineno="715"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">goto</highlight><highlight class="normal"><sp/><ref refid="proxy_8c_1a11614f44ef4d939bdd984953346a7572" kindref="member">error</ref>;</highlight></codeline>
<codeline lineno="716"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="717"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="718"><highlight class="normal"></highlight></codeline>
<codeline lineno="719"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="packet_8h_1a7e6c7ed74c23ace432476aa8a6841140" kindref="member">ssh_packet_send</ref>(msg-&gt;<ref refid="structssh__message__struct_1aceb641c0b1e8eaaa91965f3bf5025ad3" kindref="member">session</ref>);</highlight></codeline>
<codeline lineno="720"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="721"><highlight class="normal"></highlight></codeline>
<codeline lineno="722"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(msg-&gt;<ref refid="structssh__message__struct_1a76853b41d044d79fac0269c051507995" kindref="member">global_request</ref>.<ref refid="structssh__global__request_1a8eddd04a65fd218bac1e40488091b7fd" kindref="member">type</ref><sp/>==<sp/><ref refid="libssh_8h_1a7b5a4b48ef3802d694bea0a5eae4d7e4ac06ca985ccb40b3d3d365b36ef4f8142" kindref="member">SSH_GLOBAL_REQUEST_TCPIP_FORWARD</ref><sp/></highlight></codeline>
<codeline lineno="723"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&amp;&amp;<sp/>msg-&gt;<ref refid="structssh__message__struct_1a76853b41d044d79fac0269c051507995" kindref="member">global_request</ref>.<ref refid="structssh__global__request_1a599709a2aca163c961c8d224292a13b5" kindref="member">bind_port</ref><sp/>==<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="724"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="priv_8h_1aa21fd8a7a609329603b7b16da7939fca" kindref="member">SSH_LOG</ref>(<ref refid="group__libssh__log_1ggadf764cbdea00d65edcd07bb9953ad2b7a6445dfe21592d69d9741d319538b6673" kindref="member">SSH_LOG_PACKET</ref>,</highlight></codeline>
<codeline lineno="725"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;The<sp/>client<sp/>doesn&apos;t<sp/>want<sp/>to<sp/>know<sp/>the<sp/>remote<sp/>port!&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="726"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="727"><highlight class="normal"></highlight></codeline>
<codeline lineno="728"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="libssh_8h_1ac1ee1d1e917456d4760a94a18015377d" kindref="member">SSH_OK</ref>;</highlight></codeline>
<codeline lineno="729"><highlight class="normal"><ref refid="proxy_8c_1a11614f44ef4d939bdd984953346a7572" kindref="member">error</ref>:</highlight></codeline>
<codeline lineno="730"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" kindref="member">SSH_ERROR</ref>;</highlight></codeline>
<codeline lineno="731"><highlight class="normal">}</highlight></codeline>
<codeline lineno="732"><highlight class="normal"></highlight></codeline>
<codeline lineno="733" refid="group__libssh__server_1ga518a6b12d13cb2f4d74e261e43fc0129" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="group__libssh__server_1ga518a6b12d13cb2f4d74e261e43fc0129" kindref="member">ssh_message_global_request_reply_default</ref>(<ref refid="structssh__message__struct" kindref="compound">ssh_message</ref><sp/>msg)<sp/>{</highlight></codeline>
<codeline lineno="734"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="priv_8h_1aa21fd8a7a609329603b7b16da7939fca" kindref="member">SSH_LOG</ref>(<ref refid="group__libssh__log_1ggadf764cbdea00d65edcd07bb9953ad2b7a926c933f61d1afa64003c1cc66f6a01c" kindref="member">SSH_LOG_FUNCTIONS</ref>,<sp/></highlight><highlight class="stringliteral">&quot;Refusing<sp/>a<sp/>global<sp/>request&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="735"><highlight class="normal"></highlight></codeline>
<codeline lineno="736"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(msg-&gt;<ref refid="structssh__message__struct_1a76853b41d044d79fac0269c051507995" kindref="member">global_request</ref>.<ref refid="structssh__global__request_1ac649e9fb0003f8161f6ea366c2b320a2" kindref="member">want_reply</ref>)<sp/>{</highlight></codeline>
<codeline lineno="737"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="buffer_8h_1a25dc9ca6178465fb850de52b30e2add6" kindref="member">ssh_buffer_add_u8</ref>(msg-&gt;<ref refid="structssh__message__struct_1aceb641c0b1e8eaaa91965f3bf5025ad3" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1af0aed60c1e529bbfdcb483fd80bf98a0" kindref="member">out_buffer</ref></highlight></codeline>
<codeline lineno="738"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>,<sp/><ref refid="ssh2_8h_1a2bcaf3f5c36b9f657520dca8376ca02b" kindref="member">SSH2_MSG_REQUEST_FAILURE</ref>)<sp/>&lt;<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="739"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">goto</highlight><highlight class="normal"><sp/><ref refid="proxy_8c_1a11614f44ef4d939bdd984953346a7572" kindref="member">error</ref>;</highlight></codeline>
<codeline lineno="740"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="741"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="packet_8h_1a7e6c7ed74c23ace432476aa8a6841140" kindref="member">ssh_packet_send</ref>(msg-&gt;<ref refid="structssh__message__struct_1aceb641c0b1e8eaaa91965f3bf5025ad3" kindref="member">session</ref>);</highlight></codeline>
<codeline lineno="742"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="743"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="priv_8h_1aa21fd8a7a609329603b7b16da7939fca" kindref="member">SSH_LOG</ref>(<ref refid="group__libssh__log_1ggadf764cbdea00d65edcd07bb9953ad2b7a6445dfe21592d69d9741d319538b6673" kindref="member">SSH_LOG_PACKET</ref>,</highlight></codeline>
<codeline lineno="744"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;The<sp/>client<sp/>doesn&apos;t<sp/>want<sp/>to<sp/>know<sp/>the<sp/>request<sp/>failed!&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="745"><highlight class="normal"></highlight></codeline>
<codeline lineno="746"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="libssh_8h_1ac1ee1d1e917456d4760a94a18015377d" kindref="member">SSH_OK</ref>;</highlight></codeline>
<codeline lineno="747"><highlight class="normal"><ref refid="proxy_8c_1a11614f44ef4d939bdd984953346a7572" kindref="member">error</ref>:</highlight></codeline>
<codeline lineno="748"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" kindref="member">SSH_ERROR</ref>;</highlight></codeline>
<codeline lineno="749"><highlight class="normal">}</highlight></codeline>
<codeline lineno="750"><highlight class="normal"></highlight></codeline>
<codeline lineno="751" refid="group__libssh__server_1ga6e78c8f369333289d245931deed92573" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="group__libssh__server_1ga6e78c8f369333289d245931deed92573" kindref="member">ssh_message_reply_default</ref>(<ref refid="structssh__message__struct" kindref="compound">ssh_message</ref><sp/>msg)<sp/>{</highlight></codeline>
<codeline lineno="752"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(msg<sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="753"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>-1;</highlight></codeline>
<codeline lineno="754"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="755"><highlight class="normal"></highlight></codeline>
<codeline lineno="756"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">switch</highlight><highlight class="normal">(msg-&gt;<ref refid="structssh__message__struct_1a38c048b3819ac803f267ccdaa7b214f0" kindref="member">type</ref>)<sp/>{</highlight></codeline>
<codeline lineno="757"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="libssh_8h_1a9484ca6b9fd0460e31a80fb8d0e81da6a1c090b9498aea8b24934ba291be6fa78" kindref="member">SSH_REQUEST_AUTH</ref>:</highlight></codeline>
<codeline lineno="758"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="group__libssh__server_1gaa8a38b0ea0e5ee2bce17eab77dfc850c" kindref="member">ssh_auth_reply_default</ref>(msg-&gt;<ref refid="structssh__message__struct_1aceb641c0b1e8eaaa91965f3bf5025ad3" kindref="member">session</ref>,<sp/>0);</highlight></codeline>
<codeline lineno="759"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="libssh_8h_1a9484ca6b9fd0460e31a80fb8d0e81da6a55349816be9b38f7187447782dcd8d06" kindref="member">SSH_REQUEST_CHANNEL_OPEN</ref>:</highlight></codeline>
<codeline lineno="760"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="group__libssh__server_1gaf7984c469e61e9d5f05c80d967970a1c" kindref="member">ssh_message_channel_request_open_reply_default</ref>(msg);</highlight></codeline>
<codeline lineno="761"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="libssh_8h_1a9484ca6b9fd0460e31a80fb8d0e81da6afe34a2aeab2f735c3590510fa9db0261" kindref="member">SSH_REQUEST_CHANNEL</ref>:</highlight></codeline>
<codeline lineno="762"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="group__libssh__server_1ga79d82cfe686f9389bc74b95533f976d7" kindref="member">ssh_message_channel_request_reply_default</ref>(msg);</highlight></codeline>
<codeline lineno="763"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="libssh_8h_1a9484ca6b9fd0460e31a80fb8d0e81da6a427a659a7cd20a5cd4a4edf103322fe3" kindref="member">SSH_REQUEST_SERVICE</ref>:</highlight></codeline>
<codeline lineno="764"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="group__libssh__server_1ga6e63796d916bcc9a259e9863b2424cce" kindref="member">ssh_message_service_request_reply_default</ref>(msg);</highlight></codeline>
<codeline lineno="765"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="libssh_8h_1a9484ca6b9fd0460e31a80fb8d0e81da6a7f406af946bb752fc97dc7f801b0d085" kindref="member">SSH_REQUEST_GLOBAL</ref>:</highlight></codeline>
<codeline lineno="766"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="group__libssh__server_1ga518a6b12d13cb2f4d74e261e43fc0129" kindref="member">ssh_message_global_request_reply_default</ref>(msg);</highlight></codeline>
<codeline lineno="767"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">default</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="768"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="priv_8h_1aa21fd8a7a609329603b7b16da7939fca" kindref="member">SSH_LOG</ref>(<ref refid="group__libssh__log_1ggadf764cbdea00d65edcd07bb9953ad2b7a6445dfe21592d69d9741d319538b6673" kindref="member">SSH_LOG_PACKET</ref>,</highlight></codeline>
<codeline lineno="769"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Don&apos;t<sp/>know<sp/>what<sp/>to<sp/>default<sp/>reply<sp/>to<sp/>%d<sp/>type&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="770"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>msg-&gt;<ref refid="structssh__message__struct_1a38c048b3819ac803f267ccdaa7b214f0" kindref="member">type</ref>);</highlight></codeline>
<codeline lineno="771"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="772"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="773"><highlight class="normal"></highlight></codeline>
<codeline lineno="774"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>-1;</highlight></codeline>
<codeline lineno="775"><highlight class="normal">}</highlight></codeline>
<codeline lineno="776"><highlight class="normal"></highlight></codeline>
<codeline lineno="777" refid="group__libssh__server_1ga9f9dedae252c1b786b1213c84ac90baa" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*<ref refid="group__libssh__server_1ga9f9dedae252c1b786b1213c84ac90baa" kindref="member">ssh_message_service_service</ref>(<ref refid="structssh__message__struct" kindref="compound">ssh_message</ref><sp/>msg){</highlight></codeline>
<codeline lineno="778"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(msg<sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="779"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>NULL;</highlight></codeline>
<codeline lineno="780"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="781"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>msg-&gt;<ref refid="structssh__message__struct_1ad604523f1d9456b8de05bdd34f2184d2" kindref="member">service_request</ref>.<ref refid="structssh__service__request_1a86553bc161bc0e98d52d51ad47ef36db" kindref="member">service</ref>;</highlight></codeline>
<codeline lineno="782"><highlight class="normal">}</highlight></codeline>
<codeline lineno="783"><highlight class="normal"></highlight></codeline>
<codeline lineno="784" refid="group__libssh__server_1gad05353966b70d7f04a3b7aed07a817cc" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*<ref refid="group__libssh__server_1gad05353966b70d7f04a3b7aed07a817cc" kindref="member">ssh_message_auth_user</ref>(<ref refid="structssh__message__struct" kindref="compound">ssh_message</ref><sp/>msg)<sp/>{</highlight></codeline>
<codeline lineno="785"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(msg<sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="786"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>NULL;</highlight></codeline>
<codeline lineno="787"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="788"><highlight class="normal"></highlight></codeline>
<codeline lineno="789"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>msg-&gt;<ref refid="structssh__message__struct_1ada5e7918deb9baad950d3672960d46e2" kindref="member">auth_request</ref>.<ref refid="structssh__auth__request_1a88f26343b22a9fdb9e0d7a8313363ccf" kindref="member">username</ref>;</highlight></codeline>
<codeline lineno="790"><highlight class="normal">}</highlight></codeline>
<codeline lineno="791"><highlight class="normal"></highlight></codeline>
<codeline lineno="792" refid="group__libssh__server_1gab434b45d3f542ab24735bba6432de85d" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*<ref refid="group__libssh__server_1gab434b45d3f542ab24735bba6432de85d" kindref="member">ssh_message_auth_password</ref>(<ref refid="structssh__message__struct" kindref="compound">ssh_message</ref><sp/>msg){</highlight></codeline>
<codeline lineno="793"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(msg<sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="794"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>NULL;</highlight></codeline>
<codeline lineno="795"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="796"><highlight class="normal"></highlight></codeline>
<codeline lineno="797"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>msg-&gt;<ref refid="structssh__message__struct_1ada5e7918deb9baad950d3672960d46e2" kindref="member">auth_request</ref>.<ref refid="structssh__auth__request_1adadadbbbcb2a1d4788b197f57f76aab8" kindref="member">password</ref>;</highlight></codeline>
<codeline lineno="798"><highlight class="normal">}</highlight></codeline>
<codeline lineno="799"><highlight class="normal"></highlight></codeline>
<codeline lineno="800" refid="group__libssh__server_1ga97e909b1d89b4c4747eb5b80ac9fd215" refkind="member"><highlight class="normal"><ref refid="structssh__key__struct" kindref="compound">ssh_key</ref><sp/><ref refid="group__libssh__server_1ga97e909b1d89b4c4747eb5b80ac9fd215" kindref="member">ssh_message_auth_pubkey</ref>(<ref refid="structssh__message__struct" kindref="compound">ssh_message</ref><sp/>msg)<sp/>{</highlight></codeline>
<codeline lineno="801"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(msg<sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="802"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>NULL;</highlight></codeline>
<codeline lineno="803"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="804"><highlight class="normal"></highlight></codeline>
<codeline lineno="805"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>msg-&gt;<ref refid="structssh__message__struct_1ada5e7918deb9baad950d3672960d46e2" kindref="member">auth_request</ref>.<ref refid="structssh__auth__request_1ad3aa33442fa6e79892921ac1aa95427b" kindref="member">pubkey</ref>;</highlight></codeline>
<codeline lineno="806"><highlight class="normal">}</highlight></codeline>
<codeline lineno="807"><highlight class="normal"></highlight></codeline>
<codeline lineno="808"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>Get<sp/>the<sp/>publickey<sp/>of<sp/>an<sp/>auth<sp/>request<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="809" refid="group__libssh__server_1gaa5e80a5891527b2207dcb53efece1203" refkind="member"><highlight class="normal"><ref refid="structssh__public__key__struct" kindref="compound">ssh_public_key</ref><sp/><ref refid="group__libssh__server_1gaa5e80a5891527b2207dcb53efece1203" kindref="member">ssh_message_auth_publickey</ref>(<ref refid="structssh__message__struct" kindref="compound">ssh_message</ref><sp/>msg){</highlight></codeline>
<codeline lineno="810"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(msg<sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="811"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>NULL;</highlight></codeline>
<codeline lineno="812"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="813"><highlight class="normal"></highlight></codeline>
<codeline lineno="814"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="group__libssh__pki_1ga2fb166991a033adb5540b66f407e2db4" kindref="member">ssh_pki_convert_key_to_publickey</ref>(msg-&gt;<ref refid="structssh__message__struct_1ada5e7918deb9baad950d3672960d46e2" kindref="member">auth_request</ref>.<ref refid="structssh__auth__request_1ad3aa33442fa6e79892921ac1aa95427b" kindref="member">pubkey</ref>);</highlight></codeline>
<codeline lineno="815"><highlight class="normal">}</highlight></codeline>
<codeline lineno="816"><highlight class="normal"></highlight></codeline>
<codeline lineno="817"><highlight class="normal"></highlight><highlight class="keyword">enum</highlight><highlight class="normal"><sp/><ref refid="libssh_8h_1a678ab8f3594510db5765fc626ed91e0e" kindref="member">ssh_publickey_state_e</ref><sp/><ref refid="group__libssh__server_1gafcb928250ef8169f4823dadab217b4fe" kindref="member">ssh_message_auth_publickey_state</ref>(<ref refid="structssh__message__struct" kindref="compound">ssh_message</ref><sp/>msg){</highlight></codeline>
<codeline lineno="818"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(msg<sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="819"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>-1;</highlight></codeline>
<codeline lineno="820"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="821"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>msg-&gt;<ref refid="structssh__message__struct_1ada5e7918deb9baad950d3672960d46e2" kindref="member">auth_request</ref>.<ref refid="structssh__auth__request_1a8e37b056d13ae796030015a4c73dfac7" kindref="member">signature_state</ref>;</highlight></codeline>
<codeline lineno="822"><highlight class="normal">}</highlight></codeline>
<codeline lineno="823"><highlight class="normal"></highlight></codeline>
<codeline lineno="824" refid="group__libssh__server_1ga5132c82c49de985e9e10f51f393e52a4" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="group__libssh__server_1ga5132c82c49de985e9e10f51f393e52a4" kindref="member">ssh_message_auth_kbdint_is_response</ref>(<ref refid="structssh__message__struct" kindref="compound">ssh_message</ref><sp/>msg)<sp/>{</highlight></codeline>
<codeline lineno="825"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(msg<sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="826"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>-1;</highlight></codeline>
<codeline lineno="827"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="828"><highlight class="normal"></highlight></codeline>
<codeline lineno="829"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>msg-&gt;<ref refid="structssh__message__struct_1ada5e7918deb9baad950d3672960d46e2" kindref="member">auth_request</ref>.<ref refid="structssh__auth__request_1a7924bd37da6fd9fbd0157eadc0203c5c" kindref="member">kbdint_response</ref><sp/>!=<sp/>0;</highlight></codeline>
<codeline lineno="830"><highlight class="normal">}</highlight></codeline>
<codeline lineno="831"><highlight class="normal"></highlight></codeline>
<codeline lineno="832"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>FIXME:<sp/>methods<sp/>should<sp/>be<sp/>unsigned<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="833" refid="group__libssh__server_1gab993157d98e5b4b3399d216c9243effc" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="group__libssh__server_1gab993157d98e5b4b3399d216c9243effc" kindref="member">ssh_message_auth_set_methods</ref>(<ref refid="structssh__message__struct" kindref="compound">ssh_message</ref><sp/>msg,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="structssh__kex__struct_1a5a8b3f27866bcbfde98a9d66793ae389" kindref="member">methods</ref>)<sp/>{</highlight></codeline>
<codeline lineno="834"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(msg<sp/>==<sp/>NULL<sp/>||<sp/>msg-&gt;<ref refid="structssh__message__struct_1aceb641c0b1e8eaaa91965f3bf5025ad3" kindref="member">session</ref><sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="835"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>-1;</highlight></codeline>
<codeline lineno="836"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="837"><highlight class="normal"></highlight></codeline>
<codeline lineno="838"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="structssh__kex__struct_1a5a8b3f27866bcbfde98a9d66793ae389" kindref="member">methods</ref><sp/>&lt;<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="839"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>-1;</highlight></codeline>
<codeline lineno="840"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="841"><highlight class="normal"></highlight></codeline>
<codeline lineno="842"><highlight class="normal"><sp/><sp/>msg-&gt;<ref refid="structssh__message__struct_1aceb641c0b1e8eaaa91965f3bf5025ad3" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a3d57e01582c0c9099f7f319513321fe8" kindref="member">auth</ref>.<ref refid="structssh__session__struct_1a3e967ac3134cae87dae1f6a794424073" kindref="member">supported_methods</ref><sp/>=<sp/>(uint32_t)<ref refid="structssh__kex__struct_1a5a8b3f27866bcbfde98a9d66793ae389" kindref="member">methods</ref>;</highlight></codeline>
<codeline lineno="843"><highlight class="normal"></highlight></codeline>
<codeline lineno="844"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>0;</highlight></codeline>
<codeline lineno="845"><highlight class="normal">}</highlight></codeline>
<codeline lineno="846"><highlight class="normal"></highlight></codeline>
<codeline lineno="847" refid="group__libssh__server_1gaacbc31ce3b39ac93061164feec822c77" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="group__libssh__server_1gaacbc31ce3b39ac93061164feec822c77" kindref="member">ssh_message_auth_interactive_request</ref>(<ref refid="structssh__message__struct" kindref="compound">ssh_message</ref><sp/>msg,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*<ref refid="samplesshd-kbdint_8c_1a8f8f80d37794cde9472343e4487ba3eb" kindref="member">name</ref>,</highlight></codeline>
<codeline lineno="848"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*<ref refid="samplesshd-kbdint_8c_1a329f390332999ec7445d61fd6ac2679a" kindref="member">instruction</ref>,<sp/></highlight><highlight class="keywordtype">unsigned</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>num_prompts,</highlight></codeline>
<codeline lineno="849"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>**<ref refid="samplesshd-kbdint_8c_1acb7181144078f54b11e41ee4a6f84390" kindref="member">prompts</ref>,<sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*<ref refid="samplesshd-kbdint_8c_1aed50069385b2de326e5bbed79b19affd" kindref="member">echo</ref>)<sp/>{</highlight></codeline>
<codeline lineno="850"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref>;</highlight></codeline>
<codeline lineno="851"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">unsigned</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="852"><highlight class="normal"></highlight></codeline>
<codeline lineno="853"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<ref refid="samplesshd-kbdint_8c_1a8f8f80d37794cde9472343e4487ba3eb" kindref="member">name</ref><sp/>==<sp/>NULL<sp/>||<sp/><ref refid="samplesshd-kbdint_8c_1a329f390332999ec7445d61fd6ac2679a" kindref="member">instruction</ref><sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="854"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" kindref="member">SSH_ERROR</ref>;</highlight></codeline>
<codeline lineno="855"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="856"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(num_prompts<sp/>&gt;<sp/>0<sp/>&amp;&amp;<sp/>(<ref refid="samplesshd-kbdint_8c_1acb7181144078f54b11e41ee4a6f84390" kindref="member">prompts</ref><sp/>==<sp/>NULL<sp/>||<sp/><ref refid="samplesshd-kbdint_8c_1aed50069385b2de326e5bbed79b19affd" kindref="member">echo</ref><sp/>==<sp/>NULL))<sp/>{</highlight></codeline>
<codeline lineno="857"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" kindref="member">SSH_ERROR</ref>;</highlight></codeline>
<codeline lineno="858"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="859"><highlight class="normal"></highlight></codeline>
<codeline lineno="860"><highlight class="normal"><sp/><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="buffer_8h_1ae17848a86043f0abfc60c1c4f6126ccd" kindref="member">ssh_buffer_pack</ref>(msg-&gt;<ref refid="structssh__message__struct_1aceb641c0b1e8eaaa91965f3bf5025ad3" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1af0aed60c1e529bbfdcb483fd80bf98a0" kindref="member">out_buffer</ref>,</highlight></codeline>
<codeline lineno="861"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;bsssd&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="862"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ssh2_8h_1a52cc2cc5ee818654cdc8b5e3bf2a54be" kindref="member">SSH2_MSG_USERAUTH_INFO_REQUEST</ref>,</highlight></codeline>
<codeline lineno="863"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="samplesshd-kbdint_8c_1a8f8f80d37794cde9472343e4487ba3eb" kindref="member">name</ref>,</highlight></codeline>
<codeline lineno="864"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="samplesshd-kbdint_8c_1a329f390332999ec7445d61fd6ac2679a" kindref="member">instruction</ref>,</highlight></codeline>
<codeline lineno="865"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;</highlight><highlight class="normal">,<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>language<sp/>tag<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="866"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>num_prompts);</highlight></codeline>
<codeline lineno="867"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>!=<sp/><ref refid="libssh_8h_1ac1ee1d1e917456d4760a94a18015377d" kindref="member">SSH_OK</ref>){</highlight></codeline>
<codeline lineno="868"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="priv_8h_1ae280c413c792e04237f000841ac8ce44" kindref="member">ssh_set_error_oom</ref>(msg-&gt;<ref refid="structssh__message__struct_1aceb641c0b1e8eaaa91965f3bf5025ad3" kindref="member">session</ref>);</highlight></codeline>
<codeline lineno="869"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" kindref="member">SSH_ERROR</ref>;</highlight></codeline>
<codeline lineno="870"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="871"><highlight class="normal"></highlight></codeline>
<codeline lineno="872"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal">(i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/>num_prompts;<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="873"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="buffer_8h_1ae17848a86043f0abfc60c1c4f6126ccd" kindref="member">ssh_buffer_pack</ref>(msg-&gt;<ref refid="structssh__message__struct_1aceb641c0b1e8eaaa91965f3bf5025ad3" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1af0aed60c1e529bbfdcb483fd80bf98a0" kindref="member">out_buffer</ref>,</highlight></codeline>
<codeline lineno="874"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;sb&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="875"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="samplesshd-kbdint_8c_1acb7181144078f54b11e41ee4a6f84390" kindref="member">prompts</ref>[i],</highlight></codeline>
<codeline lineno="876"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="samplesshd-kbdint_8c_1aed50069385b2de326e5bbed79b19affd" kindref="member">echo</ref>[i]<sp/>?<sp/>1<sp/>:<sp/>0);</highlight></codeline>
<codeline lineno="877"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>!=<sp/><ref refid="libssh_8h_1ac1ee1d1e917456d4760a94a18015377d" kindref="member">SSH_OK</ref>){</highlight></codeline>
<codeline lineno="878"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="priv_8h_1ae280c413c792e04237f000841ac8ce44" kindref="member">ssh_set_error_oom</ref>(msg-&gt;<ref refid="structssh__message__struct_1aceb641c0b1e8eaaa91965f3bf5025ad3" kindref="member">session</ref>);</highlight></codeline>
<codeline lineno="879"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" kindref="member">SSH_ERROR</ref>;</highlight></codeline>
<codeline lineno="880"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="881"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="882"><highlight class="normal"></highlight></codeline>
<codeline lineno="883"><highlight class="normal"><sp/><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="packet_8h_1a7e6c7ed74c23ace432476aa8a6841140" kindref="member">ssh_packet_send</ref>(msg-&gt;<ref refid="structssh__message__struct_1aceb641c0b1e8eaaa91965f3bf5025ad3" kindref="member">session</ref>);</highlight></codeline>
<codeline lineno="884"><highlight class="normal"></highlight></codeline>
<codeline lineno="885"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">/*<sp/>fill<sp/>in<sp/>the<sp/>kbdint<sp/>structure<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="886"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(msg-&gt;<ref refid="structssh__message__struct_1aceb641c0b1e8eaaa91965f3bf5025ad3" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a9cba44c19f35693037bc9bb1e0651d17" kindref="member">kbdint</ref><sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="887"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="priv_8h_1aa21fd8a7a609329603b7b16da7939fca" kindref="member">SSH_LOG</ref>(<ref refid="group__libssh__log_1ggadf764cbdea00d65edcd07bb9953ad2b7a75fa79e63947b66462db977d9b5ae27c" kindref="member">SSH_LOG_PROTOCOL</ref>,<sp/></highlight><highlight class="stringliteral">&quot;Warning:<sp/>Got<sp/>a<sp/>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="888"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;keyboard-interactive<sp/>response<sp/>but<sp/>it<sp/>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="889"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;seems<sp/>we<sp/>didn&apos;t<sp/>send<sp/>the<sp/>request.&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="890"><highlight class="normal"></highlight></codeline>
<codeline lineno="891"><highlight class="normal"><sp/><sp/><sp/><sp/>msg-&gt;<ref refid="structssh__message__struct_1aceb641c0b1e8eaaa91965f3bf5025ad3" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a9cba44c19f35693037bc9bb1e0651d17" kindref="member">kbdint</ref><sp/>=<sp/><ref refid="group__libssh__auth_1gac17384e2e1723b50cd041d775c0175a8" kindref="member">ssh_kbdint_new</ref>();</highlight></codeline>
<codeline lineno="892"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(msg-&gt;<ref refid="structssh__message__struct_1aceb641c0b1e8eaaa91965f3bf5025ad3" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a9cba44c19f35693037bc9bb1e0651d17" kindref="member">kbdint</ref><sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="893"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="priv_8h_1ae280c413c792e04237f000841ac8ce44" kindref="member">ssh_set_error_oom</ref>(msg-&gt;<ref refid="structssh__message__struct_1aceb641c0b1e8eaaa91965f3bf5025ad3" kindref="member">session</ref>);</highlight></codeline>
<codeline lineno="894"><highlight class="normal"></highlight></codeline>
<codeline lineno="895"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" kindref="member">SSH_ERROR</ref>;</highlight></codeline>
<codeline lineno="896"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="897"><highlight class="normal"><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="898"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="group__libssh__auth_1gac042e71960b1aa80d8245125feeb249a" kindref="member">ssh_kbdint_clean</ref>(msg-&gt;<ref refid="structssh__message__struct_1aceb641c0b1e8eaaa91965f3bf5025ad3" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a9cba44c19f35693037bc9bb1e0651d17" kindref="member">kbdint</ref>);</highlight></codeline>
<codeline lineno="899"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="900"><highlight class="normal"></highlight></codeline>
<codeline lineno="901"><highlight class="normal"><sp/><sp/>msg-&gt;<ref refid="structssh__message__struct_1aceb641c0b1e8eaaa91965f3bf5025ad3" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a9cba44c19f35693037bc9bb1e0651d17" kindref="member">kbdint</ref>-&gt;<ref refid="structssh__kbdint__struct_1a8c7f5532d4b52ab7f81bacdf8394c51c" kindref="member">name</ref><sp/>=<sp/>strdup(<ref refid="samplesshd-kbdint_8c_1a8f8f80d37794cde9472343e4487ba3eb" kindref="member">name</ref>);</highlight></codeline>
<codeline lineno="902"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(msg-&gt;<ref refid="structssh__message__struct_1aceb641c0b1e8eaaa91965f3bf5025ad3" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a9cba44c19f35693037bc9bb1e0651d17" kindref="member">kbdint</ref>-&gt;<ref refid="structssh__kbdint__struct_1a8c7f5532d4b52ab7f81bacdf8394c51c" kindref="member">name</ref><sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="903"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="priv_8h_1ae280c413c792e04237f000841ac8ce44" kindref="member">ssh_set_error_oom</ref>(msg-&gt;<ref refid="structssh__message__struct_1aceb641c0b1e8eaaa91965f3bf5025ad3" kindref="member">session</ref>);</highlight></codeline>
<codeline lineno="904"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="group__libssh__auth_1ga43266010b4cc11e277658c4c6c4a5500" kindref="member">ssh_kbdint_free</ref>(msg-&gt;<ref refid="structssh__message__struct_1aceb641c0b1e8eaaa91965f3bf5025ad3" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a9cba44c19f35693037bc9bb1e0651d17" kindref="member">kbdint</ref>);</highlight></codeline>
<codeline lineno="905"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>msg-&gt;<ref refid="structssh__message__struct_1aceb641c0b1e8eaaa91965f3bf5025ad3" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a9cba44c19f35693037bc9bb1e0651d17" kindref="member">kbdint</ref><sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="906"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="group__libssh__callbacks_1gac29df803aa1295d6a498c1b081f3b494" kindref="member">SSH_PACKET_USED</ref>;</highlight></codeline>
<codeline lineno="907"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="908"><highlight class="normal"><sp/><sp/>msg-&gt;<ref refid="structssh__message__struct_1aceb641c0b1e8eaaa91965f3bf5025ad3" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a9cba44c19f35693037bc9bb1e0651d17" kindref="member">kbdint</ref>-&gt;<ref refid="structssh__kbdint__struct_1a22c149b9323116ac704fabc4c6a5caa6" kindref="member">instruction</ref><sp/>=<sp/>strdup(<ref refid="samplesshd-kbdint_8c_1a329f390332999ec7445d61fd6ac2679a" kindref="member">instruction</ref>);</highlight></codeline>
<codeline lineno="909"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(msg-&gt;<ref refid="structssh__message__struct_1aceb641c0b1e8eaaa91965f3bf5025ad3" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a9cba44c19f35693037bc9bb1e0651d17" kindref="member">kbdint</ref>-&gt;<ref refid="structssh__kbdint__struct_1a22c149b9323116ac704fabc4c6a5caa6" kindref="member">instruction</ref><sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="910"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="priv_8h_1ae280c413c792e04237f000841ac8ce44" kindref="member">ssh_set_error_oom</ref>(msg-&gt;<ref refid="structssh__message__struct_1aceb641c0b1e8eaaa91965f3bf5025ad3" kindref="member">session</ref>);</highlight></codeline>
<codeline lineno="911"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="group__libssh__auth_1ga43266010b4cc11e277658c4c6c4a5500" kindref="member">ssh_kbdint_free</ref>(msg-&gt;<ref refid="structssh__message__struct_1aceb641c0b1e8eaaa91965f3bf5025ad3" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a9cba44c19f35693037bc9bb1e0651d17" kindref="member">kbdint</ref>);</highlight></codeline>
<codeline lineno="912"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>msg-&gt;<ref refid="structssh__message__struct_1aceb641c0b1e8eaaa91965f3bf5025ad3" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a9cba44c19f35693037bc9bb1e0651d17" kindref="member">kbdint</ref><sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="913"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="group__libssh__callbacks_1gac29df803aa1295d6a498c1b081f3b494" kindref="member">SSH_PACKET_USED</ref>;</highlight></codeline>
<codeline lineno="914"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="915"><highlight class="normal"></highlight></codeline>
<codeline lineno="916"><highlight class="normal"><sp/><sp/>msg-&gt;<ref refid="structssh__message__struct_1aceb641c0b1e8eaaa91965f3bf5025ad3" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a9cba44c19f35693037bc9bb1e0651d17" kindref="member">kbdint</ref>-&gt;<ref refid="structssh__kbdint__struct_1a316bac1f096accc10024c7e787e0e3d6" kindref="member">nprompts</ref><sp/>=<sp/>num_prompts;</highlight></codeline>
<codeline lineno="917"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(num_prompts<sp/>&gt;<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="918"><highlight class="normal"><sp/><sp/><sp/><sp/>msg-&gt;<ref refid="structssh__message__struct_1aceb641c0b1e8eaaa91965f3bf5025ad3" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a9cba44c19f35693037bc9bb1e0651d17" kindref="member">kbdint</ref>-&gt;<ref refid="structssh__kbdint__struct_1a3b528280ac48b0713c1f963ee9f3574b" kindref="member">prompts</ref><sp/>=<sp/>calloc(num_prompts,<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(</highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*));</highlight></codeline>
<codeline lineno="919"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(msg-&gt;<ref refid="structssh__message__struct_1aceb641c0b1e8eaaa91965f3bf5025ad3" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a9cba44c19f35693037bc9bb1e0651d17" kindref="member">kbdint</ref>-&gt;<ref refid="structssh__kbdint__struct_1a3b528280ac48b0713c1f963ee9f3574b" kindref="member">prompts</ref><sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="920"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>msg-&gt;<ref refid="structssh__message__struct_1aceb641c0b1e8eaaa91965f3bf5025ad3" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a9cba44c19f35693037bc9bb1e0651d17" kindref="member">kbdint</ref>-&gt;<ref refid="structssh__kbdint__struct_1a316bac1f096accc10024c7e787e0e3d6" kindref="member">nprompts</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="921"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="priv_8h_1ae280c413c792e04237f000841ac8ce44" kindref="member">ssh_set_error_oom</ref>(msg-&gt;<ref refid="structssh__message__struct_1aceb641c0b1e8eaaa91965f3bf5025ad3" kindref="member">session</ref>);</highlight></codeline>
<codeline lineno="922"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="group__libssh__auth_1ga43266010b4cc11e277658c4c6c4a5500" kindref="member">ssh_kbdint_free</ref>(msg-&gt;<ref refid="structssh__message__struct_1aceb641c0b1e8eaaa91965f3bf5025ad3" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a9cba44c19f35693037bc9bb1e0651d17" kindref="member">kbdint</ref>);</highlight></codeline>
<codeline lineno="923"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>msg-&gt;<ref refid="structssh__message__struct_1aceb641c0b1e8eaaa91965f3bf5025ad3" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a9cba44c19f35693037bc9bb1e0651d17" kindref="member">kbdint</ref><sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="924"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" kindref="member">SSH_ERROR</ref>;</highlight></codeline>
<codeline lineno="925"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="926"><highlight class="normal"><sp/><sp/><sp/><sp/>msg-&gt;<ref refid="structssh__message__struct_1aceb641c0b1e8eaaa91965f3bf5025ad3" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a9cba44c19f35693037bc9bb1e0651d17" kindref="member">kbdint</ref>-&gt;<ref refid="structssh__kbdint__struct_1a53c38b9a2468c1d79954408e9b7bc7aa" kindref="member">echo</ref><sp/>=<sp/>calloc(num_prompts,<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(</highlight><highlight class="keywordtype">unsigned</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal">));</highlight></codeline>
<codeline lineno="927"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(msg-&gt;<ref refid="structssh__message__struct_1aceb641c0b1e8eaaa91965f3bf5025ad3" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a9cba44c19f35693037bc9bb1e0651d17" kindref="member">kbdint</ref>-&gt;<ref refid="structssh__kbdint__struct_1a53c38b9a2468c1d79954408e9b7bc7aa" kindref="member">echo</ref><sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="928"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="priv_8h_1ae280c413c792e04237f000841ac8ce44" kindref="member">ssh_set_error_oom</ref>(msg-&gt;<ref refid="structssh__message__struct_1aceb641c0b1e8eaaa91965f3bf5025ad3" kindref="member">session</ref>);</highlight></codeline>
<codeline lineno="929"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="group__libssh__auth_1ga43266010b4cc11e277658c4c6c4a5500" kindref="member">ssh_kbdint_free</ref>(msg-&gt;<ref refid="structssh__message__struct_1aceb641c0b1e8eaaa91965f3bf5025ad3" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a9cba44c19f35693037bc9bb1e0651d17" kindref="member">kbdint</ref>);</highlight></codeline>
<codeline lineno="930"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>msg-&gt;<ref refid="structssh__message__struct_1aceb641c0b1e8eaaa91965f3bf5025ad3" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a9cba44c19f35693037bc9bb1e0651d17" kindref="member">kbdint</ref><sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="931"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" kindref="member">SSH_ERROR</ref>;</highlight></codeline>
<codeline lineno="932"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="933"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/>num_prompts;<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="934"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>msg-&gt;<ref refid="structssh__message__struct_1aceb641c0b1e8eaaa91965f3bf5025ad3" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a9cba44c19f35693037bc9bb1e0651d17" kindref="member">kbdint</ref>-&gt;<ref refid="structssh__kbdint__struct_1a53c38b9a2468c1d79954408e9b7bc7aa" kindref="member">echo</ref>[i]<sp/>=<sp/><ref refid="samplesshd-kbdint_8c_1aed50069385b2de326e5bbed79b19affd" kindref="member">echo</ref>[i];</highlight></codeline>
<codeline lineno="935"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>msg-&gt;<ref refid="structssh__message__struct_1aceb641c0b1e8eaaa91965f3bf5025ad3" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a9cba44c19f35693037bc9bb1e0651d17" kindref="member">kbdint</ref>-&gt;<ref refid="structssh__kbdint__struct_1a3b528280ac48b0713c1f963ee9f3574b" kindref="member">prompts</ref>[i]<sp/>=<sp/>strdup(<ref refid="samplesshd-kbdint_8c_1acb7181144078f54b11e41ee4a6f84390" kindref="member">prompts</ref>[i]);</highlight></codeline>
<codeline lineno="936"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(msg-&gt;<ref refid="structssh__message__struct_1aceb641c0b1e8eaaa91965f3bf5025ad3" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a9cba44c19f35693037bc9bb1e0651d17" kindref="member">kbdint</ref>-&gt;<ref refid="structssh__kbdint__struct_1a3b528280ac48b0713c1f963ee9f3574b" kindref="member">prompts</ref>[i]<sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="937"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="priv_8h_1ae280c413c792e04237f000841ac8ce44" kindref="member">ssh_set_error_oom</ref>(msg-&gt;<ref refid="structssh__message__struct_1aceb641c0b1e8eaaa91965f3bf5025ad3" kindref="member">session</ref>);</highlight></codeline>
<codeline lineno="938"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>msg-&gt;<ref refid="structssh__message__struct_1aceb641c0b1e8eaaa91965f3bf5025ad3" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a9cba44c19f35693037bc9bb1e0651d17" kindref="member">kbdint</ref>-&gt;<ref refid="structssh__kbdint__struct_1a316bac1f096accc10024c7e787e0e3d6" kindref="member">nprompts</ref><sp/>=<sp/>i;</highlight></codeline>
<codeline lineno="939"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="group__libssh__auth_1ga43266010b4cc11e277658c4c6c4a5500" kindref="member">ssh_kbdint_free</ref>(msg-&gt;<ref refid="structssh__message__struct_1aceb641c0b1e8eaaa91965f3bf5025ad3" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a9cba44c19f35693037bc9bb1e0651d17" kindref="member">kbdint</ref>);</highlight></codeline>
<codeline lineno="940"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>msg-&gt;<ref refid="structssh__message__struct_1aceb641c0b1e8eaaa91965f3bf5025ad3" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a9cba44c19f35693037bc9bb1e0651d17" kindref="member">kbdint</ref><sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="941"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="group__libssh__callbacks_1gac29df803aa1295d6a498c1b081f3b494" kindref="member">SSH_PACKET_USED</ref>;</highlight></codeline>
<codeline lineno="942"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="943"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="944"><highlight class="normal"><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="945"><highlight class="normal"><sp/><sp/><sp/><sp/>msg-&gt;<ref refid="structssh__message__struct_1aceb641c0b1e8eaaa91965f3bf5025ad3" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a9cba44c19f35693037bc9bb1e0651d17" kindref="member">kbdint</ref>-&gt;<ref refid="structssh__kbdint__struct_1a3b528280ac48b0713c1f963ee9f3574b" kindref="member">prompts</ref><sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="946"><highlight class="normal"><sp/><sp/><sp/><sp/>msg-&gt;<ref refid="structssh__message__struct_1aceb641c0b1e8eaaa91965f3bf5025ad3" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a9cba44c19f35693037bc9bb1e0651d17" kindref="member">kbdint</ref>-&gt;<ref refid="structssh__kbdint__struct_1a53c38b9a2468c1d79954408e9b7bc7aa" kindref="member">echo</ref><sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="947"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="948"><highlight class="normal"><sp/><sp/>msg-&gt;<ref refid="structssh__message__struct_1aceb641c0b1e8eaaa91965f3bf5025ad3" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a3d57e01582c0c9099f7f319513321fe8" kindref="member">auth</ref>.<ref refid="structssh__session__struct_1af0805877d21d43e81423ead52345c64b" kindref="member">state</ref><sp/>=<sp/><ref refid="auth_8h_1a0d3114986a741a14dc3ac03f7d8eafefa97ddb5eeec18ad7d054ec5795e6e16d6" kindref="member">SSH_AUTH_STATE_INFO</ref>;</highlight></codeline>
<codeline lineno="949"><highlight class="normal"></highlight></codeline>
<codeline lineno="950"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref>;</highlight></codeline>
<codeline lineno="951"><highlight class="normal">}</highlight></codeline>
<codeline lineno="952"><highlight class="normal"></highlight></codeline>
<codeline lineno="953" refid="group__libssh__server_1gace0de62d8bdae327069fd81fdb1861d5" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="group__libssh__server_1gace0de62d8bdae327069fd81fdb1861d5" kindref="member">ssh_auth_reply_success</ref>(<ref refid="structssh__session__struct" kindref="compound">ssh_session</ref><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>partial)</highlight></codeline>
<codeline lineno="954"><highlight class="normal">{</highlight></codeline>
<codeline lineno="955"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">struct<sp/></highlight><highlight class="normal"><ref refid="structssh__crypto__struct" kindref="compound">ssh_crypto_struct</ref><sp/>*crypto<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="956"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>r;</highlight></codeline>
<codeline lineno="957"><highlight class="normal"></highlight></codeline>
<codeline lineno="958"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref><sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="959"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" kindref="member">SSH_ERROR</ref>;</highlight></codeline>
<codeline lineno="960"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="961"><highlight class="normal"></highlight></codeline>
<codeline lineno="962"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(partial)<sp/>{</highlight></codeline>
<codeline lineno="963"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="group__libssh__server_1gaa8a38b0ea0e5ee2bce17eab77dfc850c" kindref="member">ssh_auth_reply_default</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>,<sp/>partial);</highlight></codeline>
<codeline lineno="964"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="965"><highlight class="normal"></highlight></codeline>
<codeline lineno="966"><highlight class="normal"><sp/><sp/><sp/><sp/>r<sp/>=<sp/><ref refid="buffer_8h_1a25dc9ca6178465fb850de52b30e2add6" kindref="member">ssh_buffer_add_u8</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1af0aed60c1e529bbfdcb483fd80bf98a0" kindref="member">out_buffer</ref>,<ref refid="ssh2_8h_1a8a775020d2d17f962efef15a4be9927d" kindref="member">SSH2_MSG_USERAUTH_SUCCESS</ref>);</highlight></codeline>
<codeline lineno="967"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(r<sp/>&lt;<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="968"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" kindref="member">SSH_ERROR</ref>;</highlight></codeline>
<codeline lineno="969"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="970"><highlight class="normal"></highlight></codeline>
<codeline lineno="971"><highlight class="normal"><sp/><sp/><sp/><sp/>r<sp/>=<sp/><ref refid="packet_8h_1a7e6c7ed74c23ace432476aa8a6841140" kindref="member">ssh_packet_send</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>);</highlight></codeline>
<codeline lineno="972"><highlight class="normal"></highlight></codeline>
<codeline lineno="973"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*</highlight></codeline>
<codeline lineno="974"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/>*<sp/>Consider<sp/>the<sp/>session<sp/>as<sp/>having<sp/>been<sp/>authenticated<sp/>only<sp/>after<sp/>sending</highlight></codeline>
<codeline lineno="975"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/>*<sp/>the<sp/>USERAUTH_SUCCESS<sp/>message.<sp/><sp/>Setting<sp/>these<sp/>flags<sp/>after<sp/>ssh_packet_send</highlight></codeline>
<codeline lineno="976"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/>*<sp/>ensures<sp/>that<sp/>a<sp/>rekey<sp/>is<sp/>not<sp/>triggered<sp/>prematurely,<sp/>causing<sp/>the<sp/>message</highlight></codeline>
<codeline lineno="977"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/>*<sp/>to<sp/>be<sp/>queued.</highlight></codeline>
<codeline lineno="978"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="979"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a6f74d1a1eb6ed715b1073b67caa18460" kindref="member">session_state</ref><sp/>=<sp/><ref refid="session_8h_1a9bbd1d5ae11485e27279be6ad461992caced7c62fd9f24fe8f6672d50b8219f60" kindref="member">SSH_SESSION_STATE_AUTHENTICATED</ref>;</highlight></codeline>
<codeline lineno="980"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a997060832a3419d8fe884d3da855ef4c" kindref="member">flags</ref><sp/>|=<sp/><ref refid="session_8h_1ae54e87f0565e24b25aed1372b3493a2b" kindref="member">SSH_SESSION_FLAG_AUTHENTICATED</ref>;</highlight></codeline>
<codeline lineno="981"><highlight class="normal"></highlight></codeline>
<codeline lineno="982"><highlight class="normal"><sp/><sp/><sp/><sp/>crypto<sp/>=<sp/><ref refid="packet_8h_1af36b281d11b6c0affbc0faaf1ec52fbe" kindref="member">ssh_packet_get_current_crypto</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>,<sp/><ref refid="wrapper_8h_1a9ebe789b5f29a369c7799ec6ce17f1a9a4a51e00d57fa481f88149a9d7cd83c91" kindref="member">SSH_DIRECTION_OUT</ref>);</highlight></codeline>
<codeline lineno="983"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(crypto<sp/>!=<sp/>NULL<sp/>&amp;&amp;<sp/>crypto-&gt;<ref refid="structssh__crypto__struct_1a180198c8214743d490536a6855244355" kindref="member">delayed_compress_out</ref>)<sp/>{</highlight></codeline>
<codeline lineno="984"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="priv_8h_1aa21fd8a7a609329603b7b16da7939fca" kindref="member">SSH_LOG</ref>(<ref refid="group__libssh__log_1ggadf764cbdea00d65edcd07bb9953ad2b7a75fa79e63947b66462db977d9b5ae27c" kindref="member">SSH_LOG_PROTOCOL</ref>,<sp/></highlight><highlight class="stringliteral">&quot;Enabling<sp/>delayed<sp/>compression<sp/>OUT&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="985"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>crypto-&gt;<ref refid="structssh__crypto__struct_1a2d1c6e8bd0458906a8dffa7ea982fa2d" kindref="member">do_compress_out</ref><sp/>=<sp/>1;</highlight></codeline>
<codeline lineno="986"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="987"><highlight class="normal"></highlight></codeline>
<codeline lineno="988"><highlight class="normal"><sp/><sp/><sp/><sp/>crypto<sp/>=<sp/><ref refid="packet_8h_1af36b281d11b6c0affbc0faaf1ec52fbe" kindref="member">ssh_packet_get_current_crypto</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>,<sp/><ref refid="wrapper_8h_1a9ebe789b5f29a369c7799ec6ce17f1a9a86b8de4a56d77c10ee93f4cb0ab82d71" kindref="member">SSH_DIRECTION_IN</ref>);</highlight></codeline>
<codeline lineno="989"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(crypto<sp/>!=<sp/>NULL<sp/>&amp;&amp;<sp/>crypto-&gt;<ref refid="structssh__crypto__struct_1a264a702f7930c64683183b9334fa19d0" kindref="member">delayed_compress_in</ref>)<sp/>{</highlight></codeline>
<codeline lineno="990"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="priv_8h_1aa21fd8a7a609329603b7b16da7939fca" kindref="member">SSH_LOG</ref>(<ref refid="group__libssh__log_1ggadf764cbdea00d65edcd07bb9953ad2b7a75fa79e63947b66462db977d9b5ae27c" kindref="member">SSH_LOG_PROTOCOL</ref>,<sp/></highlight><highlight class="stringliteral">&quot;Enabling<sp/>delayed<sp/>compression<sp/>IN&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="991"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>crypto-&gt;<ref refid="structssh__crypto__struct_1a9322f181b21f808d19918940335ecf40" kindref="member">do_compress_in</ref><sp/>=<sp/>1;</highlight></codeline>
<codeline lineno="992"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="993"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>r;</highlight></codeline>
<codeline lineno="994"><highlight class="normal">}</highlight></codeline>
<codeline lineno="995"><highlight class="normal"></highlight></codeline>
<codeline lineno="996" refid="group__libssh__server_1gac338ce3b49e097a6b9b75b92666cac96" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="group__libssh__server_1gac338ce3b49e097a6b9b75b92666cac96" kindref="member">ssh_message_auth_reply_success</ref>(<ref refid="structssh__message__struct" kindref="compound">ssh_message</ref><sp/>msg,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>partial)<sp/>{</highlight></codeline>
<codeline lineno="997"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(msg<sp/>==<sp/>NULL)</highlight></codeline>
<codeline lineno="998"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" kindref="member">SSH_ERROR</ref>;</highlight></codeline>
<codeline lineno="999"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="group__libssh__server_1gace0de62d8bdae327069fd81fdb1861d5" kindref="member">ssh_auth_reply_success</ref>(msg-&gt;<ref refid="structssh__message__struct_1aceb641c0b1e8eaaa91965f3bf5025ad3" kindref="member">session</ref>,<sp/>partial);</highlight></codeline>
<codeline lineno="1000"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1001"><highlight class="normal"></highlight></codeline>
<codeline lineno="1002"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>Answer<sp/>OK<sp/>to<sp/>a<sp/>pubkey<sp/>auth<sp/>request<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1003" refid="group__libssh__server_1ga2ce88786e073b36991fc96c8f6b58c09" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="group__libssh__server_1ga2ce88786e073b36991fc96c8f6b58c09" kindref="member">ssh_message_auth_reply_pk_ok</ref>(<ref refid="structssh__message__struct" kindref="compound">ssh_message</ref><sp/>msg,<sp/><ref refid="structssh__string__struct" kindref="compound">ssh_string</ref><sp/>algo,<sp/><ref refid="structssh__string__struct" kindref="compound">ssh_string</ref><sp/><ref refid="curve25519-sha256_0dlibssh_8org_8txt_1a555595207a1407936ebb264ebdbf434c" kindref="member">pubkey</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1004"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref>;</highlight></codeline>
<codeline lineno="1005"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(msg<sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="1006"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" kindref="member">SSH_ERROR</ref>;</highlight></codeline>
<codeline lineno="1007"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1008"><highlight class="normal"></highlight></codeline>
<codeline lineno="1009"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="buffer_8h_1ae17848a86043f0abfc60c1c4f6126ccd" kindref="member">ssh_buffer_pack</ref>(msg-&gt;<ref refid="structssh__message__struct_1aceb641c0b1e8eaaa91965f3bf5025ad3" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1af0aed60c1e529bbfdcb483fd80bf98a0" kindref="member">out_buffer</ref>,</highlight></codeline>
<codeline lineno="1010"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;bSS&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="1011"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ssh2_8h_1a82832514bac0e92e0619393cacd0e5a5" kindref="member">SSH2_MSG_USERAUTH_PK_OK</ref>,</highlight></codeline>
<codeline lineno="1012"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>algo,</highlight></codeline>
<codeline lineno="1013"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="curve25519-sha256_0dlibssh_8org_8txt_1a555595207a1407936ebb264ebdbf434c" kindref="member">pubkey</ref>);</highlight></codeline>
<codeline lineno="1014"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>!=<sp/><ref refid="libssh_8h_1ac1ee1d1e917456d4760a94a18015377d" kindref="member">SSH_OK</ref>){</highlight></codeline>
<codeline lineno="1015"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="priv_8h_1ae280c413c792e04237f000841ac8ce44" kindref="member">ssh_set_error_oom</ref>(msg-&gt;<ref refid="structssh__message__struct_1aceb641c0b1e8eaaa91965f3bf5025ad3" kindref="member">session</ref>);</highlight></codeline>
<codeline lineno="1016"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" kindref="member">SSH_ERROR</ref>;</highlight></codeline>
<codeline lineno="1017"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1018"><highlight class="normal"></highlight></codeline>
<codeline lineno="1019"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="packet_8h_1a7e6c7ed74c23ace432476aa8a6841140" kindref="member">ssh_packet_send</ref>(msg-&gt;<ref refid="structssh__message__struct_1aceb641c0b1e8eaaa91965f3bf5025ad3" kindref="member">session</ref>);</highlight></codeline>
<codeline lineno="1020"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref>;</highlight></codeline>
<codeline lineno="1021"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1022"><highlight class="normal"></highlight></codeline>
<codeline lineno="1023" refid="group__libssh__server_1ga98321ead09cda145a08603d481a62a9e" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="group__libssh__server_1ga98321ead09cda145a08603d481a62a9e" kindref="member">ssh_message_auth_reply_pk_ok_simple</ref>(<ref refid="structssh__message__struct" kindref="compound">ssh_message</ref><sp/>msg)<sp/>{</highlight></codeline>
<codeline lineno="1024"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="structssh__string__struct" kindref="compound">ssh_string</ref><sp/>algo;</highlight></codeline>
<codeline lineno="1025"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="structssh__string__struct" kindref="compound">ssh_string</ref><sp/>pubkey_blob<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="1026"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>ret;</highlight></codeline>
<codeline lineno="1027"><highlight class="normal"></highlight></codeline>
<codeline lineno="1028"><highlight class="normal"><sp/><sp/><sp/><sp/>algo<sp/>=<sp/><ref refid="group__libssh__string_1ga4154ea16ba2dc5bd5dcb2579686aaac2" kindref="member">ssh_string_from_char</ref>(msg-&gt;<ref refid="structssh__message__struct_1ada5e7918deb9baad950d3672960d46e2" kindref="member">auth_request</ref>.<ref refid="structssh__auth__request_1ad3aa33442fa6e79892921ac1aa95427b" kindref="member">pubkey</ref>-&gt;<ref refid="structssh__key__struct_1af198ae6d0eee951e7d46b8dacbf3c412" kindref="member">type_c</ref>);</highlight></codeline>
<codeline lineno="1029"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(algo<sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="1030"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" kindref="member">SSH_ERROR</ref>;</highlight></codeline>
<codeline lineno="1031"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1032"><highlight class="normal"></highlight></codeline>
<codeline lineno="1033"><highlight class="normal"><sp/><sp/><sp/><sp/>ret<sp/>=<sp/><ref refid="group__libssh__pki_1gaadeaf6dc35e99214de0af82c3c431649" kindref="member">ssh_pki_export_pubkey_blob</ref>(msg-&gt;<ref refid="structssh__message__struct_1ada5e7918deb9baad950d3672960d46e2" kindref="member">auth_request</ref>.<ref refid="structssh__auth__request_1ad3aa33442fa6e79892921ac1aa95427b" kindref="member">pubkey</ref>,<sp/>&amp;pubkey_blob);</highlight></codeline>
<codeline lineno="1034"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(ret<sp/>&lt;<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="1035"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="libssh_8h_1a5bc8710c8633117ff449d15489fca051" kindref="member">SSH_STRING_FREE</ref>(algo);</highlight></codeline>
<codeline lineno="1036"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" kindref="member">SSH_ERROR</ref>;</highlight></codeline>
<codeline lineno="1037"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1038"><highlight class="normal"></highlight></codeline>
<codeline lineno="1039"><highlight class="normal"><sp/><sp/><sp/><sp/>ret<sp/>=<sp/><ref refid="group__libssh__server_1ga2ce88786e073b36991fc96c8f6b58c09" kindref="member">ssh_message_auth_reply_pk_ok</ref>(msg,<sp/>algo,<sp/>pubkey_blob);</highlight></codeline>
<codeline lineno="1040"><highlight class="normal"></highlight></codeline>
<codeline lineno="1041"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="libssh_8h_1a5bc8710c8633117ff449d15489fca051" kindref="member">SSH_STRING_FREE</ref>(algo);</highlight></codeline>
<codeline lineno="1042"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="libssh_8h_1a5bc8710c8633117ff449d15489fca051" kindref="member">SSH_STRING_FREE</ref>(pubkey_blob);</highlight></codeline>
<codeline lineno="1043"><highlight class="normal"></highlight></codeline>
<codeline lineno="1044"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>ret;</highlight></codeline>
<codeline lineno="1045"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1046"><highlight class="normal"></highlight></codeline>
<codeline lineno="1047"><highlight class="normal"></highlight></codeline>
<codeline lineno="1048" refid="group__libssh__server_1ga0df64acc64787532205f6e85e5fbc4fe" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*<ref refid="group__libssh__server_1ga0df64acc64787532205f6e85e5fbc4fe" kindref="member">ssh_message_channel_request_open_originator</ref>(<ref refid="structssh__message__struct" kindref="compound">ssh_message</ref><sp/>msg){</highlight></codeline>
<codeline lineno="1049"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>msg-&gt;<ref refid="structssh__message__struct_1a7579d1e2cd4136f2e152985d0018777f" kindref="member">channel_request_open</ref>.<ref refid="structssh__channel__request__open_1af98380c43eb905a05c172510a3f26c72" kindref="member">originator</ref>;</highlight></codeline>
<codeline lineno="1050"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1051"><highlight class="normal"></highlight></codeline>
<codeline lineno="1052" refid="group__libssh__server_1gaf24d0f28aca42d1b26e5a08fe4abc9fd" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="group__libssh__server_1gaf24d0f28aca42d1b26e5a08fe4abc9fd" kindref="member">ssh_message_channel_request_open_originator_port</ref>(<ref refid="structssh__message__struct" kindref="compound">ssh_message</ref><sp/>msg){</highlight></codeline>
<codeline lineno="1053"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>msg-&gt;<ref refid="structssh__message__struct_1a7579d1e2cd4136f2e152985d0018777f" kindref="member">channel_request_open</ref>.<ref refid="structssh__channel__request__open_1ad5e4f2672dcdf76b544d7a414af57a73" kindref="member">originator_port</ref>;</highlight></codeline>
<codeline lineno="1054"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1055"><highlight class="normal"></highlight></codeline>
<codeline lineno="1056" refid="group__libssh__server_1ga42f8b0980f73c9af36a0b5e4e3ba7a04" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*<ref refid="group__libssh__server_1ga42f8b0980f73c9af36a0b5e4e3ba7a04" kindref="member">ssh_message_channel_request_open_destination</ref>(<ref refid="structssh__message__struct" kindref="compound">ssh_message</ref><sp/>msg){</highlight></codeline>
<codeline lineno="1057"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>msg-&gt;<ref refid="structssh__message__struct_1a7579d1e2cd4136f2e152985d0018777f" kindref="member">channel_request_open</ref>.<ref refid="structssh__channel__request__open_1a5d418a8cb36e803cb46ecf44d29a85a3" kindref="member">destination</ref>;</highlight></codeline>
<codeline lineno="1058"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1059"><highlight class="normal"></highlight></codeline>
<codeline lineno="1060" refid="group__libssh__server_1gaf8b7350f50918f37f331efe2099ffa8b" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="group__libssh__server_1gaf8b7350f50918f37f331efe2099ffa8b" kindref="member">ssh_message_channel_request_open_destination_port</ref>(<ref refid="structssh__message__struct" kindref="compound">ssh_message</ref><sp/>msg){</highlight></codeline>
<codeline lineno="1061"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>msg-&gt;<ref refid="structssh__message__struct_1a7579d1e2cd4136f2e152985d0018777f" kindref="member">channel_request_open</ref>.<ref refid="structssh__channel__request__open_1a855a0ab9192961301638a007eed1a2ba" kindref="member">destination_port</ref>;</highlight></codeline>
<codeline lineno="1062"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1063"><highlight class="normal"></highlight></codeline>
<codeline lineno="1064" refid="group__libssh__server_1ga813cf45163230416cd179cd1dadc4118" refkind="member"><highlight class="normal"><ref refid="structssh__channel__struct" kindref="compound">ssh_channel</ref><sp/><ref refid="group__libssh__server_1ga813cf45163230416cd179cd1dadc4118" kindref="member">ssh_message_channel_request_channel</ref>(<ref refid="structssh__message__struct" kindref="compound">ssh_message</ref><sp/>msg){</highlight></codeline>
<codeline lineno="1065"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>msg-&gt;<ref refid="structssh__message__struct_1a988570288e6e64eca3bbb18c1733dd75" kindref="member">channel_request</ref>.<ref refid="structssh__channel__request_1a916ad8e5354e27dbeebdd53303afac4b" kindref="member">channel</ref>;</highlight></codeline>
<codeline lineno="1066"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1067"><highlight class="normal"></highlight></codeline>
<codeline lineno="1068" refid="group__libssh__server_1ga06f1578033ad6f3741f1c3b8e2322d2d" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*<ref refid="group__libssh__server_1ga06f1578033ad6f3741f1c3b8e2322d2d" kindref="member">ssh_message_channel_request_pty_term</ref>(<ref refid="structssh__message__struct" kindref="compound">ssh_message</ref><sp/>msg){</highlight></codeline>
<codeline lineno="1069"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>msg-&gt;<ref refid="structssh__message__struct_1a988570288e6e64eca3bbb18c1733dd75" kindref="member">channel_request</ref>.<ref refid="structssh__channel__request_1a8c3589f8ccc416fb333a7055caccac60" kindref="member">TERM</ref>;</highlight></codeline>
<codeline lineno="1070"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1071"><highlight class="normal"></highlight></codeline>
<codeline lineno="1072" refid="group__libssh__server_1ga6f96b1cee5ae05dabea404c5d40b50e7" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="group__libssh__server_1ga6f96b1cee5ae05dabea404c5d40b50e7" kindref="member">ssh_message_channel_request_pty_width</ref>(<ref refid="structssh__message__struct" kindref="compound">ssh_message</ref><sp/>msg){</highlight></codeline>
<codeline lineno="1073"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>msg-&gt;<ref refid="structssh__message__struct_1a988570288e6e64eca3bbb18c1733dd75" kindref="member">channel_request</ref>.<ref refid="structssh__channel__request_1a8c8268c77b186cf54edd8629c517a97f" kindref="member">width</ref>;</highlight></codeline>
<codeline lineno="1074"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1075"><highlight class="normal"></highlight></codeline>
<codeline lineno="1076" refid="group__libssh__server_1gac793c0d76e4b5856f15ad0ed0afaa1d5" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="group__libssh__server_1gac793c0d76e4b5856f15ad0ed0afaa1d5" kindref="member">ssh_message_channel_request_pty_height</ref>(<ref refid="structssh__message__struct" kindref="compound">ssh_message</ref><sp/>msg){</highlight></codeline>
<codeline lineno="1077"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>msg-&gt;<ref refid="structssh__message__struct_1a988570288e6e64eca3bbb18c1733dd75" kindref="member">channel_request</ref>.<ref refid="structssh__channel__request_1a6a7b89f676a893a3e6e8707900d5cb25" kindref="member">height</ref>;</highlight></codeline>
<codeline lineno="1078"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1079"><highlight class="normal"></highlight></codeline>
<codeline lineno="1080" refid="group__libssh__server_1ga9fe9493be6347da72ec3d55d6d58b9c6" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="group__libssh__server_1ga9fe9493be6347da72ec3d55d6d58b9c6" kindref="member">ssh_message_channel_request_pty_pxwidth</ref>(<ref refid="structssh__message__struct" kindref="compound">ssh_message</ref><sp/>msg){</highlight></codeline>
<codeline lineno="1081"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>msg-&gt;<ref refid="structssh__message__struct_1a988570288e6e64eca3bbb18c1733dd75" kindref="member">channel_request</ref>.<ref refid="structssh__channel__request_1ad9f4a5954a143d468e8df13dddb10bf2" kindref="member">pxwidth</ref>;</highlight></codeline>
<codeline lineno="1082"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1083"><highlight class="normal"></highlight></codeline>
<codeline lineno="1084" refid="group__libssh__server_1gacc10bc19a556898628ca239fb013d3b2" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="group__libssh__server_1gacc10bc19a556898628ca239fb013d3b2" kindref="member">ssh_message_channel_request_pty_pxheight</ref>(<ref refid="structssh__message__struct" kindref="compound">ssh_message</ref><sp/>msg){</highlight></codeline>
<codeline lineno="1085"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>msg-&gt;<ref refid="structssh__message__struct_1a988570288e6e64eca3bbb18c1733dd75" kindref="member">channel_request</ref>.<ref refid="structssh__channel__request_1a6835a75f16b64ff896311cd5a4b74b2e" kindref="member">pxheight</ref>;</highlight></codeline>
<codeline lineno="1086"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1087"><highlight class="normal"></highlight></codeline>
<codeline lineno="1088" refid="group__libssh__server_1gaa42c1e6e4224ca04ee34d9be1296ff44" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*<ref refid="group__libssh__server_1gaa42c1e6e4224ca04ee34d9be1296ff44" kindref="member">ssh_message_channel_request_env_name</ref>(<ref refid="structssh__message__struct" kindref="compound">ssh_message</ref><sp/>msg){</highlight></codeline>
<codeline lineno="1089"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>msg-&gt;<ref refid="structssh__message__struct_1a988570288e6e64eca3bbb18c1733dd75" kindref="member">channel_request</ref>.<ref refid="structssh__channel__request_1a7cd92e2217ef3afccc362193cd282c8c" kindref="member">var_name</ref>;</highlight></codeline>
<codeline lineno="1090"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1091"><highlight class="normal"></highlight></codeline>
<codeline lineno="1092" refid="group__libssh__server_1ga88cd6877143ea23c371b19eed3b94474" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*<ref refid="group__libssh__server_1ga88cd6877143ea23c371b19eed3b94474" kindref="member">ssh_message_channel_request_env_value</ref>(<ref refid="structssh__message__struct" kindref="compound">ssh_message</ref><sp/>msg){</highlight></codeline>
<codeline lineno="1093"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>msg-&gt;<ref refid="structssh__message__struct_1a988570288e6e64eca3bbb18c1733dd75" kindref="member">channel_request</ref>.<ref refid="structssh__channel__request_1a50f314a0f5f15250ca5e891a5fe3e2be" kindref="member">var_value</ref>;</highlight></codeline>
<codeline lineno="1094"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1095"><highlight class="normal"></highlight></codeline>
<codeline lineno="1096" refid="group__libssh__server_1ga9042b6943d0b34efb8a7deb82a275c55" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*<ref refid="group__libssh__server_1ga9042b6943d0b34efb8a7deb82a275c55" kindref="member">ssh_message_channel_request_command</ref>(<ref refid="structssh__message__struct" kindref="compound">ssh_message</ref><sp/>msg){</highlight></codeline>
<codeline lineno="1097"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>msg-&gt;<ref refid="structssh__message__struct_1a988570288e6e64eca3bbb18c1733dd75" kindref="member">channel_request</ref>.<ref refid="structssh__channel__request_1adce75fd369c57fcef7e17f472d4fe92f" kindref="member">command</ref>;</highlight></codeline>
<codeline lineno="1098"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1099"><highlight class="normal"></highlight></codeline>
<codeline lineno="1100" refid="group__libssh__server_1gaf0f6570120b742f303b974f4fca3288a" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*<ref refid="group__libssh__server_1gaf0f6570120b742f303b974f4fca3288a" kindref="member">ssh_message_channel_request_subsystem</ref>(<ref refid="structssh__message__struct" kindref="compound">ssh_message</ref><sp/>msg){</highlight></codeline>
<codeline lineno="1101"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>msg-&gt;<ref refid="structssh__message__struct_1a988570288e6e64eca3bbb18c1733dd75" kindref="member">channel_request</ref>.<ref refid="structssh__channel__request_1a50c3f962b3e9e293052df5f0be4e7725" kindref="member">subsystem</ref>;</highlight></codeline>
<codeline lineno="1102"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1103"><highlight class="normal"></highlight></codeline>
<codeline lineno="1104" refid="group__libssh__server_1gaa0e03d4be51727ff7341efb48d0e3f98" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="group__libssh__server_1gaa0e03d4be51727ff7341efb48d0e3f98" kindref="member">ssh_message_channel_request_x11_single_connection</ref>(<ref refid="structssh__message__struct" kindref="compound">ssh_message</ref><sp/>msg){</highlight></codeline>
<codeline lineno="1105"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>msg-&gt;<ref refid="structssh__message__struct_1a988570288e6e64eca3bbb18c1733dd75" kindref="member">channel_request</ref>.<ref refid="structssh__channel__request_1a3a5549df387696690a4abca7161cb424" kindref="member">x11_single_connection</ref><sp/>?<sp/>1<sp/>:<sp/>0;</highlight></codeline>
<codeline lineno="1106"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1107"><highlight class="normal"></highlight></codeline>
<codeline lineno="1108" refid="group__libssh__server_1gaca48ee1e17dea412e136659f82051ef0" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*<ref refid="group__libssh__server_1gaca48ee1e17dea412e136659f82051ef0" kindref="member">ssh_message_channel_request_x11_auth_protocol</ref>(<ref refid="structssh__message__struct" kindref="compound">ssh_message</ref><sp/>msg){</highlight></codeline>
<codeline lineno="1109"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>msg-&gt;<ref refid="structssh__message__struct_1a988570288e6e64eca3bbb18c1733dd75" kindref="member">channel_request</ref>.<ref refid="structssh__channel__request_1a05e399bf4429fbf7310f74167f66ff95" kindref="member">x11_auth_protocol</ref>;</highlight></codeline>
<codeline lineno="1110"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1111"><highlight class="normal"></highlight></codeline>
<codeline lineno="1112" refid="group__libssh__server_1ga2b0f472aaa4ac8ed8562c167505e2534" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*<ref refid="group__libssh__server_1ga2b0f472aaa4ac8ed8562c167505e2534" kindref="member">ssh_message_channel_request_x11_auth_cookie</ref>(<ref refid="structssh__message__struct" kindref="compound">ssh_message</ref><sp/>msg){</highlight></codeline>
<codeline lineno="1113"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>msg-&gt;<ref refid="structssh__message__struct_1a988570288e6e64eca3bbb18c1733dd75" kindref="member">channel_request</ref>.<ref refid="structssh__channel__request_1abb1371e97a8c2f8748fe8d054ca5676b" kindref="member">x11_auth_cookie</ref>;</highlight></codeline>
<codeline lineno="1114"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1115"><highlight class="normal"></highlight></codeline>
<codeline lineno="1116" refid="group__libssh__server_1gaf802b2a7e21e1026cc50c13133a33344" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="group__libssh__server_1gaf802b2a7e21e1026cc50c13133a33344" kindref="member">ssh_message_channel_request_x11_screen_number</ref>(<ref refid="structssh__message__struct" kindref="compound">ssh_message</ref><sp/>msg){</highlight></codeline>
<codeline lineno="1117"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>msg-&gt;<ref refid="structssh__message__struct_1a988570288e6e64eca3bbb18c1733dd75" kindref="member">channel_request</ref>.<ref refid="structssh__channel__request_1ae4a291eda389653de928f184ac281e71" kindref="member">x11_screen_number</ref>;</highlight></codeline>
<codeline lineno="1118"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1119"><highlight class="normal"></highlight></codeline>
<codeline lineno="1120" refid="group__libssh__server_1ga4b06e2be400a34f8b99e913fffc6b994" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*<ref refid="group__libssh__server_1ga4b06e2be400a34f8b99e913fffc6b994" kindref="member">ssh_message_global_request_address</ref>(<ref refid="structssh__message__struct" kindref="compound">ssh_message</ref><sp/>msg){</highlight></codeline>
<codeline lineno="1121"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>msg-&gt;<ref refid="structssh__message__struct_1a76853b41d044d79fac0269c051507995" kindref="member">global_request</ref>.<ref refid="structssh__global__request_1a668bc0814fc7a3035172a4ce3b36c769" kindref="member">bind_address</ref>;</highlight></codeline>
<codeline lineno="1122"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1123"><highlight class="normal"></highlight></codeline>
<codeline lineno="1124" refid="group__libssh__server_1ga2df15146bcf25bbf9e97bdd4b1728e40" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="group__libssh__server_1ga2df15146bcf25bbf9e97bdd4b1728e40" kindref="member">ssh_message_global_request_port</ref>(<ref refid="structssh__message__struct" kindref="compound">ssh_message</ref><sp/>msg){</highlight></codeline>
<codeline lineno="1125"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>msg-&gt;<ref refid="structssh__message__struct_1a76853b41d044d79fac0269c051507995" kindref="member">global_request</ref>.<ref refid="structssh__global__request_1a599709a2aca163c961c8d224292a13b5" kindref="member">bind_port</ref>;</highlight></codeline>
<codeline lineno="1126"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1127"><highlight class="normal"></highlight></codeline>
<codeline lineno="1136" refid="group__libssh__server_1gaccad877b20fca2d4a7eda5bebc1f5af1" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="group__libssh__server_1gaccad877b20fca2d4a7eda5bebc1f5af1" kindref="member">ssh_set_message_callback</ref>(<ref refid="structssh__session__struct" kindref="compound">ssh_session</ref><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>,</highlight></codeline>
<codeline lineno="1137"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal">(*ssh_bind_message_callback)(<ref refid="structssh__session__struct" kindref="compound">ssh_session</ref><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>,<sp/><ref refid="structssh__message__struct" kindref="compound">ssh_message</ref><sp/>msg,<sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>*data),</highlight></codeline>
<codeline lineno="1138"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>*data)<sp/>{</highlight></codeline>
<codeline lineno="1139"><highlight class="normal"><sp/><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1af8adf747eee07c696dc877ad13f14c42" kindref="member">ssh_message_callback</ref><sp/>=<sp/>ssh_bind_message_callback;</highlight></codeline>
<codeline lineno="1140"><highlight class="normal"><sp/><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a4bf74fdc5b687ca9e51cd71462c30c44" kindref="member">ssh_message_callback_data</ref><sp/>=<sp/>data;</highlight></codeline>
<codeline lineno="1141"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1142"><highlight class="normal"></highlight></codeline>
<codeline lineno="1143" refid="group__libssh__server_1gac5c9893e27dad15af4bd2dd8abc4760c" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="group__libssh__server_1gac5c9893e27dad15af4bd2dd8abc4760c" kindref="member">ssh_execute_message_callbacks</ref>(<ref refid="structssh__session__struct" kindref="compound">ssh_session</ref><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>){</highlight></codeline>
<codeline lineno="1144"><highlight class="normal"><sp/><sp/><ref refid="structssh__message__struct" kindref="compound">ssh_message</ref><sp/>msg=NULL;</highlight></codeline>
<codeline lineno="1145"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>ret;</highlight></codeline>
<codeline lineno="1146"><highlight class="normal"><sp/><sp/><ref refid="group__libssh__session_1gaa0e04dc9e24d5112a5ca2b7bd68031d0" kindref="member">ssh_handle_packets</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>,<sp/><ref refid="session_8h_1a5dc7677b987888e7db552768afc9d9c6" kindref="member">SSH_TIMEOUT_NONBLOCKING</ref>);</highlight></codeline>
<codeline lineno="1147"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(!<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1ac18fe9d39a3b73274e03ca0e2ae55db2" kindref="member">ssh_message_list</ref>)</highlight></codeline>
<codeline lineno="1148"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="libssh_8h_1ac1ee1d1e917456d4760a94a18015377d" kindref="member">SSH_OK</ref>;</highlight></codeline>
<codeline lineno="1149"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1af8adf747eee07c696dc877ad13f14c42" kindref="member">ssh_message_callback</ref>){</highlight></codeline>
<codeline lineno="1150"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal">((msg=<ref refid="group__libssh__messages_1gad2854ea69cec390707b167fa66864152" kindref="member">ssh_message_pop_head</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>))<sp/>!=<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="1151"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>ret=<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1af8adf747eee07c696dc877ad13f14c42" kindref="member">ssh_message_callback</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>,msg,</highlight></codeline>
<codeline lineno="1152"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>-&gt;<ref refid="structssh__session__struct_1a4bf74fdc5b687ca9e51cd71462c30c44" kindref="member">ssh_message_callback_data</ref>);</highlight></codeline>
<codeline lineno="1153"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(ret==1){</highlight></codeline>
<codeline lineno="1154"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ret<sp/>=<sp/><ref refid="group__libssh__server_1ga6e78c8f369333289d245931deed92573" kindref="member">ssh_message_reply_default</ref>(msg);</highlight></codeline>
<codeline lineno="1155"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="group__libssh__messages_1ga9d1b1d2279c6be3539f2b630960759c3" kindref="member">ssh_message_free</ref>(msg);</highlight></codeline>
<codeline lineno="1156"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(ret<sp/>!=<sp/><ref refid="libssh_8h_1ac1ee1d1e917456d4760a94a18015377d" kindref="member">SSH_OK</ref>)</highlight></codeline>
<codeline lineno="1157"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>ret;</highlight></codeline>
<codeline lineno="1158"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="1159"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="group__libssh__messages_1ga9d1b1d2279c6be3539f2b630960759c3" kindref="member">ssh_message_free</ref>(msg);</highlight></codeline>
<codeline lineno="1160"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1161"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1162"><highlight class="normal"><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="1163"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal">((msg=<ref refid="group__libssh__messages_1gad2854ea69cec390707b167fa66864152" kindref="member">ssh_message_pop_head</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>))<sp/>!=<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="1164"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>ret<sp/>=<sp/><ref refid="group__libssh__server_1ga6e78c8f369333289d245931deed92573" kindref="member">ssh_message_reply_default</ref>(msg);</highlight></codeline>
<codeline lineno="1165"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="group__libssh__messages_1ga9d1b1d2279c6be3539f2b630960759c3" kindref="member">ssh_message_free</ref>(msg);</highlight></codeline>
<codeline lineno="1166"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(ret<sp/>!=<sp/><ref refid="libssh_8h_1ac1ee1d1e917456d4760a94a18015377d" kindref="member">SSH_OK</ref>)</highlight></codeline>
<codeline lineno="1167"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>ret;</highlight></codeline>
<codeline lineno="1168"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1169"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="1170"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="libssh_8h_1ac1ee1d1e917456d4760a94a18015377d" kindref="member">SSH_OK</ref>;</highlight></codeline>
<codeline lineno="1171"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1172"><highlight class="normal"></highlight></codeline>
<codeline lineno="1173" refid="group__libssh__server_1gaa1ac2e1b7fdc23fd7e253aa9f0a47e7a" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="group__libssh__server_1gaa1ac2e1b7fdc23fd7e253aa9f0a47e7a" kindref="member">ssh_send_keepalive</ref>(<ref refid="structssh__session__struct" kindref="compound">ssh_session</ref><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>)</highlight></codeline>
<codeline lineno="1174"><highlight class="normal">{</highlight></codeline>
<codeline lineno="1175"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Client<sp/>denies<sp/>the<sp/>request,<sp/>so<sp/>the<sp/>error<sp/>code<sp/>is<sp/>not<sp/>meaningful<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1176"><highlight class="normal"><sp/><sp/><sp/><sp/>(void)<ref refid="group__libssh__channel_1ga814cf8a82b4098b8994f9029fed572c0" kindref="member">ssh_global_request</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>,<sp/></highlight><highlight class="stringliteral">&quot;keepalive@openssh.com&quot;</highlight><highlight class="normal">,<sp/>NULL,<sp/>1);</highlight></codeline>
<codeline lineno="1177"><highlight class="normal"></highlight></codeline>
<codeline lineno="1178"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="libssh_8h_1ac1ee1d1e917456d4760a94a18015377d" kindref="member">SSH_OK</ref>;</highlight></codeline>
<codeline lineno="1179"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1180"><highlight class="normal"></highlight></codeline>
    </programlisting>
    <location file="src/server.c"/>
  </compounddef>
</doxygen>
