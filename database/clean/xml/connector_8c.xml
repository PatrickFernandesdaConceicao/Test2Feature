<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<doxygen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="compound.xsd" version="1.9.1" xml:lang="en-US">
  <compounddef id="connector_8c" kind="file" language="C++">
    <compoundname>connector.c</compoundname>
    <includes refid="config_8h" local="yes">config.h</includes>
    <includes refid="priv_8h" local="yes">libssh/priv.h</includes>
    <includes refid="poll_8h" local="yes">libssh/poll.h</includes>
    <includes refid="callbacks_8h" local="yes">libssh/callbacks.h</includes>
    <includes refid="session_8h" local="yes">libssh/session.h</includes>
    <includes local="no">stdlib.h</includes>
    <includes local="no">errno.h</includes>
    <includes local="no">stdbool.h</includes>
    <includes local="no">sys/stat.h</includes>
    <includes local="no">sys/types.h</includes>
    <includes local="no">sys/socket.h</includes>
    <incdepgraph>
      <node id="29">
        <label>sys/stat.h</label>
      </node>
      <node id="19">
        <label>libssh/packet.h</label>
        <link refid="packet_8h"/>
        <childnode refid="20" relation="include">
        </childnode>
      </node>
      <node id="17">
        <label>stdbool.h</label>
      </node>
      <node id="11">
        <label>sys/select.h</label>
      </node>
      <node id="3">
        <label>libssh/priv.h</label>
        <link refid="priv_8h"/>
        <childnode refid="4" relation="include">
        </childnode>
        <childnode refid="5" relation="include">
        </childnode>
        <childnode refid="6" relation="include">
        </childnode>
        <childnode refid="7" relation="include">
        </childnode>
        <childnode refid="8" relation="include">
        </childnode>
        <childnode refid="14" relation="include">
        </childnode>
      </node>
      <node id="13">
        <label>libssh/legacy.h</label>
        <link refid="legacy_8h"/>
      </node>
      <node id="6">
        <label>string.h</label>
        <link refid="string_8h"/>
        <childnode refid="3" relation="include">
        </childnode>
      </node>
      <node id="4">
        <label>stdint.h</label>
      </node>
      <node id="5">
        <label>stdlib.h</label>
      </node>
      <node id="27">
        <label>libssh/misc.h</label>
        <link refid="misc_8h"/>
      </node>
      <node id="28">
        <label>errno.h</label>
      </node>
      <node id="21">
        <label>libssh/libcrypto.h</label>
        <link refid="libcrypto_8h"/>
        <childnode refid="2" relation="include">
        </childnode>
      </node>
      <node id="14">
        <label>libssh/callbacks.h</label>
        <link refid="callbacks_8h"/>
        <childnode refid="8" relation="include">
        </childnode>
        <childnode refid="6" relation="include">
        </childnode>
      </node>
      <node id="12">
        <label>netdb.h</label>
      </node>
      <node id="18">
        <label>libssh/kex.h</label>
        <link refid="kex_8h"/>
        <childnode refid="3" relation="include">
        </childnode>
        <childnode refid="14" relation="include">
        </childnode>
      </node>
      <node id="24">
        <label>libssh/pcap.h</label>
        <link refid="pcap_8h"/>
        <childnode refid="2" relation="include">
        </childnode>
        <childnode refid="8" relation="include">
        </childnode>
      </node>
      <node id="23">
        <label>libssh/libmbedcrypto.h</label>
        <link refid="libmbedcrypto_8h"/>
        <childnode refid="2" relation="include">
        </childnode>
      </node>
      <node id="26">
        <label>libssh/channels.h</label>
        <link refid="channels_8h"/>
        <childnode refid="3" relation="include">
        </childnode>
      </node>
      <node id="10">
        <label>sys/types.h</label>
      </node>
      <node id="22">
        <label>libssh/libgcrypt.h</label>
        <link refid="libgcrypt_8h"/>
        <childnode refid="2" relation="include">
        </childnode>
      </node>
      <node id="7">
        <label>unistd.h</label>
      </node>
      <node id="1">
        <label>src/connector.c</label>
        <link refid="connector_8c"/>
        <childnode refid="2" relation="include">
        </childnode>
        <childnode refid="3" relation="include">
        </childnode>
        <childnode refid="15" relation="include">
        </childnode>
        <childnode refid="14" relation="include">
        </childnode>
        <childnode refid="16" relation="include">
        </childnode>
        <childnode refid="5" relation="include">
        </childnode>
        <childnode refid="28" relation="include">
        </childnode>
        <childnode refid="17" relation="include">
        </childnode>
        <childnode refid="29" relation="include">
        </childnode>
        <childnode refid="10" relation="include">
        </childnode>
        <childnode refid="30" relation="include">
        </childnode>
      </node>
      <node id="15">
        <label>libssh/poll.h</label>
        <link refid="poll_8h"/>
        <childnode refid="2" relation="include">
        </childnode>
      </node>
      <node id="8">
        <label>libssh/libssh.h</label>
        <link refid="libssh_8h"/>
        <childnode refid="7" relation="include">
        </childnode>
        <childnode refid="9" relation="include">
        </childnode>
        <childnode refid="10" relation="include">
        </childnode>
        <childnode refid="11" relation="include">
        </childnode>
        <childnode refid="12" relation="include">
        </childnode>
        <childnode refid="13" relation="include">
        </childnode>
      </node>
      <node id="20">
        <label>libssh/wrapper.h</label>
        <link refid="wrapper_8h"/>
        <childnode refid="17" relation="include">
        </childnode>
        <childnode refid="2" relation="include">
        </childnode>
        <childnode refid="8" relation="include">
        </childnode>
        <childnode refid="21" relation="include">
        </childnode>
        <childnode refid="22" relation="include">
        </childnode>
        <childnode refid="23" relation="include">
        </childnode>
      </node>
      <node id="2">
        <label>config.h</label>
        <link refid="config_8h"/>
      </node>
      <node id="30">
        <label>sys/socket.h</label>
      </node>
      <node id="25">
        <label>libssh/auth.h</label>
        <link refid="auth_8h"/>
        <childnode refid="2" relation="include">
        </childnode>
        <childnode refid="14" relation="include">
        </childnode>
      </node>
      <node id="16">
        <label>libssh/session.h</label>
        <link refid="session_8h"/>
        <childnode refid="17" relation="include">
        </childnode>
        <childnode refid="3" relation="include">
        </childnode>
        <childnode refid="18" relation="include">
        </childnode>
        <childnode refid="19" relation="include">
        </childnode>
        <childnode refid="24" relation="include">
        </childnode>
        <childnode refid="25" relation="include">
        </childnode>
        <childnode refid="26" relation="include">
        </childnode>
        <childnode refid="15" relation="include">
        </childnode>
        <childnode refid="2" relation="include">
        </childnode>
        <childnode refid="27" relation="include">
        </childnode>
      </node>
      <node id="9">
        <label>inttypes.h</label>
      </node>
    </incdepgraph>
    <innerclass refid="structssh__connector__struct" prot="public">ssh_connector_struct</innerclass>
      <sectiondef kind="define">
      <memberdef kind="define" id="connector_8c_1a239bebe1697b474e6f84945e9fb9faee" prot="public" static="no">
        <name>CHUNKSIZE</name>
        <initializer>4096</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/connector.c" line="33" column="9" bodyfile="src/connector.c" bodystart="33" bodyend="-1"/>
      </memberdef>
      </sectiondef>
      <sectiondef kind="func">
      <memberdef kind="function" id="connector_8c_1ad994e6c0acb9b1f2eab185da25fd46b8" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>static int ssh_connector_channel_data_cb</definition>
        <argsstring>(ssh_session session, ssh_channel channel, void *data, uint32_t len, int is_stderr, void *userdata)</argsstring>
        <name>ssh_connector_channel_data_cb</name>
        <param>
          <type><ref refid="libssh_8h_1a02d3754de040612632cdd499c20f92f6" kindref="member">ssh_session</ref></type>
          <declname>session</declname>
        </param>
        <param>
          <type><ref refid="libssh_8h_1aca32be8db7c865697a3de381dc7e9fc3" kindref="member">ssh_channel</ref></type>
          <declname>channel</declname>
        </param>
        <param>
          <type>void *</type>
          <declname>data</declname>
        </param>
        <param>
          <type>uint32_t</type>
          <declname>len</declname>
        </param>
        <param>
          <type>int</type>
          <declname>is_stderr</declname>
        </param>
        <param>
          <type>void *</type>
          <declname>userdata</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/connector.c" line="424" column="12" bodyfile="src/connector.c" bodystart="424" bodyend="500" declfile="src/connector.c" declline="78" declcolumn="12"/>
        <references refid="structssh__connector__struct_1abfe4d6220cffdecb0596befdc269cfd1" compoundref="connector_8c" startline="68">ssh_connector_struct::in_available</references>
        <references refid="structssh__connector__struct_1a85f7eab9bedc749ea78ca1872247d10e" compoundref="connector_8c" startline="74">ssh_connector_struct::in_flags</references>
        <references refid="priv_8h_1a3acffbd305ee72dcd4593c0d8af64a4f" compoundref="priv_8h" startline="306">MIN</references>
        <references refid="structssh__connector__struct_1aef4894f7b0135245d08eed5edf68be0b" compoundref="connector_8c" startline="56">ssh_connector_struct::out_channel</references>
        <references refid="structssh__connector__struct_1a820aee50995208d193f4fe295beb239e" compoundref="connector_8c" startline="59">ssh_connector_struct::out_fd</references>
        <references refid="structssh__connector__struct_1a739a35c9ae799e36bd8b9cc0b0de1254" compoundref="connector_8c" startline="75">ssh_connector_struct::out_flags</references>
        <references refid="structssh__connector__struct_1a96f134844f8a75d2954173500b4bd06f" compoundref="connector_8c" startline="69">ssh_connector_struct::out_wontblock</references>
        <references refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" compoundref="torture__session__keys_8c" startline="61">session</references>
        <references refid="group__libssh__channel_1gadf53c5a5b501086af26d06cba3f1491f" compoundref="channels_8c" startline="1536" endline="1538">ssh_channel_window_size</references>
        <references refid="group__libssh__channel_1ga5d658df773ba854b35ff9f905341e2fb" compoundref="channels_8c" startline="1553" endline="1555">ssh_channel_write</references>
        <references refid="group__libssh__channel_1ga7ebd0ed490ee4485c6d5feb7d22bc162" compoundref="channels_8c" startline="3438" endline="3440">ssh_channel_write_stderr</references>
        <references refid="connector_8c_1a56b96ae3387e0fca09be7e8c703afe32" compoundref="connector_8c" startline="200" endline="204">ssh_connector_except</references>
        <references refid="connector_8c_1a14a16f59cb2bc11c26075ac392898529" compoundref="connector_8c" startline="207" endline="212">ssh_connector_except_channel</references>
        <references refid="connector_8c_1a2c034263a1c5bab38564d40cbfc67631" compoundref="connector_8c" startline="734" endline="752">ssh_connector_fd_write</references>
        <references refid="connector_8c_1a49e333bf300287cfadad801243c2d7f7" compoundref="connector_8c" startline="219" endline="236">ssh_connector_reset_pollevents</references>
        <references refid="libssh_8h_1a1b16de6e3d7453108e91d9e3a6608536a8990d435585796e3aecf7426e6041408" compoundref="libssh_8h" startline="450">SSH_CONNECTOR_STDERR</references>
        <references refid="libssh_8h_1a1b16de6e3d7453108e91d9e3a6608536a228d3e408dd67c003254e2d6d1395653" compoundref="libssh_8h" startline="447">SSH_CONNECTOR_STDOUT</references>
        <references refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" compoundref="libssh_8h" startline="330">SSH_ERROR</references>
        <references refid="libssh_8h_1a036b2b00fb04337a4d06d719d1b62be1a86ff0b2e8da6ad8628efc556b6ce1887" compoundref="libssh_8h" startline="286">SSH_FATAL</references>
        <references refid="libssh_8h_1a5f05b48043a1f47b36388227bee5d4f8" compoundref="libssh_8h" startline="140">SSH_INVALID_SOCKET</references>
        <references refid="priv_8h_1aa21fd8a7a609329603b7b16da7939fca" compoundref="priv_8h" startline="240">SSH_LOG</references>
        <references refid="libssh_8h_1a466c84d8dd5b1ba9162d491f31117a6b" compoundref="libssh_8h" startline="376">SSH_LOG_TRACE</references>
        <references refid="priv_8h_1a55177b3e8db90ca9adb435c44281963c" compoundref="priv_8h" startline="258">ssh_set_error</references>
        <references refid="structssh__channel__callbacks__struct_1ae7a7877dfb4eca2a39e5f281832c15f0" compoundref="callbacks_8h" startline="789">ssh_channel_callbacks_struct::userdata</references>
        <referencedby refid="libssh_8h_1abe75f2d91dee85a3834ee50a69b64385" compoundref="connector_8c" startline="96" endline="123">ssh_connector_new</referencedby>
      </memberdef>
      <memberdef kind="function" id="connector_8c_1a4cc7de304441a1cdb59c3656ad1a1678" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>static int ssh_connector_channel_write_wontblock_cb</definition>
        <argsstring>(ssh_session session, ssh_channel channel, size_t bytes, void *userdata)</argsstring>
        <name>ssh_connector_channel_write_wontblock_cb</name>
        <param>
          <type><ref refid="libssh_8h_1a02d3754de040612632cdd499c20f92f6" kindref="member">ssh_session</ref></type>
          <declname>session</declname>
        </param>
        <param>
          <type><ref refid="libssh_8h_1aca32be8db7c865697a3de381dc7e9fc3" kindref="member">ssh_channel</ref></type>
          <declname>channel</declname>
        </param>
        <param>
          <type>size_t</type>
          <declname>bytes</declname>
        </param>
        <param>
          <type>void *</type>
          <declname>userdata</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/connector.c" line="513" column="12" bodyfile="src/connector.c" bodystart="513" bodyend="563" declfile="src/connector.c" declline="84" declcolumn="12"/>
        <references refid="benchmarks_8c_1aff2566f4c366b48d73479bef43ee4d2e" compoundref="benchmarks_8c" startline="347">buffer</references>
        <references refid="connector_8c_1a239bebe1697b474e6f84945e9fb9faee" compoundref="connector_8c" startline="33">CHUNKSIZE</references>
        <references refid="structssh__connector__struct_1abfe4d6220cffdecb0596befdc269cfd1" compoundref="connector_8c" startline="68">ssh_connector_struct::in_available</references>
        <references refid="structssh__connector__struct_1a8c09fde7984ab2b042d15f7b1c26965d" compoundref="connector_8c" startline="55">ssh_connector_struct::in_channel</references>
        <references refid="structssh__connector__struct_1aed6f65c2d6ceb1c1fb8c1189e69dbac5" compoundref="connector_8c" startline="58">ssh_connector_struct::in_fd</references>
        <references refid="priv_8h_1a3acffbd305ee72dcd4593c0d8af64a4f" compoundref="priv_8h" startline="306">MIN</references>
        <references refid="structssh__connector__struct_1aef4894f7b0135245d08eed5edf68be0b" compoundref="connector_8c" startline="56">ssh_connector_struct::out_channel</references>
        <references refid="structssh__connector__struct_1a96f134844f8a75d2954173500b4bd06f" compoundref="connector_8c" startline="69">ssh_connector_struct::out_wontblock</references>
        <references refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" compoundref="torture__session__keys_8c" startline="61">session</references>
        <references refid="group__libssh__channel_1gab535264029443d77214c0615a0788b0a" compoundref="channels_8c" startline="1596" endline="1608">ssh_channel_is_eof</references>
        <references refid="group__libssh__channel_1gaaca5a3fbe9839c3ffb37b746afc35f4c" compoundref="channels_8c" startline="2983" endline="3022">ssh_channel_read_nonblocking</references>
        <references refid="group__libssh__channel_1ga072f82fdf3e50514f747653af2c99004" compoundref="channels_8c" startline="1224" endline="1270">ssh_channel_send_eof</references>
        <references refid="group__libssh__channel_1ga5d658df773ba854b35ff9f905341e2fb" compoundref="channels_8c" startline="1553" endline="1555">ssh_channel_write</references>
        <references refid="connector_8c_1a14a16f59cb2bc11c26075ac392898529" compoundref="connector_8c" startline="207" endline="212">ssh_connector_except_channel</references>
        <references refid="connector_8c_1a83806fe46fe887adb695eeca7f35682a" compoundref="connector_8c" startline="243" endline="322">ssh_connector_fd_in_cb</references>
        <references refid="connector_8c_1a49e333bf300287cfadad801243c2d7f7" compoundref="connector_8c" startline="219" endline="236">ssh_connector_reset_pollevents</references>
        <references refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" compoundref="libssh_8h" startline="330">SSH_ERROR</references>
        <references refid="libssh_8h_1a036b2b00fb04337a4d06d719d1b62be1a86ff0b2e8da6ad8628efc556b6ce1887" compoundref="libssh_8h" startline="286">SSH_FATAL</references>
        <references refid="libssh_8h_1a5f05b48043a1f47b36388227bee5d4f8" compoundref="libssh_8h" startline="140">SSH_INVALID_SOCKET</references>
        <references refid="priv_8h_1aa21fd8a7a609329603b7b16da7939fca" compoundref="priv_8h" startline="240">SSH_LOG</references>
        <references refid="libssh_8h_1a466c84d8dd5b1ba9162d491f31117a6b" compoundref="libssh_8h" startline="376">SSH_LOG_TRACE</references>
        <references refid="priv_8h_1a55177b3e8db90ca9adb435c44281963c" compoundref="priv_8h" startline="258">ssh_set_error</references>
        <references refid="structssh__channel__callbacks__struct_1ae7a7877dfb4eca2a39e5f281832c15f0" compoundref="callbacks_8h" startline="789">ssh_channel_callbacks_struct::userdata</references>
        <referencedby refid="libssh_8h_1abe75f2d91dee85a3834ee50a69b64385" compoundref="connector_8c" startline="96" endline="123">ssh_connector_new</referencedby>
      </memberdef>
      <memberdef kind="function" id="connector_8c_1a9d10a96cbda381bccc2fee5f2d5904c5" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>ssize_t</type>
        <definition>static ssize_t ssh_connector_fd_read</definition>
        <argsstring>(ssh_connector connector, void *buffer, uint32_t len)</argsstring>
        <name>ssh_connector_fd_read</name>
        <param>
          <type><ref refid="libssh_8h_1ac087532dc357998a930d9924c76d27c0" kindref="member">ssh_connector</ref></type>
          <declname>connector</declname>
        </param>
        <param>
          <type>void *</type>
          <declname>buffer</declname>
        </param>
        <param>
          <type>uint32_t</type>
          <declname>len</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/connector.c" line="713" column="16" bodyfile="src/connector.c" bodystart="713" bodyend="726" declfile="src/connector.c" declline="88" declcolumn="16"/>
        <references refid="benchmarks_8c_1aff2566f4c366b48d73479bef43ee4d2e" compoundref="benchmarks_8c" startline="347">buffer</references>
        <references refid="structssh__connector__struct_1aa7f4b9010c7f112fff0385e6e677b329" compoundref="connector_8c" startline="61">ssh_connector_struct::fd_is_socket</references>
        <references refid="structssh__connector__struct_1aed6f65c2d6ceb1c1fb8c1189e69dbac5" compoundref="connector_8c" startline="58">ssh_connector_struct::in_fd</references>
        <referencedby refid="connector_8c_1a83806fe46fe887adb695eeca7f35682a" compoundref="connector_8c" startline="243" endline="322">ssh_connector_fd_in_cb</referencedby>
      </memberdef>
      <memberdef kind="function" id="connector_8c_1a2c034263a1c5bab38564d40cbfc67631" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>ssize_t</type>
        <definition>static ssize_t ssh_connector_fd_write</definition>
        <argsstring>(ssh_connector connector, const void *buffer, uint32_t len)</argsstring>
        <name>ssh_connector_fd_write</name>
        <param>
          <type><ref refid="libssh_8h_1ac087532dc357998a930d9924c76d27c0" kindref="member">ssh_connector</ref></type>
          <declname>connector</declname>
        </param>
        <param>
          <type>const void *</type>
          <declname>buffer</declname>
        </param>
        <param>
          <type>uint32_t</type>
          <declname>len</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/connector.c" line="734" column="16" bodyfile="src/connector.c" bodystart="734" bodyend="752" declfile="src/connector.c" declline="91" declcolumn="16"/>
        <references refid="benchmarks_8c_1aff2566f4c366b48d73479bef43ee4d2e" compoundref="benchmarks_8c" startline="347">buffer</references>
        <references refid="structssh__connector__struct_1aa7f4b9010c7f112fff0385e6e677b329" compoundref="connector_8c" startline="61">ssh_connector_struct::fd_is_socket</references>
        <references refid="structssh__connector__struct_1a820aee50995208d193f4fe295beb239e" compoundref="connector_8c" startline="59">ssh_connector_struct::out_fd</references>
        <referencedby refid="connector_8c_1ad994e6c0acb9b1f2eab185da25fd46b8" compoundref="connector_8c" startline="424" endline="500">ssh_connector_channel_data_cb</referencedby>
        <referencedby refid="connector_8c_1a83806fe46fe887adb695eeca7f35682a" compoundref="connector_8c" startline="243" endline="322">ssh_connector_fd_in_cb</referencedby>
        <referencedby refid="connector_8c_1ad13c8d29eb297a425c51a53379450dd1" compoundref="connector_8c" startline="327" endline="370">ssh_connector_fd_out_cb</referencedby>
      </memberdef>
      <memberdef kind="function" id="connector_8c_1a7a60e4126deea02a1dac73121e321245" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>bool</type>
        <definition>static bool ssh_connector_fd_is_socket</definition>
        <argsstring>(socket_t socket)</argsstring>
        <name>ssh_connector_fd_is_socket</name>
        <param>
          <type><ref refid="libssh_8h_1a30353f381f5fccbb956eea1f3a110b6c" kindref="member">socket_t</ref></type>
          <declname>socket</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/connector.c" line="667" column="13" bodyfile="src/connector.c" bodystart="667" bodyend="705" declfile="src/connector.c" declline="94" declcolumn="13"/>
        <references refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" compoundref="pkd__daemon_8c" startline="62">rc</references>
        <references refid="test__socket_8c_1a73991beba1accdcc64730cb00c146fe2" compoundref="test__socket_8c" startline="34">s</references>
        <references refid="priv_8h_1aa21fd8a7a609329603b7b16da7939fca" compoundref="priv_8h" startline="240">SSH_LOG</references>
        <references refid="libssh_8h_1a466c84d8dd5b1ba9162d491f31117a6b" compoundref="libssh_8h" startline="376">SSH_LOG_TRACE</references>
        <referencedby refid="libssh_8h_1ab5763a5e739e0fcf1857f5ca24b0716b" compoundref="connector_8c" startline="185" endline="190">ssh_connector_set_in_fd</referencedby>
        <referencedby refid="libssh_8h_1a83638a551468a2a6ef0ff38784bb6697" compoundref="connector_8c" startline="192" endline="197">ssh_connector_set_out_fd</referencedby>
      </memberdef>
      <memberdef kind="function" id="connector_8c_1a6923476bf129f12137af85ca238fb498" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="libssh_8h_1ac087532dc357998a930d9924c76d27c0" kindref="member">ssh_connector</ref></type>
        <definition>ssh_connector ssh_connector_new</definition>
        <argsstring>(ssh_session session)</argsstring>
        <name>ssh_connector_new</name>
        <param>
          <type><ref refid="libssh_8h_1a02d3754de040612632cdd499c20f92f6" kindref="member">ssh_session</ref></type>
          <declname>session</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/connector.c" line="96" column="15" bodyfile="src/connector.c" bodystart="96" bodyend="123"/>
        <references refid="structssh__channel__callbacks__struct_1a12b38a7c3b2a38493c8d841015e7e8af" compoundref="callbacks_8h" startline="793">ssh_channel_callbacks_struct::channel_data_function</references>
        <references refid="structssh__channel__callbacks__struct_1a1e8a2b155fe4ab0a745556583db7dac9" compoundref="callbacks_8h" startline="849">ssh_channel_callbacks_struct::channel_write_wontblock_function</references>
        <references refid="structssh__connector__struct_1aa7f4b9010c7f112fff0385e6e677b329" compoundref="connector_8c" startline="61">ssh_connector_struct::fd_is_socket</references>
        <references refid="structssh__connector__struct_1a39e9a36b0de9750140e993541de99a8d" compoundref="connector_8c" startline="71">ssh_connector_struct::in_channel_cb</references>
        <references refid="structssh__connector__struct_1aed6f65c2d6ceb1c1fb8c1189e69dbac5" compoundref="connector_8c" startline="58">ssh_connector_struct::in_fd</references>
        <references refid="structssh__connector__struct_1ae3c4aa83afae3a01cda7e142b9191c3b" compoundref="connector_8c" startline="72">ssh_connector_struct::out_channel_cb</references>
        <references refid="structssh__connector__struct_1a820aee50995208d193f4fe295beb239e" compoundref="connector_8c" startline="59">ssh_connector_struct::out_fd</references>
        <references refid="structssh__connector__struct_1a73b1b54b8c7ad4fb06e1841c7ad51285" compoundref="connector_8c" startline="53">ssh_connector_struct::session</references>
        <references refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" compoundref="torture__session__keys_8c" startline="61">session</references>
        <references refid="group__libssh__callbacks_1gafe09b81e5346f0babe288dc38113d289" compoundref="callbacks_8h" startline="423">ssh_callbacks_init</references>
        <references refid="connector_8c_1ad994e6c0acb9b1f2eab185da25fd46b8" compoundref="connector_8c" startline="424" endline="500">ssh_connector_channel_data_cb</references>
        <references refid="connector_8c_1a4cc7de304441a1cdb59c3656ad1a1678" compoundref="connector_8c" startline="513" endline="563">ssh_connector_channel_write_wontblock_cb</references>
        <references refid="libssh_8h_1a5f05b48043a1f47b36388227bee5d4f8" compoundref="libssh_8h" startline="140">SSH_INVALID_SOCKET</references>
        <references refid="priv_8h_1ae280c413c792e04237f000841ac8ce44" compoundref="priv_8h" startline="265">ssh_set_error_oom</references>
        <references refid="structssh__channel__callbacks__struct_1ae7a7877dfb4eca2a39e5f281832c15f0" compoundref="callbacks_8h" startline="789">ssh_channel_callbacks_struct::userdata</references>
        <referencedby refid="ssh__client_8c_1a38ba4d370f756491ce0d55e0c320d08b" compoundref="ssh__client_8c" startline="198" endline="242">select_loop</referencedby>
      </memberdef>
      <memberdef kind="function" id="connector_8c_1aef2bbc39f4fb5bb7b522a41237b08f89" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void ssh_connector_free</definition>
        <argsstring>(ssh_connector connector)</argsstring>
        <name>ssh_connector_free</name>
        <param>
          <type><ref refid="libssh_8h_1ac087532dc357998a930d9924c76d27c0" kindref="member">ssh_connector</ref></type>
          <declname>connector</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/connector.c" line="125" column="6" bodyfile="src/connector.c" bodystart="125" bodyend="151"/>
        <references refid="structssh__connector__struct_1aae4c1c8966793b6649a59085aeec3ff6" compoundref="connector_8c" startline="66">ssh_connector_struct::event</references>
        <references refid="structssh__connector__struct_1a8c09fde7984ab2b042d15f7b1c26965d" compoundref="connector_8c" startline="55">ssh_connector_struct::in_channel</references>
        <references refid="structssh__connector__struct_1a39e9a36b0de9750140e993541de99a8d" compoundref="connector_8c" startline="71">ssh_connector_struct::in_channel_cb</references>
        <references refid="structssh__connector__struct_1a3d27a520636b09b59437e6d5666ce44c" compoundref="connector_8c" startline="63">ssh_connector_struct::in_poll</references>
        <references refid="structssh__connector__struct_1aef4894f7b0135245d08eed5edf68be0b" compoundref="connector_8c" startline="56">ssh_connector_struct::out_channel</references>
        <references refid="structssh__connector__struct_1ae3c4aa83afae3a01cda7e142b9191c3b" compoundref="connector_8c" startline="72">ssh_connector_struct::out_channel_cb</references>
        <references refid="structssh__connector__struct_1abab4576fbd113acfaf860eedf6a60624" compoundref="connector_8c" startline="64">ssh_connector_struct::out_poll</references>
        <references refid="connector_8c_1ad92def69fc9cce5d1d564588e668a862" compoundref="connector_8c" startline="630" endline="659">ssh_connector_remove_event</references>
        <references refid="group__libssh__poll_1ga873ecc6866c286f7777612d94de5c00d" compoundref="poll_8c" startline="376" endline="382">ssh_poll_free</references>
        <references refid="group__libssh__callbacks_1gae564352175e887c346a2e062f8124282" compoundref="callbacks_8c" startline="114" endline="130">ssh_remove_channel_callbacks</references>
        <referencedby refid="ssh__client_8c_1a38ba4d370f756491ce0d55e0c320d08b" compoundref="ssh__client_8c" startline="198" endline="242">select_loop</referencedby>
      </memberdef>
      <memberdef kind="function" id="connector_8c_1af4ddaffee9e8676d84766cc64652c565" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>int ssh_connector_set_in_channel</definition>
        <argsstring>(ssh_connector connector, ssh_channel channel, enum ssh_connector_flags_e flags)</argsstring>
        <name>ssh_connector_set_in_channel</name>
        <param>
          <type><ref refid="libssh_8h_1ac087532dc357998a930d9924c76d27c0" kindref="member">ssh_connector</ref></type>
          <declname>connector</declname>
        </param>
        <param>
          <type><ref refid="libssh_8h_1aca32be8db7c865697a3de381dc7e9fc3" kindref="member">ssh_channel</ref></type>
          <declname>channel</declname>
        </param>
        <param>
          <type>enum <ref refid="libssh_8h_1a1b16de6e3d7453108e91d9e3a6608536" kindref="member">ssh_connector_flags_e</ref></type>
          <declname>flags</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/connector.c" line="153" column="5" bodyfile="src/connector.c" bodystart="153" bodyend="167"/>
        <references refid="structssh__connector__struct_1a8c09fde7984ab2b042d15f7b1c26965d" compoundref="connector_8c" startline="55">ssh_connector_struct::in_channel</references>
        <references refid="structssh__connector__struct_1a39e9a36b0de9750140e993541de99a8d" compoundref="connector_8c" startline="71">ssh_connector_struct::in_channel_cb</references>
        <references refid="structssh__connector__struct_1aed6f65c2d6ceb1c1fb8c1189e69dbac5" compoundref="connector_8c" startline="58">ssh_connector_struct::in_fd</references>
        <references refid="structssh__connector__struct_1a85f7eab9bedc749ea78ca1872247d10e" compoundref="connector_8c" startline="74">ssh_connector_struct::in_flags</references>
        <references refid="group__libssh__callbacks_1ga2fd83df19998902f84f951fc47def83e" compoundref="callbacks_8c" startline="109" endline="112">ssh_add_channel_callbacks</references>
        <references refid="libssh_8h_1a1b16de6e3d7453108e91d9e3a6608536a8990d435585796e3aecf7426e6041408" compoundref="libssh_8h" startline="450">SSH_CONNECTOR_STDERR</references>
        <references refid="libssh_8h_1a1b16de6e3d7453108e91d9e3a6608536a228d3e408dd67c003254e2d6d1395653" compoundref="libssh_8h" startline="447">SSH_CONNECTOR_STDOUT</references>
        <references refid="libssh_8h_1a5f05b48043a1f47b36388227bee5d4f8" compoundref="libssh_8h" startline="140">SSH_INVALID_SOCKET</references>
        <referencedby refid="ssh__client_8c_1a38ba4d370f756491ce0d55e0c320d08b" compoundref="ssh__client_8c" startline="198" endline="242">select_loop</referencedby>
      </memberdef>
      <memberdef kind="function" id="connector_8c_1a4607653b47ce52ff65c2b910289898af" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>int ssh_connector_set_out_channel</definition>
        <argsstring>(ssh_connector connector, ssh_channel channel, enum ssh_connector_flags_e flags)</argsstring>
        <name>ssh_connector_set_out_channel</name>
        <param>
          <type><ref refid="libssh_8h_1ac087532dc357998a930d9924c76d27c0" kindref="member">ssh_connector</ref></type>
          <declname>connector</declname>
        </param>
        <param>
          <type><ref refid="libssh_8h_1aca32be8db7c865697a3de381dc7e9fc3" kindref="member">ssh_channel</ref></type>
          <declname>channel</declname>
        </param>
        <param>
          <type>enum <ref refid="libssh_8h_1a1b16de6e3d7453108e91d9e3a6608536" kindref="member">ssh_connector_flags_e</ref></type>
          <declname>flags</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/connector.c" line="169" column="5" bodyfile="src/connector.c" bodystart="169" bodyend="183"/>
        <references refid="structssh__connector__struct_1a85f7eab9bedc749ea78ca1872247d10e" compoundref="connector_8c" startline="74">ssh_connector_struct::in_flags</references>
        <references refid="structssh__connector__struct_1aef4894f7b0135245d08eed5edf68be0b" compoundref="connector_8c" startline="56">ssh_connector_struct::out_channel</references>
        <references refid="structssh__connector__struct_1ae3c4aa83afae3a01cda7e142b9191c3b" compoundref="connector_8c" startline="72">ssh_connector_struct::out_channel_cb</references>
        <references refid="structssh__connector__struct_1a820aee50995208d193f4fe295beb239e" compoundref="connector_8c" startline="59">ssh_connector_struct::out_fd</references>
        <references refid="structssh__connector__struct_1a739a35c9ae799e36bd8b9cc0b0de1254" compoundref="connector_8c" startline="75">ssh_connector_struct::out_flags</references>
        <references refid="group__libssh__callbacks_1ga2fd83df19998902f84f951fc47def83e" compoundref="callbacks_8c" startline="109" endline="112">ssh_add_channel_callbacks</references>
        <references refid="libssh_8h_1a1b16de6e3d7453108e91d9e3a6608536a8990d435585796e3aecf7426e6041408" compoundref="libssh_8h" startline="450">SSH_CONNECTOR_STDERR</references>
        <references refid="libssh_8h_1a1b16de6e3d7453108e91d9e3a6608536a228d3e408dd67c003254e2d6d1395653" compoundref="libssh_8h" startline="447">SSH_CONNECTOR_STDOUT</references>
        <references refid="libssh_8h_1a5f05b48043a1f47b36388227bee5d4f8" compoundref="libssh_8h" startline="140">SSH_INVALID_SOCKET</references>
        <referencedby refid="ssh__client_8c_1a38ba4d370f756491ce0d55e0c320d08b" compoundref="ssh__client_8c" startline="198" endline="242">select_loop</referencedby>
      </memberdef>
      <memberdef kind="function" id="connector_8c_1a47b38e389ee866f2252677c3e7992df2" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void ssh_connector_set_in_fd</definition>
        <argsstring>(ssh_connector connector, socket_t fd)</argsstring>
        <name>ssh_connector_set_in_fd</name>
        <param>
          <type><ref refid="libssh_8h_1ac087532dc357998a930d9924c76d27c0" kindref="member">ssh_connector</ref></type>
          <declname>connector</declname>
        </param>
        <param>
          <type><ref refid="libssh_8h_1a30353f381f5fccbb956eea1f3a110b6c" kindref="member">socket_t</ref></type>
          <declname>fd</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/connector.c" line="185" column="6" bodyfile="src/connector.c" bodystart="185" bodyend="190"/>
        <references refid="structssh__connector__struct_1aa7f4b9010c7f112fff0385e6e677b329" compoundref="connector_8c" startline="61">ssh_connector_struct::fd_is_socket</references>
        <references refid="structssh__connector__struct_1a8c09fde7984ab2b042d15f7b1c26965d" compoundref="connector_8c" startline="55">ssh_connector_struct::in_channel</references>
        <references refid="structssh__connector__struct_1aed6f65c2d6ceb1c1fb8c1189e69dbac5" compoundref="connector_8c" startline="58">ssh_connector_struct::in_fd</references>
        <references refid="connector_8c_1a7a60e4126deea02a1dac73121e321245" compoundref="connector_8c" startline="667" endline="705">ssh_connector_fd_is_socket</references>
        <referencedby refid="ssh__client_8c_1a38ba4d370f756491ce0d55e0c320d08b" compoundref="ssh__client_8c" startline="198" endline="242">select_loop</referencedby>
      </memberdef>
      <memberdef kind="function" id="connector_8c_1a47b7c3d1ffc07b7ec3374ec771d97443" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void ssh_connector_set_out_fd</definition>
        <argsstring>(ssh_connector connector, socket_t fd)</argsstring>
        <name>ssh_connector_set_out_fd</name>
        <param>
          <type><ref refid="libssh_8h_1ac087532dc357998a930d9924c76d27c0" kindref="member">ssh_connector</ref></type>
          <declname>connector</declname>
        </param>
        <param>
          <type><ref refid="libssh_8h_1a30353f381f5fccbb956eea1f3a110b6c" kindref="member">socket_t</ref></type>
          <declname>fd</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/connector.c" line="192" column="6" bodyfile="src/connector.c" bodystart="192" bodyend="197"/>
        <references refid="structssh__connector__struct_1aa7f4b9010c7f112fff0385e6e677b329" compoundref="connector_8c" startline="61">ssh_connector_struct::fd_is_socket</references>
        <references refid="structssh__connector__struct_1aef4894f7b0135245d08eed5edf68be0b" compoundref="connector_8c" startline="56">ssh_connector_struct::out_channel</references>
        <references refid="structssh__connector__struct_1a820aee50995208d193f4fe295beb239e" compoundref="connector_8c" startline="59">ssh_connector_struct::out_fd</references>
        <references refid="connector_8c_1a7a60e4126deea02a1dac73121e321245" compoundref="connector_8c" startline="667" endline="705">ssh_connector_fd_is_socket</references>
        <referencedby refid="ssh__client_8c_1a38ba4d370f756491ce0d55e0c320d08b" compoundref="ssh__client_8c" startline="198" endline="242">select_loop</referencedby>
      </memberdef>
      <memberdef kind="function" id="connector_8c_1a56b96ae3387e0fca09be7e8c703afe32" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>static void ssh_connector_except</definition>
        <argsstring>(ssh_connector connector, socket_t fd)</argsstring>
        <name>ssh_connector_except</name>
        <param>
          <type><ref refid="libssh_8h_1ac087532dc357998a930d9924c76d27c0" kindref="member">ssh_connector</ref></type>
          <declname>connector</declname>
        </param>
        <param>
          <type><ref refid="libssh_8h_1a30353f381f5fccbb956eea1f3a110b6c" kindref="member">socket_t</ref></type>
          <declname>fd</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/connector.c" line="200" column="13" bodyfile="src/connector.c" bodystart="200" bodyend="204"/>
        <referencedby refid="connector_8c_1ad994e6c0acb9b1f2eab185da25fd46b8" compoundref="connector_8c" startline="424" endline="500">ssh_connector_channel_data_cb</referencedby>
        <referencedby refid="connector_8c_1a3ee42f9fc7405a94313d6275aaa74db3" compoundref="connector_8c" startline="387" endline="407">ssh_connector_fd_cb</referencedby>
        <referencedby refid="connector_8c_1a83806fe46fe887adb695eeca7f35682a" compoundref="connector_8c" startline="243" endline="322">ssh_connector_fd_in_cb</referencedby>
        <referencedby refid="connector_8c_1ad13c8d29eb297a425c51a53379450dd1" compoundref="connector_8c" startline="327" endline="370">ssh_connector_fd_out_cb</referencedby>
      </memberdef>
      <memberdef kind="function" id="connector_8c_1a14a16f59cb2bc11c26075ac392898529" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>static void ssh_connector_except_channel</definition>
        <argsstring>(ssh_connector connector, ssh_channel channel)</argsstring>
        <name>ssh_connector_except_channel</name>
        <param>
          <type><ref refid="libssh_8h_1ac087532dc357998a930d9924c76d27c0" kindref="member">ssh_connector</ref></type>
          <declname>connector</declname>
        </param>
        <param>
          <type><ref refid="libssh_8h_1aca32be8db7c865697a3de381dc7e9fc3" kindref="member">ssh_channel</ref></type>
          <declname>channel</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/connector.c" line="207" column="13" bodyfile="src/connector.c" bodystart="207" bodyend="212"/>
        <referencedby refid="connector_8c_1ad994e6c0acb9b1f2eab185da25fd46b8" compoundref="connector_8c" startline="424" endline="500">ssh_connector_channel_data_cb</referencedby>
        <referencedby refid="connector_8c_1a4cc7de304441a1cdb59c3656ad1a1678" compoundref="connector_8c" startline="513" endline="563">ssh_connector_channel_write_wontblock_cb</referencedby>
        <referencedby refid="connector_8c_1ad13c8d29eb297a425c51a53379450dd1" compoundref="connector_8c" startline="327" endline="370">ssh_connector_fd_out_cb</referencedby>
      </memberdef>
      <memberdef kind="function" id="connector_8c_1a49e333bf300287cfadad801243c2d7f7" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>static void ssh_connector_reset_pollevents</definition>
        <argsstring>(ssh_connector connector)</argsstring>
        <name>ssh_connector_reset_pollevents</name>
        <param>
          <type><ref refid="libssh_8h_1ac087532dc357998a930d9924c76d27c0" kindref="member">ssh_connector</ref></type>
          <declname>connector</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/connector.c" line="219" column="13" bodyfile="src/connector.c" bodystart="219" bodyend="236"/>
        <references refid="structssh__connector__struct_1abfe4d6220cffdecb0596befdc269cfd1" compoundref="connector_8c" startline="68">ssh_connector_struct::in_available</references>
        <references refid="structssh__connector__struct_1aed6f65c2d6ceb1c1fb8c1189e69dbac5" compoundref="connector_8c" startline="58">ssh_connector_struct::in_fd</references>
        <references refid="structssh__connector__struct_1a3d27a520636b09b59437e6d5666ce44c" compoundref="connector_8c" startline="63">ssh_connector_struct::in_poll</references>
        <references refid="structssh__connector__struct_1a820aee50995208d193f4fe295beb239e" compoundref="connector_8c" startline="59">ssh_connector_struct::out_fd</references>
        <references refid="structssh__connector__struct_1abab4576fbd113acfaf860eedf6a60624" compoundref="connector_8c" startline="64">ssh_connector_struct::out_poll</references>
        <references refid="structssh__connector__struct_1a96f134844f8a75d2954173500b4bd06f" compoundref="connector_8c" startline="69">ssh_connector_struct::out_wontblock</references>
        <references refid="poll_8h_1a52ac479a805051f59643588b096024ff" compoundref="poll_8h" startline="82">POLLIN</references>
        <references refid="poll_8h_1a91b3c67129ac7675062f316b840a0d58" compoundref="poll_8h" startline="88">POLLOUT</references>
        <references refid="libssh_8h_1a5f05b48043a1f47b36388227bee5d4f8" compoundref="libssh_8h" startline="140">SSH_INVALID_SOCKET</references>
        <references refid="group__libssh__poll_1ga26ad689751420b91bf002f616e8bf4f7" compoundref="poll_8c" startline="442" endline="444">ssh_poll_add_events</references>
        <references refid="group__libssh__poll_1ga012582349ce62cf788761e5f97548496" compoundref="poll_8c" startline="453" endline="455">ssh_poll_remove_events</references>
        <referencedby refid="connector_8c_1ad994e6c0acb9b1f2eab185da25fd46b8" compoundref="connector_8c" startline="424" endline="500">ssh_connector_channel_data_cb</referencedby>
        <referencedby refid="connector_8c_1a4cc7de304441a1cdb59c3656ad1a1678" compoundref="connector_8c" startline="513" endline="563">ssh_connector_channel_write_wontblock_cb</referencedby>
        <referencedby refid="connector_8c_1a3ee42f9fc7405a94313d6275aaa74db3" compoundref="connector_8c" startline="387" endline="407">ssh_connector_fd_cb</referencedby>
      </memberdef>
      <memberdef kind="function" id="connector_8c_1a83806fe46fe887adb695eeca7f35682a" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>static void ssh_connector_fd_in_cb</definition>
        <argsstring>(ssh_connector connector)</argsstring>
        <name>ssh_connector_fd_in_cb</name>
        <param>
          <type><ref refid="libssh_8h_1ac087532dc357998a930d9924c76d27c0" kindref="member">ssh_connector</ref></type>
          <declname>connector</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/connector.c" line="243" column="13" bodyfile="src/connector.c" bodystart="243" bodyend="322"/>
        <references refid="benchmarks_8c_1aff2566f4c366b48d73479bef43ee4d2e" compoundref="benchmarks_8c" startline="347">buffer</references>
        <references refid="connector_8c_1a239bebe1697b474e6f84945e9fb9faee" compoundref="connector_8c" startline="33">CHUNKSIZE</references>
        <references refid="structssh__connector__struct_1abfe4d6220cffdecb0596befdc269cfd1" compoundref="connector_8c" startline="68">ssh_connector_struct::in_available</references>
        <references refid="structssh__connector__struct_1aed6f65c2d6ceb1c1fb8c1189e69dbac5" compoundref="connector_8c" startline="58">ssh_connector_struct::in_fd</references>
        <references refid="structssh__channel__struct_1a84b4de0420fa99e2b0673d4b5eeb4875" compoundref="channels_8h" startline="66">ssh_channel_struct::local_eof</references>
        <references refid="priv_8h_1a3acffbd305ee72dcd4593c0d8af64a4f" compoundref="priv_8h" startline="306">MIN</references>
        <references refid="structssh__connector__struct_1aef4894f7b0135245d08eed5edf68be0b" compoundref="connector_8c" startline="56">ssh_connector_struct::out_channel</references>
        <references refid="structssh__connector__struct_1a820aee50995208d193f4fe295beb239e" compoundref="connector_8c" startline="59">ssh_connector_struct::out_fd</references>
        <references refid="structssh__connector__struct_1a739a35c9ae799e36bd8b9cc0b0de1254" compoundref="connector_8c" startline="75">ssh_connector_struct::out_flags</references>
        <references refid="structssh__connector__struct_1a96f134844f8a75d2954173500b4bd06f" compoundref="connector_8c" startline="69">ssh_connector_struct::out_wontblock</references>
        <references refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" compoundref="pkd__daemon_8c" startline="62">rc</references>
        <references refid="structssh__connector__struct_1a73b1b54b8c7ad4fb06e1841c7ad51285" compoundref="connector_8c" startline="53">ssh_connector_struct::session</references>
        <references refid="structssh__channel__callbacks__struct_1a883357b349e33dda4e4b9b94576d99ab" compoundref="callbacks_8h" startline="785">ssh_channel_callbacks_struct::size</references>
        <references refid="group__libssh__channel_1ga072f82fdf3e50514f747653af2c99004" compoundref="channels_8c" startline="1224" endline="1270">ssh_channel_send_eof</references>
        <references refid="group__libssh__channel_1gadf53c5a5b501086af26d06cba3f1491f" compoundref="channels_8c" startline="1536" endline="1538">ssh_channel_window_size</references>
        <references refid="group__libssh__channel_1ga5d658df773ba854b35ff9f905341e2fb" compoundref="channels_8c" startline="1553" endline="1555">ssh_channel_write</references>
        <references refid="group__libssh__channel_1ga7ebd0ed490ee4485c6d5feb7d22bc162" compoundref="channels_8c" startline="3438" endline="3440">ssh_channel_write_stderr</references>
        <references refid="connector_8c_1a56b96ae3387e0fca09be7e8c703afe32" compoundref="connector_8c" startline="200" endline="204">ssh_connector_except</references>
        <references refid="connector_8c_1a9d10a96cbda381bccc2fee5f2d5904c5" compoundref="connector_8c" startline="713" endline="726">ssh_connector_fd_read</references>
        <references refid="connector_8c_1a2c034263a1c5bab38564d40cbfc67631" compoundref="connector_8c" startline="734" endline="752">ssh_connector_fd_write</references>
        <references refid="libssh_8h_1a1b16de6e3d7453108e91d9e3a6608536a228d3e408dd67c003254e2d6d1395653" compoundref="libssh_8h" startline="447">SSH_CONNECTOR_STDOUT</references>
        <references refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" compoundref="libssh_8h" startline="330">SSH_ERROR</references>
        <references refid="libssh_8h_1a036b2b00fb04337a4d06d719d1b62be1a86ff0b2e8da6ad8628efc556b6ce1887" compoundref="libssh_8h" startline="286">SSH_FATAL</references>
        <references refid="libssh_8h_1a5f05b48043a1f47b36388227bee5d4f8" compoundref="libssh_8h" startline="140">SSH_INVALID_SOCKET</references>
        <references refid="priv_8h_1aa21fd8a7a609329603b7b16da7939fca" compoundref="priv_8h" startline="240">SSH_LOG</references>
        <references refid="libssh_8h_1a466c84d8dd5b1ba9162d491f31117a6b" compoundref="libssh_8h" startline="376">SSH_LOG_TRACE</references>
        <references refid="priv_8h_1a55177b3e8db90ca9adb435c44281963c" compoundref="priv_8h" startline="258">ssh_set_error</references>
        <referencedby refid="connector_8c_1a4cc7de304441a1cdb59c3656ad1a1678" compoundref="connector_8c" startline="513" endline="563">ssh_connector_channel_write_wontblock_cb</referencedby>
        <referencedby refid="connector_8c_1a3ee42f9fc7405a94313d6275aaa74db3" compoundref="connector_8c" startline="387" endline="407">ssh_connector_fd_cb</referencedby>
        <referencedby refid="connector_8c_1ad13c8d29eb297a425c51a53379450dd1" compoundref="connector_8c" startline="327" endline="370">ssh_connector_fd_out_cb</referencedby>
      </memberdef>
      <memberdef kind="function" id="connector_8c_1ad13c8d29eb297a425c51a53379450dd1" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>static void ssh_connector_fd_out_cb</definition>
        <argsstring>(ssh_connector connector)</argsstring>
        <name>ssh_connector_fd_out_cb</name>
        <param>
          <type><ref refid="libssh_8h_1ac087532dc357998a930d9924c76d27c0" kindref="member">ssh_connector</ref></type>
          <declname>connector</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/connector.c" line="327" column="13" bodyfile="src/connector.c" bodystart="327" bodyend="370"/>
        <references refid="benchmarks_8c_1aff2566f4c366b48d73479bef43ee4d2e" compoundref="benchmarks_8c" startline="347">buffer</references>
        <references refid="connector_8c_1a239bebe1697b474e6f84945e9fb9faee" compoundref="connector_8c" startline="33">CHUNKSIZE</references>
        <references refid="structssh__connector__struct_1abfe4d6220cffdecb0596befdc269cfd1" compoundref="connector_8c" startline="68">ssh_connector_struct::in_available</references>
        <references refid="structssh__connector__struct_1a8c09fde7984ab2b042d15f7b1c26965d" compoundref="connector_8c" startline="55">ssh_connector_struct::in_channel</references>
        <references refid="structssh__connector__struct_1aed6f65c2d6ceb1c1fb8c1189e69dbac5" compoundref="connector_8c" startline="58">ssh_connector_struct::in_fd</references>
        <references refid="structssh__connector__struct_1a820aee50995208d193f4fe295beb239e" compoundref="connector_8c" startline="59">ssh_connector_struct::out_fd</references>
        <references refid="structssh__connector__struct_1a96f134844f8a75d2954173500b4bd06f" compoundref="connector_8c" startline="69">ssh_connector_struct::out_wontblock</references>
        <references refid="structssh__connector__struct_1a73b1b54b8c7ad4fb06e1841c7ad51285" compoundref="connector_8c" startline="53">ssh_connector_struct::session</references>
        <references refid="group__libssh__channel_1gab535264029443d77214c0615a0788b0a" compoundref="channels_8c" startline="1596" endline="1608">ssh_channel_is_eof</references>
        <references refid="group__libssh__channel_1gaaca5a3fbe9839c3ffb37b746afc35f4c" compoundref="channels_8c" startline="2983" endline="3022">ssh_channel_read_nonblocking</references>
        <references refid="connector_8c_1a56b96ae3387e0fca09be7e8c703afe32" compoundref="connector_8c" startline="200" endline="204">ssh_connector_except</references>
        <references refid="connector_8c_1a14a16f59cb2bc11c26075ac392898529" compoundref="connector_8c" startline="207" endline="212">ssh_connector_except_channel</references>
        <references refid="connector_8c_1a83806fe46fe887adb695eeca7f35682a" compoundref="connector_8c" startline="243" endline="322">ssh_connector_fd_in_cb</references>
        <references refid="connector_8c_1a2c034263a1c5bab38564d40cbfc67631" compoundref="connector_8c" startline="734" endline="752">ssh_connector_fd_write</references>
        <references refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" compoundref="libssh_8h" startline="330">SSH_ERROR</references>
        <references refid="libssh_8h_1a036b2b00fb04337a4d06d719d1b62be1a86ff0b2e8da6ad8628efc556b6ce1887" compoundref="libssh_8h" startline="286">SSH_FATAL</references>
        <references refid="libssh_8h_1a5f05b48043a1f47b36388227bee5d4f8" compoundref="libssh_8h" startline="140">SSH_INVALID_SOCKET</references>
        <references refid="priv_8h_1aa21fd8a7a609329603b7b16da7939fca" compoundref="priv_8h" startline="240">SSH_LOG</references>
        <references refid="libssh_8h_1a466c84d8dd5b1ba9162d491f31117a6b" compoundref="libssh_8h" startline="376">SSH_LOG_TRACE</references>
        <references refid="priv_8h_1a55177b3e8db90ca9adb435c44281963c" compoundref="priv_8h" startline="258">ssh_set_error</references>
        <referencedby refid="connector_8c_1a3ee42f9fc7405a94313d6275aaa74db3" compoundref="connector_8c" startline="387" endline="407">ssh_connector_fd_cb</referencedby>
      </memberdef>
      <memberdef kind="function" id="connector_8c_1a3ee42f9fc7405a94313d6275aaa74db3" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>static int ssh_connector_fd_cb</definition>
        <argsstring>(ssh_poll_handle p, socket_t fd, int revents, void *userdata)</argsstring>
        <name>ssh_connector_fd_cb</name>
        <param>
          <type><ref refid="poll_8h_1a8e1c9d5d48b80ed51c850241321baddf" kindref="member">ssh_poll_handle</ref></type>
          <declname>p</declname>
        </param>
        <param>
          <type><ref refid="libssh_8h_1a30353f381f5fccbb956eea1f3a110b6c" kindref="member">socket_t</ref></type>
          <declname>fd</declname>
        </param>
        <param>
          <type>int</type>
          <declname>revents</declname>
        </param>
        <param>
          <type>void *</type>
          <declname>userdata</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/connector.c" line="387" column="12" bodyfile="src/connector.c" bodystart="387" bodyend="407"/>
        <references refid="structssh__connector__struct_1aed6f65c2d6ceb1c1fb8c1189e69dbac5" compoundref="connector_8c" startline="58">ssh_connector_struct::in_fd</references>
        <references refid="structssh__connector__struct_1a820aee50995208d193f4fe295beb239e" compoundref="connector_8c" startline="59">ssh_connector_struct::out_fd</references>
        <references refid="poll_8h_1ab1c532446408c98559d4aaaeeeb99820" compoundref="poll_8h" startline="92">POLLERR</references>
        <references refid="poll_8h_1a262754fe6bdf27c2cd3da43284ec8536" compoundref="poll_8h" startline="95">POLLHUP</references>
        <references refid="poll_8h_1a52ac479a805051f59643588b096024ff" compoundref="poll_8h" startline="82">POLLIN</references>
        <references refid="poll_8h_1a91b3c67129ac7675062f316b840a0d58" compoundref="poll_8h" startline="88">POLLOUT</references>
        <references refid="connector_8c_1a56b96ae3387e0fca09be7e8c703afe32" compoundref="connector_8c" startline="200" endline="204">ssh_connector_except</references>
        <references refid="connector_8c_1a83806fe46fe887adb695eeca7f35682a" compoundref="connector_8c" startline="243" endline="322">ssh_connector_fd_in_cb</references>
        <references refid="connector_8c_1ad13c8d29eb297a425c51a53379450dd1" compoundref="connector_8c" startline="327" endline="370">ssh_connector_fd_out_cb</references>
        <references refid="connector_8c_1a49e333bf300287cfadad801243c2d7f7" compoundref="connector_8c" startline="219" endline="236">ssh_connector_reset_pollevents</references>
        <references refid="structssh__channel__callbacks__struct_1ae7a7877dfb4eca2a39e5f281832c15f0" compoundref="callbacks_8h" startline="789">ssh_channel_callbacks_struct::userdata</references>
        <referencedby refid="priv_8h_1a84015bb99d7ac6fe60fe6e61dbd0e1cf" compoundref="connector_8c" startline="565" endline="628">ssh_connector_set_event</referencedby>
      </memberdef>
      <memberdef kind="function" id="connector_8c_1a84015bb99d7ac6fe60fe6e61dbd0e1cf" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>int ssh_connector_set_event</definition>
        <argsstring>(ssh_connector connector, ssh_event event)</argsstring>
        <name>ssh_connector_set_event</name>
        <param>
          <type><ref refid="libssh_8h_1ac087532dc357998a930d9924c76d27c0" kindref="member">ssh_connector</ref></type>
          <declname>connector</declname>
        </param>
        <param>
          <type><ref refid="libssh_8h_1a55d4fb68310b11167e82fcd49dc9069f" kindref="member">ssh_event</ref></type>
          <declname>event</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/connector.c" line="565" column="5" bodyfile="src/connector.c" bodystart="565" bodyend="628"/>
        <references refid="proxy_8c_1a11614f44ef4d939bdd984953346a7572" compoundref="proxy_8c" startline="33">error</references>
        <references refid="structssh__connector__struct_1aae4c1c8966793b6649a59085aeec3ff6" compoundref="connector_8c" startline="66">ssh_connector_struct::event</references>
        <references refid="structssh__connector__struct_1abfe4d6220cffdecb0596befdc269cfd1" compoundref="connector_8c" startline="68">ssh_connector_struct::in_available</references>
        <references refid="structssh__connector__struct_1a8c09fde7984ab2b042d15f7b1c26965d" compoundref="connector_8c" startline="55">ssh_connector_struct::in_channel</references>
        <references refid="structssh__connector__struct_1aed6f65c2d6ceb1c1fb8c1189e69dbac5" compoundref="connector_8c" startline="58">ssh_connector_struct::in_fd</references>
        <references refid="structssh__connector__struct_1a3d27a520636b09b59437e6d5666ce44c" compoundref="connector_8c" startline="63">ssh_connector_struct::in_poll</references>
        <references refid="structssh__connector__struct_1aef4894f7b0135245d08eed5edf68be0b" compoundref="connector_8c" startline="56">ssh_connector_struct::out_channel</references>
        <references refid="structssh__connector__struct_1a820aee50995208d193f4fe295beb239e" compoundref="connector_8c" startline="59">ssh_connector_struct::out_fd</references>
        <references refid="structssh__connector__struct_1abab4576fbd113acfaf860eedf6a60624" compoundref="connector_8c" startline="64">ssh_connector_struct::out_poll</references>
        <references refid="structssh__connector__struct_1a96f134844f8a75d2954173500b4bd06f" compoundref="connector_8c" startline="69">ssh_connector_struct::out_wontblock</references>
        <references refid="poll_8h_1ab1c532446408c98559d4aaaeeeb99820" compoundref="poll_8h" startline="92">POLLERR</references>
        <references refid="poll_8h_1a52ac479a805051f59643588b096024ff" compoundref="poll_8h" startline="82">POLLIN</references>
        <references refid="poll_8h_1a91b3c67129ac7675062f316b840a0d58" compoundref="poll_8h" startline="88">POLLOUT</references>
        <references refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" compoundref="pkd__daemon_8c" startline="62">rc</references>
        <references refid="structssh__connector__struct_1a73b1b54b8c7ad4fb06e1841c7ad51285" compoundref="connector_8c" startline="53">ssh_connector_struct::session</references>
        <references refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" compoundref="torture__session__keys_8c" startline="61">session</references>
        <references refid="group__libssh__channel_1ga747aa5315575aa7ac9d8367c7372d8dd" compoundref="channels_8c" startline="3144" endline="3150">ssh_channel_get_session</references>
        <references refid="group__libssh__channel_1gab56c7b7959e4c23959f2989468811661" compoundref="channels_8c" startline="3090" endline="3135">ssh_channel_poll_timeout</references>
        <references refid="group__libssh__channel_1gadf53c5a5b501086af26d06cba3f1491f" compoundref="channels_8c" startline="1536" endline="1538">ssh_channel_window_size</references>
        <references refid="connector_8c_1a3ee42f9fc7405a94313d6275aaa74db3" compoundref="connector_8c" startline="387" endline="407">ssh_connector_fd_cb</references>
        <references refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" compoundref="libssh_8h" startline="330">SSH_ERROR</references>
        <references refid="group__libssh__poll_1gaaf3e1df762650369e99595eee761f2a9" compoundref="poll_8c" startline="857" endline="860">ssh_event_add_poll</references>
        <references refid="group__libssh__poll_1ga51af38de4cc3adbd5566ec1f1b91983d" compoundref="poll_8c" startline="884" endline="923">ssh_event_add_session</references>
        <references refid="libssh_8h_1a036b2b00fb04337a4d06d719d1b62be1a86ff0b2e8da6ad8628efc556b6ce1887" compoundref="libssh_8h" startline="286">SSH_FATAL</references>
        <references refid="libssh_8h_1a5f05b48043a1f47b36388227bee5d4f8" compoundref="libssh_8h" startline="140">SSH_INVALID_SOCKET</references>
        <references refid="libssh_8h_1ac1ee1d1e917456d4760a94a18015377d" compoundref="libssh_8h" startline="329">SSH_OK</references>
        <references refid="group__libssh__poll_1gac657ed07db9e5851ffb0aba45e071e99" compoundref="poll_8c" startline="351" endline="367">ssh_poll_new</references>
        <references refid="priv_8h_1a55177b3e8db90ca9adb435c44281963c" compoundref="priv_8h" startline="258">ssh_set_error</references>
        <referencedby refid="group__libssh__poll_1gae1f53a6ce420a41ae06ffb962f477f99" compoundref="poll_8c" startline="936" endline="938">ssh_event_add_connector</referencedby>
      </memberdef>
      <memberdef kind="function" id="connector_8c_1ad92def69fc9cce5d1d564588e668a862" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>int ssh_connector_remove_event</definition>
        <argsstring>(ssh_connector connector)</argsstring>
        <name>ssh_connector_remove_event</name>
        <param>
          <type><ref refid="libssh_8h_1ac087532dc357998a930d9924c76d27c0" kindref="member">ssh_connector</ref></type>
          <declname>connector</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/connector.c" line="630" column="5" bodyfile="src/connector.c" bodystart="630" bodyend="659"/>
        <references refid="structssh__connector__struct_1aae4c1c8966793b6649a59085aeec3ff6" compoundref="connector_8c" startline="66">ssh_connector_struct::event</references>
        <references refid="structssh__connector__struct_1a8c09fde7984ab2b042d15f7b1c26965d" compoundref="connector_8c" startline="55">ssh_connector_struct::in_channel</references>
        <references refid="structssh__connector__struct_1a3d27a520636b09b59437e6d5666ce44c" compoundref="connector_8c" startline="63">ssh_connector_struct::in_poll</references>
        <references refid="structssh__connector__struct_1aef4894f7b0135245d08eed5edf68be0b" compoundref="connector_8c" startline="56">ssh_connector_struct::out_channel</references>
        <references refid="structssh__connector__struct_1abab4576fbd113acfaf860eedf6a60624" compoundref="connector_8c" startline="64">ssh_connector_struct::out_poll</references>
        <references refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" compoundref="torture__session__keys_8c" startline="61">session</references>
        <references refid="group__libssh__channel_1ga747aa5315575aa7ac9d8367c7372d8dd" compoundref="channels_8c" startline="3144" endline="3150">ssh_channel_get_session</references>
        <references refid="group__libssh__poll_1ga302e3942e697063f1a54319667231f73" compoundref="poll_8c" startline="869" endline="872">ssh_event_remove_poll</references>
        <references refid="group__libssh__poll_1gaab8dec05a0afb49392c63b2ec158ac3d" compoundref="poll_8c" startline="1022" endline="1068">ssh_event_remove_session</references>
        <references refid="libssh_8h_1ac1ee1d1e917456d4760a94a18015377d" compoundref="libssh_8h" startline="329">SSH_OK</references>
        <references refid="group__libssh__poll_1ga873ecc6866c286f7777612d94de5c00d" compoundref="poll_8c" startline="376" endline="382">ssh_poll_free</references>
        <referencedby refid="libssh_8h_1ae082e4d35591a2f2f3074f28049ff993" compoundref="connector_8c" startline="125" endline="151">ssh_connector_free</referencedby>
        <referencedby refid="group__libssh__poll_1gae120116df5a1da09ee9edd42e6a63397" compoundref="poll_8c" startline="1076" endline="1079">ssh_event_remove_connector</referencedby>
      </memberdef>
      </sectiondef>
    <briefdescription>
    </briefdescription>
    <detaileddescription>
    </detaileddescription>
    <programlisting>
<codeline lineno="1"><highlight class="comment">/*</highlight></codeline>
<codeline lineno="2"><highlight class="comment"><sp/>*<sp/>This<sp/>file<sp/>is<sp/>part<sp/>of<sp/>the<sp/>SSH<sp/>Library</highlight></codeline>
<codeline lineno="3"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="4"><highlight class="comment"><sp/>*<sp/>Copyright<sp/>(c)<sp/>2015<sp/>by<sp/>Aris<sp/>Adamantiadis<sp/>&lt;aris@badcode.be&gt;</highlight></codeline>
<codeline lineno="5"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="6"><highlight class="comment"><sp/>*<sp/>The<sp/>SSH<sp/>Library<sp/>is<sp/>free<sp/>software;<sp/>you<sp/>can<sp/>redistribute<sp/>it<sp/>and/or<sp/>modify</highlight></codeline>
<codeline lineno="7"><highlight class="comment"><sp/>*<sp/>it<sp/>under<sp/>the<sp/>terms<sp/>of<sp/>the<sp/>GNU<sp/>Lesser<sp/>General<sp/>Public<sp/>License<sp/>as<sp/>published<sp/>by</highlight></codeline>
<codeline lineno="8"><highlight class="comment"><sp/>*<sp/>the<sp/>Free<sp/>Software<sp/>Foundation;<sp/>either<sp/>version<sp/>2.1<sp/>of<sp/>the<sp/>License,<sp/>or<sp/>(at<sp/>your</highlight></codeline>
<codeline lineno="9"><highlight class="comment"><sp/>*<sp/>option)<sp/>any<sp/>later<sp/>version.</highlight></codeline>
<codeline lineno="10"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="11"><highlight class="comment"><sp/>*<sp/>The<sp/>SSH<sp/>Library<sp/>is<sp/>distributed<sp/>in<sp/>the<sp/>hope<sp/>that<sp/>it<sp/>will<sp/>be<sp/>useful,<sp/>but</highlight></codeline>
<codeline lineno="12"><highlight class="comment"><sp/>*<sp/>WITHOUT<sp/>ANY<sp/>WARRANTY;<sp/>without<sp/>even<sp/>the<sp/>implied<sp/>warranty<sp/>of<sp/>MERCHANTABILITY</highlight></codeline>
<codeline lineno="13"><highlight class="comment"><sp/>*<sp/>or<sp/>FITNESS<sp/>FOR<sp/>A<sp/>PARTICULAR<sp/>PURPOSE.<sp/><sp/>See<sp/>the<sp/>GNU<sp/>Lesser<sp/>General<sp/>Public</highlight></codeline>
<codeline lineno="14"><highlight class="comment"><sp/>*<sp/>License<sp/>for<sp/>more<sp/>details.</highlight></codeline>
<codeline lineno="15"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="16"><highlight class="comment"><sp/>*<sp/>You<sp/>should<sp/>have<sp/>received<sp/>a<sp/>copy<sp/>of<sp/>the<sp/>GNU<sp/>Lesser<sp/>General<sp/>Public<sp/>License</highlight></codeline>
<codeline lineno="17"><highlight class="comment"><sp/>*<sp/>along<sp/>with<sp/>the<sp/>SSH<sp/>Library;<sp/>see<sp/>the<sp/>file<sp/>COPYING.<sp/><sp/>If<sp/>not,<sp/>write<sp/>to</highlight></codeline>
<codeline lineno="18"><highlight class="comment"><sp/>*<sp/>the<sp/>Free<sp/>Software<sp/>Foundation,<sp/>Inc.,<sp/>59<sp/>Temple<sp/>Place<sp/>-<sp/>Suite<sp/>330,<sp/>Boston,</highlight></codeline>
<codeline lineno="19"><highlight class="comment"><sp/>*<sp/>MA<sp/>02111-1307,<sp/>USA.</highlight></codeline>
<codeline lineno="20"><highlight class="comment"><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="21"><highlight class="normal"></highlight></codeline>
<codeline lineno="22"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="config_8h" kindref="compound">config.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="23"><highlight class="normal"></highlight></codeline>
<codeline lineno="24"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="priv_8h" kindref="compound">libssh/priv.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="25"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="poll_8h" kindref="compound">libssh/poll.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="26"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="callbacks_8h" kindref="compound">libssh/callbacks.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="27"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="session_8h" kindref="compound">libssh/session.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="28"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;stdlib.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="29"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;errno.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="30"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;stdbool.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="31"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;sys/stat.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="32"><highlight class="normal"></highlight></codeline>
<codeline lineno="33" refid="connector_8c_1a239bebe1697b474e6f84945e9fb9faee" refkind="member"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>CHUNKSIZE<sp/>4096</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="34"><highlight class="normal"></highlight></codeline>
<codeline lineno="35"><highlight class="normal"></highlight><highlight class="preprocessor">#ifdef<sp/>_WIN32</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="36"><highlight class="normal"></highlight><highlight class="preprocessor">#<sp/>ifdef<sp/>HAVE_IO_H</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="37"><highlight class="normal"></highlight><highlight class="preprocessor">#<sp/><sp/>include<sp/>&lt;io.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="38"><highlight class="normal"></highlight><highlight class="preprocessor">#<sp/><sp/>undef<sp/>open</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="39"><highlight class="normal"></highlight><highlight class="preprocessor">#<sp/><sp/>define<sp/>open<sp/>_open</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="40"><highlight class="normal"></highlight><highlight class="preprocessor">#<sp/><sp/>undef<sp/>close</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="41"><highlight class="normal"></highlight><highlight class="preprocessor">#<sp/><sp/>define<sp/>close<sp/>_close</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="42"><highlight class="normal"></highlight><highlight class="preprocessor">#<sp/><sp/>undef<sp/>read</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="43"><highlight class="normal"></highlight><highlight class="preprocessor">#<sp/><sp/>define<sp/>read<sp/>_read</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="44"><highlight class="normal"></highlight><highlight class="preprocessor">#<sp/><sp/>undef<sp/>unlink</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="45"><highlight class="normal"></highlight><highlight class="preprocessor">#<sp/><sp/>define<sp/>unlink<sp/>_unlink</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="46"><highlight class="normal"></highlight><highlight class="preprocessor">#<sp/>endif<sp/></highlight><highlight class="comment">/*<sp/>HAVE_IO_H<sp/>*/</highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="47"><highlight class="normal"></highlight><highlight class="preprocessor">#else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="48"><highlight class="normal"></highlight><highlight class="preprocessor">#<sp/>include<sp/>&lt;sys/types.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="49"><highlight class="normal"></highlight><highlight class="preprocessor">#<sp/>include<sp/>&lt;sys/socket.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="50"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="51"><highlight class="normal"></highlight></codeline>
<codeline lineno="52" refid="structssh__connector__struct" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">struct<sp/></highlight><highlight class="normal"><ref refid="structssh__connector__struct" kindref="compound">ssh_connector_struct</ref><sp/>{</highlight></codeline>
<codeline lineno="53" refid="structssh__connector__struct_1a73b1b54b8c7ad4fb06e1841c7ad51285" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="structssh__session__struct" kindref="compound">ssh_session</ref><sp/><ref refid="structssh__connector__struct_1a73b1b54b8c7ad4fb06e1841c7ad51285" kindref="member">session</ref>;</highlight></codeline>
<codeline lineno="54"><highlight class="normal"></highlight></codeline>
<codeline lineno="55" refid="structssh__connector__struct_1a8c09fde7984ab2b042d15f7b1c26965d" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="structssh__channel__struct" kindref="compound">ssh_channel</ref><sp/><ref refid="structssh__connector__struct_1a8c09fde7984ab2b042d15f7b1c26965d" kindref="member">in_channel</ref>;</highlight></codeline>
<codeline lineno="56" refid="structssh__connector__struct_1aef4894f7b0135245d08eed5edf68be0b" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="structssh__channel__struct" kindref="compound">ssh_channel</ref><sp/><ref refid="structssh__connector__struct_1aef4894f7b0135245d08eed5edf68be0b" kindref="member">out_channel</ref>;</highlight></codeline>
<codeline lineno="57"><highlight class="normal"></highlight></codeline>
<codeline lineno="58" refid="structssh__connector__struct_1aed6f65c2d6ceb1c1fb8c1189e69dbac5" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="libssh_8h_1a30353f381f5fccbb956eea1f3a110b6c" kindref="member">socket_t</ref><sp/><ref refid="structssh__connector__struct_1aed6f65c2d6ceb1c1fb8c1189e69dbac5" kindref="member">in_fd</ref>;</highlight></codeline>
<codeline lineno="59" refid="structssh__connector__struct_1a820aee50995208d193f4fe295beb239e" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="libssh_8h_1a30353f381f5fccbb956eea1f3a110b6c" kindref="member">socket_t</ref><sp/><ref refid="structssh__connector__struct_1a820aee50995208d193f4fe295beb239e" kindref="member">out_fd</ref>;</highlight></codeline>
<codeline lineno="60"><highlight class="normal"></highlight></codeline>
<codeline lineno="61" refid="structssh__connector__struct_1aa7f4b9010c7f112fff0385e6e677b329" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/><ref refid="structssh__connector__struct_1aa7f4b9010c7f112fff0385e6e677b329" kindref="member">fd_is_socket</ref>;</highlight></codeline>
<codeline lineno="62"><highlight class="normal"></highlight></codeline>
<codeline lineno="63" refid="structssh__connector__struct_1a3d27a520636b09b59437e6d5666ce44c" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="structssh__poll__handle__struct" kindref="compound">ssh_poll_handle</ref><sp/><ref refid="structssh__connector__struct_1a3d27a520636b09b59437e6d5666ce44c" kindref="member">in_poll</ref>;</highlight></codeline>
<codeline lineno="64" refid="structssh__connector__struct_1abab4576fbd113acfaf860eedf6a60624" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="structssh__poll__handle__struct" kindref="compound">ssh_poll_handle</ref><sp/><ref refid="structssh__connector__struct_1abab4576fbd113acfaf860eedf6a60624" kindref="member">out_poll</ref>;</highlight></codeline>
<codeline lineno="65"><highlight class="normal"></highlight></codeline>
<codeline lineno="66" refid="structssh__connector__struct_1aae4c1c8966793b6649a59085aeec3ff6" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="structssh__event__struct" kindref="compound">ssh_event</ref><sp/><ref refid="structssh__connector__struct_1aae4c1c8966793b6649a59085aeec3ff6" kindref="member">event</ref>;</highlight></codeline>
<codeline lineno="67"><highlight class="normal"></highlight></codeline>
<codeline lineno="68" refid="structssh__connector__struct_1abfe4d6220cffdecb0596befdc269cfd1" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="structssh__connector__struct_1abfe4d6220cffdecb0596befdc269cfd1" kindref="member">in_available</ref>;</highlight></codeline>
<codeline lineno="69" refid="structssh__connector__struct_1a39e9a36b0de9750140e993541de99a8d" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="structssh__connector__struct_1a96f134844f8a75d2954173500b4bd06f" kindref="member">out_wontblock</ref>;</highlight></codeline>
<codeline lineno="70"><highlight class="normal"></highlight></codeline>
<codeline lineno="71"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">struct<sp/></highlight><highlight class="normal"><ref refid="structssh__channel__callbacks__struct" kindref="compound">ssh_channel_callbacks_struct</ref><sp/><ref refid="structssh__connector__struct_1a39e9a36b0de9750140e993541de99a8d" kindref="member">in_channel_cb</ref>;</highlight></codeline>
<codeline lineno="72"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">struct<sp/></highlight><highlight class="normal"><ref refid="structssh__channel__callbacks__struct" kindref="compound">ssh_channel_callbacks_struct</ref><sp/><ref refid="structssh__connector__struct_1ae3c4aa83afae3a01cda7e142b9191c3b" kindref="member">out_channel_cb</ref>;</highlight></codeline>
<codeline lineno="73"><highlight class="normal"></highlight></codeline>
<codeline lineno="74"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">enum</highlight><highlight class="normal"><sp/><ref refid="libssh_8h_1a1b16de6e3d7453108e91d9e3a6608536" kindref="member">ssh_connector_flags_e</ref><sp/><ref refid="structssh__connector__struct_1a85f7eab9bedc749ea78ca1872247d10e" kindref="member">in_flags</ref>;</highlight></codeline>
<codeline lineno="75"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">enum</highlight><highlight class="normal"><sp/><ref refid="libssh_8h_1a1b16de6e3d7453108e91d9e3a6608536" kindref="member">ssh_connector_flags_e</ref><sp/><ref refid="structssh__connector__struct_1a739a35c9ae799e36bd8b9cc0b0de1254" kindref="member">out_flags</ref>;</highlight></codeline>
<codeline lineno="76"><highlight class="normal">};</highlight></codeline>
<codeline lineno="77"><highlight class="normal"></highlight></codeline>
<codeline lineno="78"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="connector_8c_1ad994e6c0acb9b1f2eab185da25fd46b8" kindref="member">ssh_connector_channel_data_cb</ref>(<ref refid="structssh__session__struct" kindref="compound">ssh_session</ref><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>,</highlight></codeline>
<codeline lineno="79"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structssh__channel__struct" kindref="compound">ssh_channel</ref><sp/>channel,</highlight></codeline>
<codeline lineno="80"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>*data,</highlight></codeline>
<codeline lineno="81"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>uint32_t<sp/>len,</highlight></codeline>
<codeline lineno="82"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>is_stderr,</highlight></codeline>
<codeline lineno="83"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>*<ref refid="structssh__channel__callbacks__struct_1ae7a7877dfb4eca2a39e5f281832c15f0" kindref="member">userdata</ref>);</highlight></codeline>
<codeline lineno="84"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="connector_8c_1a4cc7de304441a1cdb59c3656ad1a1678" kindref="member">ssh_connector_channel_write_wontblock_cb</ref>(<ref refid="structssh__session__struct" kindref="compound">ssh_session</ref><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>,</highlight></codeline>
<codeline lineno="85"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structssh__channel__struct" kindref="compound">ssh_channel</ref><sp/>channel,</highlight></codeline>
<codeline lineno="86"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/>bytes,</highlight></codeline>
<codeline lineno="87"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>*<ref refid="structssh__channel__callbacks__struct_1ae7a7877dfb4eca2a39e5f281832c15f0" kindref="member">userdata</ref>);</highlight></codeline>
<codeline lineno="88"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/>ssize_t<sp/><ref refid="connector_8c_1a9d10a96cbda381bccc2fee5f2d5904c5" kindref="member">ssh_connector_fd_read</ref>(<ref refid="structssh__connector__struct" kindref="compound">ssh_connector</ref><sp/>connector,</highlight></codeline>
<codeline lineno="89"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>*<ref refid="benchmarks_8c_1aff2566f4c366b48d73479bef43ee4d2e" kindref="member">buffer</ref>,</highlight></codeline>
<codeline lineno="90"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>uint32_t<sp/>len);</highlight></codeline>
<codeline lineno="91"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/>ssize_t<sp/><ref refid="connector_8c_1a2c034263a1c5bab38564d40cbfc67631" kindref="member">ssh_connector_fd_write</ref>(<ref refid="structssh__connector__struct" kindref="compound">ssh_connector</ref><sp/>connector,</highlight></codeline>
<codeline lineno="92"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>*<ref refid="benchmarks_8c_1aff2566f4c366b48d73479bef43ee4d2e" kindref="member">buffer</ref>,</highlight></codeline>
<codeline lineno="93"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>uint32_t<sp/>len);</highlight></codeline>
<codeline lineno="94"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/><ref refid="connector_8c_1a7a60e4126deea02a1dac73121e321245" kindref="member">ssh_connector_fd_is_socket</ref>(<ref refid="libssh_8h_1a30353f381f5fccbb956eea1f3a110b6c" kindref="member">socket_t</ref><sp/>socket);</highlight></codeline>
<codeline lineno="95"><highlight class="normal"></highlight></codeline>
<codeline lineno="96" refid="libssh_8h_1abe75f2d91dee85a3834ee50a69b64385" refkind="member"><highlight class="normal"><ref refid="structssh__connector__struct" kindref="compound">ssh_connector</ref><sp/><ref refid="connector_8c_1a6923476bf129f12137af85ca238fb498" kindref="member">ssh_connector_new</ref>(<ref refid="structssh__session__struct" kindref="compound">ssh_session</ref><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>)</highlight></codeline>
<codeline lineno="97"><highlight class="normal">{</highlight></codeline>
<codeline lineno="98"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="structssh__connector__struct" kindref="compound">ssh_connector</ref><sp/>connector;</highlight></codeline>
<codeline lineno="99"><highlight class="normal"></highlight></codeline>
<codeline lineno="100"><highlight class="normal"><sp/><sp/><sp/><sp/>connector<sp/>=<sp/>calloc(1,<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(</highlight><highlight class="keyword">struct</highlight><highlight class="normal"><sp/><ref refid="structssh__connector__struct" kindref="compound">ssh_connector_struct</ref>));</highlight></codeline>
<codeline lineno="101"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(connector<sp/>==<sp/>NULL){</highlight></codeline>
<codeline lineno="102"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="priv_8h_1ae280c413c792e04237f000841ac8ce44" kindref="member">ssh_set_error_oom</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>);</highlight></codeline>
<codeline lineno="103"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>NULL;</highlight></codeline>
<codeline lineno="104"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="105"><highlight class="normal"></highlight></codeline>
<codeline lineno="106"><highlight class="normal"><sp/><sp/><sp/><sp/>connector-&gt;<ref refid="structssh__connector__struct_1a73b1b54b8c7ad4fb06e1841c7ad51285" kindref="member">session</ref><sp/>=<sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>;</highlight></codeline>
<codeline lineno="107"><highlight class="normal"><sp/><sp/><sp/><sp/>connector-&gt;<ref refid="structssh__connector__struct_1aed6f65c2d6ceb1c1fb8c1189e69dbac5" kindref="member">in_fd</ref><sp/>=<sp/><ref refid="libssh_8h_1a5f05b48043a1f47b36388227bee5d4f8" kindref="member">SSH_INVALID_SOCKET</ref>;</highlight></codeline>
<codeline lineno="108"><highlight class="normal"><sp/><sp/><sp/><sp/>connector-&gt;<ref refid="structssh__connector__struct_1a820aee50995208d193f4fe295beb239e" kindref="member">out_fd</ref><sp/>=<sp/><ref refid="libssh_8h_1a5f05b48043a1f47b36388227bee5d4f8" kindref="member">SSH_INVALID_SOCKET</ref>;</highlight></codeline>
<codeline lineno="109"><highlight class="normal"></highlight></codeline>
<codeline lineno="110"><highlight class="normal"><sp/><sp/><sp/><sp/>connector-&gt;<ref refid="structssh__connector__struct_1aa7f4b9010c7f112fff0385e6e677b329" kindref="member">fd_is_socket</ref><sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="111"><highlight class="normal"></highlight></codeline>
<codeline lineno="112"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="group__libssh__callbacks_1gafe09b81e5346f0babe288dc38113d289" kindref="member">ssh_callbacks_init</ref>(&amp;connector-&gt;<ref refid="structssh__connector__struct_1a39e9a36b0de9750140e993541de99a8d" kindref="member">in_channel_cb</ref>);</highlight></codeline>
<codeline lineno="113"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="group__libssh__callbacks_1gafe09b81e5346f0babe288dc38113d289" kindref="member">ssh_callbacks_init</ref>(&amp;connector-&gt;<ref refid="structssh__connector__struct_1ae3c4aa83afae3a01cda7e142b9191c3b" kindref="member">out_channel_cb</ref>);</highlight></codeline>
<codeline lineno="114"><highlight class="normal"></highlight></codeline>
<codeline lineno="115"><highlight class="normal"><sp/><sp/><sp/><sp/>connector-&gt;<ref refid="structssh__connector__struct_1a39e9a36b0de9750140e993541de99a8d" kindref="member">in_channel_cb</ref>.<ref refid="structssh__channel__callbacks__struct_1ae7a7877dfb4eca2a39e5f281832c15f0" kindref="member">userdata</ref><sp/>=<sp/>connector;</highlight></codeline>
<codeline lineno="116"><highlight class="normal"><sp/><sp/><sp/><sp/>connector-&gt;<ref refid="structssh__connector__struct_1a39e9a36b0de9750140e993541de99a8d" kindref="member">in_channel_cb</ref>.<ref refid="structssh__channel__callbacks__struct_1a12b38a7c3b2a38493c8d841015e7e8af" kindref="member">channel_data_function</ref><sp/>=<sp/><ref refid="connector_8c_1ad994e6c0acb9b1f2eab185da25fd46b8" kindref="member">ssh_connector_channel_data_cb</ref>;</highlight></codeline>
<codeline lineno="117"><highlight class="normal"></highlight></codeline>
<codeline lineno="118"><highlight class="normal"><sp/><sp/><sp/><sp/>connector-&gt;<ref refid="structssh__connector__struct_1ae3c4aa83afae3a01cda7e142b9191c3b" kindref="member">out_channel_cb</ref>.<ref refid="structssh__channel__callbacks__struct_1ae7a7877dfb4eca2a39e5f281832c15f0" kindref="member">userdata</ref><sp/>=<sp/>connector;</highlight></codeline>
<codeline lineno="119"><highlight class="normal"><sp/><sp/><sp/><sp/>connector-&gt;<ref refid="structssh__connector__struct_1ae3c4aa83afae3a01cda7e142b9191c3b" kindref="member">out_channel_cb</ref>.<ref refid="structssh__channel__callbacks__struct_1a1e8a2b155fe4ab0a745556583db7dac9" kindref="member">channel_write_wontblock_function</ref><sp/>=</highlight></codeline>
<codeline lineno="120"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="connector_8c_1a4cc7de304441a1cdb59c3656ad1a1678" kindref="member">ssh_connector_channel_write_wontblock_cb</ref>;</highlight></codeline>
<codeline lineno="121"><highlight class="normal"></highlight></codeline>
<codeline lineno="122"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>connector;</highlight></codeline>
<codeline lineno="123"><highlight class="normal">}</highlight></codeline>
<codeline lineno="124"><highlight class="normal"></highlight></codeline>
<codeline lineno="125" refid="libssh_8h_1ae082e4d35591a2f2f3074f28049ff993" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="connector_8c_1aef2bbc39f4fb5bb7b522a41237b08f89" kindref="member">ssh_connector_free</ref><sp/>(<ref refid="structssh__connector__struct" kindref="compound">ssh_connector</ref><sp/>connector)</highlight></codeline>
<codeline lineno="126"><highlight class="normal">{</highlight></codeline>
<codeline lineno="127"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(connector-&gt;<ref refid="structssh__connector__struct_1a8c09fde7984ab2b042d15f7b1c26965d" kindref="member">in_channel</ref><sp/>!=<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="128"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="group__libssh__callbacks_1gae564352175e887c346a2e062f8124282" kindref="member">ssh_remove_channel_callbacks</ref>(connector-&gt;<ref refid="structssh__connector__struct_1a8c09fde7984ab2b042d15f7b1c26965d" kindref="member">in_channel</ref>,</highlight></codeline>
<codeline lineno="129"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&amp;connector-&gt;<ref refid="structssh__connector__struct_1a39e9a36b0de9750140e993541de99a8d" kindref="member">in_channel_cb</ref>);</highlight></codeline>
<codeline lineno="130"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="131"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(connector-&gt;<ref refid="structssh__connector__struct_1aef4894f7b0135245d08eed5edf68be0b" kindref="member">out_channel</ref><sp/>!=<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="132"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="group__libssh__callbacks_1gae564352175e887c346a2e062f8124282" kindref="member">ssh_remove_channel_callbacks</ref>(connector-&gt;<ref refid="structssh__connector__struct_1aef4894f7b0135245d08eed5edf68be0b" kindref="member">out_channel</ref>,</highlight></codeline>
<codeline lineno="133"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&amp;connector-&gt;<ref refid="structssh__connector__struct_1ae3c4aa83afae3a01cda7e142b9191c3b" kindref="member">out_channel_cb</ref>);</highlight></codeline>
<codeline lineno="134"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="135"><highlight class="normal"></highlight></codeline>
<codeline lineno="136"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(connector-&gt;<ref refid="structssh__connector__struct_1aae4c1c8966793b6649a59085aeec3ff6" kindref="member">event</ref><sp/>!=<sp/>NULL){</highlight></codeline>
<codeline lineno="137"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="connector_8c_1ad92def69fc9cce5d1d564588e668a862" kindref="member">ssh_connector_remove_event</ref>(connector);</highlight></codeline>
<codeline lineno="138"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="139"><highlight class="normal"></highlight></codeline>
<codeline lineno="140"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(connector-&gt;<ref refid="structssh__connector__struct_1a3d27a520636b09b59437e6d5666ce44c" kindref="member">in_poll</ref><sp/>!=<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="141"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="group__libssh__poll_1ga873ecc6866c286f7777612d94de5c00d" kindref="member">ssh_poll_free</ref>(connector-&gt;<ref refid="structssh__connector__struct_1a3d27a520636b09b59437e6d5666ce44c" kindref="member">in_poll</ref>);</highlight></codeline>
<codeline lineno="142"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>connector-&gt;<ref refid="structssh__connector__struct_1a3d27a520636b09b59437e6d5666ce44c" kindref="member">in_poll</ref><sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="143"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="144"><highlight class="normal"></highlight></codeline>
<codeline lineno="145"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(connector-&gt;<ref refid="structssh__connector__struct_1abab4576fbd113acfaf860eedf6a60624" kindref="member">out_poll</ref><sp/>!=<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="146"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="group__libssh__poll_1ga873ecc6866c286f7777612d94de5c00d" kindref="member">ssh_poll_free</ref>(connector-&gt;<ref refid="structssh__connector__struct_1abab4576fbd113acfaf860eedf6a60624" kindref="member">out_poll</ref>);</highlight></codeline>
<codeline lineno="147"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>connector-&gt;<ref refid="structssh__connector__struct_1abab4576fbd113acfaf860eedf6a60624" kindref="member">out_poll</ref><sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="148"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="149"><highlight class="normal"></highlight></codeline>
<codeline lineno="150"><highlight class="normal"><sp/><sp/><sp/><sp/>free(connector);</highlight></codeline>
<codeline lineno="151"><highlight class="normal">}</highlight></codeline>
<codeline lineno="152"><highlight class="normal"></highlight></codeline>
<codeline lineno="153" refid="libssh_8h_1a43ca9065044b48afdede3e9fd9f1f86a" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="connector_8c_1af4ddaffee9e8676d84766cc64652c565" kindref="member">ssh_connector_set_in_channel</ref>(<ref refid="structssh__connector__struct" kindref="compound">ssh_connector</ref><sp/>connector,</highlight></codeline>
<codeline lineno="154"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structssh__channel__struct" kindref="compound">ssh_channel</ref><sp/>channel,</highlight></codeline>
<codeline lineno="155"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">enum</highlight><highlight class="normal"><sp/><ref refid="libssh_8h_1a1b16de6e3d7453108e91d9e3a6608536" kindref="member">ssh_connector_flags_e</ref><sp/>flags)</highlight></codeline>
<codeline lineno="156"><highlight class="normal">{</highlight></codeline>
<codeline lineno="157"><highlight class="normal"><sp/><sp/><sp/><sp/>connector-&gt;<ref refid="structssh__connector__struct_1a8c09fde7984ab2b042d15f7b1c26965d" kindref="member">in_channel</ref><sp/>=<sp/>channel;</highlight></codeline>
<codeline lineno="158"><highlight class="normal"><sp/><sp/><sp/><sp/>connector-&gt;<ref refid="structssh__connector__struct_1aed6f65c2d6ceb1c1fb8c1189e69dbac5" kindref="member">in_fd</ref><sp/>=<sp/><ref refid="libssh_8h_1a5f05b48043a1f47b36388227bee5d4f8" kindref="member">SSH_INVALID_SOCKET</ref>;</highlight></codeline>
<codeline lineno="159"><highlight class="normal"><sp/><sp/><sp/><sp/>connector-&gt;<ref refid="structssh__connector__struct_1a85f7eab9bedc749ea78ca1872247d10e" kindref="member">in_flags</ref><sp/>=<sp/>flags;</highlight></codeline>
<codeline lineno="160"><highlight class="normal"></highlight></codeline>
<codeline lineno="161"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Fallback<sp/>to<sp/>default<sp/>value<sp/>for<sp/>invalid<sp/>flags<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="162"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!(flags<sp/>&amp;<sp/><ref refid="libssh_8h_1a1b16de6e3d7453108e91d9e3a6608536a228d3e408dd67c003254e2d6d1395653" kindref="member">SSH_CONNECTOR_STDOUT</ref>)<sp/>&amp;&amp;<sp/>!(flags<sp/>&amp;<sp/><ref refid="libssh_8h_1a1b16de6e3d7453108e91d9e3a6608536a8990d435585796e3aecf7426e6041408" kindref="member">SSH_CONNECTOR_STDERR</ref>))<sp/>{</highlight></codeline>
<codeline lineno="163"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>connector-&gt;<ref refid="structssh__connector__struct_1a85f7eab9bedc749ea78ca1872247d10e" kindref="member">in_flags</ref><sp/>=<sp/><ref refid="libssh_8h_1a1b16de6e3d7453108e91d9e3a6608536a228d3e408dd67c003254e2d6d1395653" kindref="member">SSH_CONNECTOR_STDOUT</ref>;</highlight></codeline>
<codeline lineno="164"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="165"><highlight class="normal"></highlight></codeline>
<codeline lineno="166"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="group__libssh__callbacks_1ga2fd83df19998902f84f951fc47def83e" kindref="member">ssh_add_channel_callbacks</ref>(channel,<sp/>&amp;connector-&gt;<ref refid="structssh__connector__struct_1a39e9a36b0de9750140e993541de99a8d" kindref="member">in_channel_cb</ref>);</highlight></codeline>
<codeline lineno="167"><highlight class="normal">}</highlight></codeline>
<codeline lineno="168"><highlight class="normal"></highlight></codeline>
<codeline lineno="169" refid="libssh_8h_1a9545174e1a2727b15a620f09b7e8b348" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="connector_8c_1a4607653b47ce52ff65c2b910289898af" kindref="member">ssh_connector_set_out_channel</ref>(<ref refid="structssh__connector__struct" kindref="compound">ssh_connector</ref><sp/>connector,</highlight></codeline>
<codeline lineno="170"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structssh__channel__struct" kindref="compound">ssh_channel</ref><sp/>channel,</highlight></codeline>
<codeline lineno="171"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">enum</highlight><highlight class="normal"><sp/><ref refid="libssh_8h_1a1b16de6e3d7453108e91d9e3a6608536" kindref="member">ssh_connector_flags_e</ref><sp/>flags)</highlight></codeline>
<codeline lineno="172"><highlight class="normal">{</highlight></codeline>
<codeline lineno="173"><highlight class="normal"><sp/><sp/><sp/><sp/>connector-&gt;<ref refid="structssh__connector__struct_1aef4894f7b0135245d08eed5edf68be0b" kindref="member">out_channel</ref><sp/>=<sp/>channel;</highlight></codeline>
<codeline lineno="174"><highlight class="normal"><sp/><sp/><sp/><sp/>connector-&gt;<ref refid="structssh__connector__struct_1a820aee50995208d193f4fe295beb239e" kindref="member">out_fd</ref><sp/>=<sp/><ref refid="libssh_8h_1a5f05b48043a1f47b36388227bee5d4f8" kindref="member">SSH_INVALID_SOCKET</ref>;</highlight></codeline>
<codeline lineno="175"><highlight class="normal"><sp/><sp/><sp/><sp/>connector-&gt;<ref refid="structssh__connector__struct_1a739a35c9ae799e36bd8b9cc0b0de1254" kindref="member">out_flags</ref><sp/>=<sp/>flags;</highlight></codeline>
<codeline lineno="176"><highlight class="normal"></highlight></codeline>
<codeline lineno="177"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Fallback<sp/>to<sp/>default<sp/>value<sp/>for<sp/>invalid<sp/>flags<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="178"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!(flags<sp/>&amp;<sp/><ref refid="libssh_8h_1a1b16de6e3d7453108e91d9e3a6608536a228d3e408dd67c003254e2d6d1395653" kindref="member">SSH_CONNECTOR_STDOUT</ref>)<sp/>&amp;&amp;<sp/>!(flags<sp/>&amp;<sp/><ref refid="libssh_8h_1a1b16de6e3d7453108e91d9e3a6608536a8990d435585796e3aecf7426e6041408" kindref="member">SSH_CONNECTOR_STDERR</ref>))<sp/>{</highlight></codeline>
<codeline lineno="179"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>connector-&gt;<ref refid="structssh__connector__struct_1a85f7eab9bedc749ea78ca1872247d10e" kindref="member">in_flags</ref><sp/>=<sp/><ref refid="libssh_8h_1a1b16de6e3d7453108e91d9e3a6608536a228d3e408dd67c003254e2d6d1395653" kindref="member">SSH_CONNECTOR_STDOUT</ref>;</highlight></codeline>
<codeline lineno="180"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="181"><highlight class="normal"></highlight></codeline>
<codeline lineno="182"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="group__libssh__callbacks_1ga2fd83df19998902f84f951fc47def83e" kindref="member">ssh_add_channel_callbacks</ref>(channel,<sp/>&amp;connector-&gt;<ref refid="structssh__connector__struct_1ae3c4aa83afae3a01cda7e142b9191c3b" kindref="member">out_channel_cb</ref>);</highlight></codeline>
<codeline lineno="183"><highlight class="normal">}</highlight></codeline>
<codeline lineno="184"><highlight class="normal"></highlight></codeline>
<codeline lineno="185" refid="libssh_8h_1ab5763a5e739e0fcf1857f5ca24b0716b" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="connector_8c_1a47b38e389ee866f2252677c3e7992df2" kindref="member">ssh_connector_set_in_fd</ref>(<ref refid="structssh__connector__struct" kindref="compound">ssh_connector</ref><sp/>connector,<sp/><ref refid="libssh_8h_1a30353f381f5fccbb956eea1f3a110b6c" kindref="member">socket_t</ref><sp/>fd)</highlight></codeline>
<codeline lineno="186"><highlight class="normal">{</highlight></codeline>
<codeline lineno="187"><highlight class="normal"><sp/><sp/><sp/><sp/>connector-&gt;<ref refid="structssh__connector__struct_1aed6f65c2d6ceb1c1fb8c1189e69dbac5" kindref="member">in_fd</ref><sp/>=<sp/>fd;</highlight></codeline>
<codeline lineno="188"><highlight class="normal"><sp/><sp/><sp/><sp/>connector-&gt;<ref refid="structssh__connector__struct_1aa7f4b9010c7f112fff0385e6e677b329" kindref="member">fd_is_socket</ref><sp/>=<sp/><ref refid="connector_8c_1a7a60e4126deea02a1dac73121e321245" kindref="member">ssh_connector_fd_is_socket</ref>(fd);</highlight></codeline>
<codeline lineno="189"><highlight class="normal"><sp/><sp/><sp/><sp/>connector-&gt;<ref refid="structssh__connector__struct_1a8c09fde7984ab2b042d15f7b1c26965d" kindref="member">in_channel</ref><sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="190"><highlight class="normal">}</highlight></codeline>
<codeline lineno="191"><highlight class="normal"></highlight></codeline>
<codeline lineno="192" refid="libssh_8h_1a83638a551468a2a6ef0ff38784bb6697" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="connector_8c_1a47b7c3d1ffc07b7ec3374ec771d97443" kindref="member">ssh_connector_set_out_fd</ref>(<ref refid="structssh__connector__struct" kindref="compound">ssh_connector</ref><sp/>connector,<sp/><ref refid="libssh_8h_1a30353f381f5fccbb956eea1f3a110b6c" kindref="member">socket_t</ref><sp/>fd)</highlight></codeline>
<codeline lineno="193"><highlight class="normal">{</highlight></codeline>
<codeline lineno="194"><highlight class="normal"><sp/><sp/><sp/><sp/>connector-&gt;<ref refid="structssh__connector__struct_1a820aee50995208d193f4fe295beb239e" kindref="member">out_fd</ref><sp/>=<sp/>fd;</highlight></codeline>
<codeline lineno="195"><highlight class="normal"><sp/><sp/><sp/><sp/>connector-&gt;<ref refid="structssh__connector__struct_1aa7f4b9010c7f112fff0385e6e677b329" kindref="member">fd_is_socket</ref><sp/>=<sp/><ref refid="connector_8c_1a7a60e4126deea02a1dac73121e321245" kindref="member">ssh_connector_fd_is_socket</ref>(fd);</highlight></codeline>
<codeline lineno="196"><highlight class="normal"><sp/><sp/><sp/><sp/>connector-&gt;<ref refid="structssh__connector__struct_1aef4894f7b0135245d08eed5edf68be0b" kindref="member">out_channel</ref><sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="197"><highlight class="normal">}</highlight></codeline>
<codeline lineno="198"><highlight class="normal"></highlight></codeline>
<codeline lineno="199"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>TODO<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="200" refid="connector_8c_1a56b96ae3387e0fca09be7e8c703afe32" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="connector_8c_1a56b96ae3387e0fca09be7e8c703afe32" kindref="member">ssh_connector_except</ref>(<ref refid="structssh__connector__struct" kindref="compound">ssh_connector</ref><sp/>connector,<sp/><ref refid="libssh_8h_1a30353f381f5fccbb956eea1f3a110b6c" kindref="member">socket_t</ref><sp/>fd)</highlight></codeline>
<codeline lineno="201"><highlight class="normal">{</highlight></codeline>
<codeline lineno="202"><highlight class="normal"><sp/><sp/><sp/><sp/>(void)<sp/>connector;</highlight></codeline>
<codeline lineno="203"><highlight class="normal"><sp/><sp/><sp/><sp/>(void)<sp/>fd;</highlight></codeline>
<codeline lineno="204"><highlight class="normal">}</highlight></codeline>
<codeline lineno="205"><highlight class="normal"></highlight></codeline>
<codeline lineno="206"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>TODO<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="207" refid="connector_8c_1a14a16f59cb2bc11c26075ac392898529" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="connector_8c_1a14a16f59cb2bc11c26075ac392898529" kindref="member">ssh_connector_except_channel</ref>(<ref refid="structssh__connector__struct" kindref="compound">ssh_connector</ref><sp/>connector,</highlight></codeline>
<codeline lineno="208"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structssh__channel__struct" kindref="compound">ssh_channel</ref><sp/>channel)</highlight></codeline>
<codeline lineno="209"><highlight class="normal">{</highlight></codeline>
<codeline lineno="210"><highlight class="normal"><sp/><sp/><sp/><sp/>(void)<sp/>connector;</highlight></codeline>
<codeline lineno="211"><highlight class="normal"><sp/><sp/><sp/><sp/>(void)<sp/>channel;</highlight></codeline>
<codeline lineno="212"><highlight class="normal">}</highlight></codeline>
<codeline lineno="213"><highlight class="normal"></highlight></codeline>
<codeline lineno="219" refid="connector_8c_1a49e333bf300287cfadad801243c2d7f7" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="connector_8c_1a49e333bf300287cfadad801243c2d7f7" kindref="member">ssh_connector_reset_pollevents</ref>(<ref refid="structssh__connector__struct" kindref="compound">ssh_connector</ref><sp/>connector)</highlight></codeline>
<codeline lineno="220"><highlight class="normal">{</highlight></codeline>
<codeline lineno="221"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(connector-&gt;<ref refid="structssh__connector__struct_1aed6f65c2d6ceb1c1fb8c1189e69dbac5" kindref="member">in_fd</ref><sp/>!=<sp/><ref refid="libssh_8h_1a5f05b48043a1f47b36388227bee5d4f8" kindref="member">SSH_INVALID_SOCKET</ref>)<sp/>{</highlight></codeline>
<codeline lineno="222"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(connector-&gt;<ref refid="structssh__connector__struct_1abfe4d6220cffdecb0596befdc269cfd1" kindref="member">in_available</ref>)<sp/>{</highlight></codeline>
<codeline lineno="223"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="group__libssh__poll_1ga012582349ce62cf788761e5f97548496" kindref="member">ssh_poll_remove_events</ref>(connector-&gt;<ref refid="structssh__connector__struct_1a3d27a520636b09b59437e6d5666ce44c" kindref="member">in_poll</ref>,<sp/><ref refid="poll_8h_1a52ac479a805051f59643588b096024ff" kindref="member">POLLIN</ref>);</highlight></codeline>
<codeline lineno="224"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="225"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="group__libssh__poll_1ga26ad689751420b91bf002f616e8bf4f7" kindref="member">ssh_poll_add_events</ref>(connector-&gt;<ref refid="structssh__connector__struct_1a3d27a520636b09b59437e6d5666ce44c" kindref="member">in_poll</ref>,<sp/><ref refid="poll_8h_1a52ac479a805051f59643588b096024ff" kindref="member">POLLIN</ref>);</highlight></codeline>
<codeline lineno="226"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="227"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="228"><highlight class="normal"></highlight></codeline>
<codeline lineno="229"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(connector-&gt;<ref refid="structssh__connector__struct_1a820aee50995208d193f4fe295beb239e" kindref="member">out_fd</ref><sp/>!=<sp/><ref refid="libssh_8h_1a5f05b48043a1f47b36388227bee5d4f8" kindref="member">SSH_INVALID_SOCKET</ref>)<sp/>{</highlight></codeline>
<codeline lineno="230"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(connector-&gt;<ref refid="structssh__connector__struct_1a96f134844f8a75d2954173500b4bd06f" kindref="member">out_wontblock</ref>)<sp/>{</highlight></codeline>
<codeline lineno="231"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="group__libssh__poll_1ga012582349ce62cf788761e5f97548496" kindref="member">ssh_poll_remove_events</ref>(connector-&gt;<ref refid="structssh__connector__struct_1abab4576fbd113acfaf860eedf6a60624" kindref="member">out_poll</ref>,<sp/><ref refid="poll_8h_1a91b3c67129ac7675062f316b840a0d58" kindref="member">POLLOUT</ref>);</highlight></codeline>
<codeline lineno="232"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="233"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="group__libssh__poll_1ga26ad689751420b91bf002f616e8bf4f7" kindref="member">ssh_poll_add_events</ref>(connector-&gt;<ref refid="structssh__connector__struct_1abab4576fbd113acfaf860eedf6a60624" kindref="member">out_poll</ref>,<sp/><ref refid="poll_8h_1a91b3c67129ac7675062f316b840a0d58" kindref="member">POLLOUT</ref>);</highlight></codeline>
<codeline lineno="234"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="235"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="236"><highlight class="normal">}</highlight></codeline>
<codeline lineno="237"><highlight class="normal"></highlight></codeline>
<codeline lineno="243" refid="connector_8c_1a83806fe46fe887adb695eeca7f35682a" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="connector_8c_1a83806fe46fe887adb695eeca7f35682a" kindref="member">ssh_connector_fd_in_cb</ref>(<ref refid="structssh__connector__struct" kindref="compound">ssh_connector</ref><sp/>connector)</highlight></codeline>
<codeline lineno="244"><highlight class="normal">{</highlight></codeline>
<codeline lineno="245"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">unsigned</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/><ref refid="benchmarks_8c_1aff2566f4c366b48d73479bef43ee4d2e" kindref="member">buffer</ref>[<ref refid="connector_8c_1a239bebe1697b474e6f84945e9fb9faee" kindref="member">CHUNKSIZE</ref>];</highlight></codeline>
<codeline lineno="246"><highlight class="normal"><sp/><sp/><sp/><sp/>uint32_t<sp/>toread<sp/>=<sp/><ref refid="connector_8c_1a239bebe1697b474e6f84945e9fb9faee" kindref="member">CHUNKSIZE</ref>;</highlight></codeline>
<codeline lineno="247"><highlight class="normal"><sp/><sp/><sp/><sp/>ssize_t<sp/>r;</highlight></codeline>
<codeline lineno="248"><highlight class="normal"><sp/><sp/><sp/><sp/>ssize_t<sp/>w;</highlight></codeline>
<codeline lineno="249"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>total<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="250"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref>;</highlight></codeline>
<codeline lineno="251"><highlight class="normal"></highlight></codeline>
<codeline lineno="252"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="priv_8h_1aa21fd8a7a609329603b7b16da7939fca" kindref="member">SSH_LOG</ref>(<ref refid="libssh_8h_1a466c84d8dd5b1ba9162d491f31117a6b" kindref="member">SSH_LOG_TRACE</ref>,<sp/></highlight><highlight class="stringliteral">&quot;connector<sp/>POLLIN<sp/>event<sp/>for<sp/>fd<sp/>%d&quot;</highlight><highlight class="normal">,<sp/>connector-&gt;<ref refid="structssh__connector__struct_1aed6f65c2d6ceb1c1fb8c1189e69dbac5" kindref="member">in_fd</ref>);</highlight></codeline>
<codeline lineno="253"><highlight class="normal"></highlight></codeline>
<codeline lineno="254"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(connector-&gt;<ref refid="structssh__connector__struct_1a96f134844f8a75d2954173500b4bd06f" kindref="member">out_wontblock</ref>)<sp/>{</highlight></codeline>
<codeline lineno="255"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(connector-&gt;<ref refid="structssh__connector__struct_1aef4894f7b0135245d08eed5edf68be0b" kindref="member">out_channel</ref><sp/>!=<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="256"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/><ref refid="structssh__channel__callbacks__struct_1a883357b349e33dda4e4b9b94576d99ab" kindref="member">size</ref><sp/>=<sp/><ref refid="group__libssh__channel_1gadf53c5a5b501086af26d06cba3f1491f" kindref="member">ssh_channel_window_size</ref>(connector-&gt;<ref refid="structssh__connector__struct_1aef4894f7b0135245d08eed5edf68be0b" kindref="member">out_channel</ref>);</highlight></codeline>
<codeline lineno="257"><highlight class="normal"></highlight></codeline>
<codeline lineno="258"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Don&apos;t<sp/>attempt<sp/>reading<sp/>more<sp/>than<sp/>the<sp/>window<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="259"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>toread<sp/>=<sp/><ref refid="priv_8h_1a3acffbd305ee72dcd4593c0d8af64a4f" kindref="member">MIN</ref>(<ref refid="structssh__channel__callbacks__struct_1a883357b349e33dda4e4b9b94576d99ab" kindref="member">size</ref>,<sp/><ref refid="connector_8c_1a239bebe1697b474e6f84945e9fb9faee" kindref="member">CHUNKSIZE</ref>);</highlight></codeline>
<codeline lineno="260"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="261"><highlight class="normal"></highlight></codeline>
<codeline lineno="262"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>r<sp/>=<sp/><ref refid="connector_8c_1a9d10a96cbda381bccc2fee5f2d5904c5" kindref="member">ssh_connector_fd_read</ref>(connector,<sp/><ref refid="benchmarks_8c_1aff2566f4c366b48d73479bef43ee4d2e" kindref="member">buffer</ref>,<sp/>toread);</highlight></codeline>
<codeline lineno="263"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(r<sp/>&lt;<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="264"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="connector_8c_1a56b96ae3387e0fca09be7e8c703afe32" kindref="member">ssh_connector_except</ref>(connector,<sp/>connector-&gt;<ref refid="structssh__connector__struct_1aed6f65c2d6ceb1c1fb8c1189e69dbac5" kindref="member">in_fd</ref>);</highlight></codeline>
<codeline lineno="265"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="266"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="267"><highlight class="normal"></highlight></codeline>
<codeline lineno="268"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(connector-&gt;<ref refid="structssh__connector__struct_1aef4894f7b0135245d08eed5edf68be0b" kindref="member">out_channel</ref><sp/>!=<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="269"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(r<sp/>==<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="270"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="priv_8h_1aa21fd8a7a609329603b7b16da7939fca" kindref="member">SSH_LOG</ref>(<ref refid="libssh_8h_1a466c84d8dd5b1ba9162d491f31117a6b" kindref="member">SSH_LOG_TRACE</ref>,<sp/></highlight><highlight class="stringliteral">&quot;input<sp/>fd<sp/>%d<sp/>is<sp/>EOF&quot;</highlight><highlight class="normal">,<sp/>connector-&gt;<ref refid="structssh__connector__struct_1aed6f65c2d6ceb1c1fb8c1189e69dbac5" kindref="member">in_fd</ref>);</highlight></codeline>
<codeline lineno="271"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(connector-&gt;<ref refid="structssh__connector__struct_1aef4894f7b0135245d08eed5edf68be0b" kindref="member">out_channel</ref>-&gt;<ref refid="structssh__channel__struct_1a84b4de0420fa99e2b0673d4b5eeb4875" kindref="member">local_eof</ref><sp/>==<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="272"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="group__libssh__channel_1ga072f82fdf3e50514f747653af2c99004" kindref="member">ssh_channel_send_eof</ref>(connector-&gt;<ref refid="structssh__connector__struct_1aef4894f7b0135245d08eed5edf68be0b" kindref="member">out_channel</ref>);</highlight></codeline>
<codeline lineno="273"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(void)<ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref>;<sp/></highlight><highlight class="comment">/*<sp/>TODO<sp/>Handle<sp/>rc?<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="274"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="275"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>connector-&gt;<ref refid="structssh__connector__struct_1abfe4d6220cffdecb0596befdc269cfd1" kindref="member">in_available</ref><sp/>=<sp/>1;<sp/></highlight><highlight class="comment">/*<sp/>Don&apos;t<sp/>poll<sp/>on<sp/>it<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="276"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="277"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(r&gt;<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="278"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>loop<sp/>around<sp/>ssh_channel_write<sp/>in<sp/>case<sp/>our<sp/>window<sp/>reduced<sp/>due<sp/>to<sp/>a<sp/>race<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="279"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>(total<sp/>!=<sp/>r){</highlight></codeline>
<codeline lineno="280"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(connector-&gt;<ref refid="structssh__connector__struct_1a739a35c9ae799e36bd8b9cc0b0de1254" kindref="member">out_flags</ref><sp/>&amp;<sp/><ref refid="libssh_8h_1a1b16de6e3d7453108e91d9e3a6608536a228d3e408dd67c003254e2d6d1395653" kindref="member">SSH_CONNECTOR_STDOUT</ref>)<sp/>{</highlight></codeline>
<codeline lineno="281"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>w<sp/>=<sp/><ref refid="group__libssh__channel_1ga5d658df773ba854b35ff9f905341e2fb" kindref="member">ssh_channel_write</ref>(connector-&gt;<ref refid="structssh__connector__struct_1aef4894f7b0135245d08eed5edf68be0b" kindref="member">out_channel</ref>,</highlight></codeline>
<codeline lineno="282"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="benchmarks_8c_1aff2566f4c366b48d73479bef43ee4d2e" kindref="member">buffer</ref><sp/>+<sp/>total,</highlight></codeline>
<codeline lineno="283"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>r<sp/>-<sp/>total);</highlight></codeline>
<codeline lineno="284"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="285"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>w<sp/>=<sp/><ref refid="group__libssh__channel_1ga7ebd0ed490ee4485c6d5feb7d22bc162" kindref="member">ssh_channel_write_stderr</ref>(connector-&gt;<ref refid="structssh__connector__struct_1aef4894f7b0135245d08eed5edf68be0b" kindref="member">out_channel</ref>,</highlight></codeline>
<codeline lineno="286"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="benchmarks_8c_1aff2566f4c366b48d73479bef43ee4d2e" kindref="member">buffer</ref><sp/>+<sp/>total,</highlight></codeline>
<codeline lineno="287"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>r<sp/>-<sp/>total);</highlight></codeline>
<codeline lineno="288"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="289"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(w<sp/>==<sp/><ref refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" kindref="member">SSH_ERROR</ref>)<sp/>{</highlight></codeline>
<codeline lineno="290"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="291"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="292"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>total<sp/>+=<sp/>w;</highlight></codeline>
<codeline lineno="293"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="294"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="295"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(connector-&gt;<ref refid="structssh__connector__struct_1a820aee50995208d193f4fe295beb239e" kindref="member">out_fd</ref><sp/>!=<sp/><ref refid="libssh_8h_1a5f05b48043a1f47b36388227bee5d4f8" kindref="member">SSH_INVALID_SOCKET</ref>)<sp/>{</highlight></codeline>
<codeline lineno="296"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(r<sp/>==<sp/>0){</highlight></codeline>
<codeline lineno="297"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>close(connector-&gt;<ref refid="structssh__connector__struct_1a820aee50995208d193f4fe295beb239e" kindref="member">out_fd</ref>);</highlight></codeline>
<codeline lineno="298"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>connector-&gt;<ref refid="structssh__connector__struct_1a820aee50995208d193f4fe295beb239e" kindref="member">out_fd</ref><sp/>=<sp/><ref refid="libssh_8h_1a5f05b48043a1f47b36388227bee5d4f8" kindref="member">SSH_INVALID_SOCKET</ref>;</highlight></codeline>
<codeline lineno="299"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="300"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*</highlight></codeline>
<codeline lineno="301"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>Loop<sp/>around<sp/>write<sp/>in<sp/>case<sp/>the<sp/>write<sp/>blocks<sp/>even<sp/>for<sp/>CHUNKSIZE</highlight></codeline>
<codeline lineno="302"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>bytes</highlight></codeline>
<codeline lineno="303"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="304"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>(total<sp/>!=<sp/>r)<sp/>{</highlight></codeline>
<codeline lineno="305"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>w<sp/>=<sp/><ref refid="connector_8c_1a2c034263a1c5bab38564d40cbfc67631" kindref="member">ssh_connector_fd_write</ref>(connector,<sp/><ref refid="benchmarks_8c_1aff2566f4c366b48d73479bef43ee4d2e" kindref="member">buffer</ref><sp/>+<sp/>total,<sp/>r<sp/>-<sp/>total);</highlight></codeline>
<codeline lineno="306"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(w<sp/>&lt;<sp/>0){</highlight></codeline>
<codeline lineno="307"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="connector_8c_1a56b96ae3387e0fca09be7e8c703afe32" kindref="member">ssh_connector_except</ref>(connector,<sp/>connector-&gt;<ref refid="structssh__connector__struct_1a820aee50995208d193f4fe295beb239e" kindref="member">out_fd</ref>);</highlight></codeline>
<codeline lineno="308"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="309"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="310"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>total<sp/>+=<sp/>w;</highlight></codeline>
<codeline lineno="311"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="312"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="313"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="314"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="priv_8h_1a55177b3e8db90ca9adb435c44281963c" kindref="member">ssh_set_error</ref>(connector-&gt;<ref refid="structssh__connector__struct_1a73b1b54b8c7ad4fb06e1841c7ad51285" kindref="member">session</ref>,<sp/><ref refid="libssh_8h_1a036b2b00fb04337a4d06d719d1b62be1a86ff0b2e8da6ad8628efc556b6ce1887" kindref="member">SSH_FATAL</ref>,<sp/></highlight><highlight class="stringliteral">&quot;output<sp/>socket<sp/>or<sp/>channel<sp/>closed&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="315"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="316"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="317"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>connector-&gt;<ref refid="structssh__connector__struct_1a96f134844f8a75d2954173500b4bd06f" kindref="member">out_wontblock</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="318"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>connector-&gt;<ref refid="structssh__connector__struct_1abfe4d6220cffdecb0596befdc269cfd1" kindref="member">in_available</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="319"><highlight class="normal"><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="320"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>connector-&gt;<ref refid="structssh__connector__struct_1abfe4d6220cffdecb0596befdc269cfd1" kindref="member">in_available</ref><sp/>=<sp/>1;</highlight></codeline>
<codeline lineno="321"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="322"><highlight class="normal">}</highlight></codeline>
<codeline lineno="323"><highlight class="normal"></highlight></codeline>
<codeline lineno="327" refid="connector_8c_1ad13c8d29eb297a425c51a53379450dd1" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="connector_8c_1ad13c8d29eb297a425c51a53379450dd1" kindref="member">ssh_connector_fd_out_cb</ref>(<ref refid="structssh__connector__struct" kindref="compound">ssh_connector</ref><sp/>connector){</highlight></codeline>
<codeline lineno="328"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">unsigned</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/><ref refid="benchmarks_8c_1aff2566f4c366b48d73479bef43ee4d2e" kindref="member">buffer</ref>[<ref refid="connector_8c_1a239bebe1697b474e6f84945e9fb9faee" kindref="member">CHUNKSIZE</ref>];</highlight></codeline>
<codeline lineno="329"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>r;</highlight></codeline>
<codeline lineno="330"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>w;</highlight></codeline>
<codeline lineno="331"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>total<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="332"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="priv_8h_1aa21fd8a7a609329603b7b16da7939fca" kindref="member">SSH_LOG</ref>(<ref refid="libssh_8h_1a466c84d8dd5b1ba9162d491f31117a6b" kindref="member">SSH_LOG_TRACE</ref>,<sp/></highlight><highlight class="stringliteral">&quot;connector<sp/>POLLOUT<sp/>event<sp/>for<sp/>fd<sp/>%d&quot;</highlight><highlight class="normal">,<sp/>connector-&gt;<ref refid="structssh__connector__struct_1a820aee50995208d193f4fe295beb239e" kindref="member">out_fd</ref>);</highlight></codeline>
<codeline lineno="333"><highlight class="normal"></highlight></codeline>
<codeline lineno="334"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(connector-&gt;<ref refid="structssh__connector__struct_1abfe4d6220cffdecb0596befdc269cfd1" kindref="member">in_available</ref>){</highlight></codeline>
<codeline lineno="335"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(connector-&gt;<ref refid="structssh__connector__struct_1a8c09fde7984ab2b042d15f7b1c26965d" kindref="member">in_channel</ref><sp/>!=<sp/>NULL){</highlight></codeline>
<codeline lineno="336"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>r<sp/>=<sp/><ref refid="group__libssh__channel_1gaaca5a3fbe9839c3ffb37b746afc35f4c" kindref="member">ssh_channel_read_nonblocking</ref>(connector-&gt;<ref refid="structssh__connector__struct_1a8c09fde7984ab2b042d15f7b1c26965d" kindref="member">in_channel</ref>,<sp/><ref refid="benchmarks_8c_1aff2566f4c366b48d73479bef43ee4d2e" kindref="member">buffer</ref>,<sp/><ref refid="connector_8c_1a239bebe1697b474e6f84945e9fb9faee" kindref="member">CHUNKSIZE</ref>,<sp/>0);</highlight></codeline>
<codeline lineno="337"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(r<sp/>==<sp/><ref refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" kindref="member">SSH_ERROR</ref>){</highlight></codeline>
<codeline lineno="338"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="connector_8c_1a14a16f59cb2bc11c26075ac392898529" kindref="member">ssh_connector_except_channel</ref>(connector,<sp/>connector-&gt;<ref refid="structssh__connector__struct_1a8c09fde7984ab2b042d15f7b1c26965d" kindref="member">in_channel</ref>);</highlight></codeline>
<codeline lineno="339"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="340"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(r<sp/>==<sp/>0<sp/>&amp;&amp;<sp/><ref refid="group__libssh__channel_1gab535264029443d77214c0615a0788b0a" kindref="member">ssh_channel_is_eof</ref>(connector-&gt;<ref refid="structssh__connector__struct_1a8c09fde7984ab2b042d15f7b1c26965d" kindref="member">in_channel</ref>)){</highlight></codeline>
<codeline lineno="341"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>close(connector-&gt;<ref refid="structssh__connector__struct_1a820aee50995208d193f4fe295beb239e" kindref="member">out_fd</ref>);</highlight></codeline>
<codeline lineno="342"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>connector-&gt;<ref refid="structssh__connector__struct_1a820aee50995208d193f4fe295beb239e" kindref="member">out_fd</ref><sp/>=<sp/><ref refid="libssh_8h_1a5f05b48043a1f47b36388227bee5d4f8" kindref="member">SSH_INVALID_SOCKET</ref>;</highlight></codeline>
<codeline lineno="343"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="344"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(r&gt;0)<sp/>{</highlight></codeline>
<codeline lineno="345"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>loop<sp/>around<sp/>write<sp/>in<sp/>case<sp/>the<sp/>write<sp/>blocks<sp/>even<sp/>for<sp/>CHUNKSIZE<sp/>bytes<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="346"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>(total<sp/>!=<sp/>r){</highlight></codeline>
<codeline lineno="347"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>w<sp/>=<sp/><ref refid="connector_8c_1a2c034263a1c5bab38564d40cbfc67631" kindref="member">ssh_connector_fd_write</ref>(connector,<sp/><ref refid="benchmarks_8c_1aff2566f4c366b48d73479bef43ee4d2e" kindref="member">buffer</ref><sp/>+<sp/>total,<sp/>r<sp/>-<sp/>total);</highlight></codeline>
<codeline lineno="348"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(w<sp/>&lt;<sp/>0){</highlight></codeline>
<codeline lineno="349"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="connector_8c_1a56b96ae3387e0fca09be7e8c703afe32" kindref="member">ssh_connector_except</ref>(connector,<sp/>connector-&gt;<ref refid="structssh__connector__struct_1a820aee50995208d193f4fe295beb239e" kindref="member">out_fd</ref>);</highlight></codeline>
<codeline lineno="350"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="351"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="352"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>total<sp/>+=<sp/>w;</highlight></codeline>
<codeline lineno="353"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="354"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="355"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(connector-&gt;<ref refid="structssh__connector__struct_1aed6f65c2d6ceb1c1fb8c1189e69dbac5" kindref="member">in_fd</ref><sp/>!=<sp/><ref refid="libssh_8h_1a5f05b48043a1f47b36388227bee5d4f8" kindref="member">SSH_INVALID_SOCKET</ref>){</highlight></codeline>
<codeline lineno="356"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>fallback<sp/>on<sp/>the<sp/>socket<sp/>input<sp/>callback<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="357"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>connector-&gt;<ref refid="structssh__connector__struct_1a96f134844f8a75d2954173500b4bd06f" kindref="member">out_wontblock</ref><sp/>=<sp/>1;</highlight></codeline>
<codeline lineno="358"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="connector_8c_1a83806fe46fe887adb695eeca7f35682a" kindref="member">ssh_connector_fd_in_cb</ref>(connector);</highlight></codeline>
<codeline lineno="359"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="360"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="priv_8h_1a55177b3e8db90ca9adb435c44281963c" kindref="member">ssh_set_error</ref>(connector-&gt;<ref refid="structssh__connector__struct_1a73b1b54b8c7ad4fb06e1841c7ad51285" kindref="member">session</ref>,</highlight></codeline>
<codeline lineno="361"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="libssh_8h_1a036b2b00fb04337a4d06d719d1b62be1a86ff0b2e8da6ad8628efc556b6ce1887" kindref="member">SSH_FATAL</ref>,</highlight></codeline>
<codeline lineno="362"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Output<sp/>socket<sp/>or<sp/>channel<sp/>closed&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="363"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="364"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="365"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>connector-&gt;<ref refid="structssh__connector__struct_1abfe4d6220cffdecb0596befdc269cfd1" kindref="member">in_available</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="366"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>connector-&gt;<ref refid="structssh__connector__struct_1a96f134844f8a75d2954173500b4bd06f" kindref="member">out_wontblock</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="367"><highlight class="normal"><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="368"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>connector-&gt;<ref refid="structssh__connector__struct_1a96f134844f8a75d2954173500b4bd06f" kindref="member">out_wontblock</ref><sp/>=<sp/>1;</highlight></codeline>
<codeline lineno="369"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="370"><highlight class="normal">}</highlight></codeline>
<codeline lineno="371"><highlight class="normal"></highlight></codeline>
<codeline lineno="387" refid="connector_8c_1a3ee42f9fc7405a94313d6275aaa74db3" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="connector_8c_1a3ee42f9fc7405a94313d6275aaa74db3" kindref="member">ssh_connector_fd_cb</ref>(<ref refid="structssh__poll__handle__struct" kindref="compound">ssh_poll_handle</ref><sp/>p,</highlight></codeline>
<codeline lineno="388"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="libssh_8h_1a30353f381f5fccbb956eea1f3a110b6c" kindref="member">socket_t</ref><sp/>fd,</highlight></codeline>
<codeline lineno="389"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>revents,</highlight></codeline>
<codeline lineno="390"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>*<ref refid="structssh__channel__callbacks__struct_1ae7a7877dfb4eca2a39e5f281832c15f0" kindref="member">userdata</ref>)</highlight></codeline>
<codeline lineno="391"><highlight class="normal">{</highlight></codeline>
<codeline lineno="392"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="structssh__connector__struct" kindref="compound">ssh_connector</ref><sp/>connector<sp/>=<sp/><ref refid="structssh__channel__callbacks__struct_1ae7a7877dfb4eca2a39e5f281832c15f0" kindref="member">userdata</ref>;</highlight></codeline>
<codeline lineno="393"><highlight class="normal"></highlight></codeline>
<codeline lineno="394"><highlight class="normal"><sp/><sp/><sp/><sp/>(void)p;</highlight></codeline>
<codeline lineno="395"><highlight class="normal"></highlight></codeline>
<codeline lineno="396"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(revents<sp/>&amp;<sp/><ref refid="poll_8h_1ab1c532446408c98559d4aaaeeeb99820" kindref="member">POLLERR</ref>)<sp/>{</highlight></codeline>
<codeline lineno="397"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="connector_8c_1a56b96ae3387e0fca09be7e8c703afe32" kindref="member">ssh_connector_except</ref>(connector,<sp/>fd);</highlight></codeline>
<codeline lineno="398"><highlight class="normal"><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">((revents<sp/>&amp;<sp/>(<ref refid="poll_8h_1a52ac479a805051f59643588b096024ff" kindref="member">POLLIN</ref>|<ref refid="poll_8h_1a262754fe6bdf27c2cd3da43284ec8536" kindref="member">POLLHUP</ref>))<sp/>&amp;&amp;<sp/>fd<sp/>==<sp/>connector-&gt;<ref refid="structssh__connector__struct_1aed6f65c2d6ceb1c1fb8c1189e69dbac5" kindref="member">in_fd</ref>)<sp/>{</highlight></codeline>
<codeline lineno="399"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="connector_8c_1a83806fe46fe887adb695eeca7f35682a" kindref="member">ssh_connector_fd_in_cb</ref>(connector);</highlight></codeline>
<codeline lineno="400"><highlight class="normal"><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(((revents<sp/>&amp;<sp/><ref refid="poll_8h_1a91b3c67129ac7675062f316b840a0d58" kindref="member">POLLOUT</ref>)<sp/>||<sp/>(revents<sp/>&amp;<sp/><ref refid="poll_8h_1a262754fe6bdf27c2cd3da43284ec8536" kindref="member">POLLHUP</ref>))<sp/>&amp;&amp;</highlight></codeline>
<codeline lineno="401"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fd<sp/>==<sp/>connector-&gt;<ref refid="structssh__connector__struct_1a820aee50995208d193f4fe295beb239e" kindref="member">out_fd</ref>)<sp/>{</highlight></codeline>
<codeline lineno="402"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="connector_8c_1ad13c8d29eb297a425c51a53379450dd1" kindref="member">ssh_connector_fd_out_cb</ref>(connector);</highlight></codeline>
<codeline lineno="403"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="404"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="connector_8c_1a49e333bf300287cfadad801243c2d7f7" kindref="member">ssh_connector_reset_pollevents</ref>(connector);</highlight></codeline>
<codeline lineno="405"><highlight class="normal"></highlight></codeline>
<codeline lineno="406"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>0;</highlight></codeline>
<codeline lineno="407"><highlight class="normal">}</highlight></codeline>
<codeline lineno="408"><highlight class="normal"></highlight></codeline>
<codeline lineno="424" refid="connector_8c_1ad994e6c0acb9b1f2eab185da25fd46b8" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="connector_8c_1ad994e6c0acb9b1f2eab185da25fd46b8" kindref="member">ssh_connector_channel_data_cb</ref>(<ref refid="structssh__session__struct" kindref="compound">ssh_session</ref><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>,</highlight></codeline>
<codeline lineno="425"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structssh__channel__struct" kindref="compound">ssh_channel</ref><sp/>channel,</highlight></codeline>
<codeline lineno="426"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>*data,</highlight></codeline>
<codeline lineno="427"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>uint32_t<sp/>len,</highlight></codeline>
<codeline lineno="428"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>is_stderr,</highlight></codeline>
<codeline lineno="429"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>*<ref refid="structssh__channel__callbacks__struct_1ae7a7877dfb4eca2a39e5f281832c15f0" kindref="member">userdata</ref>)</highlight></codeline>
<codeline lineno="430"><highlight class="normal">{</highlight></codeline>
<codeline lineno="431"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="structssh__connector__struct" kindref="compound">ssh_connector</ref><sp/>connector<sp/>=<sp/><ref refid="structssh__channel__callbacks__struct_1ae7a7877dfb4eca2a39e5f281832c15f0" kindref="member">userdata</ref>;</highlight></codeline>
<codeline lineno="432"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>w;</highlight></codeline>
<codeline lineno="433"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/>window;</highlight></codeline>
<codeline lineno="434"><highlight class="normal"></highlight></codeline>
<codeline lineno="435"><highlight class="normal"><sp/><sp/><sp/><sp/>(void)<sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>;</highlight></codeline>
<codeline lineno="436"><highlight class="normal"><sp/><sp/><sp/><sp/>(void)<sp/>channel;</highlight></codeline>
<codeline lineno="437"><highlight class="normal"><sp/><sp/><sp/><sp/>(void)<sp/>is_stderr;</highlight></codeline>
<codeline lineno="438"><highlight class="normal"></highlight></codeline>
<codeline lineno="439"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="priv_8h_1aa21fd8a7a609329603b7b16da7939fca" kindref="member">SSH_LOG</ref>(<ref refid="libssh_8h_1a466c84d8dd5b1ba9162d491f31117a6b" kindref="member">SSH_LOG_TRACE</ref>,</highlight><highlight class="stringliteral">&quot;connector<sp/>data<sp/>on<sp/>channel&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="440"><highlight class="normal"></highlight></codeline>
<codeline lineno="441"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(is_stderr<sp/>&amp;&amp;<sp/>!(connector-&gt;<ref refid="structssh__connector__struct_1a85f7eab9bedc749ea78ca1872247d10e" kindref="member">in_flags</ref><sp/>&amp;<sp/><ref refid="libssh_8h_1a1b16de6e3d7453108e91d9e3a6608536a8990d435585796e3aecf7426e6041408" kindref="member">SSH_CONNECTOR_STDERR</ref>))<sp/>{</highlight></codeline>
<codeline lineno="442"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>ignore<sp/>stderr<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="443"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>0;</highlight></codeline>
<codeline lineno="444"><highlight class="normal"><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!is_stderr<sp/>&amp;&amp;<sp/>!(connector-&gt;<ref refid="structssh__connector__struct_1a85f7eab9bedc749ea78ca1872247d10e" kindref="member">in_flags</ref><sp/>&amp;<sp/><ref refid="libssh_8h_1a1b16de6e3d7453108e91d9e3a6608536a228d3e408dd67c003254e2d6d1395653" kindref="member">SSH_CONNECTOR_STDOUT</ref>))<sp/>{</highlight></codeline>
<codeline lineno="445"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>ignore<sp/>stdout<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="446"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>0;</highlight></codeline>
<codeline lineno="447"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="448"><highlight class="normal"></highlight></codeline>
<codeline lineno="449"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(connector-&gt;<ref refid="structssh__connector__struct_1a96f134844f8a75d2954173500b4bd06f" kindref="member">out_wontblock</ref>)<sp/>{</highlight></codeline>
<codeline lineno="450"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(connector-&gt;<ref refid="structssh__connector__struct_1aef4894f7b0135245d08eed5edf68be0b" kindref="member">out_channel</ref><sp/>!=<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="451"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>window_len;</highlight></codeline>
<codeline lineno="452"><highlight class="normal"></highlight></codeline>
<codeline lineno="453"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>window<sp/>=<sp/><ref refid="group__libssh__channel_1gadf53c5a5b501086af26d06cba3f1491f" kindref="member">ssh_channel_window_size</ref>(connector-&gt;<ref refid="structssh__connector__struct_1aef4894f7b0135245d08eed5edf68be0b" kindref="member">out_channel</ref>);</highlight></codeline>
<codeline lineno="454"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>window_len<sp/>=<sp/><ref refid="priv_8h_1a3acffbd305ee72dcd4593c0d8af64a4f" kindref="member">MIN</ref>(window,<sp/>len);</highlight></codeline>
<codeline lineno="455"><highlight class="normal"></highlight></codeline>
<codeline lineno="456"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Route<sp/>the<sp/>data<sp/>to<sp/>the<sp/>right<sp/>exception<sp/>channel<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="457"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(is_stderr<sp/>&amp;&amp;<sp/>(connector-&gt;<ref refid="structssh__connector__struct_1a739a35c9ae799e36bd8b9cc0b0de1254" kindref="member">out_flags</ref><sp/>&amp;<sp/><ref refid="libssh_8h_1a1b16de6e3d7453108e91d9e3a6608536a8990d435585796e3aecf7426e6041408" kindref="member">SSH_CONNECTOR_STDERR</ref>))<sp/>{</highlight></codeline>
<codeline lineno="458"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>w<sp/>=<sp/><ref refid="group__libssh__channel_1ga7ebd0ed490ee4485c6d5feb7d22bc162" kindref="member">ssh_channel_write_stderr</ref>(connector-&gt;<ref refid="structssh__connector__struct_1aef4894f7b0135245d08eed5edf68be0b" kindref="member">out_channel</ref>,</highlight></codeline>
<codeline lineno="459"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>data,</highlight></codeline>
<codeline lineno="460"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>window_len);</highlight></codeline>
<codeline lineno="461"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!is_stderr<sp/>&amp;&amp;</highlight></codeline>
<codeline lineno="462"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(connector-&gt;<ref refid="structssh__connector__struct_1a739a35c9ae799e36bd8b9cc0b0de1254" kindref="member">out_flags</ref><sp/>&amp;<sp/><ref refid="libssh_8h_1a1b16de6e3d7453108e91d9e3a6608536a228d3e408dd67c003254e2d6d1395653" kindref="member">SSH_CONNECTOR_STDOUT</ref>))<sp/>{</highlight></codeline>
<codeline lineno="463"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>w<sp/>=<sp/><ref refid="group__libssh__channel_1ga5d658df773ba854b35ff9f905341e2fb" kindref="member">ssh_channel_write</ref>(connector-&gt;<ref refid="structssh__connector__struct_1aef4894f7b0135245d08eed5edf68be0b" kindref="member">out_channel</ref>,</highlight></codeline>
<codeline lineno="464"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>data,</highlight></codeline>
<codeline lineno="465"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>window_len);</highlight></codeline>
<codeline lineno="466"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(connector-&gt;<ref refid="structssh__connector__struct_1a739a35c9ae799e36bd8b9cc0b0de1254" kindref="member">out_flags</ref><sp/>&amp;<sp/><ref refid="libssh_8h_1a1b16de6e3d7453108e91d9e3a6608536a228d3e408dd67c003254e2d6d1395653" kindref="member">SSH_CONNECTOR_STDOUT</ref>)<sp/>{</highlight></codeline>
<codeline lineno="467"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>w<sp/>=<sp/><ref refid="group__libssh__channel_1ga5d658df773ba854b35ff9f905341e2fb" kindref="member">ssh_channel_write</ref>(connector-&gt;<ref refid="structssh__connector__struct_1aef4894f7b0135245d08eed5edf68be0b" kindref="member">out_channel</ref>,</highlight></codeline>
<codeline lineno="468"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>data,</highlight></codeline>
<codeline lineno="469"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>window_len);</highlight></codeline>
<codeline lineno="470"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="471"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>w<sp/>=<sp/><ref refid="group__libssh__channel_1ga7ebd0ed490ee4485c6d5feb7d22bc162" kindref="member">ssh_channel_write_stderr</ref>(connector-&gt;<ref refid="structssh__connector__struct_1aef4894f7b0135245d08eed5edf68be0b" kindref="member">out_channel</ref>,</highlight></codeline>
<codeline lineno="472"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>data,</highlight></codeline>
<codeline lineno="473"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>window_len);</highlight></codeline>
<codeline lineno="474"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="475"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(w<sp/>==<sp/><ref refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" kindref="member">SSH_ERROR</ref>)<sp/>{</highlight></codeline>
<codeline lineno="476"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="connector_8c_1a14a16f59cb2bc11c26075ac392898529" kindref="member">ssh_connector_except_channel</ref>(connector,<sp/>connector-&gt;<ref refid="structssh__connector__struct_1aef4894f7b0135245d08eed5edf68be0b" kindref="member">out_channel</ref>);</highlight></codeline>
<codeline lineno="477"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="478"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(connector-&gt;<ref refid="structssh__connector__struct_1a820aee50995208d193f4fe295beb239e" kindref="member">out_fd</ref><sp/>!=<sp/><ref refid="libssh_8h_1a5f05b48043a1f47b36388227bee5d4f8" kindref="member">SSH_INVALID_SOCKET</ref>)<sp/>{</highlight></codeline>
<codeline lineno="479"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>w<sp/>=<sp/><ref refid="connector_8c_1a2c034263a1c5bab38564d40cbfc67631" kindref="member">ssh_connector_fd_write</ref>(connector,<sp/>data,<sp/>len);</highlight></codeline>
<codeline lineno="480"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(w<sp/>&lt;<sp/>0)</highlight></codeline>
<codeline lineno="481"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="connector_8c_1a56b96ae3387e0fca09be7e8c703afe32" kindref="member">ssh_connector_except</ref>(connector,<sp/>connector-&gt;<ref refid="structssh__connector__struct_1a820aee50995208d193f4fe295beb239e" kindref="member">out_fd</ref>);</highlight></codeline>
<codeline lineno="482"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="483"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="priv_8h_1a55177b3e8db90ca9adb435c44281963c" kindref="member">ssh_set_error</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>,<sp/><ref refid="libssh_8h_1a036b2b00fb04337a4d06d719d1b62be1a86ff0b2e8da6ad8628efc556b6ce1887" kindref="member">SSH_FATAL</ref>,<sp/></highlight><highlight class="stringliteral">&quot;output<sp/>socket<sp/>or<sp/>channel<sp/>closed&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="484"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" kindref="member">SSH_ERROR</ref>;</highlight></codeline>
<codeline lineno="485"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="486"><highlight class="normal"></highlight></codeline>
<codeline lineno="487"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>connector-&gt;<ref refid="structssh__connector__struct_1a96f134844f8a75d2954173500b4bd06f" kindref="member">out_wontblock</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="488"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>connector-&gt;<ref refid="structssh__connector__struct_1abfe4d6220cffdecb0596befdc269cfd1" kindref="member">in_available</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="489"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>((</highlight><highlight class="keywordtype">unsigned</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal">)w<sp/>&lt;<sp/>len)<sp/>{</highlight></codeline>
<codeline lineno="490"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>connector-&gt;<ref refid="structssh__connector__struct_1abfe4d6220cffdecb0596befdc269cfd1" kindref="member">in_available</ref><sp/>=<sp/>1;</highlight></codeline>
<codeline lineno="491"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="492"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="connector_8c_1a49e333bf300287cfadad801243c2d7f7" kindref="member">ssh_connector_reset_pollevents</ref>(connector);</highlight></codeline>
<codeline lineno="493"><highlight class="normal"></highlight></codeline>
<codeline lineno="494"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>w;</highlight></codeline>
<codeline lineno="495"><highlight class="normal"><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="496"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>connector-&gt;<ref refid="structssh__connector__struct_1abfe4d6220cffdecb0596befdc269cfd1" kindref="member">in_available</ref><sp/>=<sp/>1;</highlight></codeline>
<codeline lineno="497"><highlight class="normal"></highlight></codeline>
<codeline lineno="498"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>0;</highlight></codeline>
<codeline lineno="499"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="500"><highlight class="normal">}</highlight></codeline>
<codeline lineno="501"><highlight class="normal"></highlight></codeline>
<codeline lineno="513" refid="connector_8c_1a4cc7de304441a1cdb59c3656ad1a1678" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="connector_8c_1a4cc7de304441a1cdb59c3656ad1a1678" kindref="member">ssh_connector_channel_write_wontblock_cb</ref>(<ref refid="structssh__session__struct" kindref="compound">ssh_session</ref><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>,</highlight></codeline>
<codeline lineno="514"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structssh__channel__struct" kindref="compound">ssh_channel</ref><sp/>channel,</highlight></codeline>
<codeline lineno="515"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/>bytes,</highlight></codeline>
<codeline lineno="516"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>*<ref refid="structssh__channel__callbacks__struct_1ae7a7877dfb4eca2a39e5f281832c15f0" kindref="member">userdata</ref>)</highlight></codeline>
<codeline lineno="517"><highlight class="normal">{</highlight></codeline>
<codeline lineno="518"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="structssh__connector__struct" kindref="compound">ssh_connector</ref><sp/>connector<sp/>=<sp/><ref refid="structssh__channel__callbacks__struct_1ae7a7877dfb4eca2a39e5f281832c15f0" kindref="member">userdata</ref>;</highlight></codeline>
<codeline lineno="519"><highlight class="normal"><sp/><sp/><sp/><sp/>uint8_t<sp/><ref refid="benchmarks_8c_1aff2566f4c366b48d73479bef43ee4d2e" kindref="member">buffer</ref>[<ref refid="connector_8c_1a239bebe1697b474e6f84945e9fb9faee" kindref="member">CHUNKSIZE</ref>];</highlight></codeline>
<codeline lineno="520"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>r,<sp/>w;</highlight></codeline>
<codeline lineno="521"><highlight class="normal"></highlight></codeline>
<codeline lineno="522"><highlight class="normal"><sp/><sp/><sp/><sp/>(void)<sp/>channel;</highlight></codeline>
<codeline lineno="523"><highlight class="normal"></highlight></codeline>
<codeline lineno="524"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="priv_8h_1aa21fd8a7a609329603b7b16da7939fca" kindref="member">SSH_LOG</ref>(<ref refid="libssh_8h_1a466c84d8dd5b1ba9162d491f31117a6b" kindref="member">SSH_LOG_TRACE</ref>,<sp/></highlight><highlight class="stringliteral">&quot;Channel<sp/>write<sp/>won&apos;t<sp/>block&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="525"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(connector-&gt;<ref refid="structssh__connector__struct_1abfe4d6220cffdecb0596befdc269cfd1" kindref="member">in_available</ref>)<sp/>{</highlight></codeline>
<codeline lineno="526"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(connector-&gt;<ref refid="structssh__connector__struct_1a8c09fde7984ab2b042d15f7b1c26965d" kindref="member">in_channel</ref><sp/>!=<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="527"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/>len<sp/>=<sp/><ref refid="priv_8h_1a3acffbd305ee72dcd4593c0d8af64a4f" kindref="member">MIN</ref>(<ref refid="connector_8c_1a239bebe1697b474e6f84945e9fb9faee" kindref="member">CHUNKSIZE</ref>,<sp/>bytes);</highlight></codeline>
<codeline lineno="528"><highlight class="normal"></highlight></codeline>
<codeline lineno="529"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>r<sp/>=<sp/><ref refid="group__libssh__channel_1gaaca5a3fbe9839c3ffb37b746afc35f4c" kindref="member">ssh_channel_read_nonblocking</ref>(connector-&gt;<ref refid="structssh__connector__struct_1a8c09fde7984ab2b042d15f7b1c26965d" kindref="member">in_channel</ref>,</highlight></codeline>
<codeline lineno="530"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="benchmarks_8c_1aff2566f4c366b48d73479bef43ee4d2e" kindref="member">buffer</ref>,</highlight></codeline>
<codeline lineno="531"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>len,</highlight></codeline>
<codeline lineno="532"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0);</highlight></codeline>
<codeline lineno="533"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(r<sp/>==<sp/><ref refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" kindref="member">SSH_ERROR</ref>)<sp/>{</highlight></codeline>
<codeline lineno="534"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="connector_8c_1a14a16f59cb2bc11c26075ac392898529" kindref="member">ssh_connector_except_channel</ref>(connector,<sp/>connector-&gt;<ref refid="structssh__connector__struct_1a8c09fde7984ab2b042d15f7b1c26965d" kindref="member">in_channel</ref>);</highlight></codeline>
<codeline lineno="535"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(r<sp/>==<sp/>0<sp/>&amp;&amp;<sp/><ref refid="group__libssh__channel_1gab535264029443d77214c0615a0788b0a" kindref="member">ssh_channel_is_eof</ref>(connector-&gt;<ref refid="structssh__connector__struct_1a8c09fde7984ab2b042d15f7b1c26965d" kindref="member">in_channel</ref>)){</highlight></codeline>
<codeline lineno="536"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="group__libssh__channel_1ga072f82fdf3e50514f747653af2c99004" kindref="member">ssh_channel_send_eof</ref>(connector-&gt;<ref refid="structssh__connector__struct_1aef4894f7b0135245d08eed5edf68be0b" kindref="member">out_channel</ref>);</highlight></codeline>
<codeline lineno="537"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(r<sp/>&gt;<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="538"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>w<sp/>=<sp/><ref refid="group__libssh__channel_1ga5d658df773ba854b35ff9f905341e2fb" kindref="member">ssh_channel_write</ref>(connector-&gt;<ref refid="structssh__connector__struct_1aef4894f7b0135245d08eed5edf68be0b" kindref="member">out_channel</ref>,<sp/><ref refid="benchmarks_8c_1aff2566f4c366b48d73479bef43ee4d2e" kindref="member">buffer</ref>,<sp/>r);</highlight></codeline>
<codeline lineno="539"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(w<sp/>==<sp/><ref refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" kindref="member">SSH_ERROR</ref>)<sp/>{</highlight></codeline>
<codeline lineno="540"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="connector_8c_1a14a16f59cb2bc11c26075ac392898529" kindref="member">ssh_connector_except_channel</ref>(connector,</highlight></codeline>
<codeline lineno="541"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>connector-&gt;<ref refid="structssh__connector__struct_1aef4894f7b0135245d08eed5edf68be0b" kindref="member">out_channel</ref>);</highlight></codeline>
<codeline lineno="542"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="543"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="544"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(connector-&gt;<ref refid="structssh__connector__struct_1aed6f65c2d6ceb1c1fb8c1189e69dbac5" kindref="member">in_fd</ref><sp/>!=<sp/><ref refid="libssh_8h_1a5f05b48043a1f47b36388227bee5d4f8" kindref="member">SSH_INVALID_SOCKET</ref>)<sp/>{</highlight></codeline>
<codeline lineno="545"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>fallback<sp/>on<sp/>on<sp/>the<sp/>socket<sp/>input<sp/>callback<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="546"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>connector-&gt;<ref refid="structssh__connector__struct_1a96f134844f8a75d2954173500b4bd06f" kindref="member">out_wontblock</ref><sp/>=<sp/>1;</highlight></codeline>
<codeline lineno="547"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="connector_8c_1a83806fe46fe887adb695eeca7f35682a" kindref="member">ssh_connector_fd_in_cb</ref>(connector);</highlight></codeline>
<codeline lineno="548"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="connector_8c_1a49e333bf300287cfadad801243c2d7f7" kindref="member">ssh_connector_reset_pollevents</ref>(connector);</highlight></codeline>
<codeline lineno="549"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="550"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="priv_8h_1a55177b3e8db90ca9adb435c44281963c" kindref="member">ssh_set_error</ref>(<ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>,</highlight></codeline>
<codeline lineno="551"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="libssh_8h_1a036b2b00fb04337a4d06d719d1b62be1a86ff0b2e8da6ad8628efc556b6ce1887" kindref="member">SSH_FATAL</ref>,</highlight></codeline>
<codeline lineno="552"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Output<sp/>socket<sp/>or<sp/>channel<sp/>closed&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="553"><highlight class="normal"></highlight></codeline>
<codeline lineno="554"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>0;</highlight></codeline>
<codeline lineno="555"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="556"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>connector-&gt;<ref refid="structssh__connector__struct_1abfe4d6220cffdecb0596befdc269cfd1" kindref="member">in_available</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="557"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>connector-&gt;<ref refid="structssh__connector__struct_1a96f134844f8a75d2954173500b4bd06f" kindref="member">out_wontblock</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="558"><highlight class="normal"><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="559"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>connector-&gt;<ref refid="structssh__connector__struct_1a96f134844f8a75d2954173500b4bd06f" kindref="member">out_wontblock</ref><sp/>=<sp/>1;</highlight></codeline>
<codeline lineno="560"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="561"><highlight class="normal"></highlight></codeline>
<codeline lineno="562"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>0;</highlight></codeline>
<codeline lineno="563"><highlight class="normal">}</highlight></codeline>
<codeline lineno="564"><highlight class="normal"></highlight></codeline>
<codeline lineno="565" refid="priv_8h_1a84015bb99d7ac6fe60fe6e61dbd0e1cf" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="connector_8c_1a84015bb99d7ac6fe60fe6e61dbd0e1cf" kindref="member">ssh_connector_set_event</ref>(<ref refid="structssh__connector__struct" kindref="compound">ssh_connector</ref><sp/>connector,<sp/><ref refid="structssh__event__struct" kindref="compound">ssh_event</ref><sp/>event)</highlight></codeline>
<codeline lineno="566"><highlight class="normal">{</highlight></codeline>
<codeline lineno="567"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="libssh_8h_1ac1ee1d1e917456d4760a94a18015377d" kindref="member">SSH_OK</ref>;</highlight></codeline>
<codeline lineno="568"><highlight class="normal"></highlight></codeline>
<codeline lineno="569"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>((connector-&gt;<ref refid="structssh__connector__struct_1aed6f65c2d6ceb1c1fb8c1189e69dbac5" kindref="member">in_fd</ref><sp/>==<sp/><ref refid="libssh_8h_1a5f05b48043a1f47b36388227bee5d4f8" kindref="member">SSH_INVALID_SOCKET</ref><sp/>&amp;&amp;</highlight></codeline>
<codeline lineno="570"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>connector-&gt;<ref refid="structssh__connector__struct_1a8c09fde7984ab2b042d15f7b1c26965d" kindref="member">in_channel</ref><sp/>==<sp/>NULL)</highlight></codeline>
<codeline lineno="571"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>||<sp/>(connector-&gt;<ref refid="structssh__connector__struct_1a820aee50995208d193f4fe295beb239e" kindref="member">out_fd</ref><sp/>==<sp/><ref refid="libssh_8h_1a5f05b48043a1f47b36388227bee5d4f8" kindref="member">SSH_INVALID_SOCKET</ref><sp/>&amp;&amp;</highlight></codeline>
<codeline lineno="572"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>connector-&gt;<ref refid="structssh__connector__struct_1aef4894f7b0135245d08eed5edf68be0b" kindref="member">out_channel</ref><sp/>==<sp/>NULL))<sp/>{</highlight></codeline>
<codeline lineno="573"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" kindref="member">SSH_ERROR</ref>;</highlight></codeline>
<codeline lineno="574"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="priv_8h_1a55177b3e8db90ca9adb435c44281963c" kindref="member">ssh_set_error</ref>(connector-&gt;<ref refid="structssh__connector__struct_1a73b1b54b8c7ad4fb06e1841c7ad51285" kindref="member">session</ref>,<ref refid="libssh_8h_1a036b2b00fb04337a4d06d719d1b62be1a86ff0b2e8da6ad8628efc556b6ce1887" kindref="member">SSH_FATAL</ref>,</highlight><highlight class="stringliteral">&quot;Connector<sp/>not<sp/>complete&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="575"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">goto</highlight><highlight class="normal"><sp/><ref refid="proxy_8c_1a11614f44ef4d939bdd984953346a7572" kindref="member">error</ref>;</highlight></codeline>
<codeline lineno="576"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="577"><highlight class="normal"></highlight></codeline>
<codeline lineno="578"><highlight class="normal"><sp/><sp/><sp/><sp/>connector-&gt;<ref refid="structssh__connector__struct_1aae4c1c8966793b6649a59085aeec3ff6" kindref="member">event</ref><sp/>=<sp/>event;</highlight></codeline>
<codeline lineno="579"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(connector-&gt;<ref refid="structssh__connector__struct_1aed6f65c2d6ceb1c1fb8c1189e69dbac5" kindref="member">in_fd</ref><sp/>!=<sp/><ref refid="libssh_8h_1a5f05b48043a1f47b36388227bee5d4f8" kindref="member">SSH_INVALID_SOCKET</ref>)<sp/>{</highlight></codeline>
<codeline lineno="580"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(connector-&gt;<ref refid="structssh__connector__struct_1a3d27a520636b09b59437e6d5666ce44c" kindref="member">in_poll</ref><sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="581"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>connector-&gt;<ref refid="structssh__connector__struct_1a3d27a520636b09b59437e6d5666ce44c" kindref="member">in_poll</ref><sp/>=<sp/><ref refid="group__libssh__poll_1gac657ed07db9e5851ffb0aba45e071e99" kindref="member">ssh_poll_new</ref>(connector-&gt;<ref refid="structssh__connector__struct_1aed6f65c2d6ceb1c1fb8c1189e69dbac5" kindref="member">in_fd</ref>,</highlight></codeline>
<codeline lineno="582"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="poll_8h_1a52ac479a805051f59643588b096024ff" kindref="member">POLLIN</ref>|<ref refid="poll_8h_1ab1c532446408c98559d4aaaeeeb99820" kindref="member">POLLERR</ref>,</highlight></codeline>
<codeline lineno="583"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="connector_8c_1a3ee42f9fc7405a94313d6275aaa74db3" kindref="member">ssh_connector_fd_cb</ref>,</highlight></codeline>
<codeline lineno="584"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>connector);</highlight></codeline>
<codeline lineno="585"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="586"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="group__libssh__poll_1gaaf3e1df762650369e99595eee761f2a9" kindref="member">ssh_event_add_poll</ref>(event,<sp/>connector-&gt;<ref refid="structssh__connector__struct_1a3d27a520636b09b59437e6d5666ce44c" kindref="member">in_poll</ref>);</highlight></codeline>
<codeline lineno="587"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>!=<sp/><ref refid="libssh_8h_1ac1ee1d1e917456d4760a94a18015377d" kindref="member">SSH_OK</ref>)<sp/>{</highlight></codeline>
<codeline lineno="588"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">goto</highlight><highlight class="normal"><sp/><ref refid="proxy_8c_1a11614f44ef4d939bdd984953346a7572" kindref="member">error</ref>;</highlight></codeline>
<codeline lineno="589"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="590"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="591"><highlight class="normal"></highlight></codeline>
<codeline lineno="592"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(connector-&gt;<ref refid="structssh__connector__struct_1a820aee50995208d193f4fe295beb239e" kindref="member">out_fd</ref><sp/>!=<sp/><ref refid="libssh_8h_1a5f05b48043a1f47b36388227bee5d4f8" kindref="member">SSH_INVALID_SOCKET</ref>)<sp/>{</highlight></codeline>
<codeline lineno="593"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(connector-&gt;<ref refid="structssh__connector__struct_1abab4576fbd113acfaf860eedf6a60624" kindref="member">out_poll</ref><sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="594"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>connector-&gt;<ref refid="structssh__connector__struct_1abab4576fbd113acfaf860eedf6a60624" kindref="member">out_poll</ref><sp/>=<sp/><ref refid="group__libssh__poll_1gac657ed07db9e5851ffb0aba45e071e99" kindref="member">ssh_poll_new</ref>(connector-&gt;<ref refid="structssh__connector__struct_1a820aee50995208d193f4fe295beb239e" kindref="member">out_fd</ref>,</highlight></codeline>
<codeline lineno="595"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="poll_8h_1a91b3c67129ac7675062f316b840a0d58" kindref="member">POLLOUT</ref>|<ref refid="poll_8h_1ab1c532446408c98559d4aaaeeeb99820" kindref="member">POLLERR</ref>,</highlight></codeline>
<codeline lineno="596"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="connector_8c_1a3ee42f9fc7405a94313d6275aaa74db3" kindref="member">ssh_connector_fd_cb</ref>,</highlight></codeline>
<codeline lineno="597"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>connector);</highlight></codeline>
<codeline lineno="598"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="599"><highlight class="normal"></highlight></codeline>
<codeline lineno="600"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="group__libssh__poll_1gaaf3e1df762650369e99595eee761f2a9" kindref="member">ssh_event_add_poll</ref>(event,<sp/>connector-&gt;<ref refid="structssh__connector__struct_1abab4576fbd113acfaf860eedf6a60624" kindref="member">out_poll</ref>);</highlight></codeline>
<codeline lineno="601"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>!=<sp/><ref refid="libssh_8h_1ac1ee1d1e917456d4760a94a18015377d" kindref="member">SSH_OK</ref>)<sp/>{</highlight></codeline>
<codeline lineno="602"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">goto</highlight><highlight class="normal"><sp/><ref refid="proxy_8c_1a11614f44ef4d939bdd984953346a7572" kindref="member">error</ref>;</highlight></codeline>
<codeline lineno="603"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="604"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="605"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(connector-&gt;<ref refid="structssh__connector__struct_1a8c09fde7984ab2b042d15f7b1c26965d" kindref="member">in_channel</ref><sp/>!=<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="606"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><ref refid="group__libssh__poll_1ga51af38de4cc3adbd5566ec1f1b91983d" kindref="member">ssh_event_add_session</ref>(event,</highlight></codeline>
<codeline lineno="607"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="group__libssh__channel_1ga747aa5315575aa7ac9d8367c7372d8dd" kindref="member">ssh_channel_get_session</ref>(connector-&gt;<ref refid="structssh__connector__struct_1a8c09fde7984ab2b042d15f7b1c26965d" kindref="member">in_channel</ref>));</highlight></codeline>
<codeline lineno="608"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>!=<sp/><ref refid="libssh_8h_1ac1ee1d1e917456d4760a94a18015377d" kindref="member">SSH_OK</ref>)</highlight></codeline>
<codeline lineno="609"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">goto</highlight><highlight class="normal"><sp/><ref refid="proxy_8c_1a11614f44ef4d939bdd984953346a7572" kindref="member">error</ref>;</highlight></codeline>
<codeline lineno="610"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="group__libssh__channel_1gab56c7b7959e4c23959f2989468811661" kindref="member">ssh_channel_poll_timeout</ref>(connector-&gt;<ref refid="structssh__connector__struct_1a8c09fde7984ab2b042d15f7b1c26965d" kindref="member">in_channel</ref>,<sp/>0,<sp/>0)<sp/>&gt;<sp/>0){</highlight></codeline>
<codeline lineno="611"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>connector-&gt;<ref refid="structssh__connector__struct_1abfe4d6220cffdecb0596befdc269cfd1" kindref="member">in_available</ref><sp/>=<sp/>1;</highlight></codeline>
<codeline lineno="612"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="613"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="614"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(connector-&gt;<ref refid="structssh__connector__struct_1aef4894f7b0135245d08eed5edf68be0b" kindref="member">out_channel</ref><sp/>!=<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="615"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structssh__session__struct" kindref="compound">ssh_session</ref><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref><sp/>=<sp/><ref refid="group__libssh__channel_1ga747aa5315575aa7ac9d8367c7372d8dd" kindref="member">ssh_channel_get_session</ref>(connector-&gt;<ref refid="structssh__connector__struct_1aef4894f7b0135245d08eed5edf68be0b" kindref="member">out_channel</ref>);</highlight></codeline>
<codeline lineno="616"><highlight class="normal"></highlight></codeline>
<codeline lineno="617"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/><sp/><ref refid="group__libssh__poll_1ga51af38de4cc3adbd5566ec1f1b91983d" kindref="member">ssh_event_add_session</ref>(event,<sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>);</highlight></codeline>
<codeline lineno="618"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>!=<sp/><ref refid="libssh_8h_1ac1ee1d1e917456d4760a94a18015377d" kindref="member">SSH_OK</ref>)<sp/>{</highlight></codeline>
<codeline lineno="619"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">goto</highlight><highlight class="normal"><sp/><ref refid="proxy_8c_1a11614f44ef4d939bdd984953346a7572" kindref="member">error</ref>;</highlight></codeline>
<codeline lineno="620"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="621"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="group__libssh__channel_1gadf53c5a5b501086af26d06cba3f1491f" kindref="member">ssh_channel_window_size</ref>(connector-&gt;<ref refid="structssh__connector__struct_1aef4894f7b0135245d08eed5edf68be0b" kindref="member">out_channel</ref>)<sp/>&gt;<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="622"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>connector-&gt;<ref refid="structssh__connector__struct_1a96f134844f8a75d2954173500b4bd06f" kindref="member">out_wontblock</ref><sp/>=<sp/>1;</highlight></codeline>
<codeline lineno="623"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="624"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="625"><highlight class="normal"></highlight></codeline>
<codeline lineno="626"><highlight class="normal"><ref refid="proxy_8c_1a11614f44ef4d939bdd984953346a7572" kindref="member">error</ref>:</highlight></codeline>
<codeline lineno="627"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref>;</highlight></codeline>
<codeline lineno="628"><highlight class="normal">}</highlight></codeline>
<codeline lineno="629"><highlight class="normal"></highlight></codeline>
<codeline lineno="630" refid="priv_8h_1ad92def69fc9cce5d1d564588e668a862" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="connector_8c_1ad92def69fc9cce5d1d564588e668a862" kindref="member">ssh_connector_remove_event</ref>(<ref refid="structssh__connector__struct" kindref="compound">ssh_connector</ref><sp/>connector)<sp/>{</highlight></codeline>
<codeline lineno="631"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="structssh__session__struct" kindref="compound">ssh_session</ref><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>;</highlight></codeline>
<codeline lineno="632"><highlight class="normal"></highlight></codeline>
<codeline lineno="633"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(connector-&gt;<ref refid="structssh__connector__struct_1a3d27a520636b09b59437e6d5666ce44c" kindref="member">in_poll</ref><sp/>!=<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="634"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="group__libssh__poll_1ga302e3942e697063f1a54319667231f73" kindref="member">ssh_event_remove_poll</ref>(connector-&gt;<ref refid="structssh__connector__struct_1aae4c1c8966793b6649a59085aeec3ff6" kindref="member">event</ref>,<sp/>connector-&gt;<ref refid="structssh__connector__struct_1a3d27a520636b09b59437e6d5666ce44c" kindref="member">in_poll</ref>);</highlight></codeline>
<codeline lineno="635"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="group__libssh__poll_1ga873ecc6866c286f7777612d94de5c00d" kindref="member">ssh_poll_free</ref>(connector-&gt;<ref refid="structssh__connector__struct_1a3d27a520636b09b59437e6d5666ce44c" kindref="member">in_poll</ref>);</highlight></codeline>
<codeline lineno="636"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>connector-&gt;<ref refid="structssh__connector__struct_1a3d27a520636b09b59437e6d5666ce44c" kindref="member">in_poll</ref><sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="637"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="638"><highlight class="normal"></highlight></codeline>
<codeline lineno="639"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(connector-&gt;<ref refid="structssh__connector__struct_1abab4576fbd113acfaf860eedf6a60624" kindref="member">out_poll</ref><sp/>!=<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="640"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="group__libssh__poll_1ga302e3942e697063f1a54319667231f73" kindref="member">ssh_event_remove_poll</ref>(connector-&gt;<ref refid="structssh__connector__struct_1aae4c1c8966793b6649a59085aeec3ff6" kindref="member">event</ref>,<sp/>connector-&gt;<ref refid="structssh__connector__struct_1abab4576fbd113acfaf860eedf6a60624" kindref="member">out_poll</ref>);</highlight></codeline>
<codeline lineno="641"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="group__libssh__poll_1ga873ecc6866c286f7777612d94de5c00d" kindref="member">ssh_poll_free</ref>(connector-&gt;<ref refid="structssh__connector__struct_1abab4576fbd113acfaf860eedf6a60624" kindref="member">out_poll</ref>);</highlight></codeline>
<codeline lineno="642"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>connector-&gt;<ref refid="structssh__connector__struct_1abab4576fbd113acfaf860eedf6a60624" kindref="member">out_poll</ref><sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="643"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="644"><highlight class="normal"></highlight></codeline>
<codeline lineno="645"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(connector-&gt;<ref refid="structssh__connector__struct_1a8c09fde7984ab2b042d15f7b1c26965d" kindref="member">in_channel</ref><sp/>!=<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="646"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref><sp/>=<sp/><ref refid="group__libssh__channel_1ga747aa5315575aa7ac9d8367c7372d8dd" kindref="member">ssh_channel_get_session</ref>(connector-&gt;<ref refid="structssh__connector__struct_1a8c09fde7984ab2b042d15f7b1c26965d" kindref="member">in_channel</ref>);</highlight></codeline>
<codeline lineno="647"><highlight class="normal"></highlight></codeline>
<codeline lineno="648"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="group__libssh__poll_1gaab8dec05a0afb49392c63b2ec158ac3d" kindref="member">ssh_event_remove_session</ref>(connector-&gt;<ref refid="structssh__connector__struct_1aae4c1c8966793b6649a59085aeec3ff6" kindref="member">event</ref>,<sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>);</highlight></codeline>
<codeline lineno="649"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="650"><highlight class="normal"></highlight></codeline>
<codeline lineno="651"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(connector-&gt;<ref refid="structssh__connector__struct_1aef4894f7b0135245d08eed5edf68be0b" kindref="member">out_channel</ref><sp/>!=<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="652"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref><sp/>=<sp/><ref refid="group__libssh__channel_1ga747aa5315575aa7ac9d8367c7372d8dd" kindref="member">ssh_channel_get_session</ref>(connector-&gt;<ref refid="structssh__connector__struct_1aef4894f7b0135245d08eed5edf68be0b" kindref="member">out_channel</ref>);</highlight></codeline>
<codeline lineno="653"><highlight class="normal"></highlight></codeline>
<codeline lineno="654"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="group__libssh__poll_1gaab8dec05a0afb49392c63b2ec158ac3d" kindref="member">ssh_event_remove_session</ref>(connector-&gt;<ref refid="structssh__connector__struct_1aae4c1c8966793b6649a59085aeec3ff6" kindref="member">event</ref>,<sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>);</highlight></codeline>
<codeline lineno="655"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="656"><highlight class="normal"><sp/><sp/><sp/><sp/>connector-&gt;<ref refid="structssh__connector__struct_1aae4c1c8966793b6649a59085aeec3ff6" kindref="member">event</ref><sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="657"><highlight class="normal"></highlight></codeline>
<codeline lineno="658"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="libssh_8h_1ac1ee1d1e917456d4760a94a18015377d" kindref="member">SSH_OK</ref>;</highlight></codeline>
<codeline lineno="659"><highlight class="normal">}</highlight></codeline>
<codeline lineno="660"><highlight class="normal"></highlight></codeline>
<codeline lineno="667" refid="connector_8c_1a7a60e4126deea02a1dac73121e321245" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/><ref refid="connector_8c_1a7a60e4126deea02a1dac73121e321245" kindref="member">ssh_connector_fd_is_socket</ref>(<ref refid="libssh_8h_1a30353f381f5fccbb956eea1f3a110b6c" kindref="member">socket_t</ref><sp/><ref refid="test__socket_8c_1a73991beba1accdcc64730cb00c146fe2" kindref="member">s</ref>)</highlight></codeline>
<codeline lineno="668"><highlight class="normal">{</highlight></codeline>
<codeline lineno="669"><highlight class="normal"></highlight><highlight class="preprocessor">#ifdef<sp/>_WIN32</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="670"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">struct<sp/></highlight><highlight class="normal">sockaddr_storage<sp/>ss;</highlight></codeline>
<codeline lineno="671"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>len<sp/>=<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(</highlight><highlight class="keyword">struct<sp/></highlight><highlight class="normal">sockaddr_storage);</highlight></codeline>
<codeline lineno="672"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref>;</highlight></codeline>
<codeline lineno="673"><highlight class="normal"></highlight></codeline>
<codeline lineno="674"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/>getsockname(<ref refid="test__socket_8c_1a73991beba1accdcc64730cb00c146fe2" kindref="member">s</ref>,<sp/>(</highlight><highlight class="keyword">struct</highlight><highlight class="normal"><sp/>sockaddr<sp/>*)&amp;ss,<sp/>&amp;len);</highlight></codeline>
<codeline lineno="675"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>==<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="676"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="677"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="678"><highlight class="normal"></highlight></codeline>
<codeline lineno="679"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="priv_8h_1aa21fd8a7a609329603b7b16da7939fca" kindref="member">SSH_LOG</ref>(<ref refid="libssh_8h_1a466c84d8dd5b1ba9162d491f31117a6b" kindref="member">SSH_LOG_TRACE</ref>,</highlight></codeline>
<codeline lineno="680"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Error<sp/>%i<sp/>in<sp/>getsockname()<sp/>for<sp/>fd<sp/>%d&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="681"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>WSAGetLastError(),</highlight></codeline>
<codeline lineno="682"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="test__socket_8c_1a73991beba1accdcc64730cb00c146fe2" kindref="member">s</ref>);</highlight></codeline>
<codeline lineno="683"><highlight class="normal"></highlight></codeline>
<codeline lineno="684"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="685"><highlight class="normal"></highlight><highlight class="preprocessor">#else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="686"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">struct<sp/></highlight><highlight class="normal">stat<sp/>sb;</highlight></codeline>
<codeline lineno="687"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref>;</highlight></codeline>
<codeline lineno="688"><highlight class="normal"></highlight></codeline>
<codeline lineno="689"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>=<sp/>fstat(<ref refid="test__socket_8c_1a73991beba1accdcc64730cb00c146fe2" kindref="member">s</ref>,<sp/>&amp;sb);</highlight></codeline>
<codeline lineno="690"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" kindref="member">rc</ref><sp/>!=<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="691"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="priv_8h_1aa21fd8a7a609329603b7b16da7939fca" kindref="member">SSH_LOG</ref>(<ref refid="libssh_8h_1a466c84d8dd5b1ba9162d491f31117a6b" kindref="member">SSH_LOG_TRACE</ref>,</highlight></codeline>
<codeline lineno="692"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;error<sp/>%i<sp/>in<sp/>fstat()<sp/>for<sp/>fd<sp/>%d&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="693"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>errno,</highlight></codeline>
<codeline lineno="694"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="test__socket_8c_1a73991beba1accdcc64730cb00c146fe2" kindref="member">s</ref>);</highlight></codeline>
<codeline lineno="695"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="696"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="697"><highlight class="normal"></highlight></codeline>
<codeline lineno="698"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>The<sp/>descriptor<sp/>is<sp/>a<sp/>socket<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="699"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(S_ISSOCK(sb.st_mode))<sp/>{</highlight></codeline>
<codeline lineno="700"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="701"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="702"><highlight class="normal"></highlight></codeline>
<codeline lineno="703"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="704"><highlight class="normal"></highlight><highlight class="preprocessor">#endif<sp/></highlight><highlight class="comment">/*<sp/>_WIN32<sp/>*/</highlight><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="705"><highlight class="normal">}</highlight></codeline>
<codeline lineno="706"><highlight class="normal"></highlight></codeline>
<codeline lineno="713" refid="connector_8c_1a9d10a96cbda381bccc2fee5f2d5904c5" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/>ssize_t<sp/><ref refid="connector_8c_1a9d10a96cbda381bccc2fee5f2d5904c5" kindref="member">ssh_connector_fd_read</ref>(<ref refid="structssh__connector__struct" kindref="compound">ssh_connector</ref><sp/>connector,</highlight></codeline>
<codeline lineno="714"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>*<ref refid="benchmarks_8c_1aff2566f4c366b48d73479bef43ee4d2e" kindref="member">buffer</ref>,</highlight></codeline>
<codeline lineno="715"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>uint32_t<sp/>len)</highlight></codeline>
<codeline lineno="716"><highlight class="normal">{</highlight></codeline>
<codeline lineno="717"><highlight class="normal"><sp/><sp/><sp/><sp/>ssize_t<sp/>nread<sp/>=<sp/>-1;</highlight></codeline>
<codeline lineno="718"><highlight class="normal"></highlight></codeline>
<codeline lineno="719"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(connector-&gt;<ref refid="structssh__connector__struct_1aa7f4b9010c7f112fff0385e6e677b329" kindref="member">fd_is_socket</ref>)<sp/>{</highlight></codeline>
<codeline lineno="720"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nread<sp/>=<sp/>recv(connector-&gt;<ref refid="structssh__connector__struct_1aed6f65c2d6ceb1c1fb8c1189e69dbac5" kindref="member">in_fd</ref>,<ref refid="benchmarks_8c_1aff2566f4c366b48d73479bef43ee4d2e" kindref="member">buffer</ref>,<sp/>len,<sp/>0);</highlight></codeline>
<codeline lineno="721"><highlight class="normal"><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="722"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nread<sp/>=<sp/>read(connector-&gt;<ref refid="structssh__connector__struct_1aed6f65c2d6ceb1c1fb8c1189e69dbac5" kindref="member">in_fd</ref>,<ref refid="benchmarks_8c_1aff2566f4c366b48d73479bef43ee4d2e" kindref="member">buffer</ref>,<sp/>len);</highlight></codeline>
<codeline lineno="723"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="724"><highlight class="normal"></highlight></codeline>
<codeline lineno="725"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>nread;</highlight></codeline>
<codeline lineno="726"><highlight class="normal">}</highlight></codeline>
<codeline lineno="727"><highlight class="normal"></highlight></codeline>
<codeline lineno="734" refid="connector_8c_1a2c034263a1c5bab38564d40cbfc67631" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/>ssize_t<sp/><ref refid="connector_8c_1a2c034263a1c5bab38564d40cbfc67631" kindref="member">ssh_connector_fd_write</ref>(<ref refid="structssh__connector__struct" kindref="compound">ssh_connector</ref><sp/>connector,</highlight></codeline>
<codeline lineno="735"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>*<ref refid="benchmarks_8c_1aff2566f4c366b48d73479bef43ee4d2e" kindref="member">buffer</ref>,</highlight></codeline>
<codeline lineno="736"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>uint32_t<sp/>len)</highlight></codeline>
<codeline lineno="737"><highlight class="normal">{</highlight></codeline>
<codeline lineno="738"><highlight class="normal"><sp/><sp/><sp/><sp/>ssize_t<sp/>bwritten<sp/>=<sp/>-1;</highlight></codeline>
<codeline lineno="739"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>flags<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="740"><highlight class="normal"></highlight></codeline>
<codeline lineno="741"><highlight class="normal"></highlight><highlight class="preprocessor">#ifdef<sp/>MSG_NOSIGNAL</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="742"><highlight class="normal"><sp/><sp/><sp/><sp/>flags<sp/>|=<sp/>MSG_NOSIGNAL;</highlight></codeline>
<codeline lineno="743"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="744"><highlight class="normal"></highlight></codeline>
<codeline lineno="745"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(connector-&gt;<ref refid="structssh__connector__struct_1aa7f4b9010c7f112fff0385e6e677b329" kindref="member">fd_is_socket</ref>)<sp/>{</highlight></codeline>
<codeline lineno="746"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>bwritten<sp/>=<sp/>send(connector-&gt;<ref refid="structssh__connector__struct_1a820aee50995208d193f4fe295beb239e" kindref="member">out_fd</ref>,<ref refid="benchmarks_8c_1aff2566f4c366b48d73479bef43ee4d2e" kindref="member">buffer</ref>,<sp/>len,<sp/>flags);</highlight></codeline>
<codeline lineno="747"><highlight class="normal"><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="748"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>bwritten<sp/>=<sp/>write(connector-&gt;<ref refid="structssh__connector__struct_1a820aee50995208d193f4fe295beb239e" kindref="member">out_fd</ref>,<sp/><ref refid="benchmarks_8c_1aff2566f4c366b48d73479bef43ee4d2e" kindref="member">buffer</ref>,<sp/>len);</highlight></codeline>
<codeline lineno="749"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="750"><highlight class="normal"></highlight></codeline>
<codeline lineno="751"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>bwritten;</highlight></codeline>
<codeline lineno="752"><highlight class="normal">}</highlight></codeline>
    </programlisting>
    <location file="src/connector.c"/>
  </compounddef>
</doxygen>
