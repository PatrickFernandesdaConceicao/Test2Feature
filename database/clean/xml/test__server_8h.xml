<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<doxygen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="compound.xsd" version="1.9.1" xml:lang="en-US">
  <compounddef id="test__server_8h" kind="file" language="C++">
    <compoundname>test_server.h</compoundname>
    <includes refid="config_8h" local="yes">config.h</includes>
    <includes local="no">stdbool.h</includes>
    <includes local="no">fcntl.h</includes>
    <includes refid="libssh_8h" local="no">libssh/libssh.h</includes>
    <includes refid="server_8h" local="no">libssh/server.h</includes>
    <includes refid="callbacks_8h" local="no">libssh/callbacks.h</includes>
    <includedby refid="default__cb_8c" local="yes">tests/server/test_server/default_cb.c</includedby>
    <includedby refid="server_2test__server_2main_8c" local="yes">tests/server/test_server/main.c</includedby>
    <includedby refid="test__server_8c" local="yes">tests/server/test_server/test_server.c</includedby>
    <includedby refid="torture__server_8c" local="yes">tests/server/torture_server.c</includedby>
    <includedby refid="torture__server__auth__kbdint_8c" local="yes">tests/server/torture_server_auth_kbdint.c</includedby>
    <includedby refid="torture__server__config_8c" local="yes">tests/server/torture_server_config.c</includedby>
    <incdepgraph>
      <node id="3">
        <label>stdbool.h</label>
      </node>
      <node id="9">
        <label>sys/select.h</label>
      </node>
      <node id="15">
        <label>libssh/priv.h</label>
        <link refid="priv_8h"/>
        <childnode refid="16" relation="include">
        </childnode>
        <childnode refid="17" relation="include">
        </childnode>
        <childnode refid="14" relation="include">
        </childnode>
        <childnode refid="6" relation="include">
        </childnode>
        <childnode refid="5" relation="include">
        </childnode>
        <childnode refid="13" relation="include">
        </childnode>
      </node>
      <node id="14">
        <label>string.h</label>
        <link refid="string_8h"/>
        <childnode refid="15" relation="include">
        </childnode>
      </node>
      <node id="11">
        <label>libssh/legacy.h</label>
        <link refid="legacy_8h"/>
      </node>
      <node id="16">
        <label>stdint.h</label>
      </node>
      <node id="17">
        <label>stdlib.h</label>
      </node>
      <node id="4">
        <label>fcntl.h</label>
      </node>
      <node id="13">
        <label>libssh/callbacks.h</label>
        <link refid="callbacks_8h"/>
        <childnode refid="5" relation="include">
        </childnode>
        <childnode refid="14" relation="include">
        </childnode>
      </node>
      <node id="10">
        <label>netdb.h</label>
      </node>
      <node id="1">
        <label>tests/server/test_server/test_server.h</label>
        <link refid="test__server_8h"/>
        <childnode refid="2" relation="include">
        </childnode>
        <childnode refid="3" relation="include">
        </childnode>
        <childnode refid="4" relation="include">
        </childnode>
        <childnode refid="5" relation="include">
        </childnode>
        <childnode refid="12" relation="include">
        </childnode>
        <childnode refid="13" relation="include">
        </childnode>
      </node>
      <node id="8">
        <label>sys/types.h</label>
      </node>
      <node id="6">
        <label>unistd.h</label>
      </node>
      <node id="12">
        <label>libssh/server.h</label>
        <link refid="server_8h"/>
        <childnode refid="5" relation="include">
        </childnode>
      </node>
      <node id="5">
        <label>libssh/libssh.h</label>
        <link refid="libssh_8h"/>
        <childnode refid="6" relation="include">
        </childnode>
        <childnode refid="7" relation="include">
        </childnode>
        <childnode refid="8" relation="include">
        </childnode>
        <childnode refid="9" relation="include">
        </childnode>
        <childnode refid="10" relation="include">
        </childnode>
        <childnode refid="11" relation="include">
        </childnode>
      </node>
      <node id="2">
        <label>config.h</label>
        <link refid="config_8h"/>
      </node>
      <node id="7">
        <label>inttypes.h</label>
      </node>
    </incdepgraph>
    <invincdepgraph>
      <node id="3">
        <label>tests/server/test_server/main.c</label>
        <link refid="server_2test__server_2main_8c"/>
      </node>
      <node id="5">
        <label>tests/server/torture_server.c</label>
        <link refid="torture__server_8c"/>
      </node>
      <node id="2">
        <label>tests/server/test_server/default_cb.c</label>
        <link refid="default__cb_8c"/>
      </node>
      <node id="7">
        <label>tests/server/torture_server_config.c</label>
        <link refid="torture__server__config_8c"/>
      </node>
      <node id="4">
        <label>tests/server/test_server/test_server.c</label>
        <link refid="test__server_8c"/>
      </node>
      <node id="1">
        <label>tests/server/test_server/test_server.h</label>
        <link refid="test__server_8h"/>
        <childnode refid="2" relation="include">
        </childnode>
        <childnode refid="3" relation="include">
        </childnode>
        <childnode refid="4" relation="include">
        </childnode>
        <childnode refid="5" relation="include">
        </childnode>
        <childnode refid="6" relation="include">
        </childnode>
        <childnode refid="7" relation="include">
        </childnode>
      </node>
      <node id="6">
        <label>tests/server/torture_server_auth_kbdint.c</label>
        <link refid="torture__server__auth__kbdint_8c"/>
      </node>
    </invincdepgraph>
    <innerclass refid="structserver__state__st" prot="public">server_state_st</innerclass>
      <sectiondef kind="func">
      <memberdef kind="function" id="test__server_8h_1aa2c7214928de23992f797acef0a7eb19" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void free_server_state</definition>
        <argsstring>(struct server_state_st *state)</argsstring>
        <name>free_server_state</name>
        <param>
          <type>struct <ref refid="structserver__state__st" kindref="compound">server_state_st</ref> *</type>
          <declname>state</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="tests/server/test_server/test_server.h" line="70" column="6" bodyfile="tests/server/test_server/test_server.c" bodystart="40" bodyend="62" declfile="tests/server/test_server/test_server.h" declline="70" declcolumn="6"/>
        <references refid="structserver__state__st_1a8d81d77b615531aa2be206d0b76c1c13" compoundref="test__server_8h" startline="35">server_state_st::address</references>
        <references refid="structserver__state__st_1ae676fb637a54970ab9a4d448bb5d91aa" compoundref="test__server_8h" startline="53">server_state_st::config_file</references>
        <references refid="structserver__state__st_1a947c147c24e43d11deae01584cbd7fca" compoundref="test__server_8h" startline="39">server_state_st::dsa_key</references>
        <references refid="structserver__state__st_1ad6ff7796e9805c9dd11aee8565bcecbc" compoundref="test__server_8h" startline="38">server_state_st::ecdsa_key</references>
        <references refid="structserver__state__st_1ad86753427c1587b062660033d4c92209" compoundref="test__server_8h" startline="40">server_state_st::ed25519_key</references>
        <references refid="structserver__state__st_1a3f83043259f014640e60811bb43c9d51" compoundref="test__server_8h" startline="51">server_state_st::expected_password</references>
        <references refid="structserver__state__st_1a44b3968f4219e28d0e55d0448bc66685" compoundref="test__server_8h" startline="50">server_state_st::expected_username</references>
        <references refid="structserver__state__st_1aa318a605262595271a03825aa08957a8" compoundref="test__server_8h" startline="42">server_state_st::host_key</references>
        <references refid="structserver__state__st_1a510bd1788121b36d97a6ccb365148839" compoundref="test__server_8h" startline="48">server_state_st::pcap_file</references>
        <references refid="structserver__state__st_1a6e287f7cf82bb2f52596d6cda643130b" compoundref="test__server_8h" startline="41">server_state_st::rsa_key</references>
        <references refid="sshd__direct-tcpip_8c_1aed3129b7674034c979192bcca6b0ad8c" compoundref="sshd__direct-tcpip_8c" startline="36">SAFE_FREE</references>
        <referencedby refid="server_2test__server_2main_8c_1aa86a8bbbf4e1ef1a41dd619074535f0e" compoundref="server_2test__server_2main_8c" startline="598" endline="634">main</referencedby>
        <referencedby refid="test__server_8c_1a1356104271e38a5856393ef01d01bc3a" compoundref="test__server_8c" startline="70" endline="277">run_server</referencedby>
        <referencedby refid="torture__server_8c_1a756711216ba1c7855c33f314006fc1cd" compoundref="torture__server_8c" startline="226" endline="249">teardown_default_server</referencedby>
        <referencedby refid="torture__server__auth__kbdint_8c_1a6b91d654d3aa911bdea83498b5c3c3c9" compoundref="torture__server__auth__kbdint_8c" startline="611" endline="634">teardown_kbdint_server</referencedby>
        <referencedby refid="torture__server__config_8c_1a5de50eda837b8f94dcf6d18a765d0dc8" compoundref="torture__server__config_8c" startline="350" endline="423">try_config_content</referencedby>
      </memberdef>
      <memberdef kind="function" id="test__server_8h_1a1356104271e38a5856393ef01d01bc3a" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>int run_server</definition>
        <argsstring>(struct server_state_st *state)</argsstring>
        <name>run_server</name>
        <param>
          <type>struct <ref refid="structserver__state__st" kindref="compound">server_state_st</ref> *</type>
          <declname>state</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="tests/server/test_server/test_server.h" line="73" column="5" bodyfile="tests/server/test_server/test_server.c" bodystart="70" bodyend="277" declfile="tests/server/test_server/test_server.h" declline="73" declcolumn="5"/>
        <references refid="structserver__state__st_1a8d81d77b615531aa2be206d0b76c1c13" compoundref="test__server_8h" startline="35">server_state_st::address</references>
        <references refid="structserver__state__st_1ae676fb637a54970ab9a4d448bb5d91aa" compoundref="test__server_8h" startline="53">server_state_st::config_file</references>
        <references refid="structserver__state__st_1a947c147c24e43d11deae01584cbd7fca" compoundref="test__server_8h" startline="39">server_state_st::dsa_key</references>
        <references refid="structserver__state__st_1ad6ff7796e9805c9dd11aee8565bcecbc" compoundref="test__server_8h" startline="38">server_state_st::ecdsa_key</references>
        <references refid="test__server_8c_1aa2c7214928de23992f797acef0a7eb19" compoundref="test__server_8c" startline="40" endline="62">free_server_state</references>
        <references refid="structserver__state__st_1aade5fd2595bab522a63b31df9fba740d" compoundref="test__server_8h" startline="64">server_state_st::handle_session</references>
        <references refid="structserver__state__st_1aa318a605262595271a03825aa08957a8" compoundref="test__server_8h" startline="42">server_state_st::host_key</references>
        <references refid="structserver__state__st_1ae0b442f3e69a5f09e2a432d3d32bf921" compoundref="test__server_8h" startline="54">server_state_st::parse_global_config</references>
        <references refid="structserver__state__st_1a2d8fb37eb07bba7094dfa998048a0c88" compoundref="test__server_8h" startline="36">server_state_st::port</references>
        <references refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" compoundref="pkd__daemon_8c" startline="62">rc</references>
        <references refid="structserver__state__st_1a6e287f7cf82bb2f52596d6cda643130b" compoundref="test__server_8h" startline="41">server_state_st::rsa_key</references>
        <references refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" compoundref="torture__session__keys_8c" startline="61">session</references>
        <references refid="test__server_8c_1a3abee2584deb5e89d9c92c58d033e422" compoundref="test__server_8c" startline="65" endline="68">sigchld_handler</references>
        <references refid="group__libssh__server_1ga6609243446f1650243101e0a779dc822" compoundref="bind_8c" startline="553" endline="581">ssh_bind_accept</references>
        <references refid="group__libssh__server_1gaa7650d22d982a82bf328345c04948cdf" compoundref="bind_8c" startline="382" endline="421">ssh_bind_free</references>
        <references refid="group__libssh__server_1gaee5406f486d73aad765cab4c445f2f63" compoundref="bind_8c" startline="251" endline="300">ssh_bind_listen</references>
        <references refid="group__libssh__server_1ga4e4edf0cfd185a335d08e6e610aed77e" compoundref="bind_8c" startline="133" endline="145">ssh_bind_new</references>
        <references refid="group__libssh__server_1gga4c8b5efd4d5e280d59fb680cb7c5d3b8a8e8c977e8e36dacf2e201cc23676276a" compoundref="server_8h" startline="39">SSH_BIND_OPTIONS_BINDADDR</references>
        <references refid="group__libssh__server_1gga4c8b5efd4d5e280d59fb680cb7c5d3b8a7aa510c399d2f7760657c643f9057271" compoundref="server_8h" startline="40">SSH_BIND_OPTIONS_BINDPORT</references>
        <references refid="group__libssh__server_1gga4c8b5efd4d5e280d59fb680cb7c5d3b8a774bda12cf0f9116d270c3b2ff8046d6" compoundref="server_8h" startline="43">SSH_BIND_OPTIONS_DSAKEY</references>
        <references refid="group__libssh__server_1gga4c8b5efd4d5e280d59fb680cb7c5d3b8a3f65d490316ddd6e27c668ee30f99093" compoundref="server_8h" startline="48">SSH_BIND_OPTIONS_ECDSAKEY</references>
        <references refid="group__libssh__server_1gga4c8b5efd4d5e280d59fb680cb7c5d3b8ae77da31d38bc5ed42085f38ff2b83d85" compoundref="server_8h" startline="42">SSH_BIND_OPTIONS_HOSTKEY</references>
        <references refid="group__libssh__server_1gga4c8b5efd4d5e280d59fb680cb7c5d3b8ac3c29bccf06ec4de2d6c529761da6f85" compoundref="server_8h" startline="46">SSH_BIND_OPTIONS_LOG_VERBOSITY</references>
        <references refid="group__libssh__server_1ga3bb16df3af3e45481e17b742f3ba774d">ssh_bind_options_parse_config</references>
        <references refid="group__libssh__server_1gga4c8b5efd4d5e280d59fb680cb7c5d3b8aaf8af78b923d68dbd7e6adac83d3f59d" compoundref="server_8h" startline="58">SSH_BIND_OPTIONS_PROCESS_CONFIG</references>
        <references refid="group__libssh__server_1gga4c8b5efd4d5e280d59fb680cb7c5d3b8a1d0f9a21e9c265587b2e63ef73adfa7b" compoundref="server_8h" startline="44">SSH_BIND_OPTIONS_RSAKEY</references>
        <references refid="group__libssh__server_1ga44466ff79106eb04e66d60d64b76d7e2">ssh_bind_options_set</references>
        <references refid="group__libssh__session_1ga0f048a4c0dbe02cfb7e9c5b6d0db0f27" compoundref="client_8c" startline="672" endline="750">ssh_disconnect</references>
        <references refid="libssh_8h_1a790179ef432b3b59aaccd9adab0169ec" compoundref="libssh_8h" startline="330">SSH_ERROR</references>
        <references refid="group__libssh__poll_1ga101388903c74d53ed550574b587449cd" compoundref="poll_8c" startline="1089" endline="1118">ssh_event_free</references>
        <references refid="group__libssh__poll_1ga406895f99b6b486c4b65536e5399ff96" compoundref="poll_8c" startline="760" endline="785">ssh_event_new</references>
        <references refid="group__libssh__session_1gae5af27a98a7488e9f5ded6b37c274156" compoundref="session_8c" startline="191" endline="326">ssh_free</references>
        <references refid="group__libssh__error_1ga9241586665bf21f823806473fc386258" compoundref="error_8c" startline="128" endline="132">ssh_get_error</references>
        <references refid="group__libssh__session_1gaadadc0f9601547c30db7c4d62017d32c" compoundref="session_8c" startline="59" endline="181">ssh_new</references>
        <references refid="structserver__state__st_1a95887fe7d2381e1393c2aff2e42e7221" compoundref="test__server_8h" startline="44">server_state_st::verbosity</references>
        <referencedby refid="test__server_8c_1a0d05af3ed0172f2990ffcfc14bed7f1a" compoundref="test__server_8c" startline="279" endline="329">fork_run_server</referencedby>
        <referencedby refid="server_2test__server_2main_8c_1aa86a8bbbf4e1ef1a41dd619074535f0e" compoundref="server_2test__server_2main_8c" startline="598" endline="634">main</referencedby>
      </memberdef>
      <memberdef kind="function" id="test__server_8h_1a0d05af3ed0172f2990ffcfc14bed7f1a" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>pid_t</type>
        <definition>pid_t fork_run_server</definition>
        <argsstring>(struct server_state_st *state)</argsstring>
        <name>fork_run_server</name>
        <param>
          <type>struct <ref refid="structserver__state__st" kindref="compound">server_state_st</ref> *</type>
          <declname>state</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="tests/server/test_server/test_server.h" line="76" column="7" bodyfile="tests/server/test_server/test_server.c" bodystart="279" bodyend="329" declfile="tests/server/test_server/test_server.h" declline="76" declcolumn="7"/>
        <references refid="pkd__daemon_8c_1ac6509c6fe4cbf7bde170597172f8a288" compoundref="pkd__daemon_8c" startline="62">rc</references>
        <references refid="test__server_8c_1a1356104271e38a5856393ef01d01bc3a" compoundref="test__server_8c" startline="70" endline="277">run_server</references>
        <references refid="test__server_8c_1a3abee2584deb5e89d9c92c58d033e422" compoundref="test__server_8c" startline="65" endline="68">sigchld_handler</references>
        <referencedby refid="torture__server_8c_1a9ed0fa82496e6fd08dff180c6744ea49" compoundref="torture__server_8c" startline="53" endline="224">setup_default_server</referencedby>
        <referencedby refid="torture__server__auth__kbdint_8c_1a9590dbfecb55deab25a850e3b0202e2e" compoundref="torture__server__auth__kbdint_8c" startline="517" endline="609">setup_kbdint_server</referencedby>
        <referencedby refid="torture__server__config_8c_1a2394d8f8505cec93141a9f6fd7dcf57a" compoundref="torture__server__config_8c" startline="240" endline="272">start_server</referencedby>
      </memberdef>
      </sectiondef>
    <briefdescription>
    </briefdescription>
    <detaileddescription>
    </detaileddescription>
    <programlisting>
<codeline lineno="1"><highlight class="comment">/*</highlight></codeline>
<codeline lineno="2"><highlight class="comment"><sp/>*<sp/>This<sp/>file<sp/>is<sp/>part<sp/>of<sp/>the<sp/>SSH<sp/>Library</highlight></codeline>
<codeline lineno="3"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="4"><highlight class="comment"><sp/>*<sp/>Copyright<sp/>(c)<sp/>2018<sp/>by<sp/>Red<sp/>Hat,<sp/>Inc.</highlight></codeline>
<codeline lineno="5"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="6"><highlight class="comment"><sp/>*<sp/>Author:<sp/>Anderson<sp/>Toshiyuki<sp/>Sasaki<sp/>&lt;ansasaki@redhat.com&gt;</highlight></codeline>
<codeline lineno="7"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="8"><highlight class="comment"><sp/>*<sp/>The<sp/>SSH<sp/>Library<sp/>is<sp/>free<sp/>software;<sp/>you<sp/>can<sp/>redistribute<sp/>it<sp/>and/or<sp/>modify</highlight></codeline>
<codeline lineno="9"><highlight class="comment"><sp/>*<sp/>it<sp/>under<sp/>the<sp/>terms<sp/>of<sp/>the<sp/>GNU<sp/>Lesser<sp/>General<sp/>Public<sp/>License<sp/>as<sp/>published<sp/>by</highlight></codeline>
<codeline lineno="10"><highlight class="comment"><sp/>*<sp/>the<sp/>Free<sp/>Software<sp/>Foundation;<sp/>either<sp/>version<sp/>2.1<sp/>of<sp/>the<sp/>License,<sp/>or<sp/>(at<sp/>your</highlight></codeline>
<codeline lineno="11"><highlight class="comment"><sp/>*<sp/>option)<sp/>any<sp/>later<sp/>version.</highlight></codeline>
<codeline lineno="12"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="13"><highlight class="comment"><sp/>*<sp/>The<sp/>SSH<sp/>Library<sp/>is<sp/>distributed<sp/>in<sp/>the<sp/>hope<sp/>that<sp/>it<sp/>will<sp/>be<sp/>useful,<sp/>but</highlight></codeline>
<codeline lineno="14"><highlight class="comment"><sp/>*<sp/>WITHOUT<sp/>ANY<sp/>WARRANTY;<sp/>without<sp/>even<sp/>the<sp/>implied<sp/>warranty<sp/>of<sp/>MERCHANTABILITY</highlight></codeline>
<codeline lineno="15"><highlight class="comment"><sp/>*<sp/>or<sp/>FITNESS<sp/>FOR<sp/>A<sp/>PARTICULAR<sp/>PURPOSE.<sp/><sp/>See<sp/>the<sp/>GNU<sp/>Lesser<sp/>General<sp/>Public</highlight></codeline>
<codeline lineno="16"><highlight class="comment"><sp/>*<sp/>License<sp/>for<sp/>more<sp/>details.</highlight></codeline>
<codeline lineno="17"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="18"><highlight class="comment"><sp/>*<sp/>You<sp/>should<sp/>have<sp/>received<sp/>a<sp/>copy<sp/>of<sp/>the<sp/>GNU<sp/>Lesser<sp/>General<sp/>Public<sp/>License</highlight></codeline>
<codeline lineno="19"><highlight class="comment"><sp/>*<sp/>along<sp/>with<sp/>the<sp/>SSH<sp/>Library;<sp/>see<sp/>the<sp/>file<sp/>COPYING.<sp/><sp/>If<sp/>not,<sp/>write<sp/>to</highlight></codeline>
<codeline lineno="20"><highlight class="comment"><sp/>*<sp/>the<sp/>Free<sp/>Software<sp/>Foundation,<sp/>Inc.,<sp/>59<sp/>Temple<sp/>Place<sp/>-<sp/>Suite<sp/>330,<sp/>Boston,</highlight></codeline>
<codeline lineno="21"><highlight class="comment"><sp/>*<sp/>MA<sp/>02111-1307,<sp/>USA.</highlight></codeline>
<codeline lineno="22"><highlight class="comment"><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="23"><highlight class="normal"></highlight></codeline>
<codeline lineno="24"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="config_8h" kindref="compound">config.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="25"><highlight class="normal"></highlight></codeline>
<codeline lineno="26"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;stdbool.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="27"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;fcntl.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="28"><highlight class="normal"></highlight></codeline>
<codeline lineno="29"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;<ref refid="libssh_8h" kindref="compound">libssh/libssh.h</ref>&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="30"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;<ref refid="server_8h" kindref="compound">libssh/server.h</ref>&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="31"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;<ref refid="callbacks_8h" kindref="compound">libssh/callbacks.h</ref>&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="32"><highlight class="normal"></highlight></codeline>
<codeline lineno="33" refid="structserver__state__st" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">struct<sp/></highlight><highlight class="normal"><ref refid="structserver__state__st" kindref="compound">server_state_st</ref><sp/>{</highlight></codeline>
<codeline lineno="34"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Arguments<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="35" refid="structserver__state__st_1a8d81d77b615531aa2be206d0b76c1c13" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*<ref refid="structserver__state__st_1a8d81d77b615531aa2be206d0b76c1c13" kindref="member">address</ref>;</highlight></codeline>
<codeline lineno="36" refid="structserver__state__st_1a2d8fb37eb07bba7094dfa998048a0c88" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><sp/><ref refid="structserver__state__st_1a2d8fb37eb07bba7094dfa998048a0c88" kindref="member">port</ref>;</highlight></codeline>
<codeline lineno="37"><highlight class="normal"></highlight></codeline>
<codeline lineno="38" refid="structserver__state__st_1ad6ff7796e9805c9dd11aee8565bcecbc" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*<ref refid="structserver__state__st_1ad6ff7796e9805c9dd11aee8565bcecbc" kindref="member">ecdsa_key</ref>;</highlight></codeline>
<codeline lineno="39" refid="structserver__state__st_1a947c147c24e43d11deae01584cbd7fca" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*<ref refid="structserver__state__st_1a947c147c24e43d11deae01584cbd7fca" kindref="member">dsa_key</ref>;</highlight></codeline>
<codeline lineno="40" refid="structserver__state__st_1ad86753427c1587b062660033d4c92209" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*<ref refid="structserver__state__st_1ad86753427c1587b062660033d4c92209" kindref="member">ed25519_key</ref>;</highlight></codeline>
<codeline lineno="41" refid="structserver__state__st_1a6e287f7cf82bb2f52596d6cda643130b" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*<ref refid="structserver__state__st_1a6e287f7cf82bb2f52596d6cda643130b" kindref="member">rsa_key</ref>;</highlight></codeline>
<codeline lineno="42" refid="structserver__state__st_1aa318a605262595271a03825aa08957a8" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*<ref refid="structserver__state__st_1aa318a605262595271a03825aa08957a8" kindref="member">host_key</ref>;</highlight></codeline>
<codeline lineno="43"><highlight class="normal"></highlight></codeline>
<codeline lineno="44" refid="structserver__state__st_1a95887fe7d2381e1393c2aff2e42e7221" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><sp/><ref refid="structserver__state__st_1a95887fe7d2381e1393c2aff2e42e7221" kindref="member">verbosity</ref>;</highlight></codeline>
<codeline lineno="45" refid="structserver__state__st_1a98e7fe1e029f6337047816a8124eebe8" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><sp/><ref refid="structserver__state__st_1a98e7fe1e029f6337047816a8124eebe8" kindref="member">auth_methods</ref>;</highlight></codeline>
<codeline lineno="46" refid="structserver__state__st_1ad6712390266f19c3e4790b5a714d07cb" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/><ref refid="structserver__state__st_1ad6712390266f19c3e4790b5a714d07cb" kindref="member">with_pcap</ref>;</highlight></codeline>
<codeline lineno="47"><highlight class="normal"></highlight></codeline>
<codeline lineno="48" refid="structserver__state__st_1a510bd1788121b36d97a6ccb365148839" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*<ref refid="structserver__state__st_1a510bd1788121b36d97a6ccb365148839" kindref="member">pcap_file</ref>;</highlight></codeline>
<codeline lineno="49"><highlight class="normal"></highlight></codeline>
<codeline lineno="50" refid="structserver__state__st_1a44b3968f4219e28d0e55d0448bc66685" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*<ref refid="structserver__state__st_1a44b3968f4219e28d0e55d0448bc66685" kindref="member">expected_username</ref>;</highlight></codeline>
<codeline lineno="51" refid="structserver__state__st_1a3f83043259f014640e60811bb43c9d51" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*<ref refid="structserver__state__st_1a3f83043259f014640e60811bb43c9d51" kindref="member">expected_password</ref>;</highlight></codeline>
<codeline lineno="52"><highlight class="normal"></highlight></codeline>
<codeline lineno="53" refid="structserver__state__st_1ae676fb637a54970ab9a4d448bb5d91aa" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*<ref refid="structserver__state__st_1ae676fb637a54970ab9a4d448bb5d91aa" kindref="member">config_file</ref>;</highlight></codeline>
<codeline lineno="54" refid="structserver__state__st_1ae0b442f3e69a5f09e2a432d3d32bf921" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/><ref refid="structserver__state__st_1ae0b442f3e69a5f09e2a432d3d32bf921" kindref="member">parse_global_config</ref>;</highlight></codeline>
<codeline lineno="55"><highlight class="normal"></highlight></codeline>
<codeline lineno="56"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>State<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="57" refid="structserver__state__st_1a1509adabb8c47cc743bd3c3ee6b3912e" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><sp/><ref refid="structserver__state__st_1a1509adabb8c47cc743bd3c3ee6b3912e" kindref="member">max_tries</ref>;</highlight></codeline>
<codeline lineno="58" refid="structserver__state__st_1aaafdae90666443e2d645a852a90618f5" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><sp/><ref refid="structserver__state__st_1aaafdae90666443e2d645a852a90618f5" kindref="member">error</ref>;</highlight></codeline>
<codeline lineno="59"><highlight class="normal"></highlight></codeline>
<codeline lineno="60" refid="structserver__state__st_1a1deba12991ec3cf3e867599239331f66" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">struct<sp/></highlight><highlight class="normal"><ref refid="structssh__server__callbacks__struct" kindref="compound">ssh_server_callbacks_struct</ref><sp/>*<ref refid="structserver__state__st_1a1deba12991ec3cf3e867599239331f66" kindref="member">server_cb</ref>;</highlight></codeline>
<codeline lineno="61" refid="structserver__state__st_1ada8dec67948a66c65e4023fe2f740412" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">struct<sp/></highlight><highlight class="normal"><ref refid="structssh__channel__callbacks__struct" kindref="compound">ssh_channel_callbacks_struct</ref><sp/>*<ref refid="structserver__state__st_1ada8dec67948a66c65e4023fe2f740412" kindref="member">channel_cb</ref>;</highlight></codeline>
<codeline lineno="62"><highlight class="normal"></highlight></codeline>
<codeline lineno="63"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Callback<sp/>to<sp/>handle<sp/>the<sp/>session,<sp/>should<sp/>block<sp/>until<sp/>disconnected<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="64" refid="structserver__state__st_1aade5fd2595bab522a63b31df9fba740d" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>void<sp/>(*<ref refid="structserver__state__st_1aade5fd2595bab522a63b31df9fba740d" kindref="member">handle_session</ref>)(<ref refid="structssh__event__struct" kindref="compound">ssh_event</ref><sp/>event,</highlight></codeline>
<codeline lineno="65"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structssh__session__struct" kindref="compound">ssh_session</ref><sp/><ref refid="torture__session__keys_8c_1a1ea82fff28491cf424fc0753ec725adb" kindref="member">session</ref>,</highlight></codeline>
<codeline lineno="66"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">struct<sp/></highlight><highlight class="normal"><ref refid="structserver__state__st" kindref="compound">server_state_st</ref><sp/>*state);</highlight></codeline>
<codeline lineno="67"><highlight class="normal">};</highlight></codeline>
<codeline lineno="68"><highlight class="normal"></highlight></codeline>
<codeline lineno="69"><highlight class="normal"></highlight><highlight class="comment">/*TODO:<sp/>Add<sp/>documentation<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="70"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="test__server_8h_1aa2c7214928de23992f797acef0a7eb19" kindref="member">free_server_state</ref>(</highlight><highlight class="keyword">struct</highlight><highlight class="normal"><sp/><ref refid="structserver__state__st" kindref="compound">server_state_st</ref><sp/>*state);</highlight></codeline>
<codeline lineno="71"><highlight class="normal"></highlight></codeline>
<codeline lineno="72"><highlight class="normal"></highlight><highlight class="comment">/*TODO:<sp/>Add<sp/>documentation<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="73"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="test__server_8h_1a1356104271e38a5856393ef01d01bc3a" kindref="member">run_server</ref>(</highlight><highlight class="keyword">struct</highlight><highlight class="normal"><sp/><ref refid="structserver__state__st" kindref="compound">server_state_st</ref><sp/>*state);</highlight></codeline>
<codeline lineno="74"><highlight class="normal"></highlight></codeline>
<codeline lineno="75"><highlight class="normal"></highlight><highlight class="comment">/*TODO:<sp/>Add<sp/>documentation<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="76"><highlight class="normal">pid_t<sp/><ref refid="test__server_8h_1a0d05af3ed0172f2990ffcfc14bed7f1a" kindref="member">fork_run_server</ref>(</highlight><highlight class="keyword">struct</highlight><highlight class="normal"><sp/><ref refid="structserver__state__st" kindref="compound">server_state_st</ref><sp/>*state);</highlight></codeline>
    </programlisting>
    <location file="tests/server/test_server/test_server.h"/>
  </compounddef>
</doxygen>
